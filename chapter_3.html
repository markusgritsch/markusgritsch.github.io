<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><title>Understanding Digital Signal Processing</title>
<style type="text/css">
body {
  font-family: "BookerlyLCD";
}
a {
  color: #005090;
  text-decoration: none;
}
a {font-variant-numeric: oldstyle-nums proportional-nums;}
p.caption {font-variant-numeric: oldstyle-nums proportional-nums;}
</style>
</head><body>


<div class="calibre" id="calibre_link-572">
<p class="calibre3"><a id="calibre_link-2482"></a></p>
<h2 class="calibre8"><a id="calibre_link-2483" class="calibre5"></a>Contents</h2>
<p class="toc-chapter"><strong class="calibre9"><a href="#calibre_link-589">3 THE DISCRETE FOURIER TRANSFORM</a></strong></p>
<p class="toc-section"><a href="#calibre_link-457">3.1 Understanding the DFT Equation</a></p>
<p class="toc-section"><a href="#calibre_link-590">3.2 DFT Symmetry</a></p>
<p class="toc-section"><a id="calibre_link-2484"></a><a href="#calibre_link-591">3.3 DFT Linearity</a></p>
<p class="toc-section"><a href="#calibre_link-465">3.4 DFT Magnitudes</a></p>
<p class="toc-section"><a href="#calibre_link-592">3.5 DFT Frequency Axis</a></p>
<p class="toc-section"><a href="#calibre_link-113">3.6 DFT Shifting Theorem</a></p>
<p class="toc-section"><a href="#calibre_link-593">3.7 Inverse DFT</a></p>
<p class="toc-section"><a href="#calibre_link-461">3.8 DFT Leakage</a></p>
<p class="toc-section"><a href="#calibre_link-594">3.9 Windows</a></p>
<p class="toc-section"><a href="#calibre_link-595">3.10 DFT Scalloping Loss</a></p>
<p class="toc-section"><a href="#calibre_link-460">3.11 DFT Resolution, Zero Padding, and Frequency-Domain Sampling</a></p>
<p class="toc-section"><a href="#calibre_link-596">3.12 DFT Processing Gain</a></p>
<p class="toc-section"><a href="#calibre_link-597">3.13 The DFT of Rectangular Functions</a></p>
<p class="toc-section"><a href="#calibre_link-598">3.14 Interpreting the DFT Using the Discrete-Time Fourier Transform</a></p>
<p class="toc-section1"><a href="#calibre_link-599">References</a></p>

</div>


<div class="calibre" id="calibre_link-589">
<p class="calibre3"><a id="calibre_link-134"></a></p>
<h2 class="calibre8"><a id="calibre_link-2049" class="calibre5"></a>3 The Discrete Fourier Transform</h2>
<p class="image"><img src="images/001041.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The discrete Fourier transform (DFT) is one of the two most common, and powerful, procedures encountered in the field of digital signal processing. (Digital filtering is the other.) The DFT enables us to analyze, manipulate, and synthesize signals in ways not possible with continuous (analog) signal processing. Even though it’s now used in almost every field of engineering, we’ll see applications for DFT continue to flourish as its utility becomes more widely understood. Because of this, a solid understanding of the DFT is mandatory for anyone working in the field of digital signal processing.</p>
<p class="calibre3">The DFT is a mathematical procedure used to determine the harmonic, or frequency, content of a discrete signal sequence. Although, for our purposes, a discrete signal sequence is a set of values obtained by periodic sampling of a continuous signal in the time domain, we’ll find that the DFT is useful in analyzing any discrete sequence regardless of what that sequence actually represents. The DFT’s origin, of course, is the continuous Fourier transform <em class="calibre7">X</em>(<em class="calibre7">f</em>) defined as</p>
<p class="caption"><a id="calibre_link-1515"></a>(3-1)</p>
<p class="image"><img src="images/001360.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">x</em>(<em class="calibre7">t</em>) is some continuous time-domain signal.<sup class="calibre10"><a id="calibre_link-1514"></a><a href="#calibre_link-1513">†</a></sup></p>
<p class="footnotes"><a id="calibre_link-1513"></a><sup class="calibre11"><a href="#calibre_link-1514">†</a></sup> Fourier is pronounced ‘for-y<img src="images/000571.jpg" alt="image" class="calibre2" />. In engineering school, we called <a href="#calibre_link-1515">Eq. (3-1)</a> the “four-year” transform because it took about four years to do one homework problem.</p>
<p class="calibre3">In the field of continuous signal processing, <a href="#calibre_link-1515">Eq. (3-1)</a> is used to transform an expression of a continuous time-domain function <em class="calibre7">x</em>(<em class="calibre7">t</em>) into a continuous frequency-domain function <em class="calibre7">X</em>(<em class="calibre7">f</em>). Subsequent evaluation of the <em class="calibre7">X</em>(<em class="calibre7">f</em>) <a id="calibre_link-2128"></a>expression enables us to determine the frequency content of any practical signal of interest and opens up a wide array of signal analysis and processing possibilities in the fields of engineering and physics. One could argue that the Fourier transform is the most dominant and widespread mathematical mechanism available for the analysis of physical systems. (A prominent quote from Lord Kelvin better states this sentiment: “Fourier’s theorem is not only one of the most beautiful results of modern analysis, but it may be said to furnish an indispensable instrument in the treatment of nearly every recondite question in modern physics.” By the way, the history of Fourier’s original work in harmonic analysis, relating to the problem of heat conduction, is fascinating. References <a href="#calibre_link-1516">[1]</a> and <a href="#calibre_link-1517">[2]</a> are good places to start for those interested in the subject.)</p>
<p class="calibre3">With the advent of the digital computer, the efforts of early digital processing pioneers led to the development of the DFT defined as the discrete frequency-domain sequence <em class="calibre7">X</em>(<em class="calibre7">m</em>), where</p>
<p class="caption"><a id="calibre_link-1518"></a>(3-2)</p>
<p class="image"><img src="images/000310.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">For our discussion of <a href="#calibre_link-1518">Eq. (3-2)</a>, <em class="calibre7">x</em>(<em class="calibre7">n</em>) is a discrete sequence of time-domain sampled values of the continuous variable <em class="calibre7">x</em>(<em class="calibre7">t</em>). The “<em class="calibre7">e</em>” in <a href="#calibre_link-1518">Eq. (3-2)</a> is, of course, the base of natural logarithms and <img src="images/001216.jpg" alt="image" class="calibre2" />.</p>
<p class="calibre3"><a id="calibre_link-457"></a></p>
<h3 class="calibre6">3.1 Understanding the DFT Equation</h3>
<p class="calibre3"><a href="#calibre_link-1518">Equation (3-2)</a> has a tangled, almost unfriendly, look about it. Not to worry. After studying this chapter, <a href="#calibre_link-1518">Eq. (3-2)</a> will become one of our most familiar and powerful tools in understanding digital signal processing. Let’s get started by expressing <a href="#calibre_link-1518">Eq. (3-2)</a> in a different way and examining it carefully. From <em class="calibre7">Euler’s relationship, e</em><sup class="calibre10">−<em class="calibre7">j</em>ø</sup> = cos(ø) −<em class="calibre7">j</em>sin(ø), <a href="#calibre_link-1518">Eq. (3-2)</a> is equivalent to</p>
<p class="caption"><a id="calibre_link-1519"></a>(3-3)</p>
<p class="image"><img src="images/001150.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We have separated the complex exponential of <a href="#calibre_link-1518">Eq. (3-2)</a> into its real and imaginary components where</p>
<p class="indent"><em class="calibre7">X</em>(<em class="calibre7">m</em>) = the <em class="calibre7">m</em>th DFT output component, i.e., <em class="calibre7">X</em>(0), <em class="calibre7">X</em>(1), <em class="calibre7">X</em>(2), <em class="calibre7">X</em>(3), etc.,</p>
<p class="indent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em class="calibre7">m</em> = the index of the DFT output in the frequency domain, <em class="calibre7">m</em> = 0, 1, 2, 3, . . ., <em class="calibre7">N</em>−1,</p>
<p class="indent">&nbsp;<em class="calibre7">x</em>(<em class="calibre7">n</em>) = the sequence of input samples, <em class="calibre7">x</em>(0), <em class="calibre7">x</em>(1), <em class="calibre7">x</em>(2), <em class="calibre7">x</em>(3), etc.,</p>
<p class="indent"><a id="calibre_link-2555"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em class="calibre7">n</em> = the time-domain index of the input samples, <em class="calibre7">n</em> = 0, 1, 2, 3, . . ., <em class="calibre7">N</em>−1,</p>
<p class="indent">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="images/001216.jpg" alt="image" class="calibre2" />, and</p>
<p class="indent">&nbsp;&nbsp;&nbsp;&nbsp;<em class="calibre7">N</em> = the number of samples of the input sequence and the number of frequency points in the DFT output.</p>
<p class="calibre3">Although it looks more complicated than <a href="#calibre_link-1518">Eq. (3-2)</a>, <a href="#calibre_link-1519">Eq. (3-3)</a> turns out to be easier to understand. (If you’re not too comfortable with it, don’t let the <img src="images/001216.jpg" alt="image" class="calibre2" /> concept bother you too much. It’s merely a convenient abstraction that helps us compare the phase relationship between various sinusoidal components of a signal. <a href="#calibre_link-235">Chapter 8</a> discusses the <em class="calibre7">j</em> operator in some detail.)<sup class="calibre10"><a id="calibre_link-1521"></a><a href="#calibre_link-1520">†</a></sup> The indices for the input samples (<em class="calibre7">n</em>) and the DFT output samples (<em class="calibre7">m</em>) always go from 0 to <em class="calibre7">N</em>−1 in the standard DFT notation. This means that with <em class="calibre7">N</em> input time-domain sample values, the DFT determines the spectral content of the input at <em class="calibre7">N</em> equally spaced frequency points. The value <em class="calibre7">N</em> is an important parameter because it determines how many input samples are needed, the resolution of the frequency-domain results, and the amount of processing time necessary to calculate an <em class="calibre7">N</em>-point DFT.</p>
<p class="footnotes"><a id="calibre_link-1520"></a><sup class="calibre11"><a href="#calibre_link-1521">†</a></sup> Instead of the letter <em class="calibre7">j</em>, be aware that mathematicians often use the letter <em class="calibre7">i</em> to represent the <img src="images/000038.jpg" alt="image" class="calibre2" /> operator.</p>
<p class="calibre3">It’s useful to see the structure of <a href="#calibre_link-1519">Eq. (3-3)</a> by eliminating the summation and writing out all the terms. For example, when <em class="calibre7">N</em> = 4, <em class="calibre7">n</em> and <em class="calibre7">m</em> both go from 0 to 3, and <a href="#calibre_link-1519">Eq. (3-3)</a> becomes</p>
<p class="caption"><a id="calibre_link-1522"></a>(3-4a)</p>
<p class="image"><img src="images/000198.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Writing out all the terms for the first DFT output term corresponding to <em class="calibre7">m</em> = 0,</p>
<p class="caption"><a id="calibre_link-1523"></a>(3-4b)</p>
<p class="image"><img src="images/001040.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">For the second DFT output term corresponding to <em class="calibre7">m</em> = 1, <a href="#calibre_link-1522">Eq. (3-4a)</a> becomes</p>
<p class="caption"><a id="calibre_link-2556"></a>(3-4c)</p>
<p class="image"><img src="images/000095.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2101"></a>For the third output term corresponding to <em class="calibre7">m</em> = 2, <a href="#calibre_link-1522">Eq. (3-4a)</a> becomes</p>
<p class="caption"><a id="calibre_link-2557"></a>(3-4d)</p>
<p class="image"><img src="images/001515.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Finally, for the fourth and last output term corresponding to <em class="calibre7">m</em> = 3, <a href="#calibre_link-1522">Eq. (3-4a)</a> becomes</p>
<p class="caption"><a id="calibre_link-1524"></a>(3-4e)</p>
<p class="image"><img src="images/001798.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The above multiplication symbol “·” in <a href="#calibre_link-1522">Eq. (3-4)</a> is used merely to separate the factors in the sine and cosine terms. The pattern in <a href="#calibre_link-1523">Eqs. (3-4b)</a> through <a href="#calibre_link-1524">(3-4e)</a> is apparent now, and we can certainly see why it’s convenient to use the summation sign in <a href="#calibre_link-1519">Eq. (3-3)</a>. Each <em class="calibre7">X</em>(<em class="calibre7">m</em>) DFT output term is the sum of the <em class="calibre7">point-for-point</em> product between an input sequence of signal values and a complex sinusoid of the form cos(ø) − <em class="calibre7">j</em>sin(ø). The exact frequencies of the different sinusoids depend on both the sampling rate <em class="calibre7">f<sub class="calibre12">s</sub></em> at which the original signal was sampled, and the number of samples <em class="calibre7">N</em>. For example, if we are sampling a continuous signal at a rate of 500 samples/second and, then, perform a 16-point DFT on the sampled data, the fundamental frequency of the sinusoids is <em class="calibre7">f<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em> = 500/16 or 31.25 Hz. The other <em class="calibre7">X</em>(<em class="calibre7">m</em>) analysis frequencies are integral multiples of the fundamental frequency, i.e.,</p>
<p class="calibre3">X(0) = 1st frequency term, with analysis frequency = 0 · 31.25 = 0 Hz,<br class="calibre1" />X(1) = 2nd frequency term, with analysis frequency = 1 · 31.25 = 31.25 Hz,<br class="calibre1" />X(2) = 3rd frequency term, with analysis frequency = 2 · 31.25 = 62.5 Hz,<br class="calibre1" />X(3) = 4th frequency term, with analysis frequency = 3 · 31.25 = 93.75 Hz,</p>
<p class="center">. . .</p>
<p class="center">. . .</p>
<p class="calibre3">X(15) = 16th frequency term, with analysis frequency = 15 · 31.25 = 468.75 Hz.</p>
<p class="calibre3">The <em class="calibre7">N</em> separate DFT analysis frequencies are</p>
<p class="caption"><a id="calibre_link-1526"></a>(3-5)</p>
<p class="image"><img src="images/000823.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So, in this example, the <em class="calibre7">X</em>(0) DFT term tells us the magnitude of any 0 Hz DC (direct current) component contained in the input signal, the <em class="calibre7">X</em>(1) term specifies <a id="calibre_link-2129"></a>the magnitude of any 31.25 Hz component in the input signal, and the <em class="calibre7">X</em>(2) term indicates the magnitude of any 62.5 Hz component in the input signal, etc. Moreover, as we’ll soon show by example, the DFT output terms also determine the phase relationship between the various analysis frequencies contained in an input signal.</p>
<p class="calibre3">Quite often we’re interested in both the magnitude and the power (magnitude squared) contained in each <em class="calibre7">X</em>(<em class="calibre7">m</em>) term, and the standard definitions for right triangles apply here as depicted in <a href="#calibre_link-1525">Figure 3-1</a>.</p>
<p class="caption"><a id="calibre_link-1525"></a><strong class="calibre9">Figure 3-1</strong> Trigonometric relationships of an individual DFT <em class="calibre7">X</em>(<em class="calibre7">m</em>) complex output value.</p>
<p class="image"><img src="images/000097.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we represent an arbitrary DFT output value, <em class="calibre7">X</em>(<em class="calibre7">m</em>), by its real and imaginary parts</p>
<p class="caption"><a id="calibre_link-1616"></a>(3-6)</p>
<p class="image"><img src="images/001682.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">the magnitude of <em class="calibre7">X</em>(<em class="calibre7">m</em>) is</p>
<p class="caption"><a id="calibre_link-1530"></a>(3-7)</p>
<p class="image"><img src="images/000705.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">By definition, the phase angle of <em class="calibre7">X</em>(<em class="calibre7">m</em>), <em class="calibre7">X</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>), is</p>
<p class="caption"><a id="calibre_link-1531"></a>(3-8)</p>
<p class="image"><img src="images/001563.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The power of <em class="calibre7">X</em>(<em class="calibre7">m</em>), referred to as the power spectrum, is the magnitude squared where</p>
<p class="caption"><a id="calibre_link-1532"></a>(3-9)</p>
<p class="image"><img src="images/000587.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2558"></a></p>
<h4 class="calibre13">3.1.1 DFT Example 1</h4>
<p class="calibre3">The above <a href="#calibre_link-1518">Eqs. (3-2)</a> and <a href="#calibre_link-1519">(3-3)</a> will become more meaningful by way of an example, so let’s go through a simple one step by step. Let’s say we want to <a id="calibre_link-2559"></a>sample and perform an 8-point DFT on a continuous input signal containing components at 1 kHz and 2 kHz, expressed as</p>
<p class="caption"><a id="calibre_link-1528"></a>(3-10)</p>
<p class="image"><img src="images/001448.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To make our example input signal <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">t</em>) a little more interesting, we have the 2 kHz term shifted in phase by 135° (3π/4 radians) relative to the 1 kHz sinewave. With a sample rate of <em class="calibre7">f<sub class="calibre12">s</sub></em>, we sample the input every 1/<em class="calibre7">f<sub class="calibre12">s</sub></em> = <em class="calibre7">t<sub class="calibre12">s</sub></em> seconds. Because <em class="calibre7">N</em> = 8, we need 8 input sample values on which to perform the DFT. So the 8-element sequence <em class="calibre7">x</em>(<em class="calibre7">n</em>) is equal to <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">t</em>) sampled at the <em class="calibre7">nt<sub class="calibre12">s</sub></em> instants in time so that</p>
<p class="caption"><a id="calibre_link-1536"></a>(3-11)</p>
<p class="image"><img src="images/000485.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we choose to sample <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">t</em>) at a rate of <em class="calibre7">f<sub class="calibre12">s</sub></em> = 8000 samples/second from <a href="#calibre_link-1526">Eq. (3-5)</a>, our DFT results will indicate what signal amplitude exists in <em class="calibre7">x</em>(<em class="calibre7">n</em>) at the analysis frequencies of <em class="calibre7">mf<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em>, or 0 kHz, 1 kHz, 2 kHz, . . ., 7 kHz. With <em class="calibre7">f<sub class="calibre12">s</sub></em> = 8000 samples/second, our eight <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples are</p>
<p class="caption"><a id="calibre_link-1543"></a>(3-11′)</p>
<p class="image"><img src="images/001351.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">These <em class="calibre7">x</em>(<em class="calibre7">n</em>) sample values are the dots plotted on the solid continuous <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">t</em>) curve in <a href="#calibre_link-1527">Figure 3-2(a)</a>. (Note that the sum of the sinusoidal terms in <a href="#calibre_link-1528">Eq. (3-10)</a>, shown as the dashed curves in <a href="#calibre_link-1527">Figure 3-2(a)</a>, is equal to <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">t</em>).)</p>
<p class="caption"><a id="calibre_link-2560"></a><a id="calibre_link-1527"></a><strong class="calibre9">Figure 3-2</strong> DFT Example 1: (a) the input signal; (b) the input signal and the <em class="calibre7">m</em> = 1 sinusoids; (c) the input signal and the <em class="calibre7">m</em> = 2 sinusoids; (d) the input signal and the <em class="calibre7">m</em> = 3 sinusoids.</p>
<p class="image"><img src="images/000935.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Now we’re ready to apply <a href="#calibre_link-1519">Eq. (3-3)</a> to determine the DFT of our <em class="calibre7">x</em>(<em class="calibre7">n</em>) input. We’ll start with <em class="calibre7">m</em> = 1 because the <em class="calibre7">m</em> = 0 case leads to a special result that we’ll discuss shortly. So, for <em class="calibre7">m</em> = 1, or the 1 kHz (<em class="calibre7">mf<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em> = 1·8000/8) DFT frequency term, <a href="#calibre_link-1519">Eq. (3-3)</a> for this example becomes</p>
<p class="caption"><a id="calibre_link-1529"></a>(3-12)</p>
<p class="image"><img src="images/000104.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Next we multiply <em class="calibre7">x</em>(<em class="calibre7">n</em>) by successive points on the cosine and sine curves of the first analysis frequency that have a single cycle over our eight input samples. In our example, for <em class="calibre7">m</em> = 1, we’ll sum the products of the <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence with a 1 kHz cosine wave and a 1 kHz sinewave evaluated at the angular values of 2π<em class="calibre7">n</em>/8. Those analysis sinusoids are shown as the dashed curves in <a href="#calibre_link-1527">Figure 3-2(b)</a>. Notice how the cosine and sinewaves have <em class="calibre7">m</em> = 1 complete cycles in our sample interval.</p>
<p class="calibre3"><a id="calibre_link-2561"></a>Substituting our <em class="calibre7">x</em>(<em class="calibre7">n</em>) sample values into <a href="#calibre_link-1529">Eq. (3-12)</a> and listing the cosine terms in the left column and the sine terms in the right column, we have</p>
<p class="image"><img src="images/001221.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So we now see that the input <em class="calibre7">x</em>(<em class="calibre7">n</em>) contains a signal component at a frequency of 1 kHz. Using <a href="#calibre_link-1530">Eqs. (3-7)</a>, <a href="#calibre_link-1531">(3-8)</a>, and <a href="#calibre_link-1532">(3-9)</a> for our <em class="calibre7">X</em>(1) result, <em class="calibre7">X</em><sub class="calibre12">mag</sub>(1) = 4, <em class="calibre7">X</em><sub class="calibre12">PS</sub>(1) = 16, and <em class="calibre7">X</em>(1)’s phase angle relative to a 1 kHz cosine is <em class="calibre7">X</em><sub class="calibre12">ø</sub>(1) = −90°.</p>
<p class="calibre3">For the <em class="calibre7">m</em> = 2 frequency term, we correlate <em class="calibre7">x</em>(<em class="calibre7">n</em>) with a 2 kHz cosine wave and a 2 kHz sinewave. These waves are the dashed curves in <a href="#calibre_link-1527">Figure 3-2(c)</a>. Notice here that the cosine and sinewaves have <em class="calibre7">m</em> = 2 complete cycles in our sample interval in <a href="#calibre_link-1527">Figure 3-2(c)</a>. Substituting our <em class="calibre7">x</em>(<em class="calibre7">n</em>) sample values in <a href="#calibre_link-1519">Eq. (3-3)</a> for <em class="calibre7">m</em> = 2 gives</p>
<p class="image"><img src="images/000260.jpg" alt="image" class="calibre2" /></p>
<p class="image"><a id="calibre_link-2562"></a><img src="images/001100.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Here our input <em class="calibre7">x</em>(<em class="calibre7">n</em>) contains a signal at a frequency of 2 kHz whose relative amplitude is 2, and whose phase angle relative to a 2 kHz cosine is 45°. For the <em class="calibre7">m</em> = 3 frequency term, we correlate <em class="calibre7">x</em>(<em class="calibre7">n</em>) with a 3 kHz cosine wave and a 3 kHz sinewave. These waves are the dashed curves in <a href="#calibre_link-1527">Figure 3-2(d)</a>. Again, see how the cosine and sinewaves have <em class="calibre7">m</em> = 3 complete cycles in our sample interval in <a href="#calibre_link-1527">Figure 3-2(d)</a>. Substituting our <em class="calibre7">x</em>(<em class="calibre7">n</em>) sample values in <a href="#calibre_link-1519">Eq. (3-3)</a> for <em class="calibre7">m</em> = 3 gives</p>
<p class="image"><img src="images/001093.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Our DFT indicates that <em class="calibre7">x</em>(<em class="calibre7">n</em>) contained no signal at a frequency of 3 kHz. Let’s continue our DFT for the <em class="calibre7">m</em> = 4 frequency term using the sinusoids in <a href="#calibre_link-1533">Figure 3-3(a)</a>.</p>
<p class="caption"><a id="calibre_link-2563"></a><a id="calibre_link-1533"></a><strong class="calibre9">Figure 3-3</strong> DFT Example 1: (a) the input signal and the <em class="calibre7">m</em> = 4 sinusoids; (b) the input and the <em class="calibre7">m</em> = 5 sinusoids; (c) the input and the <em class="calibre7">m</em> = 6 sinusoids; (d) the input and the <em class="calibre7">m</em> = 7 sinusoids.</p>
<p class="image"><img src="images/001799.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So <a href="#calibre_link-1519">Eq. (3-3)</a> is</p>
<p class="image"><a id="calibre_link-2564"></a><img src="images/000996.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Our DFT for the <em class="calibre7">m</em> = 5 frequency term using the sinusoids in <a href="#calibre_link-1533">Figure 3-3(b)</a> yields</p>
<p class="image"><img src="images/001229.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">For the <em class="calibre7">m</em> = 6 frequency term using the sinusoids in <a href="#calibre_link-1533">Figure 3-3(c)</a>, <a href="#calibre_link-1519">Eq. (3-3)</a> is</p>
<p class="image"><a id="calibre_link-2565"></a><img src="images/000892.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">For the <em class="calibre7">m</em> = 7 frequency term using the sinusoids in <a href="#calibre_link-1533">Figure 3-3(d)</a>, <a href="#calibre_link-1519">Eq. (3-3)</a> is</p>
<p class="image"><img src="images/001746.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we plot the <em class="calibre7">X</em>(<em class="calibre7">m</em>) output magnitudes as a function of frequency, we produce the magnitude <em class="calibre7">spectrum</em> of the <em class="calibre7">x</em>(<em class="calibre7">n</em>) input sequence, shown in <a href="#calibre_link-1534">Figure 3-4(a)</a>. The phase angles of the <em class="calibre7">X</em>(<em class="calibre7">m</em>) output terms are depicted in <a href="#calibre_link-1534">Figure 3-4(b)</a>.</p>
<p class="caption"><a id="calibre_link-2566"></a><a id="calibre_link-1534"></a><strong class="calibre9">Figure 3-4</strong> DFT results from Example 1: (a) magnitude of <em class="calibre7">X</em>(<em class="calibre7">m</em>); (b) phase of <em class="calibre7">X</em>(<em class="calibre7">m</em>); (c) real part of <em class="calibre7">X</em>(<em class="calibre7">m</em>); (d) imaginary part of <em class="calibre7">X</em>(<em class="calibre7">m</em>).</p>
<p class="image"><img src="images/000824.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Hang in there; we’re almost finished with our example. We’ve saved the calculation of the <em class="calibre7">m</em> = 0 frequency term to the end because it has a special significance. When <em class="calibre7">m</em> = 0, we correlate <em class="calibre7">x</em>(<em class="calibre7">n</em>) with cos(0) − <em class="calibre7">j</em>sin(0) so that <a href="#calibre_link-1519">Eq. (3-3)</a> becomes</p>
<p class="caption"><a id="calibre_link-2567"></a>(3-13)</p>
<p class="image"><img src="images/000021.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Because cos(0) = 1, and sin(0) = 0,</p>
<p class="caption"><a id="calibre_link-1535"></a>(3-13′)</p>
<p class="image"><img src="images/000865.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We can see that <a href="#calibre_link-1535">Eq. (3-13′)</a> is the sum of the <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples. This sum is, of course, proportional to the average of <em class="calibre7">x</em>(<em class="calibre7">n</em>). (Specifically, <em class="calibre7">X</em>(0) is equal to <em class="calibre7">N</em> times <em class="calibre7">x</em>(<em class="calibre7">n</em>)’s average value.) This makes sense because the <em class="calibre7">X</em>(0) frequency term is the non-time-varying (DC) component of <em class="calibre7">x</em>(<em class="calibre7">n</em>). If <em class="calibre7">X</em>(0) were nonzero, this would tell us that the <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence is riding on a DC bias and has some nonzero average value. For our specific example input from <a href="#calibre_link-1528">Eq. (3-10)</a>, the sum, however, is zero. The input sequence has no DC component, so we <a id="calibre_link-2568"></a>know that <em class="calibre7">X</em>(0) will be zero. But let’s not be lazy&mdash;we’ll calculate <em class="calibre7">X</em>(0) anyway just to be sure. Evaluating <a href="#calibre_link-1519">Eq. (3-3)</a> or <a href="#calibre_link-1535">Eq. (3-13′)</a> for <em class="calibre7">m</em> = 0, we see that</p>
<p class="image"><img src="images/000772.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So our <em class="calibre7">x</em>(<em class="calibre7">n</em>) had no DC component, and, thus, its average value is zero. Notice that <a href="#calibre_link-1534">Figure 3-4</a> indicates that <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">t</em>), from <a href="#calibre_link-1528">Eq. (3-10)</a>, has signal components at 1 kHz (<em class="calibre7">m</em> = 1) and 2 kHz (<em class="calibre7">m</em> = 2). Moreover, the 1 kHz tone has a magnitude twice that of the 2 kHz tone. The DFT results depicted in <a href="#calibre_link-1534">Figure 3-4</a> tell us exactly the spectral content of the signal defined by <a href="#calibre_link-1528">Eqs. (3-10)</a> and <a href="#calibre_link-1536">(3-11)</a>.</p>
<p class="calibre3">While looking at <a href="#calibre_link-1534">Figure 3-4(b)</a>, we might notice that the phase of <em class="calibre7">X</em>(1) is −90 degrees and ask, “This −90 degrees phase is relative to what?” The answer is: The DFT phase at the frequency <em class="calibre7">mf<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em> is relative to a cosine wave at that same frequency of <em class="calibre7">mf<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em> Hz where <em class="calibre7">m</em> = 1, 2, 3, ..., <em class="calibre7">N</em>−1. For example, the phase of <em class="calibre7">X</em>(1) is −90 degrees, so the input sinusoid whose frequency is 1 · <em class="calibre7">f<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em> = 1000 Hz was a cosine wave having an initial phase shift of −90 degrees. From the trigonometric identity cos(α−90°) = sin(α), we see that the 1000 Hz input tone was a sinewave having an initial phase of zero. This agrees with our <a href="#calibre_link-1536">Eq. (3-11)</a>. The phase of <em class="calibre7">X</em>(2) is 45 degrees so the 2000 Hz input tone was a cosine wave having an initial phase of 45 degrees, which is equivalent to a sinewave having an initial phase of 135 degrees (3π/4 radians from <a href="#calibre_link-1536">Eq. (3-11)</a>).</p>
<p class="calibre3">When the DFT input signals are real-valued, the DFT phase at 0 Hz (<em class="calibre7">m</em> = 0, DC) is always zero because <em class="calibre7">X</em>(0) is always real-only as shown by <a href="#calibre_link-1535">Eq. (3-13′)</a>.</p>
<p class="calibre3">The perceptive reader should be asking two questions at this point. First, what do those nonzero magnitude values at <em class="calibre7">m</em> = 6 and <em class="calibre7">m</em> = 7 in <a href="#calibre_link-1534">Figure 3-4(a)</a> mean? Also, why do the magnitudes seem four times larger than we would <a id="calibre_link-1971"></a>expect? We’ll answer those good questions shortly. The above 8-point DFT example, although admittedly simple, illustrates two very important characteristics of the DFT that we should never forget. First, any individual <em class="calibre7">X</em>(<em class="calibre7">m</em>) output value is nothing more than the sum of the term-by-term products, a correlation, of an input signal sample sequence with a cosine and a sinewave whose frequencies are <em class="calibre7">m</em> complete cycles in the total sample interval of <em class="calibre7">N</em> samples. This is true no matter what the <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate is and no matter how large <em class="calibre7">N</em> is in an <em class="calibre7">N</em>-point DFT. The second important characteristic of the DFT of real input samples is the symmetry of the DFT output terms.</p>
<p class="calibre3"><a id="calibre_link-590"></a></p>
<h3 class="calibre6">3.2 DFT Symmetry</h3>
<p class="calibre3">Looking at <a href="#calibre_link-1534">Figure 3-4(a)</a> again, we see that there is an obvious symmetry in the DFT results. Although the standard DFT is designed to accept complex input sequences, most physical DFT inputs (such as digitized values of some continuous signal) are referred to as <em class="calibre7">real</em>; that is, real inputs have nonzero real sample values, and the imaginary sample values are assumed to be zero. When the input sequence <em class="calibre7">x</em>(<em class="calibre7">n</em>) is real, as it will be for all of our examples, the complex DFT outputs for <em class="calibre7">m</em> = 1 to <em class="calibre7">m</em> = (<em class="calibre7">N</em>/2) − 1 are redundant with frequency output values for <em class="calibre7">m</em> &gt; (<em class="calibre7">N</em>/2). The <em class="calibre7">m</em>th DFT output will have the same magnitude as the (<em class="calibre7">N</em>−<em class="calibre7">m</em>)th DFT output. The phase angle of the DFT’s <em class="calibre7">m</em>th output is the negative of the phase angle of the (<em class="calibre7">N</em>−<em class="calibre7">m</em>)th DFT output. So the <em class="calibre7">m</em>th and (<em class="calibre7">N</em>−<em class="calibre7">m</em>)th outputs are related by the following</p>
<p class="caption"><a id="calibre_link-1537"></a>(3-14)</p>
<p class="image"><img src="images/001721.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">for 1 ≤ <em class="calibre7">m</em> ≤ (<em class="calibre7">N</em>/2)−1. We can state that when the DFT input sequence is real, <em class="calibre7">X</em>(<em class="calibre7">m</em>) is the complex conjugate of <em class="calibre7">X</em>(<em class="calibre7">N</em>−<em class="calibre7">m</em>), or</p>
<p class="caption"><a id="calibre_link-2569"></a>(3-14′)</p>
<p class="image"><img src="images/000744.jpg" alt="image" class="calibre2" /></p>
<p class="footnotes"><a id="calibre_link-2570"></a><sup class="calibre11">†</sup> Using our notation, the complex conjugate of <em class="calibre7">x</em> = <em class="calibre7">a</em> + <em class="calibre7">jb</em> is defined as <em class="calibre7">x</em>* = <em class="calibre7">a</em> − <em class="calibre7">jb</em>; that is, we merely change the sign of the imaginary part of <em class="calibre7">x</em>. In an equivalent form, if <em class="calibre7">x</em> = <em class="calibre7">e<sup class="calibre11">j</sup></em><sup class="calibre11">ø</sup>, then <em class="calibre7">x</em>* = <em class="calibre7">e</em><sup class="calibre11">−<em class="calibre7">j</em>ø</sup>.</p>
<p class="calibre3">where the superscript “*” symbol denotes conjugation, and <em class="calibre7">m</em> = 1, 2, 3, . . . , <em class="calibre7">N</em>−1.</p>
<p class="calibre3">In our example above, notice in <a href="#calibre_link-1534">Figures 3-4(b)</a> and <a href="#calibre_link-1534">3-4(d)</a> that <em class="calibre7">X</em>(5), <em class="calibre7">X</em>(6), and <em class="calibre7">X</em>(7) are the complex conjugates of <em class="calibre7">X</em>(3), <em class="calibre7">X</em>(2), and <em class="calibre7">X</em>(1), respectively. Like the DFT’s magnitude symmetry, the real part of <em class="calibre7">X</em>(<em class="calibre7">m</em>) has what is called <em class="calibre7">even symmetry,</em> as shown in <a href="#calibre_link-1534">Figure 3-4(c)</a>, while the DFT’s imaginary part has <a id="calibre_link-2571"></a><em class="calibre7">odd symmetry,</em> as shown in <a href="#calibre_link-1534">Figure 3-4(d)</a>. This relationship is what is meant when the DFT is called conjugate symmetric in the literature. It means that if we perform an <em class="calibre7">N</em>-point DFT on a real input sequence, we’ll get <em class="calibre7">N</em> separate complex DFT output terms, but only the first <em class="calibre7">N</em>/2+1 terms are independent. So to obtain the DFT of <em class="calibre7">x</em>(<em class="calibre7">n</em>), we need only compute the first <em class="calibre7">N</em>/2+1 values of <em class="calibre7">X</em>(<em class="calibre7">m</em>) where 0 ≤ <em class="calibre7">m</em> ≤ (<em class="calibre7">N</em>/2); the <em class="calibre7">X</em>(<em class="calibre7">N</em>/2+1) to <em class="calibre7">X</em>(<em class="calibre7">N</em>−1) DFT output terms provide no additional information about the spectrum of the real sequence <em class="calibre7">x</em>(<em class="calibre7">n</em>).</p>
<p class="calibre3">The above <em class="calibre7">N</em>-point DFT symmetry discussion applies to DFTs, whose inputs are real-valued, where <em class="calibre7">N</em> is an even number. If <em class="calibre7">N</em> happens to be an odd number, then only the first (<em class="calibre7">N</em>+1)/2 samples of the DFT are independent. For example, with a 9-point DFT only the first five DFT samples are independent.</p>
<p class="calibre3">Although <a href="#calibre_link-1518">Eqs. (3-2)</a> and <a href="#calibre_link-1519">(3-3)</a> are equivalent, expressing the DFT in the exponential form of <a href="#calibre_link-1518">Eq. (3-2)</a> has a terrific advantage over the form of <a href="#calibre_link-1519">Eq. (3-3)</a>. Not only does <a href="#calibre_link-1518">Eq. (3-2)</a> save pen and paper, but <a href="#calibre_link-1518">Eq. (3-2)</a>’s exponentials are much easier to manipulate when we’re trying to analyze DFT relationships. Using <a href="#calibre_link-1518">Eq. (3-2)</a>, products of terms become the addition of exponents and, with due respect to Euler, we don’t have all those trigonometric relationships to memorize. Let’s demonstrate this by proving <a href="#calibre_link-1537">Eq. (3-14)</a> to show the symmetry of the DFT of real input sequences. Substituting <em class="calibre7">N</em>−<em class="calibre7">m</em> for <em class="calibre7">m</em> in <a href="#calibre_link-1518">Eq. (3-2)</a>, we get the expression for the (<em class="calibre7">N</em>−<em class="calibre7">m</em>)th component of the DFT:</p>
<p class="caption"><a id="calibre_link-2572"></a>(3-15)</p>
<p class="image"><img src="images/001604.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Because <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>2π<em class="calibre7">n</em></sup> = cos(2π<em class="calibre7">n</em>) −<em class="calibre7">j</em>sin(2π<em class="calibre7">n</em>) = 1 for all integer values of <em class="calibre7">n</em>,</p>
<p class="caption"><a id="calibre_link-1538"></a>(3-15′)</p>
<p class="image"><img src="images/000625.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We see that <em class="calibre7">X</em>(<em class="calibre7">N</em>−<em class="calibre7">m</em>) in <a href="#calibre_link-1538">Eq. (3-15′)</a> is merely <em class="calibre7">X</em>(<em class="calibre7">m</em>) in <a href="#calibre_link-1518">Eq. (3-2)</a> with the sign reversed on <em class="calibre7">X</em>(<em class="calibre7">m</em>)’s exponent&mdash;and that’s the definition of the complex conjugate. This is illustrated by the DFT output phase-angle plot in <a href="#calibre_link-1534">Figure 3-4(b)</a> for our DFT Example 1. Try deriving <a href="#calibre_link-1538">Eq. (3-15′)</a> using the cosines and sines of <a href="#calibre_link-1519">Eq. (3-3)</a>, and you’ll see why the exponential form of the DFT is so convenient for analytical purposes.</p>
<p class="calibre3">There’s an additional symmetry property of the DFT that deserves mention at this point. In practice, we’re occasionally required to determine the DFT of real input functions where the input index <em class="calibre7">n</em> is defined over both positive and negative values. If that real input function is even, then <em class="calibre7">X</em>(<em class="calibre7">m</em>) is always <a id="calibre_link-2135"></a>real and even; that is, if the real <em class="calibre7">x</em>(<em class="calibre7">n</em>) = <em class="calibre7">x</em>(−<em class="calibre7">n</em>), then, <em class="calibre7">X</em><sub class="calibre12">real</sub>(<em class="calibre7">m</em>) is in general nonzero and <em class="calibre7">X</em><sub class="calibre12">imag</sub>(<em class="calibre7">m</em>) is zero. Conversely, if the real input function is odd, <em class="calibre7">x</em>(<em class="calibre7">n</em>) = −<em class="calibre7">x</em>(−<em class="calibre7">n</em>), then <em class="calibre7">X</em><sub class="calibre12">real</sub>(<em class="calibre7">m</em>) is always zero and <em class="calibre7">X</em><sub class="calibre12">imag</sub>(<em class="calibre7">m</em>) is, in general, nonzero. This characteristic of input function symmetry is a property that the DFT shares with the continuous Fourier transform, and (don’t worry) we’ll cover specific examples of it later in <a href="#calibre_link-597">Section 3.13</a> and in <a href="#calibre_link-79">Chapter 5</a>.</p>
<p class="calibre3"><a id="calibre_link-591"></a></p>
<h3 class="calibre6">3.3 DFT Linearity</h3>
<p class="calibre3">The DFT has a very important property known as <em class="calibre7">linearity.</em> This property states that the DFT of the sum of two signals is equal to the sum of the transforms of each signal; that is, if an input sequence <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) has a DFT <em class="calibre7">X</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>) and another input sequence <em class="calibre7">x</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>) has a DFT <em class="calibre7">X</em><sub class="calibre12">2</sub>(<em class="calibre7">m</em>), then the DFT of the sum of these sequences <em class="calibre7">x</em><sub class="calibre12">sum</sub>(<em class="calibre7">n</em>) = <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) + <em class="calibre7">x</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>) is</p>
<p class="caption"><a id="calibre_link-2573"></a>(3-16)</p>
<p class="image"><img src="images/001484.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">This is certainly easy enough to prove. If we plug <em class="calibre7">x</em><sub class="calibre12">sum</sub>(<em class="calibre7">n</em>) into <a href="#calibre_link-1518">Eq. (3-2)</a> to get <em class="calibre7">X</em><sub class="calibre12">sum</sub>(<em class="calibre7">m</em>), then</p>
<p class="image"><img src="images/000850.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Without this property of linearity, the DFT would be useless as an analytical tool because we could transform only those input signals that contain a single sinewave. The real-world signals that we want to analyze are much more complicated than a single sinewave.</p>
<p class="calibre3"><a id="calibre_link-465"></a></p>
<h3 class="calibre6">3.4 DFT Magnitudes</h3>
<p class="calibre3">The DFT Example 1 results of |<em class="calibre7">X</em>(1)| = 4 and |<em class="calibre7">X</em>(2)| = 2 may puzzle the reader because our input <em class="calibre7">x</em>(<em class="calibre7">n</em>) signal, from <a href="#calibre_link-1536">Eq. (3-11)</a>, had peak amplitudes of 1.0 and 0.5, respectively. There’s an important point to keep in mind regarding DFTs defined by <a href="#calibre_link-1518">Eq. (3-2)</a>. When a real input signal contains a sinewave component, whose frequency is less than half the <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate, of peak amplitude <em class="calibre7">A</em><sub class="calibre12">o</sub> with an integral number of cycles over <em class="calibre7">N</em> input samples, the output magnitude of the DFT for that particular sinewave is <em class="calibre7">M<sub class="calibre12">r</sub></em> where</p>
<p class="caption"><a id="calibre_link-1539"></a>(3-17)</p>
<p class="image"><img src="images/000518.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2574"></a>If the DFT input is a complex sinusoid of magnitude <em class="calibre7">A</em><sub class="calibre12">o</sub> (i.e., <em class="calibre7">A</em><sub class="calibre12">o</sub><em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">2π<em class="calibre7">fnt<sub class="calibre15">s</sub></em></sup>) with an integer number of cycles over <em class="calibre7">N</em> samples, the <em class="calibre7">M</em><sub class="calibre12">c</sub> output magnitude of the DFT for that particular sinewave is</p>
<p class="caption"><a id="calibre_link-1540"></a>(3-17′)</p>
<p class="image"><img src="images/000263.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">As stated in relation to <a href="#calibre_link-1535">Eq. (3-13′)</a>, if the DFT input was riding on a DC bias value equal to <em class="calibre7">D</em><sub class="calibre12">o</sub>, the magnitude of the DFT’s <em class="calibre7">X</em>(0) output will be <em class="calibre7">D</em><sub class="calibre12">o</sub><em class="calibre7">N</em>.</p>
<p class="calibre3">Looking at the real input case for the 1000 Hz component of <a href="#calibre_link-1536">Eq. (3-11)</a>, <em class="calibre7">A</em><sub class="calibre12">o</sub> = 1 and <em class="calibre7">N</em> = 8, so that <em class="calibre7">M</em><sub class="calibre12">real</sub> = 1 · 8/2 = 4, as our example shows. <a href="#calibre_link-1539">Equation (3-17)</a> may not be so important when we’re using software or floating-point hardware to perform DFTs, but if we’re implementing the DFT with fixed-point hardware, we have to be aware that the output can be as large as <em class="calibre7">N</em>/2 times the peak value of the input. This means that, for real inputs, hardware memory registers must be able to hold values as large as <em class="calibre7">N</em>/2 times the maximum amplitude of the input sample values. We discuss DFT output magnitudes in further detail later in this chapter. The DFT magnitude expressions in <a href="#calibre_link-1539">Eqs. (3-17)</a> and <a href="#calibre_link-1540">(3-17′)</a> are why we occasionally see the DFT defined in the literature as</p>
<p class="caption"><a id="calibre_link-1541"></a>(3-18)</p>
<p class="image"><img src="images/000841.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The 1/<em class="calibre7">N</em> scale factor in <a href="#calibre_link-1541">Eq. (3-18)</a> makes the amplitudes of <em class="calibre7">X</em>′(<em class="calibre7">m</em>) equal to half the time-domain input sinusoid’s peak value at the expense of the additional division by <em class="calibre7">N</em> computation. Thus, hardware or software implementations of the DFT typically use <a href="#calibre_link-1518">Eq. (3-2)</a> as opposed to <a href="#calibre_link-1541">Eq. (3-18)</a>. Of course, there are always exceptions. There are commercial software packages using</p>
<p class="caption"><a id="calibre_link-1542"></a>(3-18′)</p>
<p class="image"><img src="images/001269.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">for the forward and inverse DFTs. (In <a href="#calibre_link-593">Section 3.7</a>, we discuss the meaning and significance of the inverse DFT.) The <img src="images/001182.jpg" alt="image" class="calibre2" /> scale factors in <a href="#calibre_link-1542">Eqs. (3-18′)</a> seem a little strange, but they’re used so that there’s no scale change when transforming in either direction. When analyzing signal spectra in practice, we’re normally more interested in the relative magnitudes rather than absolute magnitudes of the individual DFT outputs, so scaling factors aren’t usually that important to us.</p>
<p class="calibre3"><a id="calibre_link-592"></a></p>
<h3 class="calibre6"><a id="calibre_link-2132" class="calibre5"></a>3.5 DFT Frequency Axis</h3>
<p class="calibre3">The frequency axis <em class="calibre7">m</em> of the DFT result in <a href="#calibre_link-1534">Figure 3-4</a> deserves our attention once again. Suppose we hadn’t previously seen our DFT Example 1, were given the eight input sample values, from <a href="#calibre_link-1543">Eq. (3-11′)</a>, and were asked to perform an 8-point DFT on them. We’d grind through <a href="#calibre_link-1518">Eq. (3-2)</a> and obtain the <em class="calibre7">X</em>(<em class="calibre7">m</em>) values shown in <a href="#calibre_link-1534">Figure 3-4</a>. Next we ask, “What’s the frequency of the highest magnitude component in <em class="calibre7">X</em>(<em class="calibre7">m</em>) in Hz?” The answer is not “1” kHz. The answer depends on the original sample rate <em class="calibre7">f<sub class="calibre12">s</sub></em>. Without prior knowledge, we have no idea over what time interval the samples were taken, so we don’t know the absolute scale of the <em class="calibre7">X</em>(<em class="calibre7">m</em>) frequency axis. The correct answer to the question is to take <em class="calibre7">f<sub class="calibre12">s</sub></em> and plug it into <a href="#calibre_link-1526">Eq. (3-5)</a> with <em class="calibre7">m</em> = 1. Thus, if <em class="calibre7">f<sub class="calibre12">s</sub></em> = 8000 samples/second, then the frequency associated with the largest DFT magnitude term is</p>
<p class="image"><img src="images/000210.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we said the sample rate <em class="calibre7">f<sub class="calibre12">s</sub></em> was 75 samples/second, we’d know, from <a href="#calibre_link-1526">Eq. (3-5)</a>, that the frequency associated with the largest magnitude term is now</p>
<p class="image"><img src="images/001024.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">OK, enough of this&mdash;just remember that the DFT’s frequency spacing (resolution) is <em class="calibre7">f<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em>.</p>
<p class="calibre3">To recap what we’ve learned so far:</p>
<p class="indenthangingb">• Each DFT output term is the sum of the term-by-term products of an input time-domain sequence with sequences representing a sine and a cosine wave.</p>
<p class="indenthangingb">• For real inputs, an <em class="calibre7">N</em>-point DFT’s output provides only <em class="calibre7">N</em>/2+1 independent terms.</p>
<p class="indenthangingb">• The DFT is a linear operation.</p>
<p class="indenthangingb">• The magnitude of the DFT results is directly proportional to <em class="calibre7">N</em>.</p>
<p class="indenthangingb">• The DFT’s frequency resolution is <em class="calibre7">f<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em>.</p>
<p class="calibre3">It’s also important to realize, from <a href="#calibre_link-1526">Eq. (3-5)</a>, that <em class="calibre7">X</em>(<em class="calibre7">N</em>/2), when <em class="calibre7">m</em> = <em class="calibre7">N</em>/2, corresponds to half the sample rate, i.e., the folding (Nyquist) frequency <em class="calibre7">f<sub class="calibre12">s</sub></em>/2.</p>
<p class="calibre3"><a id="calibre_link-113"></a></p>
<h3 class="calibre6">3.6 DFT Shifting Theorem</h3>
<p class="calibre3">There’s an important property of the DFT known as the <em class="calibre7">shifting theorem.</em> It states that a shift in time of a periodic <em class="calibre7">x</em>(<em class="calibre7">n</em>) input sequence manifests itself as a <a id="calibre_link-2130"></a>constant phase shift in the angles associated with the DFT results. (We won’t derive the shifting theorem equation here because its derivation is included in just about every digital signal processing textbook in print.) If we decide to sample <em class="calibre7">x</em>(<em class="calibre7">n</em>) starting at <em class="calibre7">n</em> equals some integer <em class="calibre7">k</em>, as opposed to <em class="calibre7">n</em> = 0, the DFT of those time-shifted sample values is <em class="calibre7">X</em><sub class="calibre12">shifted</sub>(<em class="calibre7">m</em>) where</p>
<p class="caption"><a id="calibre_link-1544"></a>(3-19)</p>
<p class="image"><img src="images/000307.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1544">Equation (3-19)</a> tells us that if the point where we start sampling <em class="calibre7">x</em>(<em class="calibre7">n</em>) is shifted to the right by <em class="calibre7">k</em> samples, the DFT output spectrum of <em class="calibre7">X</em><sub class="calibre12">shifted</sub>(<em class="calibre7">m</em>) is <em class="calibre7">X</em>(<em class="calibre7">m</em>) with each of <em class="calibre7">X</em>(<em class="calibre7">m</em>)’s complex terms multiplied by the linear phase shift <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">2π<em class="calibre7">km</em>/<em class="calibre7">N</em></sup>, which is merely a phase shift of 2π<em class="calibre7">km</em>/<em class="calibre7">N</em> radians or 360<em class="calibre7">km</em>/<em class="calibre7">N</em> degrees. Conversely, if the point where we start sampling <em class="calibre7">x</em>(<em class="calibre7">n</em>) is shifted to the left by <em class="calibre7">k</em> samples, the spectrum of <em class="calibre7">X</em><sub class="calibre12">shifted</sub>(<em class="calibre7">m</em>) is <em class="calibre7">X</em>(<em class="calibre7">m</em>) multiplied by <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>2π<em class="calibre7">km</em>/<em class="calibre7">N</em></sup>. Let’s illustrate <a href="#calibre_link-1544">Eq. (3-19)</a> with an example.</p>
<p class="calibre3"><a id="calibre_link-2575"></a></p>
<h4 class="calibre13">3.6.1 DFT Example 2</h4>
<p class="calibre3">Suppose we sampled our DFT Example 1 input sequence later in time by <em class="calibre7">k</em> = 3 samples. <a href="#calibre_link-1545">Figure 3-5</a> shows the original input time function,</p>
<p class="center"><em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">t</em>) = sin(2π1000<em class="calibre7">t</em>) + 0.5sin(2π2000<em class="calibre7">t</em>+3π/4).</p>
<p class="caption"><a id="calibre_link-1545"></a><strong class="calibre9">Figure 3-5</strong> Comparison of sampling times between DFT Example 1 and DFT Example 2.</p>
<p class="image"><img src="images/001683.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We can see that <a href="#calibre_link-1545">Figure 3-5</a> is a continuation of <a href="#calibre_link-1527">Figure 3-2(a)</a>. Our new <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence becomes the values represented by the solid black dots in <a href="#calibre_link-1545">Figure 3-5</a> whose values are</p>
<p class="caption"><a id="calibre_link-2576"></a><a id="calibre_link-1546"></a>(3-20)</p>
<p class="image"><img src="images/001147.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Performing the DFT on <a href="#calibre_link-1546">Eq. (3-20)</a>, <em class="calibre7">X</em><sub class="calibre12">shifted</sub>(<em class="calibre7">m</em>) is</p>
<p class="caption"><a id="calibre_link-1547"></a>(3-21)</p>
<p class="image"><img src="images/000194.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The values in <a href="#calibre_link-1547">Eq. (3-21)</a> are illustrated as the dots in <a href="#calibre_link-1548">Figure 3-6</a>. Notice that <a href="#calibre_link-1548">Figure 3-6(a)</a> is identical to <a href="#calibre_link-1534">Figure 3-4(a)</a>. <a href="#calibre_link-1544">Equation (3-19)</a> told us that the magnitude of <em class="calibre7">X</em><sub class="calibre12">shifted</sub>(<em class="calibre7">m</em>) should be unchanged from that of <em class="calibre7">X</em>(<em class="calibre7">m</em>). That’s a comforting thought, isn’t it? We wouldn’t expect the DFT magnitude of our original periodic <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">t</em>) to change just because we sampled it over a different <a id="calibre_link-2134"></a>time interval. The phase of the DFT result does, however, change depending on the instant at which we started to sample <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">t</em>).</p>
<p class="caption"><a id="calibre_link-1548"></a><strong class="calibre9">Figure 3-6</strong> DFT results from Example 2: (a) magnitude of <em class="calibre7">X</em><sub class="calibre12">shifted</sub>(<em class="calibre7">m</em>); (b) phase of <em class="calibre7">X</em><sub class="calibre12">shifted</sub>(<em class="calibre7">m</em>); (c) real part of <em class="calibre7">X</em><sub class="calibre12">shifted</sub>(<em class="calibre7">m</em>); (d) imaginary part of <em class="calibre7">X</em><sub class="calibre12">shifted</sub>(<em class="calibre7">m</em>).</p>
<p class="image"><img src="images/000164.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">By looking at the <em class="calibre7">m</em> = 1 component of <em class="calibre7">X</em><sub class="calibre12">shifted</sub>(<em class="calibre7">m</em>), for example, we can double-check to see that phase values in <a href="#calibre_link-1548">Figure 3-6(b)</a> are correct. Using <a href="#calibre_link-1544">Eq. (3-19)</a> and remembering that <em class="calibre7">X</em>(1) from DFT Example 1 had a magnitude of 4 at a phase angle of −90° (or −π/2 radians), <em class="calibre7">k</em> = 3 and <em class="calibre7">N</em> = 8 so that</p>
<p class="caption"><a id="calibre_link-2577"></a>(3-22)</p>
<p class="image"><img src="images/001037.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So <em class="calibre7">X</em><sub class="calibre12">shifted</sub>(1) has a magnitude of 4 and a phase angle of π/4 or +45°, which is what we set out to prove using <a href="#calibre_link-1544">Eq. (3-19)</a>.</p>
<p class="calibre3"><a id="calibre_link-593"></a></p>
<h3 class="calibre6">3.7 Inverse DFT</h3>
<p class="calibre3">Although the DFT is the major topic of this chapter, it’s appropriate, now, to introduce the inverse discrete Fourier transform (IDFT). Typically we think of the DFT as transforming time-domain data into a frequency-domain representation. Well, we can reverse this process and obtain the original time-domain signal by performing the IDFT on the <em class="calibre7">X</em>(<em class="calibre7">m</em>) frequency-domain values. The standard expressions for the IDFT are</p>
<p class="caption"><a id="calibre_link-1549"></a>(3-23)</p>
<p class="image"><img src="images/000090.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">and equally,</p>
<p class="caption"><a id="calibre_link-1550"></a>(3-23′)</p>
<p class="image"><img src="images/001165.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Remember the statement we made in <a href="#calibre_link-457">Section 3.1</a> that a discrete time-domain signal can be considered the sum of various sinusoidal analytical frequencies and that the <em class="calibre7">X</em>(<em class="calibre7">m</em>) outputs of the DFT are a set of <em class="calibre7">N</em> complex values indicating the magnitude and phase of each analysis frequency comprising that sum. <a href="#calibre_link-1549">Equations (3-23)</a> and <a href="#calibre_link-1550">(3-23′)</a> are the mathematical expressions of that statement. It’s very important for the reader to understand this concept. If we perform the IDFT by plugging our results from DFT Example 1 into <a href="#calibre_link-1549">Eq. (3-23)</a>, we’ll go from the frequency domain back to the time domain and get our original real <a href="#calibre_link-1543">Eq. (3-11′)</a> <em class="calibre7">x</em>(<em class="calibre7">n</em>) sample values of</p>
<p class="image"><img src="images/001110.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2142"></a>Notice that <a href="#calibre_link-1549">Eq. (3-23)</a>’s IDFT expression differs from the DFT’s <a href="#calibre_link-1518">Eq. (3-2)</a> only by a 1/<em class="calibre7">N</em> scale factor and a change in the sign of the exponent. Other than the magnitude of the results, every characteristic that we’ve covered thus far regarding the DFT also applies to the IDFT.</p>
<p class="calibre3"><a id="calibre_link-461"></a></p>
<h3 class="calibre6">3.8 DFT Leakage</h3>
<p class="calibre3">Hold on to your seat now. Here’s where the DFT starts to get really interesting. The two previous DFT examples gave us correct results because the input <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequences were very carefully chosen sinusoids. As it turns out, the DFT of sampled real-world signals provides frequency-domain results that can be misleading. A characteristic known as <em class="calibre7">leakage</em> causes our DFT results to be only an approximation of the true spectra of the original input signals prior to digital sampling. Although there are ways to minimize leakage, we can’t eliminate it entirely. Thus, we need to understand exactly what effect it has on our DFT results.</p>
<p class="calibre3">Let’s start from the beginning. DFTs are constrained to operate on a finite set of <em class="calibre7">N</em> input values, sampled at a sample rate of <em class="calibre7">f</em><sub class="calibre12">s</sub>, to produce an <em class="calibre7">N</em>-point transform whose discrete outputs are associated with the individual analytical frequencies <em class="calibre7">f</em><sub class="calibre12">analysis</sub>(<em class="calibre7">m</em>), with</p>
<p class="caption"><a id="calibre_link-1551"></a>(3-24)</p>
<p class="image"><img src="images/001796.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1551">Equation (3-24)</a>, illustrated in DFT Example 1, may not seem like a problem, but it is. The DFT produces correct results only when the input data sequence contains energy precisely at the analysis frequencies given in <a href="#calibre_link-1551">Eq. (3-24)</a>, at integral multiples of our fundamental frequency <em class="calibre7">f<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em>. If the input has a signal component at some intermediate frequency between our analytical frequencies of <em class="calibre7">mf<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em>, say 1.5<em class="calibre7">f<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em>, this input signal will show up to some degree in <em class="calibre7">all</em> of the <em class="calibre7">N</em> output analysis frequencies of our DFT! (We typically say that input signal energy shows up in all of the DFT’s output <em class="calibre7">bins</em>, and we’ll see, in a moment, why the phrase “output bins” is appropriate. Engineers often refer to DFT samples as “bins.” So when you see, or hear, the word <em class="calibre7">bin</em> it merely means a frequency-domain sample.) Let’s understand the significance of this problem with another DFT example.</p>
<p class="calibre3">Assume we’re taking a 64-point DFT of the sequence indicated by the dots in <a href="#calibre_link-1552">Figure 3-7(a)</a>. The sequence is a sinewave with exactly three cycles contained in our <em class="calibre7">N</em> = 64 samples. <a href="#calibre_link-1552">Figure 3-7(b)</a> shows the first half of the DFT of the input sequence and indicates that the sequence has an average value of zero (<em class="calibre7">X</em>(0) = 0) and no signal components at any frequency other than the <em class="calibre7">m</em> = 3 frequency. No surprises so far. <a href="#calibre_link-1552">Figure 3-7(a)</a> also shows, for example, the <em class="calibre7">m</em> = 4 sinewave analysis frequency, superimposed over the input sequence, to <a id="calibre_link-2141"></a>remind us that the analytical frequencies always have an integral number of cycles over our total sample interval of 64 points. The sum of the products of the input sequence and the <em class="calibre7">m</em> = 4 analysis frequency is zero. (Or we can say, the correlation of the input sequence and the <em class="calibre7">m</em> = 4 analysis frequency is zero.) The sum of the products of this particular three-cycle input sequence and any analysis frequency other than <em class="calibre7">m</em> = 3 is zero. Continuing with our leakage example, the dots in <a href="#calibre_link-1553">Figure 3-8(a)</a> show an input sequence having 3.4 cycles over our <em class="calibre7">N</em> = 64 samples. Because the input sequence does not have an integral number of cycles over our 64-sample interval, input energy has leaked into all the other DFT output bins as shown in <a href="#calibre_link-1553">Figure 3-8(b)</a>. The <em class="calibre7">m</em> = 4 bin, for example, is not zero because the sum of the products of the input sequence and the <em class="calibre7">m</em> = 4 analysis frequency is no longer zero. This is leakage&mdash;it causes any input signal whose frequency is not exactly at a DFT bin center to leak into all of the other DFT output bins. Moreover, leakage is an unavoidable fact of life when we perform the DFT on real-world finite-length time sequences.</p>
<p class="caption"><a id="calibre_link-1552"></a><strong class="calibre9">Figure 3-7</strong> Sixty-four-point DFT: (a) input sequence of three cycles and the <em class="calibre7">m</em> = 4 analysis frequency sinusoid; (b) DFT output magnitude.</p>
<p class="image"><img src="images/001564.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1553"></a><strong class="calibre9">Figure 3-8</strong> Sixty-four-point DFT: (a) 3.4 cycles input sequence and the <em class="calibre7">m</em> = 4 analysis frequency sinusoid; (b) DFT output magnitude.</p>
<p class="image"><img src="images/000588.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Now, as the English philosopher Douglas Adams would say, “Don’t panic.” Let’s take a quick look at the cause of leakage to learn how to predict <a id="calibre_link-1972"></a>and minimize its unpleasant effects. To understand the effects of leakage, we need to know the amplitude response of a DFT when the DFT’s input is an arbitrary, real sinusoid. Although <a href="#calibre_link-597">Sections 3.13</a> discusses this issue in detail, for our purposes, here, we’ll just say that for a real cosine input having <em class="calibre7">k</em> cycles (<em class="calibre7">k</em> need not be an integer) in the <em class="calibre7">N</em>-point input time sequence, the amplitude response of an <em class="calibre7">N</em>-point DFT bin in terms of the bin index <em class="calibre7">m</em> is approximated by the sinc function</p>
<p class="caption"><a id="calibre_link-1554"></a>(3-25)</p>
<p class="image"><img src="images/000820.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">A<sub class="calibre12">o</sub></em> is the peak value of the DFT’s input sinusiod. For our examples here, <em class="calibre7">A<sub class="calibre12">o</sub></em> is unity. We’ll use <a href="#calibre_link-1554">Eq. (3-25)</a>, illustrated in <a href="#calibre_link-1555">Figure 3-9(a)</a>, to help us determine how much leakage occurs in DFTs. We can think of the curve in <a href="#calibre_link-1555">Figure 3-9(a)</a>, comprising a main lobe and periodic peaks and valleys known as <em class="calibre7">sidelobes</em>, as the continuous positive spectrum of an <em class="calibre7">N</em>-point, real cosine <a id="calibre_link-2578"></a>time sequence having <em class="calibre7">k</em> cycles in the <em class="calibre7">N</em>-point input time interval. The DFT’s outputs are discrete samples that reside on the curves in <a href="#calibre_link-1555">Figure 3-9</a>; that is, our DFT output will be a sampled version of the continuous spectrum. (We show the DFT’s magnitude response to a real input in terms of frequency (Hz) in <a href="#calibre_link-1555">Figure 3-9(b)</a>.) When the DFT’s input sequence has exactly an integral <em class="calibre7">k</em> number of cycles (centered exactly in the <em class="calibre7">m</em> = <em class="calibre7">k</em> bin), no leakage occurs, as in <a href="#calibre_link-1555">Figure 3-9</a>, because when the angle in the numerator of <a href="#calibre_link-1554">Eq. (3-25)</a> is a nonzero integral multiple of π, the sine of that angle is zero.</p>
<p class="caption"><a id="calibre_link-1555"></a><strong class="calibre9">Figure 3-9</strong> DFT positive-frequency response due to an <em class="calibre7">N</em>-point input sequence containing <em class="calibre7">k</em> cycles of a real cosine: (a) amplitude response as a function of bin index <em class="calibre7">m</em>; (b) magnitude response as a function of frequency in Hz.</p>
<p class="image"><img src="images/001449.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">By way of example, we can illustrate again what happens when the input frequency <em class="calibre7">k</em> is not located at a bin center. Assume that a real 8 kHz sinusoid, having unity amplitude, has been sampled at a rate of <em class="calibre7">f<sub class="calibre12">s</sub></em> = 32000 samples/second. If we take a 32-point DFT of the samples, the DFT’s frequency resolution, or bin spacing, is <em class="calibre7">f<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em> = 32000/32 Hz = 1.0 kHz. We can predict the DFT’s magnitude response by centering the input sinusoid’s spectral <a id="calibre_link-2579"></a>curve at the positive frequency of 8 kHz, as shown in <a href="#calibre_link-1556">Figure 3-10(a)</a>. The dots show the DFT’s output bin magnitudes.</p>
<p class="caption"><a id="calibre_link-1556"></a><strong class="calibre9">Figure 3-10</strong> DFT bin positive-frequency responses: (a) DFT input frequency = 8.0 kHz; (b) DFT input frequency = 8.5 kHz; (c) DFT input frequency = 8.75 kHz.</p>
<p class="image"><img src="images/001566.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Again, here’s the important point to remember: the DFT output is a sampled version of the continuous spectral curve in <a href="#calibre_link-1556">Figure 3-10(a)</a>. Those sampled values in the frequency domain, located at <em class="calibre7">mf<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em>, are the dots in <a href="#calibre_link-1556">Figure 3-10(a)</a>. Because the input signal frequency is exactly at a DFT bin center, the DFT results have only one nonzero value. Stated in another way, when an input sinusoid has an integral number of cycles over <em class="calibre7">N</em> time-domain input sample values, the DFT outputs reside on the continuous spectrum at its peak and exactly at the curve’s zero crossing points. From <a href="#calibre_link-1554">Eq. (3-25)</a> we know the peak output magnitude is 32/2 = 16. (If the real input sinusoid had an amplitude of 2, the peak of the response curve would be 2 · 32/2, or 32.) <a href="#calibre_link-1556">Figure 3-10(b)</a> illustrates DFT leakage where the input frequency is 8.5 kHz, and we see that the frequency-domain sampling results in nonzero magnitudes for all DFT output bins. An 8.75 kHz input sinusoid would result in the leaky DFT output shown in <a href="#calibre_link-1556">Figure 3-10(c)</a>. If we’re sitting at a computer studying leakage by plotting the magnitude of DFT output values, of course, we’ll get the dots in <a href="#calibre_link-1556">Figure 3-10</a> and won’t see the continuous spectral curves.</p>
<p class="calibre3"><a id="calibre_link-2144"></a>At this point, the attentive reader should be thinking: “If the continuous spectra that we’re sampling are symmetrical, why does the DFT output in <a href="#calibre_link-1553">Figure 3-8(b)</a> look so asymmetrical?” In <a href="#calibre_link-1553">Figure 3-8(b)</a>, the bins to the right of the third bin are decreasing in amplitude faster than the bins to the left of the third bin. “And another thing, with <em class="calibre7">k</em> = 3.4 and <em class="calibre7">m</em> = 3, from <a href="#calibre_link-1554">Eq. (3-25)</a> the <em class="calibre7">X</em>(3) bin’s magnitude should be approximately equal to 24.2&mdash;but <a href="#calibre_link-1553">Figure 3-8(b)</a> shows the <em class="calibre7">X</em>(3) bin magnitude to be slightly greater than 25. What’s going on here?” We answer this by remembering what <a href="#calibre_link-1553">Figure 3-8(b)</a> really represents. When examining a DFT output, we’re normally interested only in the <em class="calibre7">m</em> = 0 to <em class="calibre7">m</em> = (<em class="calibre7">N</em>/2−1) bins. Thus, for our 3.4 cycles per sample interval example in <a href="#calibre_link-1553">Figure 3-8(b)</a>, only the first 32 bins are shown. Well, the DFT is periodic in the frequency domain as illustrated in <a href="#calibre_link-1557">Figure 3-11</a>. (We address this periodicity issue in <a href="#calibre_link-598">Section 3.14</a>.) Upon examining the DFT’s output for higher and higher frequencies, we end up going in circles, and the spectrum repeats itself forever.</p>
<p class="caption"><a id="calibre_link-1557"></a><strong class="calibre9">Figure 3-11</strong> Cyclic representation of the DFT’s spectral replication when the DFT input is 3.4 cycles per sample interval.</p>
<p class="image"><img src="images/001352.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The more conventional way to view a DFT output is to <em class="calibre7">unwrap</em> the spectrum in <a href="#calibre_link-1557">Figure 3-11</a> to get the spectrum in <a href="#calibre_link-1558">Figure 3-12</a>. <a href="#calibre_link-1558">Figure 3-12</a> shows some of the additional replications in the spectrum for the 3.4 cycles per sample interval example. Concerning our DFT output asymmetry problem, as some of the input 3.4-cycle signal amplitude leaks into the 2nd bin, the 1st bin, and the 0th bin, leakage continues into the −1st bin, the −2nd bin, the −3rd bin, etc. Remember, the 63rd bin is the −1st bin, the 62nd bin is the −2nd bin, and so on. These bin equivalencies allow us to view the DFT output bins as if they extend into the negative-frequency range, as shown in <a href="#calibre_link-1559">Figure 3-13(a)</a>. The result is that the leakage <em class="calibre7">wraps around</em> the <em class="calibre7">m</em> = 0 frequency bin, as well as around the <em class="calibre7">m</em> = <em class="calibre7">N</em> frequency bin. This is not surprising, because the <em class="calibre7">m</em> = 0 frequency <em class="calibre7">is</em> the <a id="calibre_link-2580"></a><em class="calibre7">m</em> = <em class="calibre7">N</em> frequency. The leakage wraparound at the <em class="calibre7">m</em> = 0 frequency accounts for the asymmetry around the DFT’s <em class="calibre7">m</em> = 3 bin in <a href="#calibre_link-1553">Figure 3-8(b)</a>.</p>
<p class="caption"><a id="calibre_link-1558"></a><strong class="calibre9">Figure 3-12</strong> Spectral replication when the DFT input is 3.4 cycles per sample interval.</p>
<p class="image"><img src="images/000915.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1559"></a><strong class="calibre9">Figure 3-13</strong> DFT output magnitude: (a) when the DFT input is 3.4 cycles per sample interval; (b) when the DFT input is 28.6 cycles per sample interval.</p>
<p class="image"><img src="images/000952.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Recall from the DFT symmetry discussion that when a DFT input sequence <em class="calibre7">x</em>(<em class="calibre7">n</em>) is real, the DFT outputs from <em class="calibre7">m</em> = 0 to <em class="calibre7">m</em> = (<em class="calibre7">N</em>/2−1) are redundant with frequency bin values for <em class="calibre7">m</em> &gt; (<em class="calibre7">N</em>/2), where <em class="calibre7">N</em> is the DFT size. The <em class="calibre7">m</em>th <a id="calibre_link-2581"></a>DFT output will have the same magnitude as the (<em class="calibre7">N</em>−<em class="calibre7">m</em>)th DFT output. That is, |<em class="calibre7">X</em>(<em class="calibre7">m</em>)| = |<em class="calibre7">X</em>(<em class="calibre7">N</em>−<em class="calibre7">m</em>)|. What this means is that leakage wraparound also occurs around the <em class="calibre7">m</em> = <em class="calibre7">N</em>/2 bin. This can be illustrated using an input of 28.6 cycles per sample interval (32 − 3.4) whose spectrum is shown in <a href="#calibre_link-1559">Figure 3-13(b)</a>. Notice the similarity between <a href="#calibre_link-1559">Figures 3-13(a)</a> and <a href="#calibre_link-1559">3-13(b)</a>. So the DFT exhibits leakage wraparound about the <em class="calibre7">m</em> = 0 and <em class="calibre7">m</em> = <em class="calibre7">N</em>/2 bins. Minimum leakage asymmetry will occur near the <em class="calibre7">N</em>/4th bin as shown in <a href="#calibre_link-1560">Figure 3-14(a)</a> where the full spectrum of a 16.4 cycles per sample interval input is provided. <a href="#calibre_link-1560">Figure 3-14(b)</a> shows a close-up view of the first 32 bins of the 16.4 cycles per sample interval spectrum.</p>
<p class="caption"><a id="calibre_link-1560"></a><strong class="calibre9">Figure 3-14</strong> DFT output magnitude when the DFT input is 16.4 cycles per sample interval: (a) full output spectrum view; (b) close-up view showing minimized leakage asymmetry at frequency <em class="calibre7">m</em> = <em class="calibre7">N</em>/4.</p>
<p class="image"><img src="images/000803.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">You could read about leakage all day. However, the best way to appreciate its effects is to sit down at a computer and use a software program to take DFTs, in the form of fast Fourier transforms (FFTs), of your personally generated test signals like those in <a href="#calibre_link-1552">Figures 3-7</a> and <a href="#calibre_link-1553">3-8</a>. You can then experiment with different combinations of input frequencies and various DFT sizes. You’ll be able to demonstrate that the DFT leakage effect is troublesome <a id="calibre_link-2143"></a>because the bins containing low-level signals are corrupted by the sidelobe levels from neighboring bins containing high-amplitude signals.</p>
<p class="calibre3">Although there’s no way to eliminate leakage completely, an important technique known as <em class="calibre7">windowing</em> is the most common remedy to reduce its unpleasant effects. Let’s look at a few DFT window examples.</p>
<p class="calibre3"><a id="calibre_link-594"></a></p>
<h3 class="calibre6">3.9 Windows</h3>
<p class="calibre3">Windowing reduces DFT leakage by minimizing the magnitude of <a href="#calibre_link-1554">Eq. (3-25)</a>’s sinc function’s sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> sidelobes shown in <a href="#calibre_link-1555">Figure 3-9</a>. We do this by forcing the amplitude of the input time sequence at both the beginning and the end of the sample interval to go smoothly toward a single common amplitude value. <a href="#calibre_link-1561">Figure 3-15</a> shows how this process works. If we consider the infinite-duration time signal shown in <a href="#calibre_link-1561">Figure 3-15(a)</a>, a DFT can only be performed over a finite-time sample interval like that shown in <a href="#calibre_link-1561">Figure 3-15(c)</a>. We can think of the DFT input signal in <a href="#calibre_link-1561">Figure 3-15(c)</a> as the product of an input signal existing for all time, <a href="#calibre_link-1561">Figure 3-15(a)</a>, and the rectangular window whose magnitude is 1 over the sample interval shown in <a href="#calibre_link-1561">Figure 3-15(b)</a>. Anytime we take the DFT of a finite-extent input sequence, we are, by default, multiplying that sequence by a window of all ones and effectively multiplying the input values outside that window by zeros. As it turns out, <a href="#calibre_link-1554">Eq. (3-25)</a>’s sinc function’s sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> shape, shown in <a href="#calibre_link-1555">Figure 3-9</a>, is caused by this rectangular window because the continuous Fourier transform of the rectangular window in <a href="#calibre_link-1561">Figure 3-15(b)</a> <em class="calibre7">is</em> the sinc function.</p>
<p class="caption"><a id="calibre_link-2582"></a><a id="calibre_link-1561"></a><strong class="calibre9">Figure 3-15</strong> Minimizing sample interval end-point discontinuities: (a) infinite-duration input sinusoid; (b) rectangular window due to finite-time sample interval; (c) product of rectangular window and infinite-duration input sinusoid; (d) triangular window function; (e) product of triangular window and infinite-duration input sinusoid; (f) Hanning window function; (g) product of Hanning window and infinite-duration input sinusoid; (h) Hamming window function.</p>
<p class="image"><img src="images/001662.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">As we’ll soon see, it’s the rectangular window’s abrupt changes between one and zero that are the cause of the sidelobes in the the sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> sinc function. To minimize the spectral leakage caused by those sidelobes, we have to reduce the sidelobe amplitudes by using window functions other than the rectangular window. Imagine if we multiplied our DFT input, <a href="#calibre_link-1561">Figure 3-15(c)</a>, by the triangular window function shown in <a href="#calibre_link-1561">Figure 3-15(d)</a> to obtain the windowed input signal shown in <a href="#calibre_link-1561">Figure 3-15(e)</a>. Notice that the values of our final input signal appear to be the same at the beginning and end of the sample interval in <a href="#calibre_link-1561">Figure 3-15(e)</a>. The reduced discontinuity decreases the level of relatively high-frequency components in our overall DFT output; that is, our DFT bin sidelobe levels are reduced in magnitude using a triangular window. There are other window functions that reduce leakage even more than the triangular window, such as the Hanning window in <a href="#calibre_link-1561">Figure 3-15(f)</a>. The product of the window in <a href="#calibre_link-1561">Figure 3-15(f)</a> and the input sequence provides the signal shown in <a href="#calibre_link-1561">Figure 3-15(g)</a> as the input to the DFT. Another common window function is the Hamming window shown in <a href="#calibre_link-1561">Figure 3-15(h)</a>. It’s much like the Hanning window, but it’s raised on a <em class="calibre7">pedestal</em>.</p>
<p class="calibre3"><a id="calibre_link-2468"></a>Before we see exactly how well these windows minimize DFT leakage, let’s define them mathematically. Assuming that our original <em class="calibre7">N</em> input signal samples are indexed by <em class="calibre7">n</em>, where 0 ≤ <em class="calibre7">n</em> ≤ <em class="calibre7">N</em>−1, we’ll call the <em class="calibre7">N</em> time-domain window coefficients <em class="calibre7">w</em>(<em class="calibre7">n</em>); that is, an input sequence <em class="calibre7">x</em>(<em class="calibre7">n</em>) is multiplied by the corresponding window <em class="calibre7">w</em>(<em class="calibre7">n</em>) coefficients before the DFT is performed. So the DFT of the windowed <em class="calibre7">x</em>(<em class="calibre7">n</em>) input sequence, <em class="calibre7">X<sub class="calibre12">w</sub></em>(<em class="calibre7">m</em>), takes the form of</p>
<p class="caption"><a id="calibre_link-2583"></a>(3-26)</p>
<p class="image"><img src="images/001679.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To use window functions, we need mathematical expressions of them in terms of <em class="calibre7">n</em>. The following expressions define our window function coefficients:</p>
<p class="caption"><a id="calibre_link-1562"></a>(3-27)</p>
<p class="image"><img src="images/000044.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2584"></a>(3-28)</p>
<p class="image"><img src="images/001560.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2585"></a>(3-29)</p>
<p class="image"><img src="images/000583.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1563"></a>(3-30)</p>
<p class="image"><img src="images/001445.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we plot the <em class="calibre7">w</em>(<em class="calibre7">n</em>) values from <a href="#calibre_link-1562">Eqs. (3-27)</a> through <a href="#calibre_link-1563">(3-30)</a>, we’d get the corresponding window functions like those in <a href="#calibre_link-1561">Figures 3-15(b)</a>, <a href="#calibre_link-1561">3-15(d)</a>, <a href="#calibre_link-1561">3-15(f)</a>, and <a href="#calibre_link-1561">3-15(h)</a>.<sup class="calibre10"><a id="calibre_link-1565"></a><a href="#calibre_link-1564">†</a></sup></p>
<p class="footnotes"><a id="calibre_link-1564"></a><sup class="calibre11"><a href="#calibre_link-1565">†</a></sup> In the literature, the equations for window functions depend on the range of the sample index <em class="calibre7">n</em>. We define <em class="calibre7">n</em> to be in the range 0 &lt; <em class="calibre7">n</em> &lt; <em class="calibre7">N</em>−1. Some authors define <em class="calibre7">n</em> to be in the range −<em class="calibre7">N</em>/2 ≤ <em class="calibre7">n</em> ≤ <em class="calibre7">N</em>/2−1, in which case, for example, the expression for the Hanning window would have a sign change and be <em class="calibre7">w</em>(<em class="calibre7">n</em>) = 0.5 + 0.5cos(2π<em class="calibre7">n</em>/<em class="calibre7">N</em>).</p>
<p class="calibre3">The rectangular window’s amplitude response is the yardstick we normally use to evaluate another window function’s amplitude response; that is, we typically get an appreciation for a window’s response by comparing it to <a id="calibre_link-2295"></a>the rectangular window that exhibits the magnitude response shown in <a href="#calibre_link-1555">Figure 3-9(b)</a>. The rectangular window’s sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> magnitude response, |<em class="calibre7">W</em>(<em class="calibre7">m</em>)|, is repeated in <a href="#calibre_link-1566">Figure 3-16(a)</a>. Also included in <a href="#calibre_link-1566">Figure 3-16(a)</a> are the Hamming, Hanning, and triangular window magnitude responses. (The frequency axis in <a href="#calibre_link-1566">Figure 3-16</a> is such that the curves show the response of a single <em class="calibre7">N</em>-point DFT bin when the various window functions are used.) We can see that the last three windows give reduced sidelobe levels relative to the rectangular window. Because the Hamming, Hanning, and triangular windows reduce the time-domain signal levels applied to the DFT, their main lobe peak values are reduced relative to the rectangular window. (Because of the near-zero <em class="calibre7">w</em>(<em class="calibre7">n</em>) coefficients at the beginning and end of the sample interval, this signal level loss is called the processing gain, or loss, of a window.) Be that as it may, we’re primarily interested in the windows’ sidelobe levels, which are difficult to see in <a href="#calibre_link-1566">Figure 3-16(a)</a>’s linear scale. We will avoid this difficulty by plotting the windows’ magnitude responses on a logarithmic decibel scale, and normalize each plot so its main lobe peak values are zero dB. (<a href="#calibre_link-296">Appendix E</a> provides a discussion of the origin and utility of measuring frequency-domain responses on a logarithmic scale using decibels.) Defining the log magnitude response to be |<em class="calibre7">W</em><sub class="calibre12">dB</sub>(<em class="calibre7">m</em>)|, we get |<em class="calibre7">W</em><sub class="calibre12">dB</sub>(<em class="calibre7">m</em>)| by using the expression</p>
<p class="caption"><a id="calibre_link-1567"></a>(3-31)</p>
<p class="image"><img src="images/000481.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2586"></a><a id="calibre_link-1566"></a><strong class="calibre9">Figure 3-16</strong> Window magnitude responses: (a) |<em class="calibre7">W</em>(<em class="calibre7">m</em>)| on a linear scale; (b) |<em class="calibre7">W</em><sub class="calibre12">dB</sub>(<em class="calibre7">m</em>)| on a normalized logarithmic scale.</p>
<p class="image"><img src="images/001032.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">(The |<em class="calibre7">W</em>(0)| term in the denominator of <a href="#calibre_link-1567">Eq. (3-31)</a> is the value of <em class="calibre7">W</em>(<em class="calibre7">m</em>) at the peak of the main lobe when <em class="calibre7">m</em> = 0.) The |<em class="calibre7">W</em><sub class="calibre12">dB</sub>(<em class="calibre7">m</em>)| curves for the various window functions are shown in <a href="#calibre_link-1566">Figure 3-16(b)</a>. Now we can really see how the various window sidelobe responses compare to each other.</p>
<p class="calibre3">Looking at the rectangular window’s magnitude response, we see that its main lobe is the most narrow, <em class="calibre7">f<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em>. However, unfortunately, its first sidelobe level is only −13 dB below the main lobe peak, which is not so good. (Notice that we’re only showing the positive-frequency portion of the window responses in <a href="#calibre_link-1566">Figure 3-16</a>.) The triangular window has reduced sidelobe levels, but the price we’ve paid is that the triangular window’s main lobe width is twice as wide as that of the rectangular window’s. The various nonrectangular windows’ wide main lobes degrade the windowed DFT’s frequency resolution by almost a factor of two. However, as we’ll see, the important benefits of leakage reduction usually outweigh the loss in DFT frequency resolution.</p>
<p class="calibre3">Notice the further reduction of the first sidelobe level, and the rapid sidelobe roll-off of the Hanning window. The Hamming window has even lower first sidelobe levels, but this window’s sidelobes roll off slowly relative to the Hanning window. This means that leakage three or four bins away from the center bin is lower for the Hamming window than for the Hanning window, and leakage a half-dozen or so bins away from the center bin is lower for the Hanning window than for the Hamming window.</p>
<p class="calibre3"><a id="calibre_link-2587"></a>When we apply the Hanning window to <a href="#calibre_link-1553">Figure 3-8(a)</a>’s 3.4 cycles per sample interval example, we end up with the DFT input shown in <a href="#calibre_link-1104">Figure 3-17(a)</a> under the Hanning window envelope. The DFT outputs for the windowed waveform are shown in <a href="#calibre_link-1104">Figure 3-17(b)</a> along with the DFT results with no windowing, i.e., the rectangular window. As we expected, the shape of the Hanning window’s response looks broader and has a lower peak amplitude, but its sidelobe leakage is noticeably reduced from that of the rectangular window.</p>
<p class="caption"><a id="calibre_link-1104"></a><strong class="calibre9">Figure 3-17</strong> Hanning window: (a) 64-sample product of a Hanning window and a 3.4 cycles per sample interval input sinewave; (b) Hanning DFT output response versus rectangular window DFT output response.</p>
<p class="image"><img src="images/001544.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2588"></a>We can demonstrate the benefit of using a window function to help us detect a low-level signal in the presence of a nearby high-level signal. Let’s add 64 samples of a 7 cycles per sample interval sinewave, with a peak amplitude of only 0.1, to <a href="#calibre_link-1553">Figure 3-8(a)</a>’s unity-amplitude 3.4 cycles per sample sinewave. When we apply a Hanning window to the sum of these sinewaves, we get the time-domain input shown in <a href="#calibre_link-1568">Figure 3-18(a)</a>. Had we not windowed the input data, our DFT output would be the squares in <a href="#calibre_link-1568">Figure 3-18(b)</a> where DFT leakage causes the input signal component at <em class="calibre7">m</em> = 7 to be barely discernible. However, the DFT of the windowed data shown as the triangles <a id="calibre_link-2138"></a>in <a href="#calibre_link-1568">Figure 3-18(b)</a> makes it easier for us to detect the presence of the <em class="calibre7">m</em> = 7 signal component. From a practical standpoint, people who use the DFT to perform real-world signal detection have learned that their overall frequency resolution and signal sensitivity are affected much more by the size and shape of their window function than the mere size of their DFTs.</p>
<p class="caption"><a id="calibre_link-1568"></a><strong class="calibre9">Figure 3-18</strong> Increased signal detection sensitivity afforded using windowing: (a) 64-sample product of a Hanning window and the sum of a 3.4 cycles and a 7 cycles per sample interval sinewaves; (b) reduced leakage Hanning DFT output response versus rectangular window DFT output response.</p>
<p class="image"><img src="images/000570.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">As we become more experienced using window functions on our DFT input data, we’ll see how different window functions have their own individual advantages and disadvantages. Furthermore, regardless of the window function used, we’ve decreased the leakage in our DFT output from that of the rectangular window. There are many different window functions described in the literature of digital signal processing&mdash;so many, in fact, that they’ve been named after just about everyone in the digital signal processing business. It’s not that clear that there’s a great deal of difference among many of these window functions. What we find is that window selection is a trade-off between main lobe widening, first sidelobe levels, and how fast the sidelobes decrease with increased frequency. The use of any particular window depends on the application<a href="#calibre_link-1569">[5]</a>, and there are many applications.</p>
<p class="calibre3">Windows are used to improve DFT spectrum analysis accuracy<a href="#calibre_link-1570">[6]</a>, to design digital filters[<a href="#calibre_link-1571">7</a>,<a href="#calibre_link-1572">8</a>], to simulate antenna radiation patterns, and even in the hardware world to improve the performance of certain mechanical force to voltage conversion devices<a href="#calibre_link-1573">[9]</a>. So there’s plenty of window information available for those readers seeking further knowledge. (The mother of all technical papers on windows is that by Harris<a href="#calibre_link-1574">[10]</a>. A useful paper by Nuttall corrected and extended some portions of Harris’s paper<a href="#calibre_link-1575">[11]</a>.) Again, the best way to appreciate windowing effects is to have access to a computer software package that contains DFT, or FFT, routines and start analyzing windowed signals. (By the way, while we delayed their discussion until <a href="#calibre_link-610">Section 5.3</a>, there are two other commonly used window functions that can be used to reduce DFT leakage. They’re the Chebyshev and Kaiser window functions, which have adjustable parameters, enabling us to strike a compromise between widening main lobe width and reducing sidelobe levels.)</p>
<p class="calibre3"><a id="calibre_link-595"></a></p>
<h3 class="calibre6">3.10 DFT Scalloping Loss</h3>
<p class="calibre3"><em class="calibre7">Scalloping</em> is the name used to describe fluctuations in the overall magnitude response of an <em class="calibre7">N</em>-point DFT. Although we derive this fact in Section 3.16, for now we’ll just say that when no input windowing function is used, the sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> shape of the sinc function’s magnitude response applies to each DFT output bin. <a href="#calibre_link-1576">Figure 3-19(a)</a> shows a DFT’s aggregate magnitude response by superimposing several sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> bin magnitude responses.<sup class="calibre10"><a id="calibre_link-1578"></a><a href="#calibre_link-1577">†</a></sup> (Because the sinc <a id="calibre_link-2136"></a>function’s sidelobes are not key to this discussion, we don’t show them in <a href="#calibre_link-1576">Figure 3-19(a)</a>.) Notice from <a href="#calibre_link-1576">Figure 3-19(b)</a> that the overall DFT frequency-domain response is indicated by the bold envelope curve. This rippled curve, also called the picket fence effect, illustrates the processing loss for input frequencies between the bin centers.</p>
<p class="footnotes"><a id="calibre_link-1577"></a><sup class="calibre11"><a href="#calibre_link-1578">†</a></sup> Perhaps <a href="#calibre_link-1576">Figure 3-19(a)</a> is why individual DFT outputs are called “bins.” Any signal energy under a sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> curve will show up in the <em class="calibre7">enclosed storage compartment</em> of that DFT’s output sample.</p>
<p class="caption"><a id="calibre_link-1576"></a><strong class="calibre9">Figure 3-19</strong> DFT bin magnitude response curves: (a) individual sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> responses for each DFT bin; (b) equivalent overall DFT magnitude response.</p>
<p class="image"><img src="images/001121.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">From <a href="#calibre_link-1576">Figure 3-19(b)</a>, we can determine that the magnitude of the DFT response fluctuates from 1.0, at bin center, to 0.637 halfway between bin centers. If we’re interested in DFT output power levels, this envelope ripple exhibits a scalloping loss of almost −4 dB halfway between bin centers. <a href="#calibre_link-1576">Figure 3-19</a> illustrates a DFT output when no window (i.e., a rectangular window) is used. Because nonrectangular window functions broaden the DFT’s main lobe, their use results in a scalloping loss that will not be as severe as with the rectangular window[<a href="#calibre_link-1574">10</a>,<a href="#calibre_link-1579">12</a>]. That is, their wider main lobes overlap more and fill in the valleys of the envelope curve in <a href="#calibre_link-1576">Figure 3-19(b)</a>. For example, the scalloping loss of a Hanning window is approximately 0.82, or −1.45 dB, halfway between bin centers. Scalloping loss is not, however, a severe problem in practice. Real-world signals normally have bandwidths that span many frequency bins so that DFT magnitude response ripples can go almost unnoticed. Let’s look at a scheme called <em class="calibre7">zero padding</em> that’s used to both alleviate scalloping loss effects and to improve the DFT’s frequency granularity.</p>
<p class="calibre3"><a id="calibre_link-460"></a></p>
<h3 class="calibre6"><a id="calibre_link-2050" class="calibre5"></a>3.11 DFT Resolution, Zero Padding, and Frequency-Domain Sampling</h3>
<p class="calibre3">One popular method used to improve DFT spectral estimation is known as <em class="calibre7">zero padding.</em> This process involves the addition of zero-valued data samples to an original DFT input sequence to increase the total number of input data samples. Investigating this zero-padding technique illustrates the DFT’s important property of frequency-domain sampling alluded to in the discussion on leakage. When we sample a continuous time-domain function, having a continuous Fourier transform (CFT), and take the DFT of those samples, the DFT results in a frequency-domain sampled approximation of the CFT. The more points in our DFT, the better our DFT output approximates the CFT.</p>
<p class="calibre3">To illustrate this idea, suppose we want to approximate the CFT of the continuous <em class="calibre7">f</em>(<em class="calibre7">t</em>) function in <a href="#calibre_link-1580">Figure 3-20(a)</a>. This <em class="calibre7">f</em>(<em class="calibre7">t</em>) waveform extends to infinity in both directions but is nonzero only over the time interval of <em class="calibre7">T</em> seconds. If the nonzero portion of the time function is a sinewave of three cycles in <em class="calibre7">T</em> seconds, the magnitude of its CFT is shown in <a href="#calibre_link-1580">Figure 3-20(b)</a>. (Because the CFT is taken over an infinitely wide time interval, the CFT has infinitesimally small frequency resolution, resolution so fine-grained that it’s continuous.) It’s this CFT that we’ll approximate with a DFT.</p>
<p class="caption"><a id="calibre_link-1580"></a><strong class="calibre9">Figure 3-20</strong> Continuous Fourier transform: (a) continuous time-domain <em class="calibre7">f</em>(<em class="calibre7">t</em>) of a truncated sinusoid of frequency 3/<em class="calibre7">T</em>; (b) continuous Fourier transform of <em class="calibre7">f</em>(<em class="calibre7">t</em>).</p>
<p class="image"><img src="images/000468.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Suppose we want to use a 16-point DFT to approximate the CFT of <em class="calibre7">f</em>(<em class="calibre7">t</em>) in <a href="#calibre_link-1580">Figure 3-20(a)</a>. The 16 discrete samples of <em class="calibre7">f</em>(<em class="calibre7">t</em>), spanning the three periods of <em class="calibre7">f</em>(<em class="calibre7">t</em>)’s sinusoid, are those shown on the left side of <a href="#calibre_link-1581">Figure 3-21(a)</a>. Applying those time samples to a 16-point DFT results in discrete frequency-domain <a id="calibre_link-2589"></a>samples, the positive frequencies of which are represented by the dots on the right side of <a href="#calibre_link-1581">Figure 3-21(a)</a>. We can see that the DFT output comprises samples of <a href="#calibre_link-1580">Figure 3-20(b)</a>’s CFT. If we append (or zero-pad) 16 zeros to the input sequence and take a 32-point DFT, we get the output shown <a id="calibre_link-2275"></a>on the right side of <a href="#calibre_link-1581">Figure 3-21(b)</a>, where we’ve increased our DFT frequency sampling by a factor of two. Our DFT is sampling the input function’s CFT more often now. Adding 32 more zeros and taking a 64-point DFT, we get the output shown on the right side of <a href="#calibre_link-1581">Figure 3-21(c)</a>. The 64-point DFT output now begins to show the true shape of the CFT. Adding 64 more zeros and taking a 128-point DFT, we get the output shown on the right side of <a href="#calibre_link-1581">Figure 3-21(d)</a>. The DFT frequency-domain sampling characteristic is obvious now, but notice that the bin index for the center of the main lobe is different for each of the DFT outputs in <a href="#calibre_link-1581">Figure 3-21</a>.</p>
<p class="caption"><a id="calibre_link-1581"></a><strong class="calibre9">Figure 3-21</strong> DFT frequency-domain sampling: (a) 16 input data samples and <em class="calibre7">N</em> = 16; (b) 16 input data samples, 16 padded zeros, and <em class="calibre7">N</em> = 32; (c) 16 input data samples, 48 padded zeros, and <em class="calibre7">N</em> = 64; (d) 16 input data samples, 112 padded zeros, and <em class="calibre7">N</em> = 128.</p>
<p class="image"><img src="images/001326.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Does this mean we have to redefine the DFT’s frequency axis when using the zero-padding technique? Not really. If we perform zero padding on <em class="calibre7">L</em> nonzero input samples to get a total of <em class="calibre7">N</em> time samples for an <em class="calibre7">N</em>-point DFT, the zero-padded DFT output bin center frequencies are related to the original <em class="calibre7">f<sub class="calibre12">s</sub></em> by our old friend <a href="#calibre_link-1526">Eq. (3-5)</a>, or</p>
<p class="caption"><a id="calibre_link-1582"></a>(3-32)</p>
<p class="image"><img src="images/000016.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So in our <a href="#calibre_link-1581">Figure 3-21(a)</a> example, we use <a href="#calibre_link-1582">Eq. (3-32)</a> to show that although the zero-padded DFT output bin index of the main lobe changes as <em class="calibre7">N</em> increases, the zero-padded DFT output frequency associated with the main lobe remains the same. The following list shows how this works:</p>
<p class="image"><img src="images/001398.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Do we gain anything by appending more zeros to the input sequence and taking larger DFTs? Not really, because our 128-point DFT is sampling the input’s CFT sufficiently now in <a href="#calibre_link-1581">Figure 3-21(d)</a>. Sampling it more often with a larger DFT won’t improve our understanding of the input’s frequency content. The issue here is that adding zeros to an input sequence will improve our DFT’s output resolution, but there’s a practical limit on how much we gain by adding more zeros. For our example here, a 128-point DFT shows us the detailed content of the input spectrum. We’ve hit a <em class="calibre7">law of diminishing returns</em> here. Performing a 256-point or 512-point DFT, in our case, would serve little purpose.<sup class="calibre10"><a id="calibre_link-1584"></a><a href="#calibre_link-1583">†</a></sup> There’s no reason to <em class="calibre7">oversample</em> this particular input sequence’s <a id="calibre_link-2165"></a>CFT. Of course, there’s nothing sacred about stopping at a 128-point DFT. Depending on the number of samples in some arbitrary input sequence and the sample rate, we might, in practice, need to append any number of zeros to get some desired DFT frequency resolution.</p>
<p class="footnotes"><a id="calibre_link-1583"></a><sup class="calibre11"><a href="#calibre_link-1584">†</a></sup> Notice that the DFT sizes (<em class="calibre7">N</em>) we’ve discussed are powers of 2 (64, 128, 256, 512). That’s because we actually perform DFTs using a special algorithm known as the <em class="calibre7">fast Fourier transform</em> (FFT). As we’ll see in <a href="#calibre_link-288">Chapter 4</a>, the typical implementation of the FFT requires that <em class="calibre7">N</em> be a power of two.</p>
<p class="calibre3">There are two final points to be made concerning zero padding. First, the DFT magnitude expressions in <a href="#calibre_link-1539">Eqs. (3-17)</a> and <a href="#calibre_link-1540">(3-17′)</a> don’t apply if zero padding is being used. If we perform zero padding on <em class="calibre7">L</em> nonzero samples of a sinusoid whose frequency is located at a bin center to get a total of <em class="calibre7">N</em> input samples for an <em class="calibre7">N</em>-point DFT, we must replace the <em class="calibre7">N</em> with <em class="calibre7">L</em> in <a href="#calibre_link-1539">Eqs. (3-17)</a> and <a href="#calibre_link-1540">(3-17′)</a> to predict the DFT’s output magnitude for that particular sinewave. Second, in practical situations, if we want to perform both zero padding and windowing on a sequence of input data samples, we must be careful not to apply the window to the entire input including the appended zero-valued samples. The window function must be applied only to the original nonzero time samples; otherwise the padded zeros will <em class="calibre7">zero out</em> and distort part of the window function, leading to erroneous results. (<a href="#calibre_link-78">Section 4.2</a> gives additional practical pointers on performing the DFT using the FFT algorithm to analyze real-world signals.)</p>
<p class="calibre3">To digress slightly, now’s a good time to define the term <em class="calibre7">discrete-time Fourier transform</em> (DTFT) which the reader may encounter in the literature. The DTFT is the continuous Fourier transform of an <em class="calibre7">L</em>-point discrete time-domain sequence, and some authors use the DTFT to describe many of the digital signal processing concepts we’ve covered in this chapter. On a computer we can’t perform the DTFT because it has an infinitely fine frequency resolution&mdash;but we can approximate the DTFT by performing an <em class="calibre7">N</em>-point DFT on an <em class="calibre7">L</em>-point discrete time sequence where <em class="calibre7">N</em> &gt; <em class="calibre7">L</em>. That is, in fact, what we did in <a href="#calibre_link-1581">Figure 3-21</a> when we zero-padded the original 16-point time sequence. (When <em class="calibre7">N</em> = <em class="calibre7">L,</em> the DTFT approximation is identical to the DFT.)</p>
<p class="calibre3">To make the connection between the DTFT and the DFT, know that the infinite-resolution DTFT magnitude (i.e., continuous Fourier transform magnitude) of the 16 nonzero time samples in <a href="#calibre_link-1581">Figure 3-21(a)</a> is the shaded sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em>-like spectral function in <a href="#calibre_link-1581">Figure 3-21</a>. Our DFTs approximate (sample) that function. Increased zero padding of the 16 nonzero time samples merely interpolates our DFT’s sampled version of the DTFT function with smaller and smaller frequency-domain sample spacing.</p>
<p class="calibre3">Please keep in mind, however, that zero padding does not improve our ability to resolve, to distinguish between, two closely spaced signals in the frequency domain. (For example, the main lobes of the various spectra in <a href="#calibre_link-1581">Figure 3-21</a> do <em class="calibre7">not</em> change in width, if measured in Hz, with increased zero padding.) To improve our true spectral resolution of two signals, we need more nonzero time samples. The rule by which we must live is: To realize <em class="calibre7">F</em><sub class="calibre12">res</sub> Hz spectral resolution, we must collect 1/<em class="calibre7">F</em><sub class="calibre12">res</sub> seconds, worth of nonzero time samples for our DFT processing.</p>
<p class="calibre3"><a id="calibre_link-2146"></a>We’ll discuss applications of time-domain zero padding in <a href="#calibre_link-686">Section 13.15</a>, revisit the DTFT in <a href="#calibre_link-598">Section 3.14</a>, and frequency-domain zero padding in <a href="#calibre_link-697">Section 13.28</a>.</p>
<p class="calibre3"><a id="calibre_link-596"></a></p>
<h3 class="calibre6">3.12 DFT Processing Gain</h3>
<p class="calibre3">There are two types of processing gain associated with DFTs. People who use the DFT to detect signal energy embedded in noise often speak of the DFT’s <em class="calibre7">processing gain</em> because the DFT can <em class="calibre7">pull</em> signals out of background noise. This is due to the inherent correlation gain that takes place in any <em class="calibre7">N</em>-point DFT. Beyond this natural processing gain, additional <em class="calibre7">integration gain</em> is possible when multiple DFT outputs are averaged. Let’s look at the DFT’s inherent processing gain first.</p>
<p class="calibre3"><a id="calibre_link-1347"></a></p>
<h4 class="calibre13">3.12.1 Processing Gain of a Single DFT</h4>
<p class="calibre3">The concept of the DFT having processing gain is straightforward if we think of a particular DFT bin output as the output of a narrowband filter. Because a DFT output bin has the amplitude response of the sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> function, that bin’s output is primarily due to input energy residing under, or very near, the bin’s main lobe. It’s valid to think of a DFT bin as a kind of <em class="calibre7"><a href="#calibre_link-1585">bandpass</a></em> filter whose band center is located at <em class="calibre7">mf<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em>. We know from <a href="#calibre_link-1539">Eq. (3-17)</a> that the maximum possible DFT output magnitude increases as the number of points (<em class="calibre7">N</em>) in a DFT increases. Also, as <em class="calibre7">N</em> increases, the DFT output bin main lobes become narrower. So a DFT output bin can be treated as a bandpass filter whose gain can be increased and whose bandwidth can be reduced by increasing the value of <em class="calibre7">N</em>. Decreasing a bandpass filter’s bandwidth is useful in energy detection because the frequency resolution improves in addition to the filter’s ability to minimize the amount of background noise that resides within its passband. We can demonstrate this by looking at the DFT of a spectral tone (a constant-frequency sinewave) added to random noise. <a href="#calibre_link-1586">Figure 3-22(a)</a> is a logarithmic plot showing the first 32 outputs of a 64-point DFT when the input tone is at the center of the DFT’s <em class="calibre7">m</em> = 20th bin. The output power levels (DFT magnitude squared) in <a href="#calibre_link-1586">Figure 3-22(a)</a> are normalized so that the highest bin output power is set to 0 dB. Because the tone’s original signal power is below the average noise power level, the tone is a bit difficult to detect when <em class="calibre7">N</em> = 64. (The time-domain noise, used to generate <a href="#calibre_link-1586">Figure 3-22(a)</a>, has an average value of zero, i.e., no DC bias or amplitude offset.) If we quadruple the number of input samples and increase the DFT size to <em class="calibre7">N</em> = 256, we can now see the tone power raised above the average background noise power as shown for <em class="calibre7">m</em> = 80 in <a href="#calibre_link-1586">Figure 3-22(b)</a>. Increasing the DFT’s size to <em class="calibre7">N</em> = 1024 provides additional processing gain to pull the tone further up out of the noise as shown in <a href="#calibre_link-1586">Figure 3-22(c)</a>.</p>
<p class="caption"><a id="calibre_link-2145"></a><a id="calibre_link-1586"></a><strong class="calibre9">Figure 3-22</strong> Single DFT processing gain: (a) <em class="calibre7">N</em> = 64; (b) <em class="calibre7">N</em> = 256; (c) <em class="calibre7">N</em> = 1024.</p>
<p class="image"><img src="images/000361.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To quantify the idea of DFT processing gain, we can define a signal-to-noise ratio (SNR) as the DFT’s <em class="calibre7">output signal-power level</em> over the <em class="calibre7">average output noise-power level</em>. (In practice, of course, we like to have this ratio as large as possible.) For several reasons, it’s hard to say what any given single DFT output SNR will be. That’s because we can’t exactly predict the energy in any given <em class="calibre7">N</em> samples of random noise. Also, if the input signal frequency is not at bin center, leakage will raise the effective background noise and reduce the <a id="calibre_link-2590"></a>DFT’s output SNR. In addition, any window being used will have some effect on the leakage and, thus, on the output SNR. What we’ll see is that the DFT’s output SNR increases as <em class="calibre7">N</em> gets larger because a DFT bin’s output noise standard deviation (<em class="calibre7">rms</em>) value is proportional to <img src="images/000492.jpg" alt="image" class="calibre2" />, and the DFT’s output magnitude for the bin containing the signal tone is proportional to <em class="calibre7">N</em>.<sup class="calibre10"><a id="calibre_link-1588"></a><a href="#calibre_link-1587">†</a></sup> More generally for real inputs, if <em class="calibre7">N</em> &gt; <em class="calibre7">N</em>′, an <em class="calibre7">N</em>-point DFT’s output <em class="calibre7">SNR<sub class="calibre12">N</sub></em> increases over the <em class="calibre7">N</em>′-point DFT <em class="calibre7">SNR<sub class="calibre12">N</sub></em> by the following relationship:</p>
<p class="footnotes"><a id="calibre_link-1587"></a><sup class="calibre11"><a href="#calibre_link-1588">†</a></sup> <em class="calibre7">rms</em> = root mean square.</p>
<p class="caption"><a id="calibre_link-1589"></a>(3-33)</p>
<p class="image"><img src="images/000378.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we increase a DFT’s size from <em class="calibre7">N</em>′ to <em class="calibre7">N</em> = 2<em class="calibre7">N</em>′, from <a href="#calibre_link-1589">Eq. (3-33)</a>, the DFT’s output SNR increases by 3 dB. So we say that a DFT’s processing gain increases by 3 dB whenever <em class="calibre7">N</em> is doubled. Be aware that we may double a DFT’s size and get a resultant processing gain of less than 3 dB in the presence of random noise; then again, we may gain slightly more than 3 dB. That’s the nature of random noise. If we perform many DFTs, we’ll see an average processing gain, shown in <a href="#calibre_link-1590">Figure 3-23(a)</a>, for various input signal SNRs. Because we’re interested in the slope of the curves in <a href="#calibre_link-1590">Figure 3-23(a)</a>, we plot those curves on a logarithmic scale for <em class="calibre7">N</em> in <a href="#calibre_link-1590">Figure 3-23(b)</a> where the curves straighten out and become linear. Looking at the slope of the curves in <a href="#calibre_link-1590">Figure 3-23(b)</a>, we can now see the 3 dB increase in processing gain as <em class="calibre7">N</em> doubles so <a id="calibre_link-2137"></a>long as <em class="calibre7">N</em> is greater than 20 or 30 and the signal is not overwhelmed by noise. There’s nothing sacred about the absolute values of the curves in <a href="#calibre_link-1590">Figures 3-23(a)</a> and <a href="#calibre_link-1590">3-23(b)</a>. They were generated through a simulation of noise and a tone whose frequency was at a DFT bin center. Had the tone’s frequency been between bin centers, the processing gain curves would have been shifted downward, but their shapes would still be the same;<sup class="calibre10"><a id="calibre_link-1592"></a><a href="#calibre_link-1591">†</a></sup> that is, <a href="#calibre_link-1589">Eq. (3-33)</a> is still valid regardless of the input tone’s frequency.</p>
<p class="footnotes"><a id="calibre_link-1591"></a><sup class="calibre11"><a href="#calibre_link-1592">†</a></sup> The curves would be shifted downward, indicating a lower SNR, because leakage would raise the average noise-power level, and scalloping loss would reduce the DFT bin’s output power level.</p>
<p class="caption"><a id="calibre_link-1590"></a><strong class="calibre9">Figure 3-23</strong> DFT processing gain versus number of DFT points <em class="calibre7">N</em> for various input signal-to-noise ratios: (a) linear <em class="calibre7">N</em> axis; (b) logarithmic <em class="calibre7">N</em> axis.</p>
<p class="image"><img src="images/001209.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2591"></a></p>
<h4 class="calibre13">3.12.2 Integration Gain Due to Averaging Multiple DFTs</h4>
<p class="calibre3">Theoretically, we could get very large DFT processing gains by increasing the DFT size arbitrarily. The problem is that the number of necessary DFT multiplications increases proportionally to <em class="calibre7">N</em><sup class="calibre10">2</sup>, and larger DFTs become very computationally intensive. Because addition is easier and faster to perform than multiplication, we can average the outputs of multiple DFTs to obtain further processing gain and signal detection sensitivity. The subject of averaging multiple DFT outputs is covered in <a href="#calibre_link-462">Section 11.3</a>.</p>
<p class="calibre3"><a id="calibre_link-597"></a></p>
<h3 class="calibre6">3.13 The DFT of Rectangular Functions</h3>
<p class="calibre3">We continue this chapter by providing the mathematical details of two important aspects of the DFT. First, we obtain the expressions for the DFT of a rectangular function (rectangular window), and then we’ll use these results to illustrate the magnitude response of the DFT. We’re interested in the DFT’s magnitude response because it provides an alternate viewpoint to understand the leakage that occurs when we use the DFT as a signal analysis tool.</p>
<p class="calibre3">One of the most prevalent and important computations encountered in digital signal processing is the DFT of a rectangular function. We see it in sampling theory, window functions, discussions of convolution, spectral analysis, and in the design of digital filters. As common as it is, however, the literature covering the DFT of rectangular functions can be confusing to the digital signal processing beginner for several reasons. The standard mathematical notation is a bit hard to follow at first, and sometimes the equations are presented with too little explanation. Compounding the problem, for the beginner, are the various expressions of this particular DFT. In the literature, we’re likely to find any one of the following forms for the DFT of a rectangular function:</p>
<p class="caption"><a id="calibre_link-1593"></a>(3-34)</p>
<p class="image"><img src="images/001226.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2371"></a>In this section we’ll show how the forms in <a href="#calibre_link-1593">Eq. (3-34)</a> were obtained, see how they’re related, and create a kind of <em class="calibre7">Rosetta Stone</em> table allowing us to move back and forth between the various DFT expressions. Take a deep breath and let’s begin our discussion with the definition of a rectangular function.</p>
<p class="calibre3"><a id="calibre_link-2592"></a></p>
<h4 class="calibre13">3.13.1 DFT of a General Rectangular Function</h4>
<p class="calibre3">A general rectangular function <em class="calibre7">x</em>(<em class="calibre7">n</em>) can be defined as <em class="calibre7">N</em> samples containing <em class="calibre7">K</em> unity-valued samples as shown in <a href="#calibre_link-1594">Figure 3-24</a>. The full <em class="calibre7">N</em>-point sequence, <em class="calibre7">x</em>(<em class="calibre7">n</em>), is the rectangular function that we want to transform. We call this the general form of a rectangular function because the <em class="calibre7">K</em> unity samples begin at an arbitrary index value of −<em class="calibre7">n</em><sub class="calibre12">o</sub>. Let’s take the DFT of <em class="calibre7">x</em>(<em class="calibre7">n</em>) in <a href="#calibre_link-1594">Figure 3-24</a> to get our desired <em class="calibre7">X</em>(<em class="calibre7">m</em>). Using <em class="calibre7">m</em> as our frequency-domain sample index, the expression for an <em class="calibre7">N</em>-point DFT is</p>
<p class="caption"><a id="calibre_link-1595"></a>(3-35)</p>
<p class="image"><img src="images/000265.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1594"></a><strong class="calibre9">Figure 3-24</strong> Rectangular function of width <em class="calibre7">K</em> samples defined over <em class="calibre7">N</em> samples where <em class="calibre7">K</em> &lt; <em class="calibre7">N</em>.</p>
<p class="image"><img src="images/000247.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">With <em class="calibre7">x</em>(<em class="calibre7">n</em>) being nonzero only over the range of −<em class="calibre7">n</em><sub class="calibre12">o</sub> ≤ <em class="calibre7">n</em> ≤ −<em class="calibre7">n</em><sub class="calibre12">o</sub> + (<em class="calibre7">K</em>−1), we can modify the summation limits of <a href="#calibre_link-1595">Eq. (3-35)</a> to express <em class="calibre7">X</em>(<em class="calibre7">m</em>) as</p>
<p class="caption"><a id="calibre_link-1596"></a>(3-36)</p>
<p class="image"><img src="images/001107.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">because only the <em class="calibre7">K</em> samples contribute to <em class="calibre7">X</em>(<em class="calibre7">m</em>). That last step is important because it allows us to eliminate the <em class="calibre7">x</em>(<em class="calibre7">n</em>) terms and make <a href="#calibre_link-1596">Eq. (3-36)</a> easier to handle. To keep the following equations from being too messy, let’s use the dummy variable <em class="calibre7">q</em> = 2π<em class="calibre7">m</em>/<em class="calibre7">N</em>.</p>
<p class="calibre3">OK, here’s where the algebra comes in. Over our new limits of summation, we eliminate the factor of one and <a href="#calibre_link-1596">Eq. (3-36)</a> becomes</p>
<p class="caption"><a id="calibre_link-2298"></a><a id="calibre_link-1597"></a>(3-37)</p>
<p class="image"><img src="images/000160.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The series inside the brackets of <a href="#calibre_link-1597">Eq. (3-37)</a> allows the use of a summation, such as</p>
<p class="caption"><a id="calibre_link-1598"></a>(3-38)</p>
<p class="image"><img src="images/001567.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1598">Equation (3-38)</a> certainly doesn’t look any simpler than <a href="#calibre_link-1596">Eq. (3-36)</a>, but it is. <a href="#calibre_link-1598">Equation (3-38)</a> is a <em class="calibre7">geometric series</em> and, from the discussion in <a href="#calibre_link-294">Appendix B</a>, it can be evaluated to the closed form of</p>
<p class="caption"><a id="calibre_link-1599"></a>(3-39)</p>
<p class="image"><img src="images/000592.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We can now simplify <a href="#calibre_link-1599">Eq. (3-39)</a>&mdash;here’s the clever step. If we multiply and divide the numerator and denominator of <a href="#calibre_link-1599">Eq. (3-39)</a>’s right-hand side by the appropriate half-angled exponentials, we break the exponentials into two parts and get</p>
<p class="caption"><a id="calibre_link-1600"></a>(3-40)</p>
<p class="image"><img src="images/001454.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Let’s pause for a moment here to remind ourselves where we’re going. We’re trying to get <a href="#calibre_link-1600">Eq. (3-40)</a> into a usable form because it’s part of <a href="#calibre_link-1598">Eq. (3-38)</a> that we’re using to evaluate <em class="calibre7">X</em>(<em class="calibre7">m</em>) in <a href="#calibre_link-1596">Eq. (3-36)</a> in our quest for an understandable expression for the DFT of a rectangular function.</p>
<p class="calibre3"><a id="calibre_link-2157"></a><a href="#calibre_link-1600">Equation (3-40)</a> looks even more complicated than <a href="#calibre_link-1599">Eq. (3-39)</a>, but things can be simplified inside the parentheses. From Euler’s equation, sin(ø) = (<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ø</sup> − <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>ø</sup>)/2<em class="calibre7">j</em>, <a href="#calibre_link-1600">Eq. (3-40)</a> becomes</p>
<p class="caption"><a id="calibre_link-1601"></a>(3-41)</p>
<p class="image"><img src="images/000113.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Substituting <a href="#calibre_link-1601">Eq. (3-41)</a> for the summation in <a href="#calibre_link-1598">Eq. (3-38)</a>, our expression for <em class="calibre7">X</em>(<em class="calibre7">q</em>) becomes</p>
<p class="caption"><a id="calibre_link-2593"></a>(3-42)</p>
<p class="image"><img src="images/001357.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Returning our dummy variable <em class="calibre7">q</em> to its original value of 2π<em class="calibre7">m</em>/<em class="calibre7">N</em>,</p>
<p class="image"><img src="images/000075.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1602"></a>(3-43)</p>
<p class="image"><img src="images/000386.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So there it is (whew!). <a href="#calibre_link-1602">Equation (3-43)</a> is the general expression for the DFT of the rectangular function as shown in <a href="#calibre_link-1594">Figure 3-24</a>. Our <em class="calibre7">X</em>(<em class="calibre7">m</em>) is a complex expression (pun intended) where a ratio of sine terms is the amplitude of <em class="calibre7">X</em>(<em class="calibre7">m</em>) and the exponential term is the phase angle of <em class="calibre7">X</em>(<em class="calibre7">m</em>).<sup class="calibre10"><a id="calibre_link-1607"></a><a href="#calibre_link-1603">†</a></sup> The ratio of sines factor in <a href="#calibre_link-1602">Eq. (3-43)</a> lies on the periodic curve shown in <a href="#calibre_link-1604">Figure 3-25(a)</a>, and like all <em class="calibre7">N</em>-point DFT representations, the periodicity of <em class="calibre7">X</em>(<em class="calibre7">m</em>) is <em class="calibre7">N</em>. This curve is known as the <em class="calibre7">Dirichlet kernel</em> (or the <em class="calibre7">aliased sinc function</em>) and has been thoroughly described in the literature[<a href="#calibre_link-1574">10</a>,<a href="#calibre_link-1605">13</a>,<a href="#calibre_link-1606">14</a>]. (It’s named after the nineteenth-century German mathematician Peter Dirichlet [pronounced dee-ree-’klay], <a id="calibre_link-2594"></a>who studied the convergence of trigonometric series used to represent arbitrary functions.)</p>
<p class="footnotes"><a id="calibre_link-1603"></a><sup class="calibre11"><a href="#calibre_link-1607">†</a></sup> <em class="calibre7">N</em> was an even number in <a href="#calibre_link-1594">Figure 3-24</a> depicting the <em class="calibre7">x</em>(<em class="calibre7">n</em>). Had <em class="calibre7">N</em> been an odd number, the limits on the summation in <a href="#calibre_link-1595">Eq. (3-35)</a> would have been −(<em class="calibre7">N</em>−1)/2 ≤ <em class="calibre7">n</em> ≤ (<em class="calibre7">N</em>−1)/2. Using these alternate limits would have led us to exactly the same <em class="calibre7">X</em>(<em class="calibre7">m</em>) as in <a href="#calibre_link-1602">Eq. (3-43)</a>.</p>
<p class="caption"><a id="calibre_link-1604"></a><strong class="calibre9">Figure 3-25</strong> The Dirichlet kernel of <em class="calibre7">X</em>(<em class="calibre7">m</em>): (a) periodic continuous curve on which the <em class="calibre7">X</em>(<em class="calibre7">m</em>) samples lie; (b) <em class="calibre7">X</em>(<em class="calibre7">m</em>) amplitudes about the <em class="calibre7">m</em> = 0 sample; (c) |<em class="calibre7">X</em>(<em class="calibre7">m</em>)| magnitudes about the <em class="calibre7">m</em> = 0 sample.</p>
<p class="image"><img src="images/001088.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We can zoom in on the curve at the <em class="calibre7">m</em> = 0 point and see more detail in <a href="#calibre_link-1604">Figure 3-25(b)</a>. The dots are shown in <a href="#calibre_link-1604">Figure 3-25(b)</a> to remind us that the DFT of our rectangular function results in discrete amplitude values that lie on the curve. So when we perform DFTs, our discrete results are sampled values of the continuous sinc function’s curve in <a href="#calibre_link-1604">Figure 3-25(a)</a>. As we’ll show later, we’re primarily interested in the absolute value, or magnitude, of the Dirichlet kernel in <a href="#calibre_link-1602">Eq. (3-43)</a>. That magnitude, |<em class="calibre7">X</em>(<em class="calibre7">m</em>)|, is shown in <a href="#calibre_link-1604">Figure 3-25(c)</a>. Although we first saw the sinc function’s curve in <a href="#calibre_link-1555">Figure 3-9</a> in <a href="#calibre_link-461">Section 3.8</a>, where we introduced the topic of DFT leakage, we’ll encounter this curve often in our study of digital signal processing.</p>
<p class="calibre3">For now, there are just a few things we need to keep in mind concerning the Dirichlet kernel. First, the DFT of a rectangular function has a main lobe, <a id="calibre_link-2361"></a>centered about the <em class="calibre7">m</em> = 0 point. The peak amplitude of the main lobe is <em class="calibre7">K</em>. This peak value makes sense, right? The <em class="calibre7">m</em> = 0 sample of a DFT <em class="calibre7">X</em>(0) is the sum of the original samples, and the sum of <em class="calibre7">K</em> unity-valued samples is <em class="calibre7">K</em>. We can show this in a more substantial way by evaluating <a href="#calibre_link-1602">Eq. (3-43)</a> for <em class="calibre7">m</em> = 0. A difficulty arises when we plug <em class="calibre7">m</em> = 0 into <a href="#calibre_link-1602">Eq. (3-43)</a> because we end up with sin(0)/sin(0), which is the indeterminate ratio 0/0. Well, hardcore mathematics to the rescue here. We can use L’Hopital’s Rule to take the derivative of the numerator and the denominator of <a href="#calibre_link-1602">Eq. (3-43)</a>, and <em class="calibre7">then</em> set <em class="calibre7">m</em> = 0 to determine the peak value of the magnitude of the Dirichlet kernel.<sup class="calibre10"><a id="calibre_link-1609"></a><a href="#calibre_link-1608">†</a></sup> We proceed as</p>
<p class="footnotes"><a id="calibre_link-1608"></a><sup class="calibre11"><a href="#calibre_link-1609">†</a></sup> L’Hopital is pronounced <img src="images/000255.jpg" alt="image" class="calibre2" />, like baby doll.</p>
<p class="caption"><a id="calibre_link-1610"></a>(3-44)</p>
<p class="image"><img src="images/001237.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">which is what we set out to show. (We could have been clever and evaluated <a href="#calibre_link-1595">Eq. (3-35)</a> with <em class="calibre7">m</em> = 0 to get the result of <a href="#calibre_link-1610">Eq. (3-44)</a>. Try it, and keep in mind that <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">0</sup> = 1.) Had the amplitudes of the nonzero samples of <em class="calibre7">x</em>(<em class="calibre7">n</em>) been other than unity, say some amplitude <em class="calibre7">A</em><sub class="calibre12">o</sub>, then, of course, the peak value of the Dirichlet kernel would be <em class="calibre7">A</em><sub class="calibre12">o</sub><em class="calibre7">K</em> instead of just <em class="calibre7">K</em>. The next important thing to notice about the Dirichlet kernel is the main lobe’s width. The first zero crossing of <a href="#calibre_link-1602">Eq. (3-43)</a> occurs when the numerator’s argument is equal to π, that is, when π<em class="calibre7">mK</em>/<em class="calibre7">N</em> = π. So the value of <em class="calibre7">m</em> at the first zero crossing is given by</p>
<p class="caption"><a id="calibre_link-1613"></a>(3-45)</p>
<p class="image"><img src="images/000276.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">as shown in <a href="#calibre_link-1604">Figure 3-25(b)</a>. Thus the main lobe width 2<em class="calibre7">N</em>/<em class="calibre7">K,</em> as shown in <a href="#calibre_link-1604">Figure 3-25(c)</a>, is inversely proportional to <em class="calibre7">K</em>.<sup class="calibre10"><a id="calibre_link-1612"></a><a href="#calibre_link-1611">††</a></sup></p>
<p class="footnotes"><a id="calibre_link-1611"></a><sup class="calibre11"><a href="#calibre_link-1612">††</a></sup> This is a fundamental characteristic of Fourier transforms. The narrower the function in one domain, the wider its transform will be in the other domain.</p>
<p class="calibre3">Notice that the main lobe in <a href="#calibre_link-1604">Figure 3-25(a)</a> is surrounded by a series of oscillations, called <em class="calibre7">sidelobes,</em> as in <a href="#calibre_link-1604">Figure 3-25(c)</a>. These sidelobe magnitudes decrease the farther they’re separated from the main lobe. However, no matter how far we look away from the main lobe, these sidelobes never reach zero magnitude&mdash;and they cause a great deal of heartache for practitioners in <a id="calibre_link-2595"></a>digital signal processing. These sidelobes cause high-amplitude signals to overwhelm and hide neighboring low-amplitude signals in spectral analysis, and they complicate the design of digital filters. As we’ll see in <a href="#calibre_link-79">Chapter 5</a>, the unwanted ripple in the passband and the poor stopband attenuation in simple digital filters are caused by the rectangular function’s DFT sidelobes. (The development, analysis, and application of window functions came about to minimize the ill effects of those sidelobes in <a href="#calibre_link-1604">Figure 3-25</a>.)</p>
<p class="calibre3">Let’s demonstrate the relationship in <a href="#calibre_link-1613">Eq. (3-45)</a> by way of a simple but concrete example. Assume that we’re taking a 64-point DFT of the 64-sample rectangular function, with 11 unity values, shown in <a href="#calibre_link-1614">Figure 3-26(a)</a>. In this example, <em class="calibre7">N</em> = 64 and <em class="calibre7">K</em> = 11. Taking the 64-point DFT of the sequence in <a href="#calibre_link-1614">Figure 3-26(a)</a> results in an <em class="calibre7">X</em>(<em class="calibre7">m</em>) whose real and imaginary parts, <em class="calibre7">X</em><sub class="calibre12">real</sub>(<em class="calibre7">m</em>) and <em class="calibre7">X</em><sub class="calibre12">imag</sub>(<em class="calibre7">m</em>), are shown in <a href="#calibre_link-1614">Figures 3-26(b)</a> and <a href="#calibre_link-1614">3-26(c)</a> respectively. <a href="#calibre_link-1614">Figure 3-26(b)</a> is a good illustration of how the real part of the DFT of a real input sequence has even symmetry, and <a href="#calibre_link-1614">Figure 3-26(c)</a> confirms that the imaginary part of the DFT of a real input sequence has odd symmetry.</p>
<p class="caption"><a id="calibre_link-1614"></a><strong class="calibre9">Figure 3-26</strong> DFT of a rectangular function: (a) original function <em class="calibre7">x</em>(<em class="calibre7">n</em>) ; (b) real part of the DFT of <em class="calibre7">x</em>(<em class="calibre7">n</em>), <em class="calibre7">X</em><sub class="calibre12">real</sub>(<em class="calibre7">m</em>); (c) imaginary part of the DFT of <em class="calibre7">x</em>(<em class="calibre7">n</em>), <em class="calibre7">X</em><sub class="calibre12">imag</sub>(<em class="calibre7">m</em>).</p>
<p class="image"><img src="images/001328.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Although <em class="calibre7">X</em><sub class="calibre12">real</sub>(<em class="calibre7">m</em>) and <em class="calibre7">X</em><sub class="calibre12">imag</sub>(<em class="calibre7">m</em>) tell us everything there is to know about the DFT of <em class="calibre7">x</em>(<em class="calibre7">n</em>), it’s a bit easier to comprehend the true spectral nature of <em class="calibre7">X</em>(<em class="calibre7">m</em>) by viewing its absolute magnitude. This magnitude, from <a href="#calibre_link-1530">Eq. (3-7)</a>, is provided in <a href="#calibre_link-1615">Figure 3-27(a)</a> where the main and sidelobes are clearly evident <a id="calibre_link-2372"></a>now. As we expected, the peak value of the main lobe is 11 because we had <em class="calibre7">K</em> = 11 samples in <em class="calibre7">x</em>(<em class="calibre7">n</em>). The width of the main lobe from <a href="#calibre_link-1613">Eq. (3-45)</a> is 64/11, or 5.82. Thus, the first positive-frequency zero-crossing location lies just below the <em class="calibre7">m</em> = 6 sample of our discrete |<em class="calibre7">X</em>(<em class="calibre7">m</em>)| represented by the squares in <a href="#calibre_link-1615">Figure 3-27(a)</a>. The phase angles associated with |<em class="calibre7">X</em>(<em class="calibre7">m</em>)|, first introduced in <a href="#calibre_link-1616">Eqs. (3-6)</a> and <a href="#calibre_link-1531">(3-8)</a>, are shown in <a href="#calibre_link-1615">Figure 3-27(b)</a>.</p>
<p class="caption"><a id="calibre_link-1615"></a><strong class="calibre9">Figure 3-27</strong> DFT of a generalized rectangular function: (a) magnitude |<em class="calibre7">X</em>(<em class="calibre7">m</em>)|; (b) phase angle in radians.</p>
<p class="image"><img src="images/000980.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To understand the nature of the DFT of rectangular functions more fully, let’s discuss a few more examples using less general rectangular functions that are more common in digital signal processing than the <em class="calibre7">x</em>(<em class="calibre7">n</em>) in <a href="#calibre_link-1594">Figure 3-24</a>.</p>
<p class="calibre3"><a id="calibre_link-2596"></a></p>
<h4 class="calibre13">3.13.2 DFT of a Symmetrical Rectangular Function</h4>
<p class="calibre3"><a href="#calibre_link-1602">Equation (3-43)</a> is a bit complicated because our original function <em class="calibre7">x</em>(<em class="calibre7">n</em>) was so general. In practice, special cases of rectangular functions lead to simpler versions of <a href="#calibre_link-1602">Eq. (3-43)</a>. Consider the symmetrical <em class="calibre7">x</em>(<em class="calibre7">n</em>) rectangular function in <a href="#calibre_link-1617">Figure 3-28</a>. As shown in <a href="#calibre_link-1617">Figure 3-28</a>, we often need to determine the DFT of a rectangular function that’s centered about the <em class="calibre7">n</em> = 0 index point. In this case, the <em class="calibre7">K</em> unity-valued samples begin at <em class="calibre7">n</em> = −<em class="calibre7">n</em><sub class="calibre12">o</sub> = −(<em class="calibre7">K</em>−1)/2. So substituting (<em class="calibre7">K</em>−1)/2 for <em class="calibre7">n</em><sub class="calibre12">o</sub> in <a href="#calibre_link-1602">Eq. (3-43)</a> yields</p>
<p class="caption"><a id="calibre_link-199"></a>(3-46)</p>
<p class="image"><img src="images/001119.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2158"></a><a id="calibre_link-1617"></a><strong class="calibre9">Figure 3-28</strong> Rectangular <em class="calibre7">x</em>(<em class="calibre7">n</em>) with <em class="calibre7">K</em> samples centered about <em class="calibre7">n</em> = 0.</p>
<p class="image"><img src="images/000033.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Because <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">0</sup> = 1, <a href="#calibre_link-199">Eq. (3-46)</a> becomes</p>
<p class="caption"><a id="calibre_link-1618"></a>(3-47)</p>
<p class="image"><img src="images/000167.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1618">Equation (3-47)</a> indicates that the DFT of the symmetrical rectangular function in <a href="#calibre_link-1617">Figure 3-28</a> is itself a real function; that is, there’s no complex exponential in <a href="#calibre_link-1618">Eq. (3-47)</a>, so this particular DFT contains no imaginary part or phase term. As we stated in <a href="#calibre_link-590">Section 3.2</a>, if <em class="calibre7">x</em>(<em class="calibre7">n</em>) is real and even, <em class="calibre7">x</em>(<em class="calibre7">n</em>) = <em class="calibre7">x</em>(−<em class="calibre7">n</em>), then <em class="calibre7">X</em><sub class="calibre12">real</sub>(<em class="calibre7">m</em>) is nonzero and <em class="calibre7">X</em><sub class="calibre12">imag</sub>(<em class="calibre7">m</em>) is always zero. We demonstrate this by taking the 64-point DFT of the sequence in <a href="#calibre_link-1619">Figure 3-29(a)</a>. Our <em class="calibre7">x</em>(<em class="calibre7">n</em>) is 11 unity-valued samples centered about the <em class="calibre7">n</em> = 0 index. Here the DFT results in an <em class="calibre7">X</em>(<em class="calibre7">m</em>) whose real and imaginary parts are shown in <a href="#calibre_link-1619">Figures 3-29(b)</a> and <a href="#calibre_link-1619">3-29(c)</a>, respectively. As <a href="#calibre_link-1618">Eq. (3-47)</a> predicted, <em class="calibre7">X</em><sub class="calibre12">real</sub>(<em class="calibre7">m</em>) is nonzero and <em class="calibre7">X</em><sub class="calibre12">imag</sub>(<em class="calibre7">m</em>) is zero. The magnitude and phase of <em class="calibre7">X</em>(<em class="calibre7">m</em>) are depicted in <a href="#calibre_link-1619">Figures 3-29(d)</a> and <a href="#calibre_link-1619">3-29(e)</a>.</p>
<p class="caption"><a id="calibre_link-1619"></a><strong class="calibre9">Figure 3-29</strong> DFT of a rectangular function centered about <em class="calibre7">n</em> = 0: (a) original <em class="calibre7">x</em>(<em class="calibre7">n</em>); (b) <em class="calibre7">X</em><sub class="calibre12">real</sub>(<em class="calibre7">m</em>); (c) <em class="calibre7">X</em><sub class="calibre12">imag</sub>(<em class="calibre7">m</em>); (d) magnitude of <em class="calibre7">X</em>(<em class="calibre7">m</em>); (e) phase angle of <em class="calibre7">X</em>(<em class="calibre7">m</em>) in radians.</p>
<p class="image"><img src="images/000878.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Notice that the magnitudes in <a href="#calibre_link-1615">Figures 3-27(a)</a> and <a href="#calibre_link-1619">3-29(d)</a> are identical. This verifies the very important shifting theorem of the DFT; that is, the magnitude |<em class="calibre7">X</em>(<em class="calibre7">m</em>)| depends only on the number of nonzero samples in <em class="calibre7">x</em>(<em class="calibre7">n</em>), <em class="calibre7">K</em>, and <em class="calibre7">not</em> on their position relative to the <em class="calibre7">n</em> = 0 index value. Shifting the <em class="calibre7">K</em> unity-valued samples to center them about the <em class="calibre7">n</em> = 0 index merely affects the phase angle of <em class="calibre7">X</em>(<em class="calibre7">m</em>), not its magnitude.</p>
<p class="calibre3">Speaking of phase angles, it’s interesting to realize here that even though <em class="calibre7">X</em><sub class="calibre12">imag</sub>(<em class="calibre7">m</em>) is zero in <a href="#calibre_link-1619">Figure 3-29(c)</a>, the phase angle of <em class="calibre7">X</em>(<em class="calibre7">m</em>) is not always zero. In this case, <em class="calibre7">X</em>(<em class="calibre7">m</em>)’s individual phase angles in <a href="#calibre_link-1619">Figure 3-29(e)</a> are either +π, zero, or −π radians. With <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">π</sup> and <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">(−π)</sup> both being equal to −1, we could easily reconstruct <em class="calibre7">X</em><sub class="calibre12">real</sub>(<em class="calibre7">m</em>) from |<em class="calibre7">X</em>(<em class="calibre7">m</em>)| and the phase angle <em class="calibre7">X</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>) if we must. <em class="calibre7">X</em><sub class="calibre12">real</sub>(<em class="calibre7">m</em>) is equal to |<em class="calibre7">X</em>(<em class="calibre7">m</em>)| with the signs of |<em class="calibre7">X</em>(<em class="calibre7">m</em>)|’s alternate sidelobes reversed.<sup class="calibre10"><a id="calibre_link-1622"></a><a href="#calibre_link-1620">†</a></sup> To gain some further appreciation of how the DFT of a rectangular function is a sampled version of the Dirichlet kernel, let’s increase the number of our nonzero <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples. <a href="#calibre_link-1621">Figure 3-30(a)</a> shows a 64-point <em class="calibre7">x</em>(<em class="calibre7">n</em>) <a id="calibre_link-2597"></a>where 31 unity-valued samples are centered about the <em class="calibre7">n</em> = 0 index location. The magnitude of <em class="calibre7">X</em>(<em class="calibre7">m</em>) is provided in <a href="#calibre_link-1621">Figure 3-30(b)</a>. By broadening the <em class="calibre7">x</em>(<em class="calibre7">n</em>) function, i.e., increasing <em class="calibre7">K</em>, we’ve narrowed the Dirichlet kernel of <em class="calibre7">X</em>(<em class="calibre7">m</em>). This follows from <a href="#calibre_link-1613">Eq. (3-45)</a>, right? The kernel’s first zero crossing is inversely proportional to <em class="calibre7">K</em>, so, as we extend the width of <em class="calibre7">K</em>, we squeeze |<em class="calibre7">X</em>(<em class="calibre7">m</em>)| in toward <em class="calibre7">m</em> = 0. In this example, <em class="calibre7">N</em> = 64 and <em class="calibre7">K</em> = 31. From <a href="#calibre_link-1613">Eq. (3-45)</a> the first positive zero crossing of <em class="calibre7">X</em>(<em class="calibre7">m</em>) occurs at 64/31, or just slightly to the right of the <em class="calibre7">m</em> = 2 sample in <a href="#calibre_link-1621">Figure 3-30(b)</a>. Also notice that the peak value of |<em class="calibre7">X</em>(<em class="calibre7">m</em>)| = <em class="calibre7">K</em> = 31, as mandated by <a href="#calibre_link-1610">Eq. (3-44)</a>.</p>
<p class="footnotes"><a id="calibre_link-1620"></a><sup class="calibre11"><a href="#calibre_link-1622">†</a></sup> The particular pattern of +π and −π values in <a href="#calibre_link-1619">Figure 3-29(e)</a> is an artifact of the software used to generate that figure. A different software package may show a different pattern, but as long as the nonzero phase samples are either +π or −π, the phase results will be correct.</p>
<p class="caption"><a id="calibre_link-1964"></a><a id="calibre_link-1621"></a><strong class="calibre9">Figure 3-30</strong> DFT of a symmetrical rectangular function with 31 unity values: (a) original <em class="calibre7">x</em>(<em class="calibre7">n</em>); (b) magnitude of <em class="calibre7">X</em>(<em class="calibre7">m</em>).</p>
<p class="image"><img src="images/001735.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2598"></a></p>
<h4 class="calibre13">3.13.3 DFT of an All-Ones Rectangular Function</h4>
<p class="calibre3">The DFT of a special form of <em class="calibre7">x</em>(<em class="calibre7">n</em>) is routinely called for, leading to yet another simplified form of <a href="#calibre_link-1602">Eq. (3-43)</a>. In the literature, we often encounter a rectangular function where <em class="calibre7">K</em> = <em class="calibre7">N</em>; that is, all <em class="calibre7">N</em> samples of <em class="calibre7">x</em>(<em class="calibre7">n</em>) are nonzero, as shown in <a href="#calibre_link-1623">Figure 3-31</a>. In this case, the <em class="calibre7">N</em> unity-valued samples begin at <em class="calibre7">n</em> = −<em class="calibre7">n</em><sub class="calibre12">o</sub> = −(<em class="calibre7">N</em>−1)/2. We obtain the expression for the DFT of the function in <a href="#calibre_link-1623">Figure 3-31</a> by substituting <em class="calibre7">K</em> = <em class="calibre7">N</em> and <em class="calibre7">n</em><sub class="calibre12">o</sub> = (<em class="calibre7">N</em>−1)/2 in <a href="#calibre_link-1602">Eq. (3-43)</a> to get</p>
<p class="image"><img src="images/000918.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1624"></a>(3-48)</p>
<p class="image"><img src="images/001009.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1623"></a><strong class="calibre9">Figure 3-31</strong> Rectangular function with <em class="calibre7">N</em> unity-valued samples.</p>
<p class="image"><img src="images/000761.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1624">Equation (3-48)</a> takes the first form of <a href="#calibre_link-1593">Eq. (3-34)</a> that we alluded to at the beginning of <a href="#calibre_link-597">Section 3.13</a>.<sup class="calibre10"><a id="calibre_link-1627"></a><a href="#calibre_link-1625">†</a></sup> <a href="#calibre_link-1626">Figure 3-32</a> demonstrates the meaning of <a href="#calibre_link-1624">Eq. (3-48)</a>. The DFT magnitude of the all-ones function, <em class="calibre7">x</em>(<em class="calibre7">n</em>) in <a href="#calibre_link-1626">Figure 3-32(a)</a>, is shown in <a href="#calibre_link-1626">Figures 3-32(b)</a> and <a href="#calibre_link-1626">3-32(c)</a>. Take note that if <em class="calibre7">m</em> is continuous, <a href="#calibre_link-1624">Eq. (3-48)</a> describes the shaded curves in <a href="#calibre_link-1626">Figure 3-32(b)</a> and <a id="calibre_link-2435"></a><a href="#calibre_link-1626">Figure 3-32(c)</a>. If <em class="calibre7">m</em> is restricted to being integers, then <a href="#calibre_link-1624">Eq. (3-48)</a> represents the dots in those figures.</p>
<p class="footnotes"><a id="calibre_link-1625"></a><sup class="calibre11"><a href="#calibre_link-1627">†</a></sup> By the way, there’s nothing <em class="calibre7">official</em> about calling <a href="#calibre_link-1624">Eq. (3-48)</a> a Type 1 Dirichlet kernel. We’re using the phrase <em class="calibre7">Type 1</em> merely to distinguish <a href="#calibre_link-1624">Eq. (3-48)</a> from other mathematical expressions for the Dirichlet kernel that we’re about to encounter.</p>
<p class="caption"><a id="calibre_link-1626"></a><strong class="calibre9">Figure 3-32</strong> All-ones function: (a) rectangular function with <em class="calibre7">N</em> = 64 unity-valued samples; (b) DFT magnitude of the all-ones time function; (c) close-up view of the DFT magnitude of an all-ones time function.</p>
<p class="image"><img src="images/001778.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The Dirichlet kernel of <em class="calibre7">X</em>(<em class="calibre7">m</em>) in <a href="#calibre_link-1626">Figure 3-32(b)</a> is now as narrow as it can get. The main lobe’s first positive zero crossing occurs at the <em class="calibre7">m</em> = 64/64 = 1 sample in <a href="#calibre_link-1626">Figure 3-32(b)</a> and the peak value of |<em class="calibre7">X</em>(<em class="calibre7">m</em>)| = <em class="calibre7">N</em> = 64. With <em class="calibre7">x</em>(<em class="calibre7">n</em>) being all ones, |<em class="calibre7">X</em>(<em class="calibre7">m</em>)| is zero for all <em class="calibre7">m</em> ≠ 0. The sinc function in <a href="#calibre_link-1624">Eq. (3-48)</a> is of utmost importance&mdash;as we’ll see at the end of this chapter, it defines the overall DFT frequency response to an input sinusoidal sequence, and it’s also the amplitude response of a single DFT bin.</p>
<p class="calibre3">The form of <a href="#calibre_link-1624">Eq. (3-48)</a> allows us to go one step further to identify the most common expression for the DFT of an all-ones rectangular function found in the literature. To do this, we have to use an approximation principle found in the mathematics of trigonometry that you may have heard before. It <a id="calibre_link-2599"></a>states that when α is small, then sin(α) is approximately equal to α, i.e., sin(α) ≈ α. This idea comes about when we consider a pie-shaped section of a circle whose radius is 1 as shown in <a href="#calibre_link-1628">Figure 3-33(a)</a>. That section is defined by the length of the arc α measured in radians and α’s chord <em class="calibre7">b</em>. If we draw a right triangle inside the section, we can say that <em class="calibre7">a</em> = sin(α). As α gets smaller, the long sides of our triangle become almost parallel, the length of chord <em class="calibre7">b</em> approaches the length of arc α, and the length of line <em class="calibre7">a</em> approaches the length of <em class="calibre7">b</em>. So, as depicted in <a href="#calibre_link-1628">Figure 3-33(b)</a>, when α is small, α ≈ <em class="calibre7">b</em> ≈ <em class="calibre7">a</em> = sin(α). We use this sin(α) ≈ α approximation when we look at the denominator of <a href="#calibre_link-1624">Eq. (3-48)</a>. When π<em class="calibre7">m</em>/<em class="calibre7">N</em> is small, then sin(π<em class="calibre7">m</em>/<em class="calibre7">N</em>) is approximately equal to π<em class="calibre7">m</em>/<em class="calibre7">N</em>. So we can, when <em class="calibre7">N</em> is large, state</p>
<p class="caption"><a id="calibre_link-1629"></a>(3-49)</p>
<p class="image"><img src="images/000057.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1628"></a><strong class="calibre9">Figure 3-33</strong> Relationships between an angle α, line <em class="calibre7">a</em> = sin(α), and α’s chord <em class="calibre7">b</em>: (a) large angle α; (b) small angle α.</p>
<p class="image"><img src="images/000640.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">It has been shown that when <em class="calibre7">N</em> is larger than, say, 10 in <a href="#calibre_link-1624">Eq. (3-48)</a>, <a href="#calibre_link-1629">Eq. (3-49)</a> accurately describes the DFT’s output.<sup class="calibre10"><a id="calibre_link-1631"></a><a href="#calibre_link-1630">†</a></sup> <a href="#calibre_link-1629">Equation (3-49)</a> is often normalized by dividing it by <em class="calibre7">N</em>, so we can express the normalized DFT of an all-ones rectangular function as</p>
<p class="footnotes"><a id="calibre_link-1630"></a><a href="#calibre_link-1631">†</a> We can be comfortable with this result because, if we let <em class="calibre7">K</em> = <em class="calibre7">N,</em> we’ll see that the peak value of <em class="calibre7">X</em>(<em class="calibre7">m</em>) in <a href="#calibre_link-1629">Eq. (3-49)</a>, for <em class="calibre7">m</em> = 0, is equal to <em class="calibre7">N,</em> which agrees with <a href="#calibre_link-1610">Eq. (3-44)</a>.</p>
<p class="caption"><a id="calibre_link-1632"></a>(3-50)</p>
<p class="image"><img src="images/000360.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2274"></a><a href="#calibre_link-1632">Equation (3-50)</a>, taking the second form of <a href="#calibre_link-1593">Eq. (3-34)</a> that is so often seen in the literature, also has the DFT magnitude shown in <a href="#calibre_link-1626">Figures 3-32(b)</a> and <a href="#calibre_link-1626">3-32(c)</a>.</p>
<p class="calibre3"><a id="calibre_link-2600"></a></p>
<h4 class="calibre13">3.13.4 Time and Frequency Axes Associated with the DFT</h4>
<p class="calibre3">Let’s establish the physical dimensions associated with the <em class="calibre7">n</em> and <em class="calibre7">m</em> index values. So far in our discussion, the <em class="calibre7">n</em> index was merely an integer enabling us to keep track of individual <em class="calibre7">x</em>(<em class="calibre7">n</em>) sample values. If the <em class="calibre7">n</em> index represents instants in time, we can identify the time period separating adjacent <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples to establish the time scale for the <em class="calibre7">x</em>(<em class="calibre7">n</em>) axis and the frequency scale for the <em class="calibre7">X</em>(<em class="calibre7">m</em>) axis. Consider the time-domain rectangular function given in <a href="#calibre_link-1633">Figure 3-34(a)</a>. That function comprises <em class="calibre7">N</em> time samples obtained <em class="calibre7">t<sub class="calibre12">s</sub></em> seconds apart, and the full sample interval is <em class="calibre7">Nt<sub class="calibre12">s</sub></em> seconds. Each <em class="calibre7">x</em>(<em class="calibre7">n</em>) sample occurs at <em class="calibre7">nt<sub class="calibre12">s</sub></em> seconds for some value of <em class="calibre7">n</em>. For example, the <em class="calibre7">n</em> = 9 sample value, <em class="calibre7">x</em>(9) = 0, occurs at 9<em class="calibre7">t<sub class="calibre12">s</sub></em> seconds.</p>
<p class="caption"><a id="calibre_link-1633"></a><strong class="calibre9">Figure 3-34</strong> DFT time and frequency axis dimensions: (a) time-domain axis uses time index <em class="calibre7">n</em>; (b) various representations of the DFT’s frequency axis.</p>
<p class="image"><img src="images/001494.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The frequency axis of <em class="calibre7">X</em>(<em class="calibre7">m</em>) can be represented in a number of different ways. Three popular types of DFT frequency axis labeling are shown in <a href="#calibre_link-1633">Figure 3-34(b)</a> and listed in <a href="#calibre_link-1634">Table 3-1</a>. Let’s consider each representation individually.</p>
<p class="caption"><a id="calibre_link-1634"></a><strong class="calibre9">Table 3-1</strong> Characteristics of Various DFT Frequency Axis Representations</p>
<p class="image"><img src="images/000971.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2601"></a></p>
<h5 class="calibre16">3.13.4.1 DFT Frequency Axis in Hz</h5>
<p class="calibre3">If we decide to relate the frequencies of <em class="calibre7">X</em>(<em class="calibre7">m</em>) to the time sample period <em class="calibre7">t<sub class="calibre12">s</sub></em>, or the sample rate <em class="calibre7">f<sub class="calibre12">s</sub></em> = 1/<em class="calibre7">t<sub class="calibre12">s</sub></em>, then the frequency axis variable is <em class="calibre7">f</em> = <em class="calibre7">m</em>/<em class="calibre7">Nt<sub class="calibre12">s</sub></em> = <em class="calibre7">mf<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em> Hz. So each <em class="calibre7">X</em>(<em class="calibre7">m</em>) DFT sample is associated with a frequency of <em class="calibre7">mf<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em> Hz. In this case, the sample spacing of <em class="calibre7">X</em>(<em class="calibre7">m</em>) is <em class="calibre7">f<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em> Hz. The DFT repetition period, or periodicity, is <em class="calibre7">f<sub class="calibre12">s</sub></em> Hz as shown in <a href="#calibre_link-1633">Figure 3-34(b)</a>. The first row of <a href="#calibre_link-1634">Table 3-1</a> illustrates the characteristics of labeling the frequency axis in Hz.</p>
<p class="calibre3"><a id="calibre_link-2602"></a></p>
<h5 class="calibre16">3.13.4.2 DFT Frequency Axis Normalized by <em class="calibre7">f</em><sub class="calibre14">s</sub></h5>
<p class="calibre3">If we think of some frequency <em class="calibre7">f</em>, in Hz, we can divide that frequency by the sampling frequency <em class="calibre7">f<sub class="calibre12">s</sub></em> to create a normalized frequency variable <em class="calibre7">f</em>/<em class="calibre7">f<sub class="calibre12">s</sub></em>. The dimensions of such a normalized frequency are cycles/sample. Using this notation, each <em class="calibre7">X</em>(<em class="calibre7">m</em>) DFT sample is associated with a normalized frequency of <em class="calibre7">m</em>/<em class="calibre7">N</em> cycles/sample, and our highest frequency are 1/2 cycles/sample as shown in <a href="#calibre_link-1633">Figure 3-34(b)</a>. In this scenario the sample spacing of <em class="calibre7">X</em>(<em class="calibre7">m</em>) is 1/<em class="calibre7">N</em> cycles/sample, and the DFT repetition period is one cycle/sample as shown by the expressions in parentheses in <a href="#calibre_link-1633">Figure 3-34(b)</a>. This normalized <em class="calibre7">f</em>/<em class="calibre7">f<sub class="calibre12">s</sub></em> frequency variable only has meaning in sampled-data systems. That is, this type of frequency notation has no meaning in the world of continuous (analog) systems.</p>
<p class="calibre3">It may seem strange to use such a normalized <em class="calibre7">f</em>/<em class="calibre7">f<sub class="calibre12">s</sub></em> frequency variable, but sometimes it’s convenient for us to do so. Furthermore, the built-in plotting functions of MATLAB (a popular signal processing software package) often label the frequency axis in terms of the normalized <em class="calibre7">f</em>/<em class="calibre7">f<sub class="calibre12">s</sub></em> variable.</p>
<p class="calibre3"><a id="calibre_link-2603"></a></p>
<h5 class="calibre16">3.13.4.3 DFT Frequency Axis Using a Normalized Angle</h5>
<p class="calibre3">We can multiply the above normalized <em class="calibre7">f</em>/<em class="calibre7">f<sub class="calibre12">s</sub></em> frequency variable by 2π to create a normalized angular notation representing frequency. Doing so would result in a <a id="calibre_link-2604"></a>frequency variable expressed as ω=2π(<em class="calibre7">f</em>/<em class="calibre7">f<sub class="calibre12">s</sub></em>) radians/sample. Using this notation, each <em class="calibre7">X</em>(<em class="calibre7">m</em>) DFT sample is associated with a normalized frequency of 2π<em class="calibre7">m</em>/<em class="calibre7">N</em> radians/sample, and our highest frequency is π radians/sample as shown in <a href="#calibre_link-1633">Figure 3-34(b)</a>. In this scenario the sample spacing of <em class="calibre7">X</em>(<em class="calibre7">m</em>) is 2π/<em class="calibre7">N</em> radians/sample, and the DFT repetition period is one radian/sample as <a id="calibre_link-1965"></a>shown by the expressions in brackets in <a href="#calibre_link-1633">Figure 3-34(b)</a>. Using the normalized angular ω frequency variable is very popular in the literature of DSP, and its characteristics are described in the last row of <a href="#calibre_link-1634">Table 3-1</a>.</p>
<p class="calibre3">Unfortunately having three different representations of the DFT’s frequency axis may initially seem a bit puzzling to a DSP beginner, but don’t worry. You’ll soon become fluent in all three frequency notations. When reviewing the literature, the reader can learn to convert between these frequency axis notation schemes by reviewing <a href="#calibre_link-1633">Figure 3-34</a> and <a href="#calibre_link-1634">Table 3-1</a>.</p>
<p class="calibre3"><a id="calibre_link-2605"></a></p>
<h4 class="calibre13">3.13.5 Alternate Form of the DFT of an All-Ones Rectangular Function</h4>
<p class="calibre3">Using the radians/sample frequency notation for the DFT axis from the bottom row of <a href="#calibre_link-1634">Table 3-1</a> leads to another prevalent form of the DFT of the all-ones rectangular function in <a href="#calibre_link-1623">Figure 3-31</a>. Letting our normalized discrete frequency axis variable be ω = 2π<em class="calibre7">m</em>/<em class="calibre7">N</em>, then π<em class="calibre7">m</em> = <em class="calibre7">N</em>ω/2. Substituting the term <em class="calibre7">N</em>ω/2 for π<em class="calibre7">m</em> in <a href="#calibre_link-1624">Eq. (3-48)</a>, we obtain</p>
<p class="caption"><a id="calibre_link-1635"></a>(3-51)</p>
<p class="image"><img src="images/001760.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1635">Equation (3-51)</a>, taking the third form of <a href="#calibre_link-1593">Eq. (3-34)</a> sometimes seen in the literature, also has the DFT magnitude shown in <a href="#calibre_link-1626">Figures 3-32(b)</a> and <a href="#calibre_link-1626">3-32(c)</a>.</p>
<p class="calibre3"><a id="calibre_link-598"></a></p>
<h3 class="calibre6">3.14 Interpreting the DFT Using the Discrete-Time Fourier Transform</h3>
<p class="calibre3">Now that we’ve learned about the DFT, it’s appropriate to ensure we understand what the DFT actually represents and avoid a common misconception regarding its behavior. In the literature of DSP you’ll encounter the topics of <em class="calibre7">continuous Fourier transform</em>, <em class="calibre7">Fourier series</em>, <em class="calibre7">discrete-time Fourier transform</em>, <em class="calibre7">discrete Fourier transform</em>, and <em class="calibre7">periodic spectra</em>. It takes effort to keep all those notions clear in your mind, especially when you read or hear someone say something like “the DFT assumes its input sequence is periodic in time.” (You wonder how this can be true because it’s easy to take the DFT of an aperiodic time sequence.) That remark is misleading at best because DFTs don’t make assumptions. What follows is how I keep the time and frequency periodicity nature of discrete sequences straight in my mind.</p>
<p class="calibre3">Consider an infinite-length continuous-time signal containing a single finite-width pulse shown in <a href="#calibre_link-1636">Figure 3-35(a)</a>. The magnitude of its continuous Fourier transform (CFT) is the continuous frequency-domain function <em class="calibre7">X</em><sub class="calibre12">1</sub>(ω). If the single pulse can be described algebraically (with an equation), then the CFT function <em class="calibre7">X</em><sub class="calibre12">1</sub>(ω), also an equation, can be found using Fourier transform <a id="calibre_link-2606"></a>calculus. (Chances are very good that you actually did this as a homework, or test, problem sometime in the past.) The continuous frequency variable ω is radians per second. If the CFT was performed on the infinite-length signal of periodic pulses in <a href="#calibre_link-1636">Figure 3-35(b)</a>, the result would be the line spectra known as the <em class="calibre7">Fourier series X</em><sub class="calibre12">2</sub>(ω). Those spectral lines (impulses) are infinitely narrow and <em class="calibre7">X</em><sub class="calibre12">2</sub>(ω) is well defined in between those lines, because <em class="calibre7">X</em><sub class="calibre12">2</sub>(ω) is continuous. (A well-known example of this concept is the CFT of a continuous squarewave, which yields a Fourier series whose frequencies are all the odd multiples of the squarewave’s fundamental frequency.)</p>
<p class="caption"><a id="calibre_link-1636"></a><strong class="calibre9">Figure 3-35</strong> Time-domain signals and sequences, and the magnitudes of their transforms in the frequency domain.</p>
<p class="image"><img src="images/000532.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1636">Figure 3-35(b)</a> is an example of a continuous periodic function (in time) having a spectrum that’s a series of individual spectral components. You’re welcome to think of the <em class="calibre7">X</em><sub class="calibre12">2</sub>(ω) Fourier series as a sampled version of the continuous spectrum in <a href="#calibre_link-1636">Figure 3-35(a)</a>. The time-frequency relationship between <em class="calibre7">x</em><sub class="calibre12">2</sub>(<em class="calibre7">t</em>) and <em class="calibre7">X</em><sub class="calibre12">2</sub>(ω) shows how a periodic function in one domain (time) leads to a function in the other domain (frequency) that is a series of discrete samples.</p>
<p class="calibre3">Next, consider the infinite-length discrete time sequence <em class="calibre7">x</em>(<em class="calibre7">n</em>), containing several nonzero samples, in <a href="#calibre_link-1636">Figure 3-35(c)</a>. We can perform a CFT of <em class="calibre7">x</em>(<em class="calibre7">n</em>) <a id="calibre_link-2607"></a>describing its spectrum as a continuous frequency-domain function <em class="calibre7">X</em><sub class="calibre12">3</sub>(ω). This continuous spectrum is called a discrete-time Fourier transform (DTFT) defined by (see page 48 of reference <a href="#calibre_link-1637">[15]</a>)</p>
<p class="caption"><a id="calibre_link-2608"></a>(3-52)</p>
<p class="image"><img src="images/000787.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where the ω frequency variable is measured in radians/sample.</p>
<p class="calibre3">To illustrate the notion of the DTFT, let’s say we had a time sequence defined as <em class="calibre7">x</em><sub class="calibre12">o</sub>(<em class="calibre7">n</em>) = (0.75)<em class="calibre7"><sup class="calibre10">n</sup></em> for <em class="calibre7">n</em> ≥ 0. Its DTFT would be</p>
<p class="caption"><a id="calibre_link-1638"></a>(3-53)</p>
<p class="image"><img src="images/001641.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1638">Equation (3-53)</a> is a geometric series (see <a href="#calibre_link-294">Appendix B</a>) and can be evaluated as</p>
<p class="caption"><a id="calibre_link-2609"></a>(3-53′)</p>
<p class="image"><img src="images/001076.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><em class="calibre7">X</em><sub class="calibre12">o</sub>(ω) is continuous and periodic with a period of 2π, whose magnitude is shown in <a href="#calibre_link-1639">Figure 3-36</a>. This is an example of a sampled (or discrete) time-domain sequence having a periodic spectrum. For the curious reader, we can verify the 2π periodicity of the DTFT using an integer <em class="calibre7">k</em> in the following</p>
<p class="caption"><a id="calibre_link-2610"></a>(3-54)</p>
<p class="image"><img src="images/001524.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1639"></a><strong class="calibre9">Figure 3-36</strong> DTFT magnitude |<em class="calibre7">X</em><sub class="calibre12">o</sub>(ω)|.</p>
<p class="image"><img src="images/001392.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">because <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>2π<em class="calibre7">kn</em></sup> = 1 for integer values of <em class="calibre7">k</em>.</p>
<p class="calibre3"><em class="calibre7">X</em><sub class="calibre12">3</sub>(ω) in <a href="#calibre_link-1636">Figure 3-35(c)</a> also has a 2π periodicity represented by ω<em class="calibre7"><sub class="calibre12">s</sub></em> = 2π<em class="calibre7">f<sub class="calibre12">s</sub></em>, where the frequency <em class="calibre7">f<sub class="calibre12">s</sub></em> is the reciprocal of the time period between the <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples. The continuous periodic spectral function <em class="calibre7">X</em><sub class="calibre12">3</sub>(ω) is what we’d like to be able to compute in our world of DSP, but we can’t. We’re using computers and, sadly, we can’t perform continuous signal analysis with the discrete (binary number) nature of computers. All of our processing comprises discrete numbers stored in our computer’s memory and, as such, all of our time-domain signals and all of our frequency-domain spectra are discrete sampled sequences. Consequently the CFT, or inverse CFT, of the sequences with which we work will all be periodic.</p>
<p class="calibre3">The transforms indicated in <a href="#calibre_link-1636">Figures 3-35(a)</a> through <a href="#calibre_link-1636">3-35(c)</a> are pencil-and-paper mathematics of calculus. In a computer, using only finite-length discrete <a id="calibre_link-2611"></a>sequences, we can only approximate the CFT (the DTFT) of the infinite-length <em class="calibre7">x</em>(<em class="calibre7">n</em>) time sequence in <a href="#calibre_link-1636">Figure 3-35(c)</a>. That approximation is called the <em class="calibre7">discrete Fourier transform</em> (DFT), and it’s the only DSP Fourier transform tool we have available to us. Taking the DFT of <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>), where <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) is a finite-length portion of <em class="calibre7">x</em>(<em class="calibre7">n</em>), we obtain the discrete periodic <em class="calibre7">X</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>) spectral samples in <a href="#calibre_link-1636">Figure 3-35(d)</a>.</p>
<p class="calibre3">Notice how <em class="calibre7">X</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>) is a sampled version of the continuous periodic <em class="calibre7">X</em><sub class="calibre12">3</sub>(ω). That sampling is represented by</p>
<p class="caption"><a id="calibre_link-1640"></a>(3-55)</p>
<p class="image"><img src="images/000557.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We interpret <a href="#calibre_link-1640">Eq. (3-55)</a> as follows: <em class="calibre7">X</em><sub class="calibre12">3</sub>(ω) is the continuous DTFT of the <em class="calibre7">N</em>−sample time sequence <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>). We can evaluate <em class="calibre7">X</em><sub class="calibre12">3</sub>(ω) at the <em class="calibre7">N</em> frequencies of ω = 2π<em class="calibre7">m</em>/<em class="calibre7">N</em>, where integer <em class="calibre7">m</em> is 0 ≤ <em class="calibre7">m</em> ≤ <em class="calibre7">N</em>−1, covering a full period of <em class="calibre7">X</em><sub class="calibre12">3</sub>(ω). The result of those <em class="calibre7">N</em> evaluated values is a sequence equal to the <em class="calibre7">X</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>) DFT of <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>).</p>
<p class="calibre3">However, and here’s the crucial point, <em class="calibre7">X</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>) is <em class="calibre7">also</em> exactly equal to the CFT of the periodic time sequence <em class="calibre7">x</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>) in <a href="#calibre_link-1636">Figure 3-35(d)</a>. So when people say “the DFT assumes its input sequence is periodic in time,” what they really mean is <em class="calibre7">the DFT is equal to the continuous Fourier transform (the DTFT) of a periodic time-domain discrete sequence</em>. After all this rigmarole, the end of the story is this: if a function is periodic, its forward/inverse DTFT will be discrete; if a function is discrete, its forward/inverse DTFT will be periodic.</p>
<p class="calibre3">In concluding this discussion of the DTFT, we mention that in the literature of DSP the reader may encounter the following expression</p>
<p class="caption"><a id="calibre_link-1641"></a>(3-56)</p>
<p class="image"><img src="images/001415.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">as an alternate definition of the DTFT. <a href="#calibre_link-1641">Eq. (3-56)</a> can be used to evaluate a full period of the DTFT of an <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence by letting the frequency variable <em class="calibre7">F</em>, whose dimensions are cycles/sample, be in either of the ranges of 0 ≤ <em class="calibre7">F</em> ≤ 1 or −0.5 ≤ <em class="calibre7">F</em> ≤ 0.5.</p>
<p class="calibre3"><a id="calibre_link-599"></a></p>
<h3 class="calibre6"><a id="calibre_link-2612" class="calibre5"></a>References</h3>
<p class="chapterendnote"><a id="calibre_link-1516"></a>[1] Bracewell, R. “The Fourier Transform,” <em class="calibre7">Scientific American</em>, June 1989.</p>
<p class="chapterendnote"><a id="calibre_link-1517"></a>[2] Struik, D. <em class="calibre7">A Concise History of Mathematics</em>, Dover Publications, New York, 1967, p. 142.</p>
<p class="chapterendnote"><a id="calibre_link-2613"></a>[3] Williams, C. S. <em class="calibre7">Designing Digital Filters</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1986, <a href="#calibre_link-428">Section 8.6</a>, p. 122.</p>
<p class="chapterendnote"><a id="calibre_link-2614"></a>[4] Press, W., et al. <em class="calibre7">Numerical Recipes: The Art of Scientific Computing</em>, Cambridge University Press, New York, 1989, p. 426.</p>
<p class="chapterendnote"><a id="calibre_link-1569"></a>[5] Geckinli, N. C., and Yavuz, D. “Some Novel Windows and a Concise Tutorial Comparison of Window Families,” <em class="calibre7">IEEE Trans. on Acoust. Speech, and Signal Proc.,</em> Vol. ASSP-26, No. 6, December 1978. (By the way, on page 505 of this paper, the phrase “such that W(f) ≥ 0 ∀ f” indicates that W(f) is never negative. The symbol ∀ means “for all.”)</p>
<p class="chapterendnote"><a id="calibre_link-1570"></a>[6] O’Donnell, J. “Looking Through the Right Window Improves Spectral Analysis,” <em class="calibre7">EDN</em>, November 1984.</p>
<p class="chapterendnote"><a id="calibre_link-1571"></a>[7] Kaiser, J. F. “Digital Filters,” in <em class="calibre7">System Analysis by Digital Computer</em>, ed. by F. F. Kuo and J. F. Kaiser, John Wiley and Sons, New York, 1966, pp. 218&ndash;277.</p>
<p class="chapterendnote"><a id="calibre_link-1572"></a>[8] Rabiner, L. R., and Gold, B. <em class="calibre7">The Theory and Application of Digital Signal Processing</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1975, p. 88.</p>
<p class="chapterendnote"><a id="calibre_link-1573"></a>[9] Schoenwald, J. “The Surface Acoustic Wave Filter: Window Functions,” <em class="calibre7">RF Design</em>, March 1986.</p>
<p class="chapterendnote"><a id="calibre_link-1574"></a>[10] Harris, F. “On the Use of Windows for Harmonic Analysis with the Discrete Fourier Transform,” <em class="calibre7">Proceedings of the IEEE,</em> Vol. 66, No. 1, January 1978.</p>
<p class="chapterendnote"><a id="calibre_link-1575"></a>[11] Nuttall, A. H. “Some Windows with Very Good Sidelobe Behavior,” <em class="calibre7">IEEE Trans. on Acoust. Speech, and Signal Proc.,</em> Vol. ASSP-29, No. 1, February 1981.</p>
<p class="chapterendnote"><a id="calibre_link-1579"></a>[12] Yanagimoto, Y. “Receiver Design for a Combined RF Network and Spectrum Analyzer,” <em class="calibre7">Hewlett-Packard Journal</em>, October 1993.</p>
<p class="chapterendnote"><a id="calibre_link-1605"></a>[13] Gullemin, E. A. <em class="calibre7">The Mathematics of Circuit Analysis</em>, John Wiley and Sons, New York, 1949, p. 511.</p>
<p class="chapterendnote"><a id="calibre_link-1606"></a>[14] Lanczos, C. <em class="calibre7">Discourse on Fourier Series</em>, Hafner Publishing Co., New York, 1966, <a href="#calibre_link-286">Chapter 1</a>, pp. 7&ndash;47.</p>
<p class="chapterendnote"><a id="calibre_link-1637"></a>[15] Oppenheim, A., et al. <em class="calibre7">Discrete-Time Signal Processing</em>, 2nd ed., Prentice Hall, Upper Saddle River, New Jersey, 1999, pp. 48&ndash;51.</p>
<p class="calibre3"><a id="calibre_link-600"></a></p>
<h3 class="calibre6"><a id="calibre_link-2615" class="calibre5"></a>Chapter 3 Problems</h3>
<p class="indenthanging"><strong class="calibre9">3.1</strong> Let’s assume that we have performed a 20-point DFT on a sequence of real-valued time-domain samples, and we want to send our <em class="calibre7">X</em>(<em class="calibre7">m</em>) DFT results to a colleague using e-mail. What is the absolute minimum number of (complex) frequency-domain sample values we will need to type in our e-mail so that our colleague has complete information regarding our DFT results?</p>
<p class="indenthanging"><strong class="calibre9">3.2</strong> Assume a systems engineer directs you to start designing a system that performs spectrum analysis using DFTs. The systems engineer states that the spectrum analysis system’s input data sample rate, <em class="calibre7">f<sub class="calibre12">s</sub></em>, is 1000 Hz and specifies that the DFT’s frequency-domain sample spacing must be exactly 45 Hz.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the number of necessary input time samples, <em class="calibre7">N</em>, for a single DFT operation?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What do you tell the systems engineer regarding the spectrum analysis system’s specifications?</p>
<p class="indenthanging"><strong class="calibre9">3.3</strong> We want to compute an <em class="calibre7">N</em>-point DFT of a one-second-duration compact disc (CD) audio signal <em class="calibre7">x</em>(<em class="calibre7">n</em>), whose sample rate is <em class="calibre7">f<sub class="calibre12">s</sub></em> = 44.1 kHz, with a DFT sample spacing of 1 Hz.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the number of necessary <em class="calibre7">x</em>(<em class="calibre7">n</em>) time samples, <em class="calibre7">N</em>?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What is the time duration of the <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence measured in seconds?</p>
<p class="indentpara"><strong class="calibre9">Hint:</strong> This Part (b) of the problem is trickier than it first appears. Think carefully.</p>
<p class="indenthanging"><strong class="calibre9">3.4</strong> Assume we have a discrete <em class="calibre7">x</em>(<em class="calibre7">n</em>) time-domain sequence of samples obtained from <em class="calibre7">lowpass sampling</em> of an analog signal, <em class="calibre7">x</em>(<em class="calibre7">t</em>). If <em class="calibre7">x</em>(<em class="calibre7">n</em>) contains <em class="calibre7">N</em> = 500 samples, and it was obtained at a sample rate of <em class="calibre7">f<sub class="calibre12">s</sub></em> = 3000 Hz:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the frequency spacing of <em class="calibre7">x</em>(<em class="calibre7">n</em>)’s DFT samples, <em class="calibre7">X</em>(<em class="calibre7">m</em>), measured in Hz?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What is the highest-frequency spectral component that can be present in the analog <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal where no aliasing errors occur in <em class="calibre7">x</em>(<em class="calibre7">n</em>)?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> If you drew the full <em class="calibre7">X</em>(<em class="calibre7">m</em>) spectrum and several of its spectral replications, what is the spacing between the spectral replications measured in Hz?</p>
<p class="indenthanging"><strong class="calibre9">3.5</strong> What are the magnitudes of the 8-point DFT samples of</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> the <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) = 9, 9, 9, 9, 9, 9, 9, 9 sequence (explain how you arrived at your solution)?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> the <em class="calibre7">x</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>) = 1, 0, 0, 0, 0, 0, 0, 0 sequence?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> the <em class="calibre7">x</em><sub class="calibre12">3</sub>(<em class="calibre7">n</em>) = 0, 1, 0, 0, 0, 0, 0, 0 sequence?</p>
<p class="indentpara"><a id="calibre_link-2616"></a>Because the <em class="calibre7">x</em><sub class="calibre12">3</sub>(<em class="calibre7">n</em>) sequence in Part (c) is merely a time-shifted version of the <em class="calibre7">x</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>) sequence in Part (b), comment on the relationship of the |<em class="calibre7">X</em><sub class="calibre12">2</sub>(<em class="calibre7">m</em>)| and |<em class="calibre7">X</em><sub class="calibre12">3</sub>(<em class="calibre7">m</em>)| DFT samples.</p>
<p class="indenthanging"><strong class="calibre9">3.6</strong> Consider sampling exactly three cycles of a continuous <em class="calibre7">x</em>(<em class="calibre7">t</em>) sinusoid resulting in an 8-point <em class="calibre7">x</em>(<em class="calibre7">n</em>) time sequence whose 8-point DFT is the <em class="calibre7">X</em>(<em class="calibre7">m</em>) shown in <a href="#calibre_link-1642">Figure P3-6</a>. If the sample rate used to obtain <em class="calibre7">x</em>(<em class="calibre7">n</em>) was 4000 Hz, write the time-domain equation for the discrete <em class="calibre7">x</em>(<em class="calibre7">n</em>) sinusoid in trigonometric form. Show how you arrived at your answer.</p>
<p class="caption"><a id="calibre_link-1642"></a><strong class="calibre9">Figure P3-6</strong></p>
<p class="image"><img src="images/001637.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">3.7</strong> In the text’s <a href="#calibre_link-457">Section 3.1</a> we discussed the computations necessary to compute the <em class="calibre7">X</em>(0) sample of an <em class="calibre7">N</em>-point DFT. That <em class="calibre7">X</em>(0) output sample represents the zero Hz (DC) spectral component of an <em class="calibre7">x</em>(<em class="calibre7">n</em>) input sequence. Because it is the DC component, <em class="calibre7">X</em>(0) is real-only and we’re free to say that an <em class="calibre7">X</em>(0) sample <em class="calibre7">always</em> has zero phase. With that said, here are two interesting DFT problems:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Given that an <em class="calibre7">N</em>-point DFT’s input sequence <em class="calibre7">x</em>(<em class="calibre7">n</em>) is real-only, and <em class="calibre7">N</em> is an even number, is there any value for <em class="calibre7">m</em> (other than <em class="calibre7">m</em> = 0) for which an <em class="calibre7">X</em>(<em class="calibre7">m</em>) DFT output sample is always real-only?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Given that <em class="calibre7">N</em> is an odd number, is there any value for <em class="calibre7">m</em> (other than <em class="calibre7">m</em> = 0) where an <em class="calibre7">X</em>(<em class="calibre7">m</em>) DFT output sample is always real-only?</p>
<p class="indenthanging"><strong class="calibre9">3.8</strong> Using the following rectangular form for the DFT equation:</p>
<p class="image"><img src="images/001782.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Prove that the <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 spectral sample is <em class="calibre7">X</em>(<em class="calibre7">N</em>/2) = <em class="calibre7">N</em> · sin(θ) when the <em class="calibre7">x</em>(<em class="calibre7">n</em>) input is a sinusoidal sequence defined by</p>
<p class="center"><em class="calibre7">x</em>(<em class="calibre7">n</em>) = sin[2π(<em class="calibre7">f<sub class="calibre12">s</sub></em>/2)<em class="calibre7">nt<sub class="calibre12">s</sub></em> + θ].</p>
<p class="indentpara1"><a id="calibre_link-2617"></a><em class="calibre7">N</em> is an even number, frequency <em class="calibre7">f<sub class="calibre12">s</sub></em> is the <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence’s sample rate in Hz, time index <em class="calibre7">n</em> = 0, 1, 2, ..., <em class="calibre7">N</em>−1, and θ is an initial phase angle measured in radians.</p>
<p class="indentpara1"><strong class="calibre9">Hint:</strong> Recall the trigonometric identity sin(α+β) = sin(α)cos(β) + cos(α)sin(β).</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What is <em class="calibre7">X</em>(<em class="calibre7">N</em>/2) when <em class="calibre7">x</em>(<em class="calibre7">n</em>) = sin[2π(<em class="calibre7">f<sub class="calibre12">s</sub></em>/2)<em class="calibre7">nt<sub class="calibre12">s</sub></em>]?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> What is <em class="calibre7">X</em>(<em class="calibre7">N</em>/2) when <em class="calibre7">x</em>(<em class="calibre7">n</em>) = cos[2π(<em class="calibre7">f<sub class="calibre12">s</sub></em>/2)<em class="calibre7">nt<sub class="calibre12">s</sub></em>]?</p>
<p class="indenthanging"><strong class="calibre9">3.9</strong> To gain some practice in using the algebra of discrete signals and the geometric series identities in <a href="#calibre_link-294">Appendix B</a>, and to reinforce our understanding of the output magnitude properties of a DFT when its input is an exact integer number of sinusoidal cycles:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Prove that when a DFT’s input is a complex sinusoid of magnitude <em class="calibre7">A</em><sub class="calibre12">o</sub> (i.e., <em class="calibre7">x</em>(<em class="calibre7">n</em>) = <em class="calibre7">A</em><sub class="calibre12">o</sub><em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">2π<em class="calibre7">fnt<sub class="calibre15">s</sub></em></sup>) with exactly three cycles over <em class="calibre7">N</em> samples, the output magnitude of the DFT’s <em class="calibre7">m</em> = 3 bin will be |<em class="calibre7">X</em>(3)| = <em class="calibre7">A</em><sub class="calibre12">o</sub><em class="calibre7">N</em>.</p>
<p class="indentpara1"><strong class="calibre9">Hint:</strong> The first step is to redefine <em class="calibre7">x</em>(<em class="calibre7">n</em>)’s <em class="calibre7">f</em> and <em class="calibre7">t<sub class="calibre12">s</sub></em> variables in terms of a sample rate <em class="calibre7">f<sub class="calibre12">s</sub></em> and <em class="calibre7">N</em> so that <em class="calibre7">x</em>(<em class="calibre7">n</em>) has exactly three cycles over <em class="calibre7">N</em> samples. The redefined <em class="calibre7">x</em>(<em class="calibre7">n</em>) is then applied to the standard DFT equation.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Prove that when a DFT’s input is a real-only sinewave of peak amplitude <em class="calibre7">A</em><sub class="calibre12">o</sub> (i.e., <em class="calibre7">x</em>(<em class="calibre7">n</em>) = <em class="calibre7">A</em><sub class="calibre12">o</sub>sin(2π<em class="calibre7">fnt<sub class="calibre12">s</sub></em>)) with exactly three cycles over <em class="calibre7">N</em> samples, the output magnitude of the DFT’s <em class="calibre7">m</em> = 3 bin will be |<em class="calibre7">X</em>(3)| = <em class="calibre7">A</em><sub class="calibre12">o</sub><em class="calibre7">N</em>/2.</p>
<p class="indentpara1"><strong class="calibre9">Hint:</strong> Once you redefine <em class="calibre7">x</em>(<em class="calibre7">n</em>)’s <em class="calibre7">f</em> and <em class="calibre7">t<sub class="calibre12">s</sub></em> variables in terms of a sample rate <em class="calibre7">f<sub class="calibre12">s</sub></em> and <em class="calibre7">N</em> so that <em class="calibre7">x</em>(<em class="calibre7">n</em>) has exactly three cycles over <em class="calibre7">N</em> samples, you must convert that real sinewave to complex exponential form so that you can evaluate its DFT for <em class="calibre7">m</em> = 3.</p>
<p class="indentpara">The purpose of this problem is to remind us that DFT output magnitudes are proportional to the size, <em class="calibre7">N</em>, of the DFT. That fact is important in a great many DSP analysis activities and applications.</p>
<p class="indenthanging"><strong class="calibre9">3.10</strong> Consider performing the 5-point DFT on the following <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) time-domain samples</p>
<p class="center"><em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) = [1, 2.2, −4, 17, 21],</p>
<p class="indentpara">and the DFT’s first sample is <em class="calibre7">X</em><sub class="calibre12">1</sub>(0) = 37.2. Next, consider performing the 5-point DFT on the following <em class="calibre7">x</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>) time samples</p>
<p class="center"><em class="calibre7">x</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>) = [1, 2.2, −4, 17, <em class="calibre7">Q</em>],</p>
<p class="indentpara">and that DFT’s first sample is <em class="calibre7">X</em><sub class="calibre12">2</sub>(0) = 57.2. What is the value of <em class="calibre7">Q</em> in the <em class="calibre7">x</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>) time sequence? Justify your answer.</p>
<p class="indenthanging"><a id="calibre_link-2618"></a><strong class="calibre9">3.11</strong> Derive the equation describing <em class="calibre7">X</em>(<em class="calibre7">m</em>), the <em class="calibre7">N</em>-point DFT of the following <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence:</p>
<p class="center"><em class="calibre7">x</em>(<em class="calibre7">n</em>) = <em class="calibre7">a<sup class="calibre10">n</sup></em>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for 0 ≤ <em class="calibre7">n</em> ≤ <em class="calibre7">N</em>−1.</p>
<p class="indentpara"><strong class="calibre9">Hint:</strong> Recall one of the laws of exponents, <em class="calibre7">p<sup class="calibre10">b</sup>q<sup class="calibre10">bc</sup></em> = (<em class="calibre7">pq<sup class="calibre10">c</sup></em>)<em class="calibre7"><sup class="calibre10">b</sup></em>, and the geometric series identities in <a href="#calibre_link-294">Appendix B</a>.</p>
<p class="indenthanging"><strong class="calibre9">3.12</strong> Consider an <em class="calibre7">N</em>-sample <em class="calibre7">x</em>(<em class="calibre7">n</em>) time sequence whose DFT is represented by <em class="calibre7">X</em>(<em class="calibre7">m</em>), where 0 ≤ <em class="calibre7">m</em> ≤ <em class="calibre7">N</em>−1. Given this situation, an Internet website once stated, “The sum of the <em class="calibre7">X</em>(<em class="calibre7">m</em>) samples is equal to <em class="calibre7">N</em> times the first <em class="calibre7">x</em>(<em class="calibre7">n</em>) sample.” Being suspicious of anything we read on the Internet, show whether or not that statement is true.</p>
<p class="indentpara"><strong class="calibre9">Hint:</strong> Use the inverse DFT process to determine the appropriate <em class="calibre7">x</em>(<em class="calibre7">n</em>) time sample of interest in terms of <em class="calibre7">X</em>(<em class="calibre7">m</em>).</p>
<p class="indenthanging"><strong class="calibre9">3.13</strong> Here is a problem whose solution may be useful to you in the future. On the Internet you will find information suggesting that an inverse DFT can be computed using a forward DFT software routine in the process shown in <a href="#calibre_link-1643">Figure P3-13</a>.</p>
<p class="caption"><a id="calibre_link-1643"></a><strong class="calibre9">Figure P3-13</strong></p>
<p class="image"><img src="images/001749.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Using the forward and inverse DFT equations, and the material in <a href="#calibre_link-293">Appendix A</a>, show why the process in <a href="#calibre_link-1643">Figure P3-13</a> computes correct inverse DFTs.</p>
<p class="indentpara1"><strong class="calibre9">Hint:</strong> Begin your solution by writing the inverse DFT equation and conjugating both sides of that equation.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Comment on how the process in <a href="#calibre_link-1643">Figure P3-13</a> changes if the original frequency-domain <em class="calibre7">X</em>(<em class="calibre7">m</em>) sequence is conjugate symmetric.</p>
<p class="indenthanging"><a id="calibre_link-2619"></a><strong class="calibre9">3.14</strong> One useful way to test the performance of commercial analog-to-digital (A/D) converters is to digitize an <em class="calibre7">f</em><sub class="calibre12">o</sub> Hz analog sinewave, apply the <em class="calibre7">N</em>-sample <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence to a DFT, and examine the DFT’s <em class="calibre7">X</em>(<em class="calibre7">m</em>) results. The process is depicted in <a href="#calibre_link-1644">Figure P3-14</a>. An ideal (A/D) converter will produce <em class="calibre7">X</em>(<em class="calibre7">m</em>) results showing spectral energy at <em class="calibre7">f</em><sub class="calibre12">o</sub> Hz and no spectral energy at any other frequency. As such, nonzero spectral energy in <em class="calibre7">X</em>(<em class="calibre7">m</em>) at frequencies other than <em class="calibre7">f</em><sub class="calibre12">o</sub> Hz indicates real-world A/D converter performance. However, the DFT’s inherent property of leakage “smears” spectral energy over multiple <em class="calibre7">X</em>(<em class="calibre7">m</em>) samples, as was shown in the text’s <a href="#calibre_link-1553">Figure 3-8(b)</a>, which degrades the effectiveness of this A/D converter test method. What can we do to minimize the DFT’s inherent spectral leakage as much as possible for this type of converter testing?</p>
<p class="caption"><a id="calibre_link-1644"></a><strong class="calibre9">Figure P3-14</strong></p>
<p class="image"><img src="images/001280.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">3.15</strong> Here is a real-world spectrum analysis problem. <a href="#calibre_link-1645">Figure P3-15(a)</a> shows 902 samples of an <em class="calibre7">x</em>(<em class="calibre7">n</em>) time sequence. (For clarity, we do not show the <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples as individual dots.) That sequence is the sound of the “A3” note (“A” below middle “C”) from an acoustic guitar, sampled at <em class="calibre7">f<sub class="calibre12">s</sub></em> = 22.255 kHz. <a href="#calibre_link-1645">Figure P3-15(b)</a> shows the <em class="calibre7">X</em>(<em class="calibre7">m</em>) spectral magnitude samples, the DFT of <em class="calibre7">x</em>(<em class="calibre7">n</em>), on a linear scale for the frequency index range of 0 ≤ <em class="calibre7">m</em> ≤ 59.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Based on the <em class="calibre7">X</em>(<em class="calibre7">m</em>) samples, what is the <em class="calibre7">fundamental</em> frequency, in Hz, of the guitar’s “A3” note?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> When we plot the DFT magnitude samples on a logarithmic scale, as in <a href="#calibre_link-1645">Figure P3-15(c)</a>, we see spectral <em class="calibre7">harmonics</em> and learn that the guitar note is rich in spectral content. (The harmonics are integer multiples of the fundamental frequency.) That’s why guitars have their pleasing sound, depending on the guitarist’s skill, of course. What is the frequency of the highest nonzero spectral component of the guitar’s “A3” note?</p>
<p class="caption"><a id="calibre_link-2620"></a><a id="calibre_link-1645"></a><strong class="calibre9">Figure P3-15</strong></p>
<p class="image"><img src="images/000553.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">3.16</strong> <a href="#calibre_link-1646">Figure P3-16(a)</a> shows a 16-point Hanning window sequence, <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>), defined by</p>
<p class="image"><img src="images/000805.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">The magnitude of its DFT samples, |<em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>)|, is shown in <a href="#calibre_link-1646">Figure P3-16(b)</a>. (For simplicity, we show only the positive-frequency range of the |<em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>)| samples.) Notice that only the |<em class="calibre7">H</em><sub class="calibre12">1</sub>(0)| and the |<em class="calibre7">H</em><sub class="calibre12">1</sub>(1)| frequency-domain samples are nonzero.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Sequence <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) comprises two signals. Looking carefully at <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>), describe what those two signals are and justify why |<em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>)| looks the way it does.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Given your understanding of the relationship between <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) and |<em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>)|, look at <em class="calibre7">h</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>), in <a href="#calibre_link-1646">Figure P3-16(c)</a>, which is two repetitions of the original <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) sequence. Draw a rough sketch of the spectral magnitude sequence |<em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">m</em>)| over its positive-frequency range.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Given that the <em class="calibre7">h</em><sub class="calibre12">3</sub>(<em class="calibre7">n</em>) in <a href="#calibre_link-1646">Figure P3-16(d)</a> is three repetitions of the original <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) sequence, draw the spectral magnitude sequence |<em class="calibre7">H</em><sub class="calibre12">3</sub>(<em class="calibre7">m</em>)| over its positive-frequency range.</p>
<p class="caption"><a id="calibre_link-2621"></a><a id="calibre_link-1646"></a><strong class="calibre9">Figure P3-16</strong></p>
<p class="image"><img src="images/001412.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(d)</strong> Considering the <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>), <em class="calibre7">h</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>), and <em class="calibre7">h</em><sub class="calibre12">3</sub>(<em class="calibre7">n</em>) sequences, and their |<em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>)|, |<em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">m</em>)|, and |<em class="calibre7">H</em><sub class="calibre12">3</sub>(<em class="calibre7">m</em>)| spectral magnitude samples, complete the following <em class="calibre7">important</em> statement: “<em class="calibre7">K</em> repetitions of an <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) sequence result in an extended-length time sequence whose spectral magnitudes have <em class="calibre7">K</em>−1 ...”</p>
<p class="indenthanging"><strong class="calibre9">3.17</strong> In the literature of DSP, you may see an <em class="calibre7">alternate</em> expression for an <em class="calibre7">N</em>-point Hanning window defined by</p>
<p class="image"><img src="images/001664.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">Prove that the above alternate expression for a Hanning window is equivalent to the <a href="#calibre_link-594">Section 3.9</a> text’s definition of a Hanning window.</p>
<p class="indenthanging"><strong class="calibre9">3.18</strong> Considering the DFT of an <em class="calibre7">N</em>-point <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence, what is the spectral effect of zero-padding the <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence to a length of <em class="calibre7">Q</em> samples (with <em class="calibre7">Q</em> being an integer power of two, and <em class="calibre7">Q</em> &gt; <em class="calibre7">N</em>) and performing a <em class="calibre7">Q</em>-point DFT on the zero-padded sequence?</p>
<p class="indenthanging"><strong class="calibre9">3.19</strong> Assume that an <em class="calibre7">N</em>-point DFT, performed on an <em class="calibre7">N</em>-sample <em class="calibre7">x</em>(<em class="calibre7">n</em>) time-domain sequence, results in a DFT frequency-domain sample spacing of 100 Hz. What would be the DFT frequency-domain sample spacing in Hz if the <em class="calibre7">N</em>-sample <em class="calibre7">x</em>(<em class="calibre7">n</em>) time sequence was padded with 4<em class="calibre7">N</em> zero-valued samples and we performed a DFT on that extended-time sequence?</p>
<p class="indenthanging"><strong class="calibre9">3.20</strong> There is a program, in the U.S. and other countries, called “Search for Extraterrestrial Intelligence” (SETI). These folk point radio antennas around in <a id="calibre_link-2622"></a>the night sky searching for “nonrandom radio” signals, hoping to find evidence of “little green men.” They search for radio-frequency (RF) signal energy that significantly exceeds the background RF noise energy in the sky. Their primary method for detecting low-level RF energy is to tune a narrowband receiver to some RF frequency and collect millions of time-domain samples, and then perform million-point DFTs in the hope of finding spectral magnitude components that significantly exceed the background spectral noise. High-level spectral components would indicate the existence of intelligent life that’s broadcasting radio signals of some sort.</p>
<p class="indentpara">Here’s the question: If a SETI researcher collects one million time samples and performs a one-million-point DFT, roughly what DFT processing gain (in dB) improvement can that person expect to achieve in <em class="calibre7">pulling</em> a weak spectral component up above the background galactic spectral noise in comparison to using a 100-point DFT?</p>
<p class="indenthanging"><strong class="calibre9">3.21</strong> This problem tests your understanding of the DFT’s frequency-domain axis. Consider sampling exactly two cycles of an analog <em class="calibre7">x</em>(<em class="calibre7">t</em>) cosine wave resulting in the 8-point <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) time sequence in <a href="#calibre_link-1647">Figure P3-21(a)</a>. The real part of the DFT of <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) is the sequence shown in <a href="#calibre_link-1647">Figure P3-21(b)</a>. Because <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) is exactly two cycles of a cosine sequence, the imaginary parts of <em class="calibre7">X</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>) are all zero-valued <a id="calibre_link-2623"></a>samples, making |<em class="calibre7">X</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>)| equal to the real part of <em class="calibre7">X</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>). (Note that no leakage is apparent in |<em class="calibre7">X</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>)|.) Think, now, of a new frequency-domain sequence <em class="calibre7">X</em><sub class="calibre12">2</sub>(<em class="calibre7">m</em>) that is equal to <em class="calibre7">X</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>) with eight zero-valued samples, the white squares in <a href="#calibre_link-1647">Figures P3-21(c)</a> and <a href="#calibre_link-1647">P3-21(d)</a>, inserted in the center of the real and imaginary parts of <em class="calibre7">X</em><sub class="calibre12">1</sub>(<em class="calibre7">m</em>).</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Draw the <em class="calibre7">x</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>) time sequence that is the inverse DFT of <em class="calibre7">X</em><sub class="calibre12">2</sub>(<em class="calibre7">m</em>).</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Comment on how the <em class="calibre7">x</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>) time sequence is related to the original analog <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal and the <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) sequence.</p>
<p class="caption"><a id="calibre_link-1647"></a><strong class="calibre9">Figure P3-21</strong></p>
<p class="image"><img src="images/000450.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">3.22</strong> There is a useful spectrum analysis process, discussed in <a href="#calibre_link-160">Chapter 13</a>, that uses the results of an <em class="calibre7">N</em>-point DFT, <em class="calibre7">X</em>(<em class="calibre7">m</em>), and requires us to compute</p>
<p class="center"><em class="calibre7">S</em> = <em class="calibre7">P</em> · <em class="calibre7">X</em>(0) − <em class="calibre7">Q</em> · <em class="calibre7">X</em>(<em class="calibre7">N</em>−1) − <em class="calibre7">Q</em> · <em class="calibre7">X</em>(1)</p>
<p class="indentpara">where <em class="calibre7">P</em> and <em class="calibre7">Q</em> are scalar constants. Value <em class="calibre7">S</em> is the sum of three complex numbers. If we represent the three DFT samples in rectangular form, we can write</p>
<p class="center"><em class="calibre7">S</em> = <em class="calibre7">P</em> · [<em class="calibre7">a + jb</em>] − <em class="calibre7">Q</em> · [<em class="calibre7">c + jd</em>] − <em class="calibre7">Q</em> · [<em class="calibre7">e + jg</em>].</p>
<p class="indentpara">In the general case, the above expression for <em class="calibre7">S</em> requires six real multiply operations. If the DFT’s <em class="calibre7">x</em>(<em class="calibre7">n</em>) input sequence is real-only, what is the equation for <em class="calibre7">S</em> that requires fewer than six real multiplies? Show your work.</p>
<p class="indenthanging"><strong class="calibre9">3.23</strong> For an <em class="calibre7">N</em>-length time-domain sequence <em class="calibre7">x</em>(<em class="calibre7">n</em>), why is the DFT useful in plotting <em class="calibre7">x</em>(<em class="calibre7">n</em>)’s discrete-time Fourier transform (DTFT) which is a function of the continuous frequency variable ω?</p>
<p class="indenthanging"><strong class="calibre9">3.24</strong> In <a href="#calibre_link-286">Chapter 1</a> we mentioned a special time-domain sequence called a <em class="calibre7">unit impulse.</em> We’ll be using that sequence, the <em class="calibre7">x</em><sub class="calibre12">imp</sub>(<em class="calibre7">n</em>) shown in <a href="#calibre_link-1648">Figure P3-24</a>, in later chapters to test digital filters. As such, it’s useful to know the spectral content of this unit impulse.</p>
<p class="caption"><a id="calibre_link-1648"></a><strong class="calibre9">Figure P3-24</strong></p>
<p class="image"><img src="images/001255.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Draw the continuous <em class="calibre7">X</em><sub class="calibre12">imp</sub>(ω) discrete-time Fourier transform (DTFT), over the frequency range of 0 ≤ ω ≤ 2π, of the <em class="calibre7">x</em><sub class="calibre12">imp</sub>(<em class="calibre7">n</em>) unit impulse sequence.</p>
<p class="indenthangingn"><a id="calibre_link-2624"></a><strong class="calibre9">(b)</strong> With your <em class="calibre7">X</em><sub class="calibre12">imp</sub>(ω) solution in mind, assume a person is listening to an AM (amplitude modulation) radio station centered at 640 kHz in the North American AM Broadcast band and a neighbor is listening to an international shortwave AM signal on a radio receiver tuned to 5.2 MHz. Can you explain why, when lightning strikes, both people hear the static noise from the lightning on their radios even though the radios are tuned to very different center frequencies?</p>
<p class="indenthanging"><strong class="calibre9">3.25</strong> Draw a rough sketch of the magnitude of the discrete-time Fourier transform (DTFT), over the frequency range of −π ≤ ω ≤ π, of the <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence in <a href="#calibre_link-1649">Figure P3-25</a>.</p>
<p class="caption"><a id="calibre_link-1649"></a><strong class="calibre9">Figure P3-25</strong></p>
<p class="image"><img src="images/000339.jpg" alt="image" class="calibre2" /></p>
</div>


</body></html>
