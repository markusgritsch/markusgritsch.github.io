<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style_edited.css" rel="stylesheet" type="text/css" /><title>Understanding Digital Signal Processing</title>
<style type="text/css">
body {
  -webkit-text-size-adjust: 260%; /* text */
  zoom: 1.7; /* graphics */
  font-family: "BookerlyLCD";
}
a {
  color: #005090;
  text-decoration: none;
}
a {font-variant-numeric: oldstyle-nums proportional-nums;}
p.caption {font-variant-numeric: oldstyle-nums proportional-nums;}
</style>
</head><body>


<div class="calibre" id="calibre_link-572">
<p class="calibre3"><a id="calibre_link-2482"></a></p>
<h2 class="calibre8"><a id="calibre_link-2483" class="calibre5"></a>Contents</h2>
<p class="toc-chapter"><strong class="calibre9"><a href="#calibre_link-583">2 PERIODIC SAMPLING</a></strong></p>
<p class="toc-section"><a href="#calibre_link-407">2.1 Aliasing: Signal Ambiguity in the Frequency Domain</a></p>
<p class="toc-section"><a href="#calibre_link-584">2.2 Sampling Lowpass Signals</a></p>
<p class="toc-section"><a href="#calibre_link-585">2.3 Sampling Bandpass Signals</a></p>
<p class="toc-section"><a href="#calibre_link-586">2.4 Practical Aspects of Bandpass Sampling</a></p>
<p class="toc-section1"><a href="#calibre_link-587">References</a></p>
<p class="toc-section1"><a href="#calibre_link-588">Chapter 2 Problems</a></p>

</div>


<div class="calibre" id="calibre_link-583">
<p class="calibre3"><a id="calibre_link-287"></a></p>
<h2 class="calibre8"><a id="calibre_link-1962" class="calibre5"></a>2 Periodic Sampling</h2>
<p class="image"><img src="images/001451.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Periodic sampling, the process of representing a continuous signal with a sequence of discrete data values, pervades the field of digital signal processing. In practice, sampling is performed by applying a continuous signal to an analog-to-digital (A/D) converter whose output is a series of digital values. Because sampling theory plays an important role in determining the accuracy and feasibility of any digital signal processing scheme, we need a solid appreciation for the often misunderstood effects of periodic sampling. With regard to sampling, the primary concern is just how fast a given continuous signal must be sampled in order to preserve its information content. We can sample a continuous signal at any sample rate we wish, and we’ll obtain a series of discrete values&mdash;but the question is, how well do these values represent the original signal? Let’s learn the answer to that question and, in doing so, explore the various sampling techniques used in digital signal processing.</p>
<p class="calibre3"><a id="calibre_link-407"></a></p>
<h3 class="calibre6">2.1 Aliasing: Signal Ambiguity in the Frequency Domain</h3>
<p class="calibre3">There is a frequency-domain ambiguity associated with discrete-time signal samples that does not exist in the continuous signal world, and we can appreciate the effects of this uncertainty by understanding the sampled nature of discrete data. By way of example, suppose you were given the following sequence of values,</p>
<p class="indenthanging1"><em class="calibre7">x</em>(0) = 0<br class="calibre1" /><em class="calibre7">x</em>(1) = 0.866<br class="calibre1" /><em class="calibre7">x</em>(2) = 0.866<br class="calibre1" /><em class="calibre7">x</em>(3) = 0<br class="calibre1" /><a id="calibre_link-2537"></a><em class="calibre7">x</em>(4) = −0.866<br class="calibre1" /><em class="calibre7">x</em>(5) = −0.866<br class="calibre1" /><em class="calibre7">x</em>(6) = 0,</p>
<p class="calibre3">and were told that they represent instantaneous values of a time-domain sinewave taken at periodic intervals. Next, you were asked to draw that sinewave. You’d start by plotting the sequence of values shown by the dots in <a href="#calibre_link-1840">Figure 2-1(a)</a>. Next, you’d be likely to draw the sinewave, illustrated by the solid line in <a href="#calibre_link-1840">Figure 2-1(b)</a>, that passes through the points representing the original sequence.</p>
<p class="caption"><a id="calibre_link-1840"></a><strong class="calibre9">Figure 2-1</strong> Frequency ambiguity: (a) discrete-time sequence of values; (b) two different sinewaves that pass through the points of the discrete sequence.</p>
<p class="image"><img src="images/000749.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Another person, however, might draw the sinewave shown by the shaded line in <a href="#calibre_link-1840">Figure 2-1(b)</a>. We see that the original sequence of values could, with equal validity, represent sampled values of both sinewaves. The key issue is that if the data sequence represents periodic samples of a sinewave, we cannot unambiguously determine the frequency of the sinewave from those sample values alone.</p>
<p class="calibre3">Reviewing the mathematical origin of this frequency ambiguity enables us not only to deal with it, but to use it to our advantage. Let’s derive an expression for this frequency-domain ambiguity and, then, look at a few specific examples. Consider the continuous time-domain sinusoidal signal defined as</p>
<p class="caption"><a id="calibre_link-2538"></a><a id="calibre_link-1841"></a>(2-1)</p>
<p class="image"><img src="images/000135.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">This <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal is a garden-variety sinewave whose frequency is <em class="calibre7">f</em><sub class="calibre12">o</sub> Hz. Now let’s sample <em class="calibre7">x</em>(<em class="calibre7">t</em>) at a rate of <em class="calibre7">f<sub class="calibre12">s</sub></em> samples/second, i.e., at regular periods of <em class="calibre7">t<sub class="calibre12">s</sub></em> seconds where <em class="calibre7">t<sub class="calibre12">s</sub></em> = 1/<em class="calibre7">f<sub class="calibre12">s</sub></em>. If we start sampling at time <em class="calibre7">t</em> = 0, we will obtain samples at times 0<em class="calibre7">t<sub class="calibre12">s</sub></em>, 1<em class="calibre7">t<sub class="calibre12">s</sub></em>, 2<em class="calibre7">t<sub class="calibre12">s</sub></em>, and so on. So, from <a href="#calibre_link-1841">Eq. (2-1)</a>, the first <em class="calibre7">n</em> successive samples have the values</p>
<p class="caption"><a id="calibre_link-1842"></a>(2-2)</p>
<p class="image"><img src="images/000973.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1842">Equation (2-2)</a> defines the value of the <em class="calibre7">n</em>th sample of our <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence to be equal to the original sinewave at the time instant <em class="calibre7">nt<sub class="calibre12">s</sub></em>. Because two values of a sinewave are identical if they’re separated by an integer multiple of 2π radians, i.e., sin(<em class="calibre7">ø</em>) = sin(<em class="calibre7">ø</em>+2π<em class="calibre7">m</em>) where <em class="calibre7">m</em> is any integer, we can modify <a href="#calibre_link-1842">Eq. (2-2)</a> as</p>
<p class="caption"><a id="calibre_link-1843"></a>(2-3)</p>
<p class="image"><img src="images/001023.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we let <em class="calibre7">m</em> be an integer multiple of <em class="calibre7">n</em>, <em class="calibre7">m</em> = <em class="calibre7">kn</em>, we can replace the <em class="calibre7">m</em>/<em class="calibre7">n</em> ratio in <a href="#calibre_link-1843">Eq. (2-3)</a> with <em class="calibre7">k</em> so that</p>
<p class="caption"><a id="calibre_link-1844"></a>(2-4)</p>
<p class="image"><img src="images/000868.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Because <em class="calibre7">f<sub class="calibre12">s</sub></em> = 1/<em class="calibre7">t<sub class="calibre12">s</sub></em>, we can equate the <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequences in <a href="#calibre_link-1842">Eqs. (2-2)</a> and <a href="#calibre_link-1844">(2-4)</a> as</p>
<p class="caption"><a id="calibre_link-1845"></a>(2-5)</p>
<p class="image"><img src="images/001371.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The <em class="calibre7">f</em><sub class="calibre12">o</sub> and (<em class="calibre7">f</em><sub class="calibre12">o</sub>+<em class="calibre7">kf<sub class="calibre12">s</sub></em>) factors in <a href="#calibre_link-1845">Eq. (2-5)</a> are therefore equal. The implication of <a href="#calibre_link-1845">Eq. (2-5)</a> is critical. It means that an <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence of digital sample values, representing a sinewave of <em class="calibre7">f</em><sub class="calibre12">o</sub> Hz, also exactly represents sinewaves at other frequencies, namely, <em class="calibre7">f</em><sub class="calibre12">o</sub> + <em class="calibre7">kf<sub class="calibre12">s</sub></em>. This is one of the most important relationships in the field of digital signal processing. It’s the thread with which all sampling schemes are woven. In words, <a href="#calibre_link-1845">Eq. (2-5)</a> states:</p>
<p class="blockquote"><strong class="calibre9">When sampling at a rate of <em class="calibre7">f<sub class="calibre12">s</sub></em> samples/second, if <em class="calibre7">k</em> is any positive or negative integer, we cannot distinguish between the sampled values of a sinewave of <em class="calibre7">f</em><sub class="calibre12">o</sub> Hz and a sinewave of (<em class="calibre7">f</em><sub class="calibre12">o</sub>+<em class="calibre7">kf<sub class="calibre12">s</sub></em>) Hz.</strong></p>
<p class="calibre3">It’s true. No sequence of values stored in a computer, for example, can unambiguously represent one and only one sinusoid without additional <a id="calibre_link-1961"></a>information. This fact applies equally to A/D-converter output samples as well as signal samples generated by computer software routines. The sampled nature of any sequence of discrete values makes that sequence also represent an infinite number of different sinusoids.</p>
<p class="calibre3"><a href="#calibre_link-1845">Equation (2-5)</a> influences all digital signal processing schemes. It’s the reason that, although we’ve only shown it for sinewaves, we’ll see in <a href="#calibre_link-134">Chapter 3</a> that the spectrum of any discrete series of sampled values contains periodic replications of the original continuous spectrum. The period between these replicated spectra in the frequency domain will always be <em class="calibre7">f<sub class="calibre12">s</sub></em>, and the spectral replications repeat all the way from <em class="calibre7">DC to daylight</em> in both directions of the frequency spectrum. That’s because <em class="calibre7">k</em> in <a href="#calibre_link-1845">Eq. (2-5)</a> can be any positive or negative integer. (In <a href="#calibre_link-79">Chapters 5</a> and <a href="#calibre_link-289">6</a>, we’ll learn that <a href="#calibre_link-1845">Eq. (2-5)</a> is the reason that all digital filter frequency responses are periodic in the frequency domain and is crucial to analyzing and designing a popular type of digital filter known as the infinite impulse response filter.)</p>
<p class="calibre3">To illustrate the effects of <a href="#calibre_link-1845">Eq. (2-5)</a>, let’s build on <a href="#calibre_link-1840">Figure 2-1</a> and consider the sampling of a 7 kHz sinewave at a sample rate of 6 kHz. A new sample is determined every 1/6000 seconds, or once every 167 microseconds, and their values are shown as the dots in <a href="#calibre_link-1846">Figure 2-2(a)</a>.</p>
<p class="caption"><a id="calibre_link-1846"></a><strong class="calibre9">Figure 2-2</strong> Frequency ambiguity effects of <a href="#calibre_link-1845">Eq. (2-5)</a>: (a) sampling a 7 kHz sinewave at a sample rate of 6 kHz; (b) sampling a 4 kHz sinewave at a sample rate of 6 kHz; (c) spectral relationships showing aliasing of the 7 and 4 kHz sinewaves.</p>
<p class="image"><img src="images/000989.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Notice that the sample values would not change at all if, instead, we were sampling a 1 kHz sinewave. In this example <em class="calibre7">f</em><sub class="calibre12">o</sub> = 7 kHz, <em class="calibre7">f<sub class="calibre12">s</sub></em> = 6 kHz, and <em class="calibre7">k</em> = −1 in <a href="#calibre_link-1845">Eq. (2-5)</a>, such that <em class="calibre7">f</em><sub class="calibre12">o</sub>+<em class="calibre7">kf<sub class="calibre12">s</sub></em> = [7+(−1·6)] = 1 kHz. Our problem is that no processing scheme can determine if the sequence of sampled values, whose amplitudes are represented by the dots, came from a 7 kHz or a 1 kHz sinusoid. If these amplitude values are applied to a digital process that detects energy at 1 kHz, the detector output would indicate energy at 1 kHz. But we know that there is no 1 kHz tone there&mdash;our input is a spectrally pure 7 kHz tone. <a href="#calibre_link-1845">Equation (2-5)</a> is causing a sinusoid, whose name is 7 kHz, to go by the <em class="calibre7">alias</em> of 1 kHz. Asking someone to determine which sinewave frequency accounts for the sample values in <a href="#calibre_link-1846">Figure 2-2(a)</a> is like asking, “When I add two numbers I get a sum of four. What are the two numbers?” The answer is that there is an infinite number of number pairs that can add up to four.</p>
<p class="calibre3"><a href="#calibre_link-1846">Figure 2-2(b)</a> shows another example of frequency ambiguity that we’ll call <em class="calibre7">aliasing</em>, where a 4 kHz sinewave could be mistaken for a −2 kHz sinewave. In <a href="#calibre_link-1846">Figure 2-2(b)</a>, <em class="calibre7">f</em><sub class="calibre12">o</sub> = 4 kHz, <em class="calibre7">f<sub class="calibre12">s</sub></em> = 6 kHz, and <em class="calibre7">k</em> = −1 in <a href="#calibre_link-1845">Eq. (2-5)</a>, so that <em class="calibre7">f</em><sub class="calibre12">o</sub>+<em class="calibre7">kf<sub class="calibre12">s</sub></em> = [4+(−1 · 6)] = −2 kHz. Again, if we examine a sequence of numbers representing the dots in <a href="#calibre_link-1846">Figure 2-2(b)</a>, we could not determine if the sampled sinewave was a 4 kHz tone or a −2 kHz tone. (Although the concept of negative frequencies might seem a bit strange, it provides a beautifully consistent methodology for predicting the spectral effects of sampling. <a href="#calibre_link-235">Chapter 8</a> discusses negative frequencies and how they relate to real and complex signals.)</p>
<p class="calibre3">Now, if we restrict our spectral band of interest to the frequency range of ±<em class="calibre7">f<sub class="calibre12">s</sub></em>/2, the previous two examples take on a special significance. The frequency <a id="calibre_link-2091"></a><em class="calibre7">f<sub class="calibre12">s</sub></em>/2 is an important quantity in sampling theory and is referred to by different names in the literature, such as critical Nyquist, half Nyquist, and folding frequency. A graphical depiction of our two frequency aliasing examples is provided in <a href="#calibre_link-1846">Figure 2-2(c)</a>. We’re interested in signal components that are aliased into the frequency band between −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 and +<em class="calibre7">f<sub class="calibre12">s</sub></em>/2. Notice in <a href="#calibre_link-1846">Figure 2-2(c)</a> that within the spectral band of interest (±3 kHz, because <em class="calibre7">f<sub class="calibre12">s</sub></em> = 6 kHz), there is energy at −2 kHz and +1 kHz, aliased from 4 kHz and 7 kHz, respectively. Note also that the vertical positions of the dots in <a href="#calibre_link-1846">Figure 2-2(c)</a> have no <a id="calibre_link-1992"></a>amplitude significance but that their horizontal positions indicate which frequencies are related through aliasing.</p>
<p class="calibre3">A general illustration of aliasing is provided in the <em class="calibre7">shark’s tooth</em> pattern in <a href="#calibre_link-1847">Figure 2-3(a)</a>. Note how the peaks of the pattern are located at integer multiples of <em class="calibre7">f<sub class="calibre12">s</sub></em> Hz. The pattern shows how signals residing at the intersection of a horizontal line and a sloped line will be aliased to all of the intersections of that horizontal line and all other lines with like slopes. For example, the pattern in <a href="#calibre_link-1847">Figure 2-3(b)</a> shows that our sampling of a 7 kHz sinewave at a sample rate of 6 kHz will provide a discrete sequence of numbers whose spectrum ambiguously represents tones at 1 kHz, 7 kHz, 13 kHz, 19 kHz, etc. Let’s pause for a moment and let these very important concepts soak in a bit. Again, discrete sequence representations of a continuous signal have unavoidable ambiguities in their frequency domains. These ambiguities must be taken into account in all practical digital signal processing algorithms.</p>
<p class="caption"><a id="calibre_link-1847"></a><strong class="calibre9">Figure 2-3</strong> Shark’s tooth pattern: (a) aliasing at multiples of the sampling frequency; (b) aliasing of the 7 kHz sinewave to 1 kHz, 13 kHz, and 19 kHz.</p>
<p class="image"><img src="images/000630.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">OK, let’s review the effects of sampling signals that are more interesting than just simple sinusoids.</p>
<p class="calibre3"><a id="calibre_link-584"></a></p>
<h3 class="calibre6">2.2 Sampling Lowpass Signals</h3>
<p class="calibre3">Consider the situation of sampling a signal such as a continuous real-valued lowpass <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal whose spectrum is shown in <a href="#calibre_link-1848">Figure 2-4(a)</a>. Notice that the spectrum is symmetrical around zero Hz, and the spectral amplitude is zero above +<em class="calibre7">B</em> Hz and below −<em class="calibre7">B</em> Hz; i.e., the signal is <em class="calibre7">band-limited</em>. (From a practical standpoint, the term <em class="calibre7">band-limited signal</em> merely implies that any signal energy outside the range of ±<em class="calibre7">B</em> Hz is below the sensitivity of our system.) The <em class="calibre7">x</em>(<em class="calibre7">t</em>) time signal is called a <em class="calibre7">lowpass signal</em> because its spectral energy is low in frequency.</p>
<p class="caption"><a id="calibre_link-2443"></a><a id="calibre_link-1848"></a><strong class="calibre9">Figure 2-4</strong> Spectral replications: (a) original continuous lowpass signal spectrum; (b) spectral replications of the sampled lowpass signal when <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 &gt; <em class="calibre7">B</em>; (c) frequency overlap and aliasing when the sampling rate is too low because <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 &lt; <em class="calibre7">B</em>.</p>
<p class="image"><img src="images/001489.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Pausing for a moment, if the continuous <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal were a voltage on a coax cable applied to the input of an analog spectrum analyzer, we would only see the spectral energy over the positive-frequency range of 0 to +<em class="calibre7">B</em> Hz on the analyzer’s screen. However, in our world of discrete signals (DSP) we show the spectrum of real-valued signals as having both positive- and negative-frequency spectral energy. Throughout this book we’ll repeatedly see why such spectral representations are often useful, and sometimes mandatory in our work. The mathematical justification for two-sided spectral diagrams is provided in both <a href="#calibre_link-134">Chapters 3</a> and <a href="#calibre_link-235">8</a>. For now, we request the reader’s acceptance that <a href="#calibre_link-1848">Figure 2-4(a)</a> is a valid representation of the spectrum of the continuous <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal.</p>
<p class="calibre3">Given that the continuous <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal, whose spectrum is shown in <a href="#calibre_link-1848">Figure 2-4(a)</a>, is sampled at a rate of <em class="calibre7">f<sub class="calibre12">s</sub></em> samples/second, we can see the spectral replication effects of sampling in <a href="#calibre_link-1848">Figure 2-4(b)</a> showing the original spectrum in addition to an infinite number of replications. The period of spectral replication is <em class="calibre7">f<sub class="calibre12">s</sub></em> Hz. <a href="#calibre_link-1848">Figure 2-4(b)</a> is the spectrum of the sequence of <em class="calibre7">x</em>(<em class="calibre7">n</em>) sampled values of <a id="calibre_link-2271"></a>the continuous <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal. (Although we stated in <a href="#calibre_link-574">Section 1.1</a> that frequency-domain representations of discrete time-domain sequences are themselves discrete, the replicated spectra in <a href="#calibre_link-1848">Figure 2-4(b)</a> are shown as continuous lines, instead of discrete dots, merely to keep the figure from looking too cluttered. We’ll cover the full implications of discrete frequency spectra in <a href="#calibre_link-134">Chapter 3</a>.)</p>
<p class="calibre3">Let’s step back a moment and understand <a href="#calibre_link-1848">Figure 2-4</a> for all it’s worth. <a href="#calibre_link-1848">Figure 2-4(a)</a> is the spectrum of a continuous signal, a signal that can only exist in one of two forms. Either it’s a continuous signal that can be sampled, through A/D conversion, or it is merely an abstract concept such as a mathematical expression for a signal. It <em class="calibre7">cannot</em> be represented in a digital machine in its current band-limited form. Once the signal is represented by a sequence of discrete sample values, its spectrum takes the replicated form of <a href="#calibre_link-1848">Figure 2-4(b)</a>.</p>
<p class="calibre3">The replicated spectra are not just figments of the mathematics; they exist and have a profound effect on subsequent digital signal processing.<sup class="calibre10"><a id="calibre_link-1851"></a><a href="#calibre_link-1849">†</a></sup> The replications may appear harmless, and it’s natural to ask, “Why care about spectral replications? We’re only interested in the frequency band within ±<em class="calibre7">f<sub class="calibre12">s</sub></em>/2.” Well, if we perform a frequency translation operation or induce a change in sampling rate through decimation or interpolation, the spectral replications will shift up or down right in the middle of the frequency range of interest ±<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 and could cause problems<a href="#calibre_link-1850">[1]</a>. Let’s see how we can control the locations of those spectral replications.</p>
<p class="footnotes"><a id="calibre_link-1849"></a><sup class="calibre11"><a href="#calibre_link-1851">†</a></sup> Toward the end of <a href="#calibre_link-614">Section 5.9</a>, as an example of using the convolution theorem, another derivation of periodic sampling’s replicated spectra will be presented.</p>
<p class="calibre3">In practical A/D conversion schemes, <em class="calibre7">f<sub class="calibre12">s</sub></em> is always greater than 2<em class="calibre7">B</em> to separate spectral replications at the <em class="calibre7">folding frequencies</em> of ±<em class="calibre7">f<sub class="calibre12">s</sub></em>/2. This very important relationship of <em class="calibre7">f<sub class="calibre12">s</sub></em> ≥ 2<em class="calibre7">B</em> is known as the <em class="calibre7">Nyquist criterion.</em> To illustrate why the term <em class="calibre7">folding frequency</em> is used, let’s lower our sampling frequency to <em class="calibre7">f<sub class="calibre12">s</sub></em> = 1.5<em class="calibre7">B</em> Hz. The spectral result of this <em class="calibre7">undersampling</em> is illustrated in <a href="#calibre_link-1848">Figure 2-4(c)</a>. The spectral replications are now overlapping the original baseband spectrum centered at zero Hz. Limiting our attention to the band ±<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz, we see two very interesting effects. First, the lower edge and upper edge of the spectral replications centered at +<em class="calibre7">f<sub class="calibre12">s</sub></em> and −<em class="calibre7">f<sub class="calibre12">s</sub></em> now lie in our band of interest. This situation is equivalent to the original spectrum folding to the left at +<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 and folding to the right at −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2. Portions of the spectral replications now combine with the original spectrum, and the result is aliasing errors. The discrete sampled values associated with the spectrum of <a href="#calibre_link-1848">Figure 2-4(c)</a> no longer truly represent the original input signal. The spectral information in the bands of −<em class="calibre7">B</em> to −<em class="calibre7">B</em>/2 and <em class="calibre7">B</em>/2 to <em class="calibre7">B</em> Hz has been corrupted. We show the amplitude of the aliased regions in <a href="#calibre_link-1848">Figure 2-4(c)</a> as shaded lines because we don’t really know what the amplitudes will be if aliasing occurs.</p>
<p class="calibre3"><a id="calibre_link-2081"></a>The second effect illustrated by <a href="#calibre_link-1848">Figure 2-4(c)</a> is that the entire spectral content of the original continuous signal is now residing in the band of interest between −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 and +<em class="calibre7">f<sub class="calibre12">s</sub></em>/2. This key property was true in <a href="#calibre_link-1848">Figure 2-4(b)</a> and will always be true, regardless of the original signal or the sample rate. This effect is particularly important when we’re digitizing (A/D converting) continuous signals. It warns us that any signal energy located above +<em class="calibre7">B</em> Hz and below −<em class="calibre7">B</em> Hz in the original continuous spectrum of <a href="#calibre_link-1848">Figure 2-4(a)</a> will always end up in the band of interest after sampling, regardless of the sample rate. For this reason, continuous (analog) <em class="calibre7">lowpass</em> filters are necessary in practice.</p>
<p class="calibre3">We illustrate this notion by showing a continuous signal of bandwidth <em class="calibre7">B</em> accompanied by noise energy in <a href="#calibre_link-1852">Figure 2-5(a)</a>. Sampling this composite continuous signal at a rate that’s greater than 2<em class="calibre7">B</em> prevents replications of the signal of interest from overlapping each other, but all of the noise energy still ends up in the range between −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 and +<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 of our discrete spectrum shown in <a href="#calibre_link-1852">Figure 2-5(b)</a>. This problem is solved in practice by using an analog lowpass <em class="calibre7">anti-aliasing</em> filter prior to A/D conversion to attenuate any unwanted signal energy above +<em class="calibre7">B</em> and below −<em class="calibre7">B</em> Hz as shown in <a href="#calibre_link-1853">Figure 2-6</a>. An example lowpass filter response shape is shown as the dotted line superimposed on the original continuous signal spectrum in <a href="#calibre_link-1853">Figure 2-6</a>. Notice how the output spectrum of the lowpass filter has been band-limited, and spectral aliasing is avoided at the output of the A/D converter.</p>
<p class="caption"><a id="calibre_link-1852"></a><strong class="calibre9">Figure 2-5</strong> Spectral replications: (a) original continuous signal-plus-noise spectrum; (b) discrete spectrum with noise contaminating the signal of interest.</p>
<p class="image"><img src="images/000523.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1853"></a><strong class="calibre9">Figure 2-6</strong> Lowpass analog filtering prior to sampling at a rate of <em class="calibre7">f<sub class="calibre12">s</sub></em> Hz.</p>
<p class="image"><img src="images/000650.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">As a historical note, the notion of periodic sampling was studied by various engineers, scientists, and mathematicians such as the Russian V. Kotelnikov, the Swedish-born H. Nyquist, the Scottish E. Whittaker, and the <a id="calibre_link-1981"></a>Japanese I. Someya<a href="#calibre_link-1854">[2]</a>. But it was the American Claude Shannon, acknowledging the work of others, that formalized the concept of periodic sampling as we know it today and brought it to the broad attention of communications engineers<a href="#calibre_link-1855">[3]</a>. That was in 1948&mdash;the birth year of the transistor, marshmallows, and this author.</p>
<p class="calibre3">This completes the discussion of simple lowpass sampling. Now let’s go on to a more advanced sampling topic that’s proven so useful in practice.</p>
<p class="calibre3"><a id="calibre_link-585"></a></p>
<h3 class="calibre6">2.3 Sampling Bandpass Signals</h3>
<p class="calibre3">Although satisfying the majority of sampling requirements, the sampling of lowpass signals, as in <a href="#calibre_link-1853">Figure 2-6</a>, is not the only sampling scheme used in practice. We can use a technique known as <em class="calibre7">bandpass sampling</em> to sample a continuous bandpass signal that is centered about some frequency other than zero Hz. When a continuous input signal’s bandwidth and center frequency permit us to do so, bandpass sampling not only reduces the speed requirement of A/D converters below that necessary with traditional lowpass sampling; it also reduces the amount of digital memory necessary to capture a given time interval of a continuous signal.</p>
<p class="calibre3">By way of example, consider sampling the band-limited signal shown in <a href="#calibre_link-1856">Figure 2-7(a)</a> centered at <em class="calibre7">f<sub class="calibre12">c</sub></em> = 20 MHz, with a bandwidth <em class="calibre7">B</em> = 5 MHz. We use the term <em class="calibre7">bandpass sampling</em> for the process of sampling continuous signals whose center frequencies have been translated up from zero Hz. What we’re calling bandpass sampling goes by various other names in the literature, such as IF sampling, harmonic sampling<a href="#calibre_link-1857">[4]</a>, sub-Nyquist sampling, and undersampling<a href="#calibre_link-1858">[5]</a>. In bandpass sampling, we’re more concerned with a signal’s bandwidth than its highest-frequency component. Note that the negative frequency portion of the signal, centered at −<em class="calibre7">f<sub class="calibre12">c</sub></em>, is the mirror image of the positive <a id="calibre_link-1998"></a>frequency portion&mdash;as it must be for real signals. Our bandpass signal’s highest-frequency component is 22.5 MHz. Conforming to the Nyquist criterion (sampling at twice the highest-frequency content of the signal) implies that the sampling frequency must be a minimum of 45 MHz. Consider the effect if the sample rate is 17.5 MHz shown in <a href="#calibre_link-1856">Figure 2-7(b)</a>. Note that the original spectral components remain located at ±<em class="calibre7">f<sub class="calibre12">c</sub></em>, and spectral replications are located exactly at baseband, i.e., butting up against each other at zero Hz. <a href="#calibre_link-1856">Figure 2-7(b)</a> shows that sampling at 45 MHz was unnecessary to avoid aliasing&mdash;instead we’ve used the spectral replicating effects of <a href="#calibre_link-1845">Eq. (2-5)</a> to our advantage.</p>
<p class="caption"><a id="calibre_link-1856"></a><strong class="calibre9">Figure 2-7</strong> Bandpass signal sampling: (a) original continuous signal spectrum; (b) sampled signal spectrum replications when sample rate is 17.5 MHz.</p>
<p class="image"><img src="images/000424.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Bandpass sampling performs digitization and frequency translation in a single process, often called <em class="calibre7">sampling translation</em>. The processes of sampling and frequency translation are intimately bound together in the world of digital signal processing, and every sampling operation inherently results in spectral replications. The inquisitive reader may ask, “Can we sample at some still lower rate and avoid aliasing?” The answer is yes, but, to find out how, we have to grind through the derivation of an important bandpass sampling relationship. Our reward, however, will be worth the trouble because here’s where bandpass sampling really gets interesting.</p>
<p class="calibre3">Let’s assume we have a continuous input bandpass signal of bandwidth <em class="calibre7">B.</em> Its <em class="calibre7">carrier frequency</em> is <em class="calibre7">f<sub class="calibre12">c</sub></em> Hz, i.e., the bandpass signal is centered at <em class="calibre7">f<sub class="calibre12">c</sub></em> Hz, and its sampled value spectrum is that shown in <a href="#calibre_link-1859">Figure 2-8(a)</a>. We can sample that continuous signal at a rate, say <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">′</sub> Hz, so the spectral replications of the positive and negative bands, Q and P, just butt up against each other exactly at zero Hz. This situation, depicted in <a href="#calibre_link-1859">Figure 2-8(a)</a>, is reminiscent of <a href="#calibre_link-1856">Figure 2-7(b)</a>. With an arbitrary number of replications, say <em class="calibre7">m,</em> in the range of 2<em class="calibre7">f<sub class="calibre12">c</sub></em> − <em class="calibre7">B</em>, we see that</p>
<p class="caption"><a id="calibre_link-1860"></a>(2-6)</p>
<p class="image"><img src="images/000748.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1859"></a><strong class="calibre9">Figure 2-8</strong> Bandpass sampling frequency limits: (a) sample rate <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">′</sub> = (2<em class="calibre7">f<sub class="calibre12">c</sub></em> − <em class="calibre7">B</em>)/6; (b) sample rate is less than <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">′</sub>; (c) minimum sample rate <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">″</sub> &lt; <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">′</sub>.</p>
<p class="image"><img src="images/001273.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2000"></a>In <a href="#calibre_link-1859">Figure 2-8(a)</a>, <em class="calibre7">m</em> = 6 for illustrative purposes only. Of course <em class="calibre7">m</em> can be any positive integer so long as <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">′</sub> is never less than 2<em class="calibre7">B</em>. If the sample rate <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">′</sub> is increased, the original spectra (bold) do not shift, but all the replications will shift. At zero Hz, the P band will shift to the right, and the Q band will shift to the left. These replications will overlap and aliasing occurs. Thus, from <a href="#calibre_link-1860">Eq. (2-6)</a>, for an arbitrary <em class="calibre7">m,</em> there is a frequency that the sample rate must not exceed, or</p>
<p class="caption"><a id="calibre_link-1862"></a>(2-7)</p>
<p class="image"><img src="images/001607.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we reduce the sample rate below the <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">′</sub> value shown in <a href="#calibre_link-1859">Figure 2-8(a)</a>, the spacing between replications will decrease in the direction of the arrows in <a href="#calibre_link-1859">Figure 2-8(b)</a>. Again, the original spectra do not shift when the sample rate is changed. At some new sample rate <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">″</sub>, where <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">″</sub> &lt; <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">′</sub>, the replication P′ will just butt up against the positive original spectrum centered at <em class="calibre7">f<sub class="calibre12">c</sub></em> as shown in <a href="#calibre_link-1859">Figure 2-8(c)</a>. In this condition, we know that</p>
<p class="caption"><a id="calibre_link-1861"></a>(2-8)</p>
<p class="image"><img src="images/000629.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Should <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">″</sub> be decreased in value, P′ will shift further down in frequency and start to overlap with the positive original spectrum at <em class="calibre7">f<sub class="calibre12">c</sub></em> and aliasing occurs. Therefore, from <a href="#calibre_link-1861">Eq. (2-8)</a> and for <em class="calibre7">m</em>+1, there is a frequency that the sample rate must always exceed, or</p>
<p class="caption"><a id="calibre_link-1863"></a>(2-9)</p>
<p class="image"><img src="images/001488.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2539"></a>We can now combine <a href="#calibre_link-1862">Eqs. (2-7)</a> and <a href="#calibre_link-1863">(2-9)</a> to say that <em class="calibre7">f<sub class="calibre12">s</sub></em> may be chosen anywhere in the range between <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">″</sub> and <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">′</sub> to avoid aliasing, or</p>
<p class="caption"><a id="calibre_link-1864"></a>(2-10)</p>
<p class="image"><img src="images/000522.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">m</em> is an arbitrary, positive integer ensuring that <em class="calibre7">f<sub class="calibre12">s</sub></em> ≥ 2<em class="calibre7">B</em>. (For this type of periodic sampling of real signals, known as <em class="calibre7">real</em> or <em class="calibre7">1st-order sampling,</em> the Nyquist criterion <em class="calibre7">f<sub class="calibre12">s</sub></em> ≥ 2<em class="calibre7">B</em> must still be satisfied.)</p>
<p class="calibre3">To appreciate the important relationships in <a href="#calibre_link-1864">Eq. (2-10)</a>, let’s return to our bandpass signal example, where <a href="#calibre_link-1864">Eq. (2-10)</a> enables the generation of <a href="#calibre_link-1865">Table 2-1</a>. This table tells us that our sample rate can be anywhere in the range of 22.5 to 35 MHz, anywhere in the range of 15 to 17.5 MHz, or anywhere in the range of 11.25 to 11.66 MHz. Any sample rate below 11.25 MHz is unacceptable because it will not satisfy <a href="#calibre_link-1864">Eq. (2-10)</a> as well as <em class="calibre7">f<sub class="calibre12">s</sub></em> ≥ 2<em class="calibre7">B</em>. The spectra resulting from several of the sampling rates from <a href="#calibre_link-1865">Table 2-1</a> are shown in <a href="#calibre_link-1866">Figure 2-9</a> for our bandpass signal example. Notice in <a href="#calibre_link-1866">Figure 2-9(f)</a> that when <em class="calibre7">f<sub class="calibre12">s</sub></em> equals 7.5 MHz (<em class="calibre7">m</em> = 5), we have aliasing problems because neither the greater-than relationships in <a href="#calibre_link-1864">Eq. (2-10)</a> nor <em class="calibre7">f<sub class="calibre12">s</sub></em> ≥ 2<em class="calibre7">B</em> have been satisfied. The <em class="calibre7">m</em> = 4 condition is also unacceptable because <em class="calibre7">f<sub class="calibre12">s</sub></em> ≥ 2<em class="calibre7">B</em> is not satisfied. The last column in <a href="#calibre_link-1865">Table 2-1</a> gives the <em class="calibre7">optimum</em> sampling frequency for each acceptable <em class="calibre7">m</em> value. Optimum sampling frequency is defined here as that frequency where spectral replications butt up against each other at zero Hz. For example, in the <em class="calibre7">m</em> = 1 range of permissible sampling frequencies, it is much easier to perform subsequent digital filtering or other processing on the signal samples whose spectrum is that of <a href="#calibre_link-1866">Figure 2-9(b)</a>, as opposed to the spectrum in <a href="#calibre_link-1866">Figure 2-9(a)</a>.</p>
<p class="caption"><a id="calibre_link-1865"></a><strong class="calibre9">Table 2-1</strong> <a href="#calibre_link-1864">Equation (2-10)</a> Applied to the Bandpass Signal Example</p>
<p class="image"><img src="images/001624.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1866"></a><strong class="calibre9">Figure 2-9</strong> Various spectral replications from <a href="#calibre_link-1865">Table 2-1</a>: (a) <em class="calibre7">f<sub class="calibre12">s</sub></em> = 35 MHz; (b) <em class="calibre7">f<sub class="calibre12">s</sub></em> = 22.5 MHz; (c) <em class="calibre7">f<sub class="calibre12">s</sub></em> = 17.5 MHz; (d) <em class="calibre7">f<sub class="calibre12">s</sub></em> = 15 MHz; (e) <em class="calibre7">f<sub class="calibre12">s</sub></em> = 11.25 MHz; (f) <em class="calibre7">f<sub class="calibre12">s</sub></em> = 7.5 MHz.</p>
<p class="image"><img src="images/000311.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-586"></a></p>
<h3 class="calibre6">2.4 Practical Aspects of Bandpass Sampling</h3>
<p class="calibre3">Now that we’re familiar with the theory of bandpass sampling, let’s discuss a few aspects of bandpass sampling in practical applications.</p>
<p class="calibre3"><a id="calibre_link-2540"></a></p>
<h4 class="calibre13"><a id="calibre_link-1997"></a>2.4.1 Spectral Inversion in Bandpass Sampling</h4>
<p class="calibre3">Some of the permissible <em class="calibre7">f<sub class="calibre12">s</sub></em> values from <a href="#calibre_link-1864">Eq. (2-10)</a> will, although avoiding aliasing problems, provide a sampled baseband spectrum (located near zero Hz) that is inverted from the original analog signal’s positive and negative spectral shapes. That is, the positive-frequency sampled baseband will have the inverted shape of the negative half from the original analog spectrum. This spectral inversion happens whenever <em class="calibre7">m</em>, in <a href="#calibre_link-1864">Eq. (2-10)</a>, is an odd integer, <a id="calibre_link-2541"></a>as illustrated in <a href="#calibre_link-1866">Figures 2-9(c)</a> and <a href="#calibre_link-1866">2-9(d)</a>. When the original positive spectral bandpass components are symmetrical about the <em class="calibre7">f<sub class="calibre12">c</sub></em> frequency, spectral inversion presents no problem and any nonaliasing value for <em class="calibre7">f<sub class="calibre12">s</sub></em> from <a href="#calibre_link-1864">Eq. (2-10)</a> may be chosen.</p>
<p class="calibre3">However, if spectral inversion is something to be avoided, for example, when single sideband signals are being processed, the applicable sample rates to avoid spectral inversion are defined by <a href="#calibre_link-1864">Eq. (2-10)</a> with the restriction that <em class="calibre7">m</em> is an even integer and <em class="calibre7">f<sub class="calibre12">s</sub></em> &gt; 2<em class="calibre7">B</em> is satisfied.</p>
<p class="calibre3">Now here’s some good news. With a little additional digital processing we can sample at rates defined by <a href="#calibre_link-1864">Eq. (2-10)</a> with odd <em class="calibre7">m</em>, with their spectral inversion, and easily reinvert the spectrum back to its original orientation. The discrete spectrum of any digital signal can be inverted by multiplying the signal’s discrete-time samples by a sequence of alternating plus ones and minus ones (1, −1, 1, −1, etc.), indicated in the literature by the succinct expression (−1)<em class="calibre7"><sup class="calibre10">n</sup></em>.</p>
<p class="calibre3">Although multiplying time samples by (−1)<em class="calibre7"><sup class="calibre10">n</sup></em> is explored in detail in <a href="#calibre_link-339">Section 13.1</a>, all we need to remember at this point is the simple rule that multiplication of real signal samples by (−1)<em class="calibre7"><sup class="calibre10">n</sup></em> flips the positive-frequency band of interest, from zero to +<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz, where the center of the flipping is <em class="calibre7">f<sub class="calibre12">s</sub></em>/4 Hz. Likewise, the multiplication flips the negative frequency band of interest, from −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 to zero Hz, where the center of the flipping is −<em class="calibre7">f<sub class="calibre12">s</sub></em>/4 Hz as shown in <a href="#calibre_link-1867">Figure 2-10</a>. In the literature of DSP, occasionally you’ll see the (−1)<em class="calibre7"><sup class="calibre10">n</sup></em> sequence expressed by the equivalent expression cos(π<em class="calibre7">n</em>).</p>
<p class="caption"><a id="calibre_link-1867"></a><strong class="calibre9">Figure 2-10</strong> Spectral inversion through multiplication by (−1)<em class="calibre7"><sup class="calibre10">n</sup></em>: (a) spectrum of original <em class="calibre7">x</em>(<em class="calibre7">n</em>); (b) spectrum of (−1)<em class="calibre7"><sup class="calibre10">n</sup></em> · <em class="calibre7">x</em>(<em class="calibre7">n</em>).</p>
<p class="image"><img src="images/001151.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2542"></a></p>
<h4 class="calibre13"><a id="calibre_link-1999"></a>2.4.2 Positioning Sampled Spectra at <em class="calibre7">f<sub class="calibre12">s</sub></em>/4</h4>
<p class="calibre3">In many signal processing applications we’ll find it useful to use an <em class="calibre7">f<sub class="calibre12">s</sub></em> bandpass sampling rate that forces the sampled spectra to be centered exactly at ±<em class="calibre7">f<sub class="calibre12">s</sub></em>/4 as shown in <a href="#calibre_link-1867">Figure 2-10(a)</a>. As we’ll see in later chapters, this scenario greatly simplifies certain common operations such as digital filtering, complex down-conversion, and Hilbert transformations.</p>
<p class="calibre3">To ensure that sampled spectra reside at ±<em class="calibre7">f<sub class="calibre12">s</sub></em>/4, we select <em class="calibre7">f<sub class="calibre12">s</sub></em> using</p>
<p class="caption"><a id="calibre_link-1877"></a>(2-11)</p>
<p class="image"><img src="images/001382.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">f<sub class="calibre12">c</sub></em> is the center frequency of the original analog signal’s bandpass signal.</p>
<p class="calibre3"><a id="calibre_link-2543"></a></p>
<h4 class="calibre13">2.4.3 Noise in Bandpass-Sampled Signals</h4>
<p class="calibre3">We have painted a rosy picture of bandpass sampling, with its analog signal capture capabilities at reduced sample rates. However, there is a negative aspect associated with bandpass sampling. The signal-to-noise ratio (SNR), the ratio of the power of a signal over the total background noise power, of our digitized signal is degraded when we perform bandpass sampling. (A general discussion of SNR is provided in <a href="#calibre_link-27">Appendix D</a>.)</p>
<p class="calibre3">Here’s the story. The spectrum of an analog lowpass signal, output from an analog anti-aliasing lowpass filter, is that shown in <a href="#calibre_link-1868">Figure 2-11(a)</a>. That lowpass signal contains some amount of background noise power. Now if an analog bandpass signal is likewise contaminated with background noise, as shown by the spectral plot in <a href="#calibre_link-1868">Figure 2-11(b)</a>, the bandpass-sampled signal will have an increased level of background noise as shown in <a href="#calibre_link-1868">Figure 2-11(c)</a>. That’s because all of the background spectral noise in <a href="#calibre_link-1868">Figure 2-11(b)</a> must now reside in the range of −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 to <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 in <a href="#calibre_link-1868">Figure 2-11(c)</a>. As such, the bandpass-sampled signal’s SNR is reduced (degraded).</p>
<p class="caption"><a id="calibre_link-1868"></a><strong class="calibre9">Figure 2-11</strong> Sampling SNR degradation: (a) analog lowpass signal spectral power; (b) analog bandpass signal spectral power; (c) bandpass-sampled signal spectral power when <em class="calibre7">m</em> = 1.</p>
<p class="image"><img src="images/000199.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">As detailed in reference <a href="#calibre_link-1869">[6]</a>, if the analog bandpass signal’s background noise spectral power level is relatively flat, as in <a href="#calibre_link-1868">Figure 2-11(b)</a>, the bandpass-sampled background noise power increases by a factor of <em class="calibre7">m</em> + 1 (the denominator of the right-side ratio in <a href="#calibre_link-1864">Eq. (2-10)</a>) while the desired signal power <em class="calibre7">P</em> remains unchanged. As such, the bandpass-sampled signal’s SNR, measured in decibels, is reduced by</p>
<p class="caption"><a id="calibre_link-2544"></a>(2-12)</p>
<p class="image"><img src="images/000423.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">below the SNR of the original analog signal. So for the <a href="#calibre_link-1868">Figure 2-11</a> example, when <em class="calibre7">m</em> = 1, the bandpass-sampled signal’s background noise power doubles, and the total bandpass-sampled signal’s SNR is <em class="calibre7">D</em><sub class="calibre12">SNR</sub> = 3 dB less than the analog bandpass signal’s SNR.</p>
<p class="calibre3"><a id="calibre_link-2545"></a>The notion of using decibels, a very convenient method of comparing the power of two signals (the two signals, in this case, are our bandpass signal and the background noise signal), is discussed in <a href="#calibre_link-296">Appendix E</a>.</p>
<p class="calibre3"><a id="calibre_link-587"></a></p>
<h3 class="calibre6">References</h3>
<p class="chapterendnote"><a id="calibre_link-1850"></a>[1] Crochiere, R., and Rabiner, L. “Optimum FIR Digital Implementations for Decimation, Interpolation, and Narrow-band Filtering,” <em class="calibre7">IEEE Trans. on Acoust. Speech, and Signal Proc.,</em> Vol. ASSP-23, No. 5, October 1975.</p>
<p class="chapterendnote"><a id="calibre_link-1854"></a>[2] Luke, H. “The Origins of the Sampling Theorem,” <em class="calibre7">IEEE Communications Magazine</em>, April 1999, pp. 106&ndash;109.</p>
<p class="chapterendnote"><a id="calibre_link-1855"></a>[3] Shannon, C. “A Mathematical Theory of Communication,” <em class="calibre7">Bell Sys. Tech. Journal</em>, Vol. 27, 1948, pp. 379&ndash;423, 623&ndash;656.</p>
<p class="chapterendnote"><a id="calibre_link-1857"></a>[4] Steyskal, H. “Digital Beamforming Antennas,” <em class="calibre7">Microwave Journal</em>, January 1987.</p>
<p class="chapterendnote"><a id="calibre_link-1858"></a>[5] Hill, G. “The Benefits of Undersampling,” <em class="calibre7">Electronic Design</em>, July 11, 1994.</p>
<p class="chapterendnote"><a id="calibre_link-1869"></a>[6] Vaughan, R., et al., “The Theory of Bandpass Sampling,” <em class="calibre7">IEEE Trans. on Signal Processing</em>, Vol. 39, No. 9, September 1991, pp. 1973&ndash;1984.</p>
<p class="calibre3"><a id="calibre_link-588"></a></p>
<h3 class="calibre6"><a id="calibre_link-2546" class="calibre5"></a>Chapter 2 Problems</h3>
<p class="indenthanging"><strong class="calibre9">2.1</strong> Suppose you have a mechanical clock that has a minute hand, but no hour hand. Next, suppose you took a photograph of the clock when the minute hand was pointed at 12:00 noon and then took additional photos every 55 minutes. Upon showing those photos, in time order, to someone:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What would that person think about the direction of motion of the minute hand as time advances?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> With the idea of <em class="calibre7">lowpass sampling</em> in mind, how often would you need to take photos, measured in photos/hour, so that the successive photos show proper (true) clockwise minute-hand rotation?</p>
<p class="indenthanging"><strong class="calibre9">2.2</strong> Assume we sampled a continuous <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal and obtained 100 <em class="calibre7">x</em>(<em class="calibre7">n</em>) time-domain samples. What important information (parameter that we need to know in order to analyze <em class="calibre7">x</em>(<em class="calibre7">t</em>)) is missing from the <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence?</p>
<p class="indenthanging"><strong class="calibre9">2.3</strong> National Instruments Corporation produces an analog-to-digital (A/D) converter (Model #NI-5154) that can sample (digitize) an analog signal at a sample rate of <em class="calibre7">f<sub class="calibre12">s</sub></em> = 2.0 GHz (gigahertz).</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the <em class="calibre7">t<sub class="calibre12">s</sub></em> period of the output samples of such a device?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Each A/D output sample is an 8-bit binary word (one byte), and the converter is able to store 256 million samples. What is the maximum time interval over which the converter can continuously sample an analog signal?</p>
<p class="indenthanging"><strong class="calibre9">2.4</strong> Consider a continuous time-domain sinewave, whose cyclic frequency is 500 Hz, defined by</p>
<p class="indenthanging1"><em class="calibre7">x</em>(<em class="calibre7">t</em>) = cos[2π(500)<em class="calibre7">t</em> + π/7].</p>
<p class="indentpara">Write the equation for the discrete <em class="calibre7">x</em>(<em class="calibre7">n</em>) sinewave sequence that results from sampling <em class="calibre7">x</em>(<em class="calibre7">t</em>) at an <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate of 4000 Hz.</p>
<p class="indentpara"><strong class="calibre9">Note:</strong> This problem is not “busy work.” If you ever want to model the <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal using software (MathCAD, MATLAB, Octave, etc.), then it is the desired <em class="calibre7">x</em>(<em class="calibre7">n</em>) equation that you program into your software.</p>
<p class="indenthanging"><strong class="calibre9">2.5</strong> If we sampled a single continuous sinewave whose frequency is <em class="calibre7">f</em><sub class="calibre12">o</sub> Hz, over what range must <em class="calibre7">t<sub class="calibre12">s</sub></em> (the time between digital samples) be to satisfy the Nyquist criterion? Express that <em class="calibre7">t<sub class="calibre12">s</sub></em> range in terms of <em class="calibre7">f</em><sub class="calibre12">o</sub>.</p>
<p class="indenthanging"><a id="calibre_link-2547"></a><strong class="calibre9">2.6</strong> Suppose we used the following statement to describe the Nyquist criterion for lowpass sampling: “When sampling a single continuous sinusoid (a single analog tone), we must obtain no fewer than <em class="calibre7">N</em> discrete samples per continuous sinewave cycle.” What is the value of this integer <em class="calibre7">N</em>?</p>
<p class="indenthanging"><strong class="calibre9">2.7</strong> The Nyquist criterion, regarding the sampling of lowpass signals, is sometimes stated as “The sampling rate <em class="calibre7">f<sub class="calibre12">s</sub></em> must be equal to, or greater than, twice the highest spectral component of the continuous signal being sampled.” Can you think of how a continuous sinusoidal signal can be sampled in accordance with that Nyquist criterion definition to yield all zero-valued discrete samples?</p>
<p class="indenthanging"><strong class="calibre9">2.8</strong> Stock market analysts study time-domain <em class="calibre7">charts</em> (plots) of the <em class="calibre7">closing price</em> of stock shares. A typical plot takes the form of that in <a href="#calibre_link-1870">Figure P2-8</a>, where instead of plotting discrete closing price sample values as dots, they draw straight lines connecting the closing price value samples. What is the <em class="calibre7">t<sub class="calibre12">s</sub></em> period for such stock market charts?</p>
<p class="caption"><a id="calibre_link-1870"></a><strong class="calibre9">Figure P2-8</strong></p>
<p class="image"><img src="images/000889.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">2.9</strong> Consider a continuous time-domain sinewave defined by</p>
<p class="indenthanging1"><em class="calibre7">x</em>(<em class="calibre7">t</em>) = cos(4000π<em class="calibre7">t</em>)</p>
<p class="indentpara">that was sampled to produce the discrete sinewave sequence defined by</p>
<p class="indenthanging1"><em class="calibre7">x</em>(<em class="calibre7">n</em>) = cos(<em class="calibre7">n</em>π/2).</p>
<p class="indentpara">What is the <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate, measured in Hz, that would result in sequence <em class="calibre7">x</em>(<em class="calibre7">n</em>)?</p>
<p class="indenthanging"><a id="calibre_link-2548"></a><strong class="calibre9">2.10</strong> Consider the two continuous signals defined by</p>
<p class="indenthanging1"><em class="calibre7">a</em>(<em class="calibre7">t</em>) = cos(4000π<em class="calibre7">t</em>) and <em class="calibre7">b</em>(<em class="calibre7">t</em>) = cos(200π<em class="calibre7">t</em>)</p>
<p class="indentpara">whose product yields the <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal shown in <a href="#calibre_link-1871">Figure P2-10</a>. What is the minimum <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate, measured in Hz, that would result in a sequence <em class="calibre7">x</em>(<em class="calibre7">n</em>) with no aliasing errors (no spectral replication overlap)?</p>
<p class="caption"><a id="calibre_link-1871"></a><strong class="calibre9">Figure P2-10</strong></p>
<p class="image"><img src="images/001353.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">2.11</strong> Consider a discrete time-domain sinewave sequence defined by</p>
<p class="indenthanging1"><em class="calibre7">x</em>(<em class="calibre7">n</em>) = sin(<em class="calibre7">n</em>π/4)</p>
<p class="indentpara">that was obtained by sampling an analog <em class="calibre7">x</em>(<em class="calibre7">t</em>) = sin(2π<em class="calibre7">f</em><sub class="calibre12">o</sub><em class="calibre7">t</em>) sinewave signal whose frequency is <em class="calibre7">f</em><sub class="calibre12">o</sub> Hz. If the sample rate of <em class="calibre7">x</em>(<em class="calibre7">n</em>) is <em class="calibre7">f<sub class="calibre12">s</sub></em> = 160 Hz, what are three possible positive frequency values, measured in Hz, for <em class="calibre7">f</em><sub class="calibre12">o</sub> that would result in sequence <em class="calibre7">x</em>(<em class="calibre7">n</em>)?</p>
<p class="indenthanging"><strong class="calibre9">2.12</strong> In the text we discussed the notion of <em class="calibre7">spectral folding</em> that can take place when an <em class="calibre7">x</em><sub class="calibre12">a</sub>(<em class="calibre7">t</em>) analog signal is sampled to produce a discrete <em class="calibre7">x</em><sub class="calibre12">d</sub>(<em class="calibre7">n</em>) sequence. We also stated that all of the analog spectral energy contained in <em class="calibre7">X</em><sub class="calibre12">a</sub>(<em class="calibre7">f</em>) will reside within the frequency range of ±<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 of the <em class="calibre7">X</em><sub class="calibre12">d</sub>(<em class="calibre7">f</em>) spectrum of the sampled <em class="calibre7">x</em><sub class="calibre12">d</sub>(<em class="calibre7">n</em>) sequence. Given those concepts, consider the spectrum of an analog signal shown in <a href="#calibre_link-1872">Figure P2-12(a)</a> whose spectrum is divided into the six segments marked as 1 to 6. Fill in the following table showing which of the A-to-F spectral segments of <em class="calibre7">X</em><sub class="calibre12">d</sub>(<em class="calibre7">f</em>), shown in <a href="#calibre_link-1872">Figure P2-12(b)</a>, are aliases of the 1-to-6 spectral segments of <em class="calibre7">X</em><sub class="calibre12">a</sub>(<em class="calibre7">f</em>).</p>
<p class="image"><img src="images/000647.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2549"></a><a id="calibre_link-1872"></a><strong class="calibre9">Figure P2-12</strong></p>
<p class="image"><img src="images/000381.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">2.13</strong> Consider the simple analog signal defined by <em class="calibre7">x</em>(<em class="calibre7">t</em>) = sin(2π700<em class="calibre7">t</em>) shown in <a href="#calibre_link-1873">Figure P2-13</a>. Draw the spectrum of <em class="calibre7">x</em>(<em class="calibre7">n</em>) showing all spectral components, labeling their frequency locations, in the frequency range −2<em class="calibre7">f<sub class="calibre12">s</sub></em> to +2<em class="calibre7">f<sub class="calibre12">s</sub></em>.</p>
<p class="caption"><a id="calibre_link-1873"></a><strong class="calibre9">Figure P2-13</strong></p>
<p class="image"><img src="images/000966.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">2.14</strong> The Nançay Observatory, in France, uses a radio astronomy receiver that generates a wideband analog <em class="calibre7">s</em>(<em class="calibre7">t</em>) signal whose spectral magnitude is represented in <a href="#calibre_link-1874">Figure P2-14</a>. The Nançay scientists bandpass sample the analog <em class="calibre7">s</em>(<em class="calibre7">t</em>) signal, using an analog-to-digital (A/D) converter to produce an <em class="calibre7">x</em>(<em class="calibre7">n</em>) discrete sequence, at a sample rate of <em class="calibre7">f<sub class="calibre12">s</sub></em> = 56 MHz.</p>
<p class="caption"><a id="calibre_link-2550"></a><a id="calibre_link-1874"></a><strong class="calibre9">Figure P2-14</strong></p>
<p class="image"><img src="images/000270.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Draw the spectrum of the <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence, <em class="calibre7">X</em>(<em class="calibre7">f</em>), showing its spectral energy over the frequency range −70 MHz to 70 MHz.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What is the center frequency of the first positive-frequency spectral replication in <em class="calibre7">X</em>(<em class="calibre7">f</em>)?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> How is your solution to Part (b) related to the <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate?</p>
<p class="indentpara"><strong class="calibre9">Hint:</strong> How is your solution to Part (b) related to <em class="calibre7">f<sub class="calibre12">s</sub></em>/2?</p>
<p class="indenthanging"><strong class="calibre9">2.15</strong> Think about the continuous (analog) signal <em class="calibre7">x</em>(<em class="calibre7">t</em>) that has the spectral magnitude shown in <a href="#calibre_link-1875">Figure P2-15</a>. What is the minimum <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate for <em class="calibre7">lowpass sampling</em> such that no spectral overlap occurs in the frequency range of 2 to 9 kHz in the spectrum of the discrete <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples?</p>
<p class="caption"><a id="calibre_link-1875"></a><strong class="calibre9">Figure P2-15</strong></p>
<p class="image"><img src="images/000347.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">2.16</strong> If a person wants to be classified as a soprano in classical opera, she must be able to sing notes in the frequency range of 247 Hz to 1175 Hz. What is the minimum <em class="calibre7">f<sub class="calibre12">s</sub></em> sampling rate allowable for <em class="calibre7">bandpass sampling</em> of the full audio spectrum of a singing soprano?</p>
<p class="indenthanging"><strong class="calibre9">2.17</strong> This problem requires the student to have some knowledge of electronics and how a mixer operates inside a radio. (The definition of a bandpass filter is given in <a href="#calibre_link-83">Appendix F</a>.) Consider the simplified version of what is called a <em class="calibre7">superheterodyne</em> digital radio depicted in <a href="#calibre_link-1876">Figure P2-17</a>.</p>
<p class="caption"><a id="calibre_link-2551"></a><a id="calibre_link-1876"></a><strong class="calibre9">Figure P2-17</strong></p>
<p class="image"><img src="images/000546.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> For what local oscillator frequency, <em class="calibre7">f</em><sub class="calibre12">LO</sub>, would an <em class="calibre7">image</em> (a copy, or duplication) of the <em class="calibre7">w</em>(<em class="calibre7">t</em>) signal’s spectrum be centered at 15 MHz (megahertz) in signal <em class="calibre7">u</em>(<em class="calibre7">t</em>)?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What is the purpose of the analog bandpass filter #2?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Fill in the following table showing all ranges of acceptable <em class="calibre7">f<sub class="calibre12">s</sub></em> bandpass sampling rates to avoid aliasing errors in the discrete <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence. Also list, in the rightmost column, for which values of <em class="calibre7">m</em> the sampled spectrum, centered at 15 MHz, will be inverted.</p>
<p class="image"><img src="images/001503.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(d)</strong> In digital receivers, to simplify AM and FM demodulation, it is advantageous to have the spectrum of the discrete <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence be centered at one-quarter of the sample rate. The text’s <a href="#calibre_link-1877">Eq. 2-11</a> describes how to achieve this situation. If we were constrained to have <em class="calibre7">f<sub class="calibre12">s</sub></em> equal to 12 MHz, what would be the maximum <em class="calibre7">f</em><sub class="calibre12">LO</sub> local oscillator frequency such that the spectra of <em class="calibre7">u</em>(<em class="calibre7">t</em>), <em class="calibre7">x</em>(<em class="calibre7">t</em>), and <em class="calibre7">x</em>(<em class="calibre7">n</em>) are centered at <em class="calibre7">f<sub class="calibre12">s</sub></em>/4? (Note: In this scenario, the <em class="calibre7">f</em><sub class="calibre12">c</sub> center frequency of analog bandpass filter #2 will no longer be 15 MHz.)</p>
<p class="indenthanging"><strong class="calibre9">2.18</strong> Think about the analog anti-aliasing filter given in <a href="#calibre_link-1878">Figure P2-18(a)</a>, having a one-sided bandwidth of <em class="calibre7">B</em> Hz. A wideband analog signal passed through that filter, and then sampled, would have an |<em class="calibre7">X</em>(<em class="calibre7">m</em>)| spectrum as shown in <a href="#calibre_link-1878">Figure P2-18(b)</a>, where the dashed curves represent spectral replications.</p>
<p class="caption"><a id="calibre_link-1878"></a><strong class="calibre9">Figure P2-18</strong></p>
<p class="image"><img src="images/000419.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara"><a id="calibre_link-2552"></a>Suppose we desired that all aliased spectral components in |<em class="calibre7">X</em>(<em class="calibre7">m</em>)| over our <em class="calibre7">B</em> Hz bandwidth of interest must be attenuated by at least 60 dB. Determine the equation, in terms of <em class="calibre7">B</em> and the <em class="calibre7">f<sub class="calibre12">s</sub></em> sampling rate, for the frequency at which the anti-aliasing filter must have an attenuation value of −60 dB. The solution to this problem gives us a useful <em class="calibre7">rule of thumb</em> we can use in specifying the desired performance of analog anti-aliasing filters.</p>
<p class="indenthanging"><strong class="calibre9">2.19</strong> This problem demonstrates a popular way of performing frequency down-conversion (converting a bandpass signal into a lowpass signal) by way of bandpass sampling. Consider the continuous 250-Hz-wide bandpass <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal whose spectral magnitude is shown in <a href="#calibre_link-1879">Figure P2-19</a>. Draw the spectrum, over the frequency range of −1.3<em class="calibre7">f<sub class="calibre12">s</sub></em> to +1.3<em class="calibre7">f<sub class="calibre12">s</sub></em>, of the <em class="calibre7">x</em>(<em class="calibre7">n</em>) sampled sequence obtained when <em class="calibre7">x</em>(<em class="calibre7">t</em>) is sampled at <em class="calibre7">f<sub class="calibre12">s</sub></em> = 1000 samples/second.</p>
<p class="caption"><a id="calibre_link-1879"></a><strong class="calibre9">Figure P2-19</strong></p>
<p class="image"><img src="images/000901.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">2.20</strong> Here’s a problem to test your understanding of bandpass sampling. Think about the continuous (analog) signal <em class="calibre7">x</em>(<em class="calibre7">t</em>) that has the spectral magnitude shown in <a href="#calibre_link-1880">Figure P2-20</a>.</p>
<p class="caption"><a id="calibre_link-2553"></a><a id="calibre_link-1880"></a><strong class="calibre9">Figure P2-20</strong></p>
<p class="image"><img src="images/001755.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the minimum <em class="calibre7">f</em><sub class="calibre12">c</sub> center frequency, in terms of <em class="calibre7">x</em>(<em class="calibre7">t</em>)’s bandwidth <em class="calibre7">B</em>, that enables bandpass sampling of <em class="calibre7">x</em>(<em class="calibre7">t</em>)? Show your work.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Given your results in Part (a) above, determine if it is possible to perform bandpass sampling of the full spectrum of the commercial AM (amplitude modulation) broadcast radio band in North America. Explain your solution.</p>
<p class="indenthanging"><strong class="calibre9">2.21</strong> Suppose we want to perform bandpass sampling of a continuous 5 kHz-wide bandpass signal whose spectral magnitude is shown in <a href="#calibre_link-1881">Figure P2-21</a>.</p>
<p class="caption"><a id="calibre_link-1881"></a><strong class="calibre9">Figure P2-21</strong></p>
<p class="image"><img src="images/000479.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">Fill in the following table showing the various ranges of acceptable <em class="calibre7">f<sub class="calibre12">s</sub></em> bandpass sampling rates, similar to the text’s <a href="#calibre_link-1865">Table 2-1</a>, to avoid aliasing errors. Also list, in the rightmost column, for which values of <em class="calibre7">m</em> the sampled spectrum in the vicinity of zero Hz is inverted.</p>
<p class="title"><a id="calibre_link-2554"></a>Acceptable Bandpass Sample Rate Ranges</p>
<p class="image"><img src="images/000538.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">2.22</strong> I recently encountered an Internet website that allegedly gave an algorithm for the minimum <em class="calibre7">f<sub class="calibre12">s</sub></em> bandpass sampling rate for an analog bandpass signal centered at <em class="calibre7">f<sub class="calibre12">c</sub></em> Hz, whose bandwidth is <em class="calibre7">B</em> Hz. The algorithm is</p>
<p class="image"><img src="images/000222.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">where</p>
<p class="image"><img src="images/001164.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">In the above notation, <img src="images/000990.jpg" alt="image" class="calibre2" /> means the integer part of <em class="calibre7">x</em>. Here’s the problem: Is the above <em class="calibre7">f<sub class="calibre12">s</sub></em><sub class="calibre12">,min</sub> algorithm correct in computing the <em class="calibre7">absolute minimum</em> possible nonaliasing <em class="calibre7">f<sub class="calibre12">s</sub></em> bandpass sampling rate for an analog bandpass signal centered at <em class="calibre7">f<sub class="calibre12">c</sub></em> Hz, whose bandwidth is <em class="calibre7">B</em> Hz? Verify your answer with an example.</p>
</div>


</body></html>
