<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><title>Understanding Digital Signal Processing</title>
<style type="text/css">
body {
  -webkit-text-size-adjust: 260%; /* text */
  zoom: 1.8; /* graphics */
  font-family: "BookerlyLCD";
}
a {
  color: #005090;
  text-decoration: none;
}
a {font-variant-numeric: oldstyle-nums proportional-nums;}
p.caption {font-variant-numeric: oldstyle-nums proportional-nums;}
</style>
</head><body>


<div class="calibre" id="calibre_link-572">
<p class="calibre3"><a id="calibre_link-2482"></a></p>
<h2 class="calibre8"><a id="calibre_link-2483" class="calibre5"></a>Contents</h2>
<p class="toc-chapter"><strong class="calibre9"><a href="#calibre_link-618">6 INFINITE IMPULSE RESPONSE FILTERS</a></strong></p>
<p class="toc-section"><a href="#calibre_link-619">6.1 An Introduction to Infinite Impulse Response Filters</a></p>
<p class="toc-section"><a href="#calibre_link-620">6.2 The Laplace Transform</a></p>
<p class="toc-section"><a href="#calibre_link-408">6.3 The <em class="calibre7">z</em>-Transform</a></p>
<p class="toc-section"><a href="#calibre_link-348">6.4 Using the <em class="calibre7">z</em>-Transform to Analyze IIR Filters</a></p>
<p class="toc-section"><a href="#calibre_link-621">6.5 Using Poles and Zeros to Analyze IIR Filters</a></p>
<p class="toc-section"><a href="#calibre_link-622">6.6 Alternate IIR Filter Structures</a></p>
<p class="toc-section"><a href="#calibre_link-623">6.7 Pitfalls in Building IIR Filters</a></p>
<p class="toc-section"><a href="#calibre_link-624">6.8 Improving IIR Filters with Cascaded Structures</a></p>
<p class="toc-section"><a href="#calibre_link-625">6.9 Scaling the Gain of IIR Filters</a></p>
<p class="toc-section"><a href="#calibre_link-626">6.10 Impulse Invariance IIR Filter Design Method</a></p>
<p class="toc-section"><a href="#calibre_link-627">6.11 Bilinear Transform IIR Filter Design Method</a></p>
<p class="toc-section"><a href="#calibre_link-628">6.12 Optimized IIR Filter Design Method</a></p>
<p class="toc-section"><a href="#calibre_link-629">6.13 A Brief Comparison of IIR and FIR Filters</a></p>
<p class="toc-section1"><a href="#calibre_link-630">References</a></p>

</div>


<div class="calibre" id="calibre_link-618">
<p class="calibre3"><a id="calibre_link-289"></a></p>
<h2 class="calibre8"><a id="calibre_link-2330" class="calibre5"></a>6 Infinite Impulse Response Filters</h2>
<p class="image"><img src="images/000970.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Infinite impulse response (IIR) digital filters are fundamentally different from FIR filters because practical IIR filters always require feedback. Where FIR filter output samples depend only on past input samples, each IIR filter output sample depends on previous input samples <em class="calibre7">and</em> previous filter output samples. IIR filters’ <em class="calibre7">memory</em> of past outputs is both a blessing and a curse. As in all feedback systems, perturbations at the IIR filter input could, depending on the design, cause the filter output to become unstable and oscillate indefinitely. This characteristic of possibly having an infinite duration of nonzero output samples, even if the input becomes all zeros, is the origin of the phrase <em class="calibre7"><a href="#calibre_link-741">infinite impulse response</a>.</em> It’s interesting at this point to know that, relative to FIR filters, IIR filters have more complicated structures (block diagrams), are harder to design and analyze, and do not have linear phase responses. Why in the world, then, would anyone use an IIR filter? Because they are very efficient. IIR filters require far fewer multiplications per filter output sample to achieve a given frequency magnitude response. From a hardware standpoint, this means that IIR filters can be very fast, allowing us to build real-time IIR filters that operate over much higher sample rates than FIR filters.<sup class="calibre10"><a id="calibre_link-743"></a><a href="#calibre_link-742">†</a></sup></p>
<p class="footnotes"><a id="calibre_link-742"></a><sup class="calibre11"><a href="#calibre_link-743">†</a></sup> At the end of this chapter, we briefly compare the advantages and disadvantages of IIR filters relative to FIR filters.</p>
<p class="calibre3">To illustrate the utility of IIR filters, <a href="#calibre_link-744">Figure 6-1</a> contrasts the frequency magnitude responses of what’s called a 4th-order lowpass IIR filter and the 19-tap FIR filter of <a href="#calibre_link-745">Figure 5-19(b)</a> from <a href="#calibre_link-79">Chapter 5</a>. Where the 19-tap FIR filter in <a href="#calibre_link-744">Figure 6-1</a> requires 19 multiplications per filter output sample, the 4th-order IIR filter requires only 9 multiplications for each filter output sample. Not only does the IIR filter give us reduced passband ripple and a <a id="calibre_link-2733"></a>sharper filter roll-off, it does so with less than half the multiplication workload of the FIR filter.</p>
<p class="caption"><a id="calibre_link-744"></a><strong class="calibre9">Figure 6-1</strong> Comparison of the frequency magnitude responses of a 19-tap lowpass FIR filter and a 4th-order lowpass IIR filter.</p>
<p class="image"><img src="images/000296.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Recall from <a href="#calibre_link-610">Section 5.3</a> that to force an FIR filter’s frequency response to have very steep transition regions, we had to design an FIR filter with a very long impulse response. The longer the impulse response, the more ideal our filter frequency response will become. From a hardware standpoint, the maximum number of FIR filter taps we can have (the length of the impulse response) depends on how fast our hardware can perform the required number of multiplications and additions to get a filter output value before the next filter input sample arrives. IIR filters, however, can be designed to have impulse responses that are longer than their number of taps! Thus, IIR filters can give us much better filtering for a given number of multiplications per output sample than FIR filters. With this in mind, let’s take a deep breath, flex our mathematical muscles, and learn about IIR filters.</p>
<p class="calibre3"><a id="calibre_link-619"></a></p>
<h3 class="calibre6">6.1 An Introduction to Infinite Impulse Response Filters</h3>
<p class="calibre3">Given a finite duration of nonzero input values, an IIR filter will have an infinite duration of nonzero output samples. So, if the IIR filter’s input suddenly becomes a sequence of all zeros, the filter’s output could conceivably remain nonzero forever. This peculiar attribute of IIR filters comes about because of the way they’re realized, i.e., the feedback structure of their delay units, multipliers, and adders. Understanding IIR filter structures is straightforward if we start by recalling the building blocks of an FIR filter. <a href="#calibre_link-746">Figure 6-2(a)</a> shows the now familiar structure of a 4-tap FIR digital filter that implements the time-domain FIR equation</p>
<p class="caption"><a id="calibre_link-747"></a>(6-1)</p>
<p class="image"><img src="images/000815.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2147"></a><a id="calibre_link-746"></a><strong class="calibre9">Figure 6-2</strong> FIR digital filter structures: (a) traditional FIR filter structure; (b) rearranged, but equivalent, FIR filter structure.</p>
<p class="image"><img src="images/000919.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Although not specifically called out as such in <a href="#calibre_link-79">Chapter 5</a>, <a href="#calibre_link-747">Eq. (6-1)</a> is known as a <em class="calibre7">difference equation</em>. To appreciate how past filter output samples are used in the structure of IIR filters, let’s begin by reorienting our FIR structure in <a href="#calibre_link-746">Figure 6-2(a)</a> to that of <a href="#calibre_link-746">Figure 6-2(b)</a>. Notice how the structures in <a href="#calibre_link-746">Figure 6-2</a> are computationally identical, and both are implementations, or realizations, of <a href="#calibre_link-747">Eq. (6-1)</a>.</p>
<p class="calibre3">We can now show how past filter output samples are combined with past input samples by using the IIR filter structure in <a href="#calibre_link-748">Figure 6-3</a>. Because IIR filters have two sets of coefficients, we’ll use the standard notation of the variables <em class="calibre7">b</em>(<em class="calibre7">k</em>) to denote the feedforward coefficients and the variables <em class="calibre7">a</em>(<em class="calibre7">k</em>) to indicate the feedback coefficients in <a href="#calibre_link-748">Figure 6-3</a>. OK, the difference equation describing the IIR filter in <a href="#calibre_link-748">Figure 6-3</a> is</p>
<p class="caption"><a id="calibre_link-2734"></a><a id="calibre_link-748"></a><strong class="calibre9">Figure 6-3</strong> IIR digital filter structure showing feedforward and feedback calculations.</p>
<p class="image"><img src="images/001547.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-749"></a>(6-2)</p>
<p class="image"><img src="images/001670.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Look at <a href="#calibre_link-748">Figure 6-3</a> and <a href="#calibre_link-749">Eq. (6-2)</a> carefully. It’s important to convince ourselves that <a href="#calibre_link-748">Figure 6-3</a> really is a valid implementation of <a href="#calibre_link-749">Eq. (6-2)</a> and that, conversely, difference equation <a href="#calibre_link-749">Eq. (6-2)</a> fully describes the IIR filter structure in <a href="#calibre_link-748">Figure 6-3</a>. Keep in mind, now, that the sequence <em class="calibre7">y</em>(<em class="calibre7">n</em>) in <a href="#calibre_link-748">Figure 6-3</a> is not the same <em class="calibre7">y</em>(<em class="calibre7">n</em>) sequence that’s shown in <a href="#calibre_link-746">Figure 6-2</a>. The <em class="calibre7">d</em>(<em class="calibre7">n</em>) sequence in <a href="#calibre_link-748">Figure 6-3</a> is equal to the <em class="calibre7">y</em>(<em class="calibre7">n</em>) sequence in <a href="#calibre_link-746">Figure 6-2</a>.</p>
<p class="calibre3">By now you’re probably wondering, “Just how do we determine those <em class="calibre7">a</em>(<em class="calibre7">k</em>) and <em class="calibre7">b</em>(<em class="calibre7">k</em>) IIR filter coefficients if we actually want to design an IIR filter?” Well, fasten your seat belt because this is where we get serious about understanding IIR filters. Recall from the last chapter concerning the window method of lowpass FIR filter design that we defined the frequency response of our desired FIR filter, took the inverse Fourier transform of that frequency response, and then shifted that transform result to get the filter’s time-domain impulse response. Happily, due to the nature of transversal FIR filters, the desired <em class="calibre7">h</em>(<em class="calibre7">k</em>) filter coefficients turned out to be exactly equal to the impulse response sequence. Following that same procedure with IIR filters, we could define the desired frequency response of our IIR filter and then take <a id="calibre_link-2013"></a>the inverse Fourier transform of that response to yield the filter’s time-domain impulse response. The bad news is that there’s no direct method for computing the IIR filter’s <em class="calibre7">a</em>(<em class="calibre7">k</em>) and <em class="calibre7">b</em>(<em class="calibre7">k</em>) coefficients from the impulse response! Unfortunately, the FIR filter design techniques that we’ve learned so far simply cannot be used to design IIR filters. Fortunately for us, this wrinkle can be ironed out by using one of several available methods of designing IIR filters.</p>
<p class="calibre3">Standard IIR filter design techniques fall into three basic classes: the impulse invariance, bilinear transform, and optimization methods. These design methods use a discrete sequence, mathematical transformation process known as the <em class="calibre7">z</em>-transform whose origin is the Laplace transform traditionally used in the analyzing of continuous systems. With that in mind, let’s start this IIR filter analysis and design discussion by briefly reacquainting ourselves with the fundamentals of the Laplace transform.</p>
<p class="calibre3"><a id="calibre_link-620"></a></p>
<h3 class="calibre6">6.2 The Laplace Transform</h3>
<p class="calibre3">The Laplace transform is a mathematical method of solving linear differential equations that has proved very useful in the fields of engineering and physics. This transform technique, as it’s used today, originated from the work of the brilliant English physicist Oliver Heaviside.<sup class="calibre10"><a id="calibre_link-751"></a><a href="#calibre_link-750">†</a></sup> The fundamental process of using the Laplace transform goes something like the following:</p>
<p class="footnotes"><a id="calibre_link-750"></a><sup class="calibre11"><a href="#calibre_link-751">†</a></sup> Heaviside (1850&ndash;1925), who was interested in electrical phenomena, developed an efficient algebraic process of solving differential equations. He initially took a lot of heat from his contemporaries because they thought his work was not sufficiently justified from a mathematical standpoint. However, the discovered correlation of Heaviside’s methods with the rigorous mathematical treatment of the French mathematician Marquis Pierre Simon de Laplace’s (1749&ndash;1827) operational calculus verified the validity of Heaviside’s techniques.</p>
<p class="indenthanging2"><strong class="calibre9">Step 1:</strong> A time-domain differential equation is written that describes the input/output relationship of a physical system (and we want to find the output function that satisfies that equation with a given input).</p>
<p class="indenthanging2"><strong class="calibre9">Step 2:</strong> The differential equation is Laplace transformed, converting it to an algebraic equation.</p>
<p class="indenthanging2"><strong class="calibre9">Step 3:</strong> Standard algebraic techniques are used to determine the desired output function’s equation in the Laplace domain.</p>
<p class="indenthanging2"><strong class="calibre9">Step 4:</strong> The desired Laplace output equation is, then, inverse Laplace transformed to yield the desired time-domain output function’s equation.</p>
<p class="calibre3">This procedure, at first, seems cumbersome because it forces us to <em class="calibre7">go the long way around</em>, instead of just solving a differential equation directly. The justification for using the Laplace transform is that although solving differential <a id="calibre_link-2012"></a>equations by classical methods is a very powerful analysis technique for all but the most simple systems, it can be tedious and (for some of us) error prone. The reduced complexity of using algebra outweighs the extra effort needed to perform the required forward and inverse Laplace transformations. This is especially true now that tables of forward and inverse Laplace transforms exist for most of the commonly encountered time functions. Well-known properties of the Laplace transform also allow practitioners to decompose complicated time functions into combinations of simpler functions and, then, use the tables. (Tables of Laplace transforms allow us to translate quickly back and forth between a time function and its Laplace transform&mdash;analogous to, say, a German-English dictionary if we were studying the German language.<sup class="calibre10"><a id="calibre_link-753"></a><a href="#calibre_link-752">†</a></sup>) Let’s briefly look at a few of the more important characteristics of the Laplace transform that will prove useful as we make our way toward the discrete <em class="calibre7">z-</em>transform used to design and analyze IIR digital filters.</p>
<p class="footnotes"><a id="calibre_link-752"></a><sup class="calibre11"><a href="#calibre_link-753">†</a></sup> Although tables of commonly encountered Laplace transforms are included in almost every system analysis textbook, very comprehensive tables are also available[<a href="#calibre_link-754">1</a>&ndash;<a href="#calibre_link-755">3</a>].</p>
<p class="calibre3">The Laplace transform of a continuous time-domain function <em class="calibre7">f</em>(<em class="calibre7">t</em>), where <em class="calibre7">f</em>(<em class="calibre7">t</em>) is defined only for positive time (<em class="calibre7">t</em> &gt; 0), is expressed mathematically as</p>
<p class="caption"><a id="calibre_link-756"></a>(6-3)</p>
<p class="image"><img src="images/000695.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><em class="calibre7">F</em>(<em class="calibre7">s</em>) is called “the Laplace transform of <em class="calibre7">f</em>(<em class="calibre7">t</em>),” and the variable <em class="calibre7">s</em> is the complex number</p>
<p class="caption"><a id="calibre_link-757"></a>(6-4)</p>
<p class="image"><img src="images/001556.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">A more general expression for the Laplace transform, called the <em class="calibre7">bilateral</em> or <em class="calibre7">two-sided transform,</em> uses negative infinity (−∞) as the lower limit of integration. However, for the systems that we’ll be interested in, where system conditions for negative time (<em class="calibre7">t</em> &lt; 0) are not needed in our analysis, the <em class="calibre7">one-sided</em> <a href="#calibre_link-756">Eq. (6-3)</a> applies. Those systems, often referred to as <em class="calibre7">causal systems,</em> may have initial conditions at <em class="calibre7">t</em> = 0 that must be taken into account (velocity of a mass, charge on a capacitor, temperature of a body, etc.), but we don’t need to know what the system was doing prior to <em class="calibre7">t</em> = 0.</p>
<p class="calibre3">In <a href="#calibre_link-757">Eq. (6-4)</a>, σ is a real number and ω is frequency in radians/second. Because <em class="calibre7">e<sup class="calibre10">−st</sup></em> is dimensionless, the exponent term <em class="calibre7">s</em> must have the dimension of 1/time, or frequency. That’s why the Laplace variable <em class="calibre7">s</em> is often called a complex frequency.</p>
<p class="calibre3">To put <a href="#calibre_link-756">Eq. (6-3)</a> into words, we can say that it requires us to multiply, point for point, the function <em class="calibre7">f</em>(<em class="calibre7">t</em>) by the complex function <em class="calibre7">e<sup class="calibre10">−st</sup></em> for a given value of <em class="calibre7">s.</em> (We’ll soon see that using the function <em class="calibre7">e<sup class="calibre10">−st</sup></em> here is not accidental; <em class="calibre7">e<sup class="calibre10">−st</sup></em> is <a id="calibre_link-2735"></a>used because it’s the general form for the solution of linear differential equations.) After the point-for-point multiplications, we find the area under the curve of the function <em class="calibre7">f</em>(<em class="calibre7">t</em>)<em class="calibre7">e<sup class="calibre10">−st</sup></em> by summing all the products. That area, a complex number, represents the value of the Laplace transform for the particular value of <em class="calibre7">s</em> = σ + <em class="calibre7">j</em>ω chosen for the original multiplications. If we were to go through this process for all values of <em class="calibre7">s,</em> we’d have a full description of <em class="calibre7">F</em>(<em class="calibre7">s</em>) for every value of <em class="calibre7">s</em>.</p>
<p class="calibre3">I like to think of the Laplace transform as a continuous function, where the complex value of that function for a particular value of <em class="calibre7">s</em> is a correlation of <em class="calibre7">f</em>(<em class="calibre7">t</em>) and a damped complex <em class="calibre7">e<sup class="calibre10">−st</sup></em> sinusoid whose frequency is ω and whose damping factor is σ. What do these complex sinusoids look like? Well, they are rotating phasors described by</p>
<p class="caption"><a id="calibre_link-758"></a>(6-5)</p>
<p class="image"><img src="images/000580.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">From our knowledge of complex numbers, we know that <em class="calibre7">e<sup class="calibre10">−j</sup></em><sup class="calibre10">ω<em class="calibre7">t</em></sup> is a unity-magnitude phasor rotating clockwise around the origin of a complex plane at a frequency of ω radians/second. The denominator of <a href="#calibre_link-758">Eq. (6-5)</a> is a real number whose value is one at time <em class="calibre7">t</em> = 0. As <em class="calibre7">t</em> increases, the denominator <em class="calibre7">e</em><sup class="calibre10">σ<em class="calibre7">t</em></sup> gets larger (when σ is positive), and the complex <em class="calibre7">e<sup class="calibre10">−st</sup></em> phasor’s magnitude gets smaller as the phasor rotates on the complex plane. The tip of that phasor traces out a curve spiraling in toward the origin of the complex plane. One way to visualize a complex sinusoid is to consider its real and imaginary parts individually. We do this by expressing the complex <em class="calibre7">e<sup class="calibre10">−st</sup></em> sinusoid from <a href="#calibre_link-758">Eq. (6-5)</a> in rectangular form as</p>
<p class="caption"><a id="calibre_link-2736"></a>(6-5′)</p>
<p class="image"><img src="images/001441.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-759">Figure 6-4</a> shows the real parts (cosine) of several complex sinusoids with different frequencies and different damping factors. In <a href="#calibre_link-759">Figure 6-4(a)</a>, the complex sinusoid’s frequency is the arbitrary ω′, and the damping factor is the arbitrary σ′. So the real part of <em class="calibre7">F</em>(<em class="calibre7">s</em>), at <em class="calibre7">s</em> = σ′ + <em class="calibre7">j</em>ω′, is equal to the correlation of <em class="calibre7">f</em>(<em class="calibre7">t</em>) and the wave in <a href="#calibre_link-759">Figure 6-4(a)</a>. For different values of <em class="calibre7">s,</em> we’ll correlate <em class="calibre7">f</em>(<em class="calibre7">t</em>) with different complex sinusoids as shown in <a href="#calibre_link-759">Figure 6-4</a>. (As we’ll see, this correlation is very much like the correlation of <em class="calibre7">f</em>(<em class="calibre7">t</em>) with various sine and cosine waves when we were calculating the discrete Fourier transform.) Again, the real part of <em class="calibre7">F</em>(<em class="calibre7">s</em>), for a particular value of <em class="calibre7">s,</em> is the correlation of <em class="calibre7">f</em>(<em class="calibre7">t</em>) with a cosine wave of frequency ω and a damping factor of σ, and the imaginary part of <em class="calibre7">F</em>(<em class="calibre7">s</em>) is the correlation of <em class="calibre7">f</em>(<em class="calibre7">t</em>) with a sinewave of frequency ω and a damping factor of σ.</p>
<p class="caption"><a id="calibre_link-759"></a><strong class="calibre9">Figure 6-4</strong> Real part (cosine) of various <em class="calibre7">e<sup class="calibre10">−st</sup></em> functions, where <em class="calibre7">s</em> = σ + <em class="calibre7">j</em>ω, to be correlated with <em class="calibre7">f</em>(<em class="calibre7">t</em>).</p>
<p class="image"><img src="images/000364.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Now, if we associate each of the different values of the complex <em class="calibre7">s</em> variable with a point on a complex plane, rightfully called the <em class="calibre7">s</em>-plane, we could plot the real part of the <em class="calibre7">F</em>(<em class="calibre7">s</em>) correlation as a surface above (or below) that <a id="calibre_link-2737"></a><em class="calibre7">s-</em>plane and generate a second plot of the imaginary part of the <em class="calibre7">F</em>(<em class="calibre7">s</em>) correlation as a surface above (or below) the <em class="calibre7">s-</em>plane. We can’t plot the full complex <em class="calibre7">F</em>(<em class="calibre7">s</em>) surface on paper because that would require four dimensions. That’s because <em class="calibre7">s</em> is complex, requiring two dimensions, and <em class="calibre7">F</em>(<em class="calibre7">s</em>) is itself complex and also requires two dimensions. What we can do, however, is graph the magnitude |<em class="calibre7">F</em>(<em class="calibre7">s</em>)| as a function of <em class="calibre7">s</em> because this graph requires only three dimensions. Let’s do that as we demonstrate this notion of an |<em class="calibre7">F</em>(<em class="calibre7">s</em>)| surface by illustrating the Laplace transform in a tangible way.</p>
<p class="calibre3">Say, for example, that we have the linear system shown in <a href="#calibre_link-760">Figure 6-5</a>. Also, let’s assume that we can relate the <em class="calibre7">x</em>(<em class="calibre7">t</em>) input and the <em class="calibre7">y</em>(<em class="calibre7">t</em>) output of the linear time-invariant physical system in <a href="#calibre_link-760">Figure 6-5</a> with the following messy homogeneous constant-coefficient differential equation:</p>
<p class="caption"><a id="calibre_link-760"></a><strong class="calibre9">Figure 6-5</strong> System described by <a href="#calibre_link-761">Eq. (6-6)</a>. The system’s input and output are the continuous-time functions <em class="calibre7">x</em>(<em class="calibre7">t</em>) and <em class="calibre7">y</em>(<em class="calibre7">t</em>) respectively.</p>
<p class="image"><img src="images/000984.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2738"></a><a id="calibre_link-761"></a>(6-6)</p>
<p class="image"><img src="images/000508.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We’ll use the Laplace transform toward our goal of figuring out how the system will behave when various types of input functions are applied, i.e., what the <em class="calibre7">y</em>(<em class="calibre7">t</em>) output will be for any given <em class="calibre7">x</em>(<em class="calibre7">t</em>) input.</p>
<p class="calibre3">Let’s slow down here and see exactly what <a href="#calibre_link-760">Figure 6-5</a> and <a href="#calibre_link-761">Eq. (6-6)</a> are telling us. First, if the system is time invariant, then the <em class="calibre7">a<sub class="calibre12">n</sub></em> and <em class="calibre7">b<sub class="calibre12">n</sub></em> coefficients in <a href="#calibre_link-761">Eq. (6-6)</a> are constant. They may be positive or negative, zero, real or complex, but they do not change with time. If the system is electrical, the coefficients might be related to capacitance, inductance, and resistance. If the system is mechanical with masses and springs, the coefficients could be related to mass, coefficient of damping, and coefficient of resilience. Then, again, if the system is thermal with masses and insulators, the coefficients would be related to thermal capacity and thermal conductance. To keep this discussion general, though, we don’t really care what the coefficients actually represent.</p>
<p class="calibre3">OK, <a href="#calibre_link-761">Eq. (6-6)</a> also indicates that, ignoring the coefficients for the moment, the sum of the <em class="calibre7">y</em>(<em class="calibre7">t</em>) output plus derivatives of that output is equal to the sum of the <em class="calibre7">x</em>(<em class="calibre7">t</em>) input plus the derivative of that input. Our problem is to determine exactly what input and output functions satisfy the elaborate relationship in <a href="#calibre_link-761">Eq. (6-6)</a>. (For the stout-hearted, classical methods of solving differential equations could be used here, but the Laplace transform makes the problem much simpler for our purposes.) Thanks to Laplace, the complex exponential time function of <em class="calibre7">e<sup class="calibre10">st</sup></em> is the one we’ll use. It has the beautiful property that it can be differentiated any number of times without destroying its original form. That is,</p>
<p class="caption"><a id="calibre_link-762"></a>(6-7)</p>
<p class="image"><img src="images/001337.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we let <em class="calibre7">x</em>(<em class="calibre7">t</em>) and <em class="calibre7">y</em>(<em class="calibre7">t</em>) be functions of <em class="calibre7">e<sup class="calibre10">st</sup></em>, <em class="calibre7">x</em>(<em class="calibre7">e<sup class="calibre10">st</sup></em>) and <em class="calibre7">y</em>(<em class="calibre7">e<sup class="calibre10">st</sup></em>), and use the properties shown in <a href="#calibre_link-762">Eq. (6-7)</a>, <a href="#calibre_link-761">Eq. (6-6)</a> becomes</p>
<p class="caption"><a id="calibre_link-763"></a>(6-8)</p>
<p class="image"><img src="images/000373.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2357"></a>Although it’s simpler than <a href="#calibre_link-761">Eq. (6-6)</a>, we can further simplify the relationship in the last line in <a href="#calibre_link-763">Eq. (6-8)</a> by considering the ratio of <em class="calibre7">y</em>(<em class="calibre7">e<sup class="calibre10">st</sup></em>) over <em class="calibre7">x</em>(<em class="calibre7">e<sup class="calibre10">st</sup></em>) as the Laplace transfer function of our system in <a href="#calibre_link-760">Figure 6-5</a>. If we call that ratio of polynomials the transfer function <em class="calibre7">H</em>(<em class="calibre7">s</em>),</p>
<p class="caption"><a id="calibre_link-795"></a>(6-9)</p>
<p class="image"><img src="images/001219.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To indicate that the original <em class="calibre7">x</em>(<em class="calibre7">t</em>) and <em class="calibre7">y</em>(<em class="calibre7">t</em>) have the identical functional form of <em class="calibre7">e<sup class="calibre10">st</sup></em>, we can follow the standard Laplace notation of capital letters and show the transfer function as</p>
<p class="caption"><a id="calibre_link-766"></a>(6-10)</p>
<p class="image"><img src="images/000259.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where the output <em class="calibre7">Y</em>(<em class="calibre7">s</em>) is given by</p>
<p class="caption"><a id="calibre_link-764"></a>(6-11)</p>
<p class="image"><img src="images/001197.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-764">Equation (6-11)</a> leads us to redraw the original system diagram in a form that highlights the definition of the transfer function <em class="calibre7">H</em>(<em class="calibre7">s</em>) as shown in <a href="#calibre_link-765">Figure 6-6</a>.</p>
<p class="caption"><a id="calibre_link-765"></a><strong class="calibre9">Figure 6-6</strong> Linear system described by <a href="#calibre_link-766">Eqs. (6-10)</a> and <a href="#calibre_link-764">(6-11)</a>. The system’s input is the Laplace function <em class="calibre7">X</em>(<em class="calibre7">s</em>), its output is the Laplace function <em class="calibre7">Y</em>(<em class="calibre7">s</em>), and the system transfer function is <em class="calibre7">H</em>(<em class="calibre7">s</em>).</p>
<p class="image"><img src="images/001619.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The cautious reader may be wondering, “Is it really valid to use this Laplace analysis technique when it’s strictly based on the system’s <em class="calibre7">x</em>(<em class="calibre7">t</em>) input being some function of <em class="calibre7">e<sup class="calibre10">st</sup></em>, or <em class="calibre7">x</em>(<em class="calibre7">e<sup class="calibre10">st</sup></em>)?” The answer is that the Laplace analysis technique, based on the complex exponential <em class="calibre7">x</em>(<em class="calibre7">e<sup class="calibre10">st</sup></em>), is valid because all practical <em class="calibre7">x</em>(<em class="calibre7">t</em>) input functions can be represented with complex exponentials, for example,</p>
<p class="indenthangingb">• a constant, <em class="calibre7">c</em> = <em class="calibre7">ce</em><sup class="calibre10">0<em class="calibre7">t</em></sup>,</p>
<p class="indenthangingb">• sinusoids, sin(ω<em class="calibre7">t</em>) = (<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω<em class="calibre7">t</em></sup> − <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>ω<em class="calibre7">t</em></sup>)/2<em class="calibre7">j</em> or cos(ω<em class="calibre7">t</em>) = (<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω<em class="calibre7">t</em></sup> + <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>ω<em class="calibre7">t</em></sup>)/2,</p>
<p class="indenthangingb">• a monotonic exponential, <em class="calibre7">e<sup class="calibre10">at</sup></em>, and</p>
<p class="indenthangingb">• an exponentially varying sinusoid, <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">at</em></sup> cos(ω<em class="calibre7">t</em>).</p>
<p class="calibre3"><a id="calibre_link-2335"></a>With that said, if we know a system’s transfer function <em class="calibre7">H</em>(<em class="calibre7">s</em>), we can take the Laplace transform of any <em class="calibre7">x</em>(<em class="calibre7">t</em>) input to determine <em class="calibre7">X</em>(<em class="calibre7">s</em>), multiply that <em class="calibre7">X</em>(<em class="calibre7">s</em>) by <em class="calibre7">H</em>(<em class="calibre7">s</em>) to get <em class="calibre7">Y</em>(<em class="calibre7">s</em>), and then inverse Laplace transform <em class="calibre7">Y</em>(<em class="calibre7">s</em>) to yield the time-domain expression for the output <em class="calibre7">y</em>(<em class="calibre7">t</em>). In practical situations, however, we usually don’t go through all those analytical steps because it’s the system’s transfer function <em class="calibre7">H</em>(<em class="calibre7">s</em>) in which we’re most interested. Being able to express <em class="calibre7">H</em>(<em class="calibre7">s</em>) mathematically or graph the surface |<em class="calibre7">H</em>(<em class="calibre7">s</em>)| as a function of <em class="calibre7">s</em> will tell us the two most important properties we need to know about the system under analysis: is the system stable, and if so, what is its frequency response?</p>
<p class="calibre3">“But wait a minute,” you say. “<a href="#calibre_link-766">Equations (6-10)</a> and <a href="#calibre_link-764">(6-11)</a> indicate that we have to know the <em class="calibre7">Y</em>(<em class="calibre7">s</em>) output before we can determine <em class="calibre7">H</em>(<em class="calibre7">s</em>)!” Not really. All we really need to know is the time-domain differential equation like that in <a href="#calibre_link-761">Eq. (6-6)</a>. Next we take the Laplace transform of that differential equation and rearrange the terms to get the <em class="calibre7">H</em>(<em class="calibre7">s</em>) ratio in the form of <a href="#calibre_link-766">Eq. (6-10)</a>. With practice, systems designers can look at a diagram (block, circuit, mechanical, whatever) of their system and promptly write the Laplace expression for <em class="calibre7">H</em>(<em class="calibre7">s</em>). Let’s use the concept of the Laplace transfer function <em class="calibre7">H</em>(<em class="calibre7">s</em>) to determine the stability and frequency response of simple continuous systems.</p>
<p class="calibre3"><a id="calibre_link-2739"></a></p>
<h4 class="calibre13">6.2.1 Poles and Zeros on the <em class="calibre7">s-</em>Plane and Stability</h4>
<p class="calibre3">One of the most important characteristics of any system involves the concept of stability. We can think of a system as stable if, given any bounded input, the output will always be bounded. This sounds like an easy condition to achieve because most systems we encounter in our daily lives are indeed stable. Nevertheless, we have all experienced instability in a system containing feedback. Recall the annoying <em class="calibre7">howl</em> when a public address system’s microphone is placed too close to the loudspeaker. A sensational example of an unstable system occurred in western Washington when the first Tacoma Narrows Bridge began oscillating on the afternoon of November 7, 1940. Those oscillations, caused by 42 mph winds, grew in amplitude until the bridge destroyed itself. For IIR digital filters with their built-in feedback, instability would result in a filter output that’s not at all representative of the filter input; that is, our filter output samples would not be a filtered version of the input; they’d be some strange oscillating or pseudo-random values&mdash;a situation we’d like to avoid if we can, right? Let’s see how.</p>
<p class="calibre3">We can determine a continuous system’s stability by examining several different examples of <em class="calibre7">H</em>(<em class="calibre7">s</em>) transfer functions associated with linear time-invariant systems. Assume that we have a system whose Laplace transfer function is of the form of <a href="#calibre_link-766">Eq. (6-10)</a>, the coefficients are all real, and the <a id="calibre_link-2740"></a>coefficients <em class="calibre7">b</em><sub class="calibre12">1</sub> and <em class="calibre7">a</em><sub class="calibre12">2</sub> are equal to zero. We’ll call that Laplace transfer function <em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">s</em>), where</p>
<p class="caption"><a id="calibre_link-767"></a>(6-12)</p>
<p class="image"><img src="images/000669.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Notice that if <em class="calibre7">s</em> = −<em class="calibre7">a</em><sub class="calibre12">0</sub>/<em class="calibre7">a</em><sub class="calibre12">1</sub>, the denominator in <a href="#calibre_link-767">Eq. (6-12)</a> equals zero and <em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">s</em>) would have an infinite magnitude. This <em class="calibre7">s</em> = −<em class="calibre7">a</em><sub class="calibre12">0</sub>/<em class="calibre7">a</em><sub class="calibre12">1</sub> point on the <em class="calibre7">s-</em>plane is called a <em class="calibre7">pole,</em> and that pole’s location is shown by the “<em class="calibre7">x</em>” in <a href="#calibre_link-768">Figure 6-7(a)</a>. Notice that the pole is located exactly on the negative portion of the real σ axis. If the system described by <em class="calibre7">H</em><sub class="calibre12">1</sub> were at rest and we disturbed it with an impulse like <em class="calibre7">x</em>(<em class="calibre7">t</em>) input at time <em class="calibre7">t</em> = 0, its continuous time-domain <em class="calibre7">y</em>(<em class="calibre7">t</em>) output would be the damped exponential curve shown in <a href="#calibre_link-768">Figure 6-7(b)</a>. We can see that <em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">s</em>) is stable because its <em class="calibre7">y</em>(<em class="calibre7">t</em>) output approaches zero as time passes. By the way, the distance of the pole from the σ = 0 axis, <em class="calibre7">a</em><sub class="calibre12">0</sub>/<em class="calibre7">a</em><sub class="calibre12">1</sub> for our <em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">s</em>), gives the decay rate of the <em class="calibre7">y</em>(<em class="calibre7">t</em>) impulse response. To illustrate why the term <em class="calibre7">pole</em> is appropriate, <a href="#calibre_link-769">Figure 6-8(b)</a> depicts the three-dimensional surface of |<em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">s</em>)| above the <em class="calibre7">s-</em>plane. Look at <a href="#calibre_link-769">Figure 6-8(b)</a> carefully and see how we’ve reoriented the <em class="calibre7">s-</em>plane axis. This new axis orientation allows us to see how the <em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">s</em>) system’s frequency magnitude response can be determined from its three-dimensional <em class="calibre7">s-</em>plane surface. If we examine the |<em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">s</em>)| surface at σ = 0, we get the bold curve in <a href="#calibre_link-769">Figure 6-8(b)</a>. That bold curve, the intersection of the vertical σ = 0 plane (the <em class="calibre7">j</em>ω axis plane) and the |<em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">s</em>)| surface, gives us the frequency magnitude response |<em class="calibre7">H</em><sub class="calibre12">1</sub>(ω)| of the system&mdash;and that’s one of the things we’re after here. The bold |<em class="calibre7">H</em><sub class="calibre12">1</sub>(ω)| curve in <a href="#calibre_link-769">Figure 6-8(b)</a> is shown in a more conventional way in <a href="#calibre_link-769">Figure 6-8(c)</a>. <a href="#calibre_link-769">Figures 6-8(b)</a> and <a href="#calibre_link-769">6-8(c)</a> highlight the very important property that the Laplace transform is a more general case of the Fourier transform because if σ = 0, then <em class="calibre7">s</em> = <em class="calibre7">j</em>ω. In this case, the |<em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">s</em>)| curve for σ = 0 above the <em class="calibre7">s-</em>plane becomes the |<em class="calibre7">H</em><sub class="calibre12">1</sub>(ω)| curve above the <em class="calibre7">j</em>ω axis in <a href="#calibre_link-769">Figure 6-8(c)</a>.</p>
<p class="caption"><a id="calibre_link-768"></a><strong class="calibre9">Figure 6-7</strong> Descriptions of <em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">s</em>): (a) pole located at <em class="calibre7">s</em> = σ + <em class="calibre7">j</em>ω = −<em class="calibre7">a</em><sub class="calibre12">0</sub>/<em class="calibre7">a</em><sub class="calibre12">1</sub> + <em class="calibre7">j</em>0 on the <em class="calibre7">s-</em>plane; (b) time-domain <em class="calibre7">y(t</em>) impulse response of the system.</p>
<p class="image"><img src="images/000433.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-769"></a><strong class="calibre9">Figure 6-8</strong> Further depictions of <em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">s</em>): (a) pole located at σ = −<em class="calibre7">a</em><sub class="calibre12">0</sub>/<em class="calibre7">a</em><sub class="calibre12">1</sub> on the <em class="calibre7">s-</em>plane; (b) |<em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">s</em>)| surface; (c) curve showing the intersection of the |<em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">s</em>)| surface and the vertical σ = 0 plane. This is the conventional depiction of the |<em class="calibre7">H</em><sub class="calibre12">1</sub>(ω)| frequency magnitude response.</p>
<p class="image"><img src="images/000443.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Another common system transfer function leads to an impulse response that oscillates. Let’s think about an alternate system whose Laplace transfer <a id="calibre_link-2358"></a>function is of the form of <a href="#calibre_link-766">Eq. (6-10)</a>, the coefficient <em class="calibre7">b</em><sub class="calibre12">0</sub> equals zero, and the coefficients lead to complex terms when the denominator polynomial is factored. We’ll call this particular 2nd-order transfer function <em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">s</em>), where</p>
<p class="caption"><a id="calibre_link-770"></a>(6-13)</p>
<p class="image"><img src="images/000690.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2410"></a>(By the way, when a transfer function has the Laplace variable <em class="calibre7">s</em> in both the numerator and denominator, the <em class="calibre7"><a href="#calibre_link-344">order</a></em> of the overall function is defined by the largest exponential order of <em class="calibre7">s</em> in either the numerator or the denominator polynomial. So our <em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">s</em>) is a 2nd-order transfer function.) To keep the following equations from becoming too messy, let’s factor its denominator and rewrite <a href="#calibre_link-770">Eq. (6-13)</a> as</p>
<p class="caption"><a id="calibre_link-771"></a>(6-14)</p>
<p class="image"><img src="images/001714.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">A</em> = <em class="calibre7">b</em><sub class="calibre12">1</sub>/<em class="calibre7">a</em><sub class="calibre12">2</sub>, <em class="calibre7">p</em> = <em class="calibre7">p</em><sub class="calibre12">real</sub> + <em class="calibre7">jp</em><sub class="calibre12">imag</sub>, and <em class="calibre7">p</em><sup class="calibre10">*</sup> = <em class="calibre7">p</em><sub class="calibre12">real</sub> − <em class="calibre7">jp<sub class="calibre12">i</sub></em><sub class="calibre12">mag</sub> (complex conjugate of <em class="calibre7">p</em>). Notice that if <em class="calibre7">s</em> is equal to −<em class="calibre7">p</em> or −<em class="calibre7">p</em><sup class="calibre10">*</sup>, one of the polynomial roots in the denominator of <a href="#calibre_link-771">Eq. (6-14)</a> will equal zero, and <em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">s</em>) will have an infinite magnitude. Those two complex poles, shown in <a href="#calibre_link-772">Figure 6-9(a)</a>, are located off the negative portion of the real σ axis. If the <em class="calibre7">H</em><sub class="calibre12">2</sub> system were at rest and we disturbed it with an impulselike <em class="calibre7">x</em>(<em class="calibre7">t</em>) input at time <em class="calibre7">t</em> = 0, its continuous time-domain <em class="calibre7">y</em>(<em class="calibre7">t</em>) output would be the damped sinusoidal curve shown in <a href="#calibre_link-772">Figure 6-9(b)</a>. We see that <em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">s</em>) is stable because its oscillating <em class="calibre7">y</em>(<em class="calibre7">t</em>) output, like a plucked guitar string, approaches zero as time increases. Again, the distance of the poles from the σ = 0 axis (−<em class="calibre7">p</em><sub class="calibre12">real</sub>) gives the decay rate of the sinusoidal <em class="calibre7">y</em>(<em class="calibre7">t</em>) impulse response. Likewise, the distance of the poles from the <em class="calibre7">j</em>ω = 0 axis (±<em class="calibre7">p</em><sub class="calibre12">imag</sub>) gives the frequency of the sinusoidal <em class="calibre7">y</em>(<em class="calibre7">t</em>) impulse response. Notice something new in <a href="#calibre_link-772">Figure 6-9(a)</a>. When <em class="calibre7">s</em> = 0, the numerator of <a href="#calibre_link-771">Eq. (6-14)</a> is zero, making the transfer function <em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">s</em>) equal to zero. Any value of <em class="calibre7">s</em> where <em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">s</em>) = 0 is sometimes of interest and is usually plotted on the <em class="calibre7">s</em>-plane as the little circle, called a <em class="calibre7">zero,</em> shown in <a href="#calibre_link-772">Figure 6-9(a)</a>. At this point we’re not very interested in knowing exactly what <em class="calibre7">p</em> and <em class="calibre7">p</em><sup class="calibre10">*</sup> are in terms of the coefficients in the denominator of <a href="#calibre_link-770">Eq. (6-13)</a>. However, an energetic reader could determine the values of <em class="calibre7">p</em> and <em class="calibre7">p</em>* in terms of <em class="calibre7">a</em><sub class="calibre12">0</sub>, <em class="calibre7">a</em><sub class="calibre12">1</sub>, and <em class="calibre7">a</em><sub class="calibre12">2</sub> by using the following well-known quadratic factorization formula: Given the 2nd-order polynomial <em class="calibre7">f</em>(<em class="calibre7">s</em>) = <em class="calibre7">as</em><sup class="calibre10">2</sup> + <em class="calibre7">bs</em> + <em class="calibre7">c</em>, then <em class="calibre7">f</em>(<em class="calibre7">s</em>) can be factored as</p>
<p class="caption"><a id="calibre_link-772"></a><strong class="calibre9">Figure 6-9</strong> Descriptions of <em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">s</em>): (a) poles located at <em class="calibre7">s</em> = <em class="calibre7">p</em><sub class="calibre12">real</sub> ± <em class="calibre7">jp</em><sub class="calibre12">imag</sub> on the <em class="calibre7">s-</em>plane; (b) time-domain <em class="calibre7">y</em>(<em class="calibre7">t</em>) impulse response of the system.</p>
<p class="image"><img src="images/001378.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2741"></a><a id="calibre_link-806"></a>(6-15)</p>
<p class="image"><img src="images/000738.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-773">Figure 6-10(b)</a> illustrates the |<em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">s</em>)| surface above the <em class="calibre7">s</em>-plane. Again, the bold |<em class="calibre7">H</em><sub class="calibre12">2</sub>(ω)| curve in <a href="#calibre_link-773">Figure 6-10(b)</a> is shown in the conventional way in <a href="#calibre_link-773">Figure 6-10(c)</a> to indicate the frequency magnitude response of the system described by <a href="#calibre_link-770">Eq. (6-13)</a>. Although the three-dimensional surfaces in <a href="#calibre_link-769">Figures 6-8(b)</a> <a id="calibre_link-2079"></a>and <a href="#calibre_link-773">6-10(b)</a> are informative, they’re also unwieldy and unnecessary. We can determine a system’s stability merely by looking at the locations of the poles on the two-dimensional <em class="calibre7">s</em>-plane.</p>
<p class="caption"><a id="calibre_link-773"></a><strong class="calibre9">Figure 6-10</strong> Further depictions of <em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">s</em>): (a) poles and zero locations on the <em class="calibre7">s&ndash;</em>plane; (b) |<em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">s</em>)| surface; (c) |<em class="calibre7">H</em><sub class="calibre12">2</sub>(ω)| frequency magnitude response curve.</p>
<p class="image"><img src="images/000024.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To further illustrate the concept of system stability, <a href="#calibre_link-774">Figure 6-11</a> shows the <em class="calibre7">s</em>-plane pole locations of several example Laplace transfer functions and their corresponding time-domain impulse responses. We recognize <a href="#calibre_link-774">Figures 6-11(a)</a> and <a href="#calibre_link-774">6-11(b)</a>, from our previous discussion, as indicative of stable systems. When disturbed from their at-rest condition, they respond and, at some later time, return to that initial condition. The single pole location at <em class="calibre7">s</em> = 0 in <a href="#calibre_link-774">Figure 6-11(c)</a> is indicative of the 1/<em class="calibre7">s</em> transfer function of a single element of a linear system. In an electrical system, this 1/<em class="calibre7">s</em> transfer function could be a capacitor that was charged with an impulse of current, and there’s no discharge path in the circuit. For a mechanical system, <a href="#calibre_link-774">Figure 6-11(c)</a> would describe a kind of spring that’s compressed with an impulse of force and, for some reason, remains under compression. Notice, in <a href="#calibre_link-774">Figure 6-11(d)</a>, that if an <em class="calibre7">H</em>(<em class="calibre7">s</em>) transfer function has conjugate poles located exactly on the <em class="calibre7">j</em>ω axis (σ = 0), the system will go into oscillation when disturbed from its initial condition. This situation, called <em class="calibre7">conditional stability</em>, happens to describe the intentional transfer function of electronic oscillators. Instability is indicated in <a href="#calibre_link-774">Figures 6-11(e)</a> and <a href="#calibre_link-774">6-11(f)</a>. Here, the poles lie to the right of the <em class="calibre7">j</em>ω axis. When disturbed from their initial at-rest condition by an impulse input, their outputs grow without bound.<sup class="calibre10"><a id="calibre_link-777"></a><a href="#calibre_link-775">†</a></sup> See how the value of σ, the real part of <em class="calibre7">s</em>, for the pole locations is the key here? When σ &lt; 0, the system is well behaved and stable; when σ = 0, the system is conditionally stable; and when σ &gt; 0, the system is unstable. So we can say that when σ is located on the right half of the <em class="calibre7">s</em>-plane, the system is unstable. We show this characteristic of linear continuous systems in <a href="#calibre_link-776">Figure 6-12</a>. Keep in mind that real-world systems often have more than two poles, and a system is only as stable as its least stable pole. For a system to be stable, all of its transfer-function poles must lie on the left half of the <em class="calibre7">s</em>-plane.</p>
<p class="footnotes"><a id="calibre_link-775"></a><sup class="calibre11"><a href="#calibre_link-777">†</a></sup> Impulse response testing in a laboratory can be an important part of the system design process. The difficult part is generating a true impulselike input. If the system is electrical, for example, although somewhat difficult to implement, the input <em class="calibre7">x</em>(<em class="calibre7">t</em>) impulse would be a very short-duration voltage or current pulse. If, however, the system were mechanical, a whack with a hammer would suffice as an <em class="calibre7">x</em>(<em class="calibre7">t</em>) impulse input. For digital systems, on the other hand, an impulse input is easy to generate; it’s a single unity-valued sample preceded and followed by all zero-valued samples.</p>
<p class="caption"><a id="calibre_link-774"></a><strong class="calibre9">Figure 6-11</strong> Various <em class="calibre7">H</em>(<em class="calibre7">s</em>) pole locations and their time-domain impulse responses: (a) single pole at σ &lt; 0; (b) conjugate poles at σ &lt; 0; (c) single pole located at σ = 0; (d) conjugate poles located at σ = 0; (e) single pole at σ &gt; 0; (f) conjugate poles at σ &gt; 0.</p>
<p class="image"><img src="images/001347.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-776"></a><strong class="calibre9">Figure 6-12</strong> The Laplace <em class="calibre7">s&ndash;p</em>lane showing the regions of stability and instability for pole locations for linear continuous systems.</p>
<p class="image"><img src="images/000852.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To consolidate what we’ve learned so far: <em class="calibre7">H</em>(<em class="calibre7">s</em>) is determined by writing a linear system’s time-domain differential equation and taking the Laplace transform of that equation to obtain a Laplace expression in terms of <em class="calibre7">X</em>(<em class="calibre7">s</em>), <em class="calibre7">Y</em>(<em class="calibre7">s</em>), <em class="calibre7">s</em>, and the system’s coefficients. Next we rearrange the Laplace expression terms to get the <em class="calibre7">H</em>(<em class="calibre7">s</em>) ratio in the form of <a href="#calibre_link-766">Eq. (6-10)</a>. (The really slick part is that we do not have to know what the time-domain <em class="calibre7">x</em>(<em class="calibre7">t</em>) input is to analyze a linear system!) We can get the expression for the continuous frequency response of a system just by substituting <em class="calibre7">j</em>ω for <em class="calibre7">s</em> in the <em class="calibre7">H</em>(<em class="calibre7">s</em>) equation. To determine <a id="calibre_link-2742"></a>system stability, the denominator polynomial of <em class="calibre7">H</em>(<em class="calibre7">s</em>) is factored to find each of its roots. Each root is set equal to zero and solved for <em class="calibre7">s</em> to find the location of the system poles on the <em class="calibre7">s</em>-plane. Any pole located to the right of the <em class="calibre7">j</em>ω axis on the <em class="calibre7">s</em>-plane will indicate an unstable system.</p>
<p class="calibre3">OK, returning to our original goal of understanding the <em class="calibre7">z-</em>transform, the process of analyzing IIR filter systems requires us to replace the Laplace transform with the <em class="calibre7">z-</em>transform and to replace the <em class="calibre7">s</em>-plane with a <em class="calibre7">z</em>-plane. Let’s <a id="calibre_link-2336"></a>introduce the <em class="calibre7">z-</em>transform, determine what this new <em class="calibre7">z</em>-plane is, discuss the stability of IIR filters, and design and analyze a few simple IIR filters.</p>
<p class="calibre3"><a id="calibre_link-408"></a></p>
<h3 class="calibre6">6.3 The <em class="calibre17">z</em>-Transform</h3>
<p class="calibre3">The <em class="calibre7">z-</em>transform is the discrete-time cousin of the continuous Laplace transform.<sup class="calibre10"><a id="calibre_link-779"></a><a href="#calibre_link-778">†</a></sup> While the Laplace transform is used to simplify the analysis of continuous differential equations, the <em class="calibre7">z-</em>transform facilitates the analysis of discrete difference equations. Let’s define the <em class="calibre7">z-</em>transform and explore its important characteristics to see how it’s used in analyzing IIR digital filters.</p>
<p class="footnotes"><a id="calibre_link-778"></a><sup class="calibre11"><a href="#calibre_link-779">†</a></sup> In the early 1960s, James Kaiser, after whom the Kaiser window function is named, consolidated the theory of digital filters using a mathematical description known as the <em class="calibre7">z</em>-transform[<a href="#calibre_link-780">4</a>,<a href="#calibre_link-781">5</a>]. Until that time, the use of the <em class="calibre7">z</em>-transform had generally been restricted to the field of discrete control systems[<a href="#calibre_link-782">6</a>&ndash;<a href="#calibre_link-783">9</a>].</p>
<p class="calibre3">The <em class="calibre7">z-</em>transform of a discrete sequence <em class="calibre7">h</em>(<em class="calibre7">n</em>), expressed as <em class="calibre7">H</em>(z), is defined as</p>
<p class="caption"><a id="calibre_link-2743"></a>(6-16)</p>
<p class="image"><img src="images/001592.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where the variable <em class="calibre7">z</em> is complex. Where <a href="#calibre_link-756">Eq. (6-3)</a> allowed us to take the Laplace transform of a continuous signal, the <em class="calibre7">z-</em>transform is performed on a discrete <em class="calibre7">h</em>(<em class="calibre7">n</em>) sequence, converting that sequence into a continuous function <em class="calibre7">H</em>(<em class="calibre7">z</em>) of the continuous complex variable <em class="calibre7">z</em>. Similarly, as the function <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">st</em></sup> is the general form for the solution of linear differential equations, <em class="calibre7">z<sup class="calibre10">−n</sup></em> is the general form for the solution of linear difference equations. Moreover, as a Laplace function <em class="calibre7">F</em>(<em class="calibre7">s</em>) is a <a id="calibre_link-2460"></a>continuous surface above the <em class="calibre7">s</em>-plane, the <em class="calibre7">z-</em>transform function <em class="calibre7">H</em>(<em class="calibre7">z</em>) is a continuous surface above a <em class="calibre7">z</em>-plane. To whet your appetite, we’ll now state that if <em class="calibre7">H</em>(<em class="calibre7">z</em>) represents an IIR filter’s <em class="calibre7">z-</em>domain transfer function, evaluating the <em class="calibre7">H</em>(<em class="calibre7">z</em>) surface will give us the filter’s frequency magnitude response, and <em class="calibre7">H</em>(<em class="calibre7">z</em>)’s pole and zero locations will determine the stability of the filter.</p>
<p class="calibre3">We can determine the frequency response of an IIR digital filter by expressing <em class="calibre7">z</em> in polar form as <em class="calibre7">z</em> = <em class="calibre7">re<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup>, where <em class="calibre7">r</em> is a magnitude and ω is the angle. In this form, the <em class="calibre7">z-</em>transform equation becomes</p>
<p class="caption"><a id="calibre_link-784"></a>(6-16′)</p>
<p class="image"><img src="images/000620.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-784">Equation (6-16′)</a> can be interpreted as the Fourier transform of the product of the original sequence <em class="calibre7">h</em>(<em class="calibre7">n</em>) and the exponential sequence <em class="calibre7">r</em><sup class="calibre10">−<em class="calibre7">n</em></sup>. When <em class="calibre7">r</em> equals one, <a href="#calibre_link-784">Eq. (6-16′)</a> simplifies to the Fourier transform. Thus on the <em class="calibre7">z</em>-plane, the contour of the <em class="calibre7">H</em>(<em class="calibre7">z</em>) surface for those values where |<em class="calibre7">z</em>| = 1 is the Fourier transform of <em class="calibre7">h</em>(<em class="calibre7">n</em>). If <em class="calibre7">h</em>(<em class="calibre7">n</em>) represents a filter impulse response sequence, evaluating the <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function for |<em class="calibre7">z</em>| = 1 yields the frequency response of the filter. So where on the <em class="calibre7">z</em>-plane is |<em class="calibre7">z</em>| = 1? It’s a circle with a radius of one, centered about the <em class="calibre7">z</em> = 0 point. This circle, so important that it’s been given the name <em class="calibre7">unit circle</em>, is shown in <a href="#calibre_link-785">Figure 6-13</a>. Recall that the <em class="calibre7">j</em>ω frequency axis on the continuous Laplace <em class="calibre7">s</em>-plane was linear and ranged from − ∞ to + ∞ radians/second. The ω frequency axis on the complex <em class="calibre7">z</em>-plane, however, spans only the range from −π to +π radians. With this relationship between the <em class="calibre7">j</em>ω axis on the Laplace <em class="calibre7">s</em>-plane and the unit circle on the <em class="calibre7">z</em>-plane, we can see that the <em class="calibre7">z</em>-plane frequency axis is equivalent to coiling the <em class="calibre7">s</em>-plane’s jω axis about the unit circle on the <em class="calibre7">z</em>-plane as shown in <a href="#calibre_link-786">Figure 6-14</a>.</p>
<p class="caption"><a id="calibre_link-785"></a><strong class="calibre9">Figure 6-13</strong> Unit circle on the complex <em class="calibre7">z&ndash;</em>plane.</p>
<p class="image"><img src="images/000367.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-786"></a><strong class="calibre9">Figure 6-14</strong> Mapping of the Laplace <em class="calibre7">s&ndash;</em>plane to the <em class="calibre7">z&ndash;</em>plane. All frequency values are in radians/second.</p>
<p class="image"><img src="images/001697.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Then, frequency ω on the <em class="calibre7">z</em>-plane is not a distance along a straight line, but rather an angle around a circle. With ω in <a href="#calibre_link-785">Figure 6-13</a> being a general normalized angle in radians ranging from −π to +π, we can relate ω to an equivalent <a id="calibre_link-2448"></a><em class="calibre7">f<sub class="calibre12">s</sub></em> sampling rate by defining a new frequency variable ω<em class="calibre7"><sub class="calibre12">s</sub></em> = 2π<em class="calibre7">f<sub class="calibre12">s</sub></em> in radians/second. The periodicity of discrete frequency representations, with a period of ω<em class="calibre7"><sub class="calibre12">s</sub></em> = 2π<em class="calibre7">f<sub class="calibre12">s</sub></em> radians/second or <em class="calibre7">f<sub class="calibre12">s</sub></em> Hz, is indicated for the <em class="calibre7">z</em>-plane in <a href="#calibre_link-786">Figure 6-14</a>. Where a walk along the <em class="calibre7">j</em>ω frequency axis on the <em class="calibre7">s</em>-plane could take us to infinity in either direction, a trip on the ω frequency path on the <em class="calibre7">z</em>-plane leads us in circles (on the unit circle). <a href="#calibre_link-786">Figure 6-14</a> shows us that only the −π<em class="calibre7">f<sub class="calibre12">s</sub></em> to +π<em class="calibre7">f<sub class="calibre12">s</sub></em> radians/second frequency range for ω can be accounted for on the <em class="calibre7">z</em>-plane, and this is another example of the universal periodicity of the discrete frequency domain. (Of course, the −π<em class="calibre7">f<sub class="calibre12">s</sub></em> to +π<em class="calibre7">f<sub class="calibre12">s</sub></em> radians/second range corresponds to a cyclic frequency range of −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 to +<em class="calibre7">f<sub class="calibre12">s</sub></em>/2.) With the perimeter of the unit circle being <em class="calibre7">z</em> = <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup>, later, we’ll show exactly how to substitute <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup> for <em class="calibre7">z</em> in a filter’s <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function, giving us the filter’s frequency response.</p>
<p class="calibre3"><a id="calibre_link-2744"></a></p>
<h4 class="calibre13">6.3.1 Poles, Zeros, and Digital Filter Stability</h4>
<p class="calibre3">One of the most important characteristics of the <em class="calibre7">z</em>-plane is that the region of filter stability is mapped to the inside of the unit circle on the <em class="calibre7">z</em>-plane. Given the <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function of a digital filter, we can examine that function’s pole locations to determine filter stability. If all poles are located inside the unit circle, the filter will be stable. On the other hand, if any pole is located outside the unit circle, the filter will be unstable.</p>
<p class="calibre3">For example, if a causal filter’s <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function has a single pole at location <em class="calibre7">p</em> on the <em class="calibre7">z</em>-plane, its transfer function can be represented by</p>
<p class="caption"><a id="calibre_link-2745"></a>(6-17)</p>
<p class="image"><img src="images/000014.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">and the filter’s time-domain impulse response sequence is</p>
<p class="caption"><a id="calibre_link-787"></a>(6-17′)</p>
<p class="image"><img src="images/001780.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2746"></a>where <em class="calibre7">u</em>(<em class="calibre7">n</em>) represents a unit step (all ones) sequence beginning at time <em class="calibre7">n</em> = 0. <a href="#calibre_link-787">Equation (6-17′)</a> tells us that as time advances, the impulse response will be <em class="calibre7">p</em> raised to larger and larger powers. When the pole location <em class="calibre7">p</em> has a magnitude less than one, as shown in <a href="#calibre_link-788">Figure 6-15(a)</a>, the <em class="calibre7">h(n</em>) impulse response sequence is unconditionally bounded in amplitude. And a value of |<em class="calibre7">p</em>| &lt; 1 means that the pole must lie inside the <em class="calibre7">z</em>-plane’s unit circle.</p>
<p class="caption"><a id="calibre_link-788"></a><strong class="calibre9">Figure 6-15</strong> Various <em class="calibre7">H</em>(<em class="calibre7">z</em>) pole locations and their discrete time-domain impulse responses: (a) single pole inside the unit circle; (b) conjugate poles located inside the unit circle; (c) conjugate poles located on the unit circle; (d) single pole outside the unit circle; (e) conjugate poles located outside the unit circle.</p>
<p class="image"><img src="images/000025.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-788">Figure 6-15</a> shows the <em class="calibre7">z</em>-plane pole locations of several example <em class="calibre7">z-</em>domain transfer functions and their corresponding discrete time-domain impulse <a id="calibre_link-2474"></a>responses. It’s a good idea for the reader to compare the <em class="calibre7">z</em>-plane and discrete-time responses of <a href="#calibre_link-788">Figure 6-15</a> with the <em class="calibre7">s</em>-plane and the continuous-time responses of <a href="#calibre_link-774">Figure 6-11</a>. The <em class="calibre7">y</em>(<em class="calibre7">n</em>) outputs in <a href="#calibre_link-788">Figures 6-15(d)</a> and <a href="#calibre_link-788">6-15(e)</a> show examples of how unstable filter outputs increase in amplitude, as time passes, whenever their <em class="calibre7">x</em>(<em class="calibre7">n</em>) inputs are nonzero. To avoid this situation, any IIR digital filter that we design should have an <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function with all of its individual poles inside the unit circle. Like a chain that’s only as strong as its weakest link, an IIR filter is only as stable as its least stable pole.</p>
<p class="calibre3">The ω<sub class="calibre12">o</sub> oscillation frequency of the impulse responses in <a href="#calibre_link-788">Figures 6-15(c)</a> and <a href="#calibre_link-788">6-15(e)</a> is, of course, proportional to the angle of the conjugate pole pairs from the <em class="calibre7">z</em><sub class="calibre12">real</sub> axis, or ω<sub class="calibre12">o</sub> radians/second corresponding to <em class="calibre7">f</em><sub class="calibre12">o</sub> = ω<sub class="calibre12">o</sub>/2π Hz. Because the intersection of the −<em class="calibre7">z</em><sub class="calibre12">real</sub> axis and the unit circle, point <em class="calibre7">z</em> = −1, corresponds to π radians (or π<em class="calibre7">f<sub class="calibre12">s</sub></em> radians/second = <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz), the ω<sub class="calibre12">o</sub> angle of π/4 in <a href="#calibre_link-788">Figure 6-15</a> means that <em class="calibre7">f</em><sub class="calibre12">o</sub> = <em class="calibre7">f<sub class="calibre12">s</sub></em>/8 and our <em class="calibre7">y</em>(<em class="calibre7">n</em>) will have eight samples per cycle of <em class="calibre7">f</em><sub class="calibre12">o</sub>.</p>
<p class="calibre3"><a id="calibre_link-348"></a></p>
<h3 class="calibre6">6.4 Using the <em class="calibre17">z</em>-Transform to Analyze IIR Filters</h3>
<p class="calibre3">We have one last concept to consider before we can add the <em class="calibre7">z-</em>transform to our collection of digital signal processing tools. We need to determine how to represent <a href="#calibre_link-748">Figure 6-3</a>’s delay operation as part of our <em class="calibre7">z</em>-transform filter analysis equations. To do this, assume we have a sequence <em class="calibre7">x</em>(<em class="calibre7">n</em>) whose <em class="calibre7">z-</em>transform is <em class="calibre7">X</em>(<em class="calibre7">z</em>) and a sequence <em class="calibre7">y</em>(<em class="calibre7">n</em>) = <em class="calibre7">x</em>(<em class="calibre7">n−</em>1) whose <em class="calibre7">z-</em>transform is <em class="calibre7">Y</em>(<em class="calibre7">z</em>) as shown in <a href="#calibre_link-789">Figure 6-16(a)</a>. The <em class="calibre7">z-</em>transform of <em class="calibre7">y</em>(<em class="calibre7">n</em>) is, by definition,</p>
<p class="caption"><a id="calibre_link-2747"></a>(6-18)</p>
<p class="image"><img src="images/000802.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-789"></a><strong class="calibre9">Figure 6-16</strong> Time- and <em class="calibre7">z</em>-domain delay element relationships: (a) single delay; (b) multiple delays.</p>
<p class="image"><img src="images/000627.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Now if we let <em class="calibre7">k</em> = <em class="calibre7">n−</em>1, then <em class="calibre7">Y</em>(<em class="calibre7">z</em>) becomes</p>
<p class="caption"><a id="calibre_link-2748"></a>(6-19)</p>
<p class="image"><img src="images/001661.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">which we can write as</p>
<p class="caption"><a id="calibre_link-2749"></a>(6-20)</p>
<p class="image"><img src="images/000685.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Thus, the effect of a single unit of time delay is to multiply the <em class="calibre7">z-</em>transform of the undelayed sequence by <em class="calibre7">z<sup class="calibre10">−</sup></em><sup class="calibre10">1</sup>.</p>
<p class="calibre3"><a id="calibre_link-2750"></a></p>
<h4 class="calibre13"><a id="calibre_link-2154"></a>6.4.1 <em class="calibre7">z</em>-Domain IIR Filter Analysis</h4>
<p class="calibre3">Interpreting a unit time delay to be equivalent to the <em class="calibre7">z<sup class="calibre10">−</sup></em><sup class="calibre10">1</sup> operator leads us to the relationship shown in <a href="#calibre_link-789">Figure 6-16(b)</a>, where we can say <em class="calibre7">X</em>(<em class="calibre7">z</em>)<em class="calibre7">z</em><sup class="calibre10">0</sup> = <em class="calibre7">X</em>(<em class="calibre7">z</em>) is the <em class="calibre7">z-</em>transform of <em class="calibre7">x</em>(<em class="calibre7">n</em>), <em class="calibre7">X</em>(<em class="calibre7">z</em>)<em class="calibre7">z</em><sup class="calibre10">−1</sup> is the <em class="calibre7">z-</em>transform of <em class="calibre7">x</em>(<em class="calibre7">n</em>) delayed by one sample, <em class="calibre7">X</em>(<em class="calibre7">z</em>)<em class="calibre7">z<sup class="calibre10">−</sup></em><sup class="calibre10">2</sup> is the <em class="calibre7">z-</em>transform of <em class="calibre7">x</em>(<em class="calibre7">n</em>) delayed by two samples, and <em class="calibre7">X</em>(<em class="calibre7">z</em>)<em class="calibre7">z<sup class="calibre10">−k</sup></em> is the <em class="calibre7">z-</em>transform of <em class="calibre7">x</em>(<em class="calibre7">n</em>) delayed by <em class="calibre7">k</em> samples. So a transfer function of <em class="calibre7">z<sup class="calibre10">−k</sup></em> is equivalent to a delay of <em class="calibre7">kt<sub class="calibre12">s</sub></em> seconds from the instant when <em class="calibre7">t</em> = 0, where <em class="calibre7">t<sub class="calibre12">s</sub></em> is the period between data samples, or one over the sample rate. Specifically, <em class="calibre7">t<sub class="calibre12">s</sub></em> = 1/<em class="calibre7">f</em><sub class="calibre12">s</sub>. Because a delay of one sample is equivalent to the factor <em class="calibre7">z</em><sup class="calibre10">−1</sup>, the unit time delay symbol used in <a href="#calibre_link-746">Figures 6-2</a> and <a href="#calibre_link-748">6-3</a> is usually indicated by the <em class="calibre7">z</em><sup class="calibre10">−1</sup> operator as in <a href="#calibre_link-789">Figure 6-16(b)</a>.</p>
<p class="calibre3">Let’s pause for a moment and consider where we stand so far. Our acquaintance with the Laplace transform with its <em class="calibre7">s</em>-plane, the concept of stability based on <em class="calibre7">H</em>(<em class="calibre7">s</em>) pole locations, the introduction of the <em class="calibre7">z-</em>transform with its <em class="calibre7">z</em>-plane poles, and the concept of the <em class="calibre7">z</em><sup class="calibre10">−1</sup> operator signifying a single unit of time delay has led us to our goal: the ability to inspect an IIR filter difference equation or filter structure (block diagram) and immediately write the filter’s <em class="calibre7">z-</em>domain transfer function <em class="calibre7">H</em>(<em class="calibre7">z</em>). Accordingly, by evaluating an IIR filter’s <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function appropriately, we can determine the filter’s frequency response and its stability. With those ambitious thoughts in mind, let’s develop the <em class="calibre7">z-</em>domain equations we need to analyze IIR filters. Using the relationships of <a href="#calibre_link-789">Figure 6-16(b)</a>, we redraw <a href="#calibre_link-748">Figure 6-3</a> as a general <em class="calibre7">M</em>th-order IIR filter using the <em class="calibre7">z</em><sup class="calibre10">−1</sup> operator as shown in <a href="#calibre_link-790">Figure 6-17</a>. (In hardware, those <em class="calibre7">z<sup class="calibre10">−</sup></em><sup class="calibre10">1</sup> operations are memory locations holding successive filter input and output sample values. When implementing an IIR filter in a software routine, the <em class="calibre7">z</em><sup class="calibre10">−1</sup> operation merely indicates sequential memory locations where input and output sequences are stored.) The IIR filter structure in <a href="#calibre_link-790">Figure 6-17</a> is called the <em class="calibre7">Direct Form I</em> structure. The time-domain difference equation describing the <a id="calibre_link-2751"></a>general <em class="calibre7">M</em>th-order IIR filter, having <em class="calibre7">N</em> feedforward stages and <em class="calibre7">M</em> feedback stages, in <a href="#calibre_link-790">Figure 6-17</a> is</p>
<p class="caption"><a id="calibre_link-791"></a>(6-21)</p>
<p class="image"><img src="images/001543.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-790"></a><strong class="calibre9">Figure 6-17</strong> General (Direct Form I) structure of an <em class="calibre7">M</em>th-order IIR filter, having <em class="calibre7">N</em> feedforward stages and <em class="calibre7">M</em> feedback stages, with the <em class="calibre7">z<sup class="calibre10">−</sup></em><sup class="calibre10">1</sup> operator indicating a unit time delay.</p>
<p class="image"><img src="images/000932.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">In the <em class="calibre7">z-</em>domain, that IIR filter’s output can be expressed by</p>
<p class="caption"><a id="calibre_link-792"></a>(6-22)</p>
<p class="image"><img src="images/000569.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">Y</em>(<em class="calibre7">z</em>) and <em class="calibre7">X</em>(<em class="calibre7">z</em>) represent the <em class="calibre7">z-</em>transform of <em class="calibre7">y</em>(<em class="calibre7">n</em>) and <em class="calibre7">x</em>(<em class="calibre7">n</em>). Look <a href="#calibre_link-791">Eqs. (6-21)</a> and <a href="#calibre_link-792">(6-22)</a> over carefully and see how the unit time delays translate to negative powers of <em class="calibre7">z</em> in the <em class="calibre7">z-</em>domain expression. A more compact notation for <em class="calibre7">Y</em>(<em class="calibre7">z</em>) is</p>
<p class="caption"><a id="calibre_link-793"></a>(6-23)</p>
<p class="image"><img src="images/001430.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">OK, now we’ve arrived at the point where we can describe the transfer function of a general IIR filter. Rearranging <a href="#calibre_link-793">Eq. (6-23)</a>, to collect like terms, we write</p>
<p class="caption"><a id="calibre_link-2752"></a>(6-24)</p>
<p class="image"><img src="images/000467.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2071"></a>Finally, we define the filter’s <em class="calibre7">z-</em>domain transfer function as <em class="calibre7">H</em>(<em class="calibre7">z</em>) = <em class="calibre7">Y</em>(<em class="calibre7">z</em>)/<em class="calibre7">X</em>(<em class="calibre7">z</em>), where <em class="calibre7">H</em>(<em class="calibre7">z</em>) is given by</p>
<p class="caption"><a id="calibre_link-794"></a>(6-25)</p>
<p class="image"><img src="images/001325.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Just as with Laplace transfer functions, the <em class="calibre7"><a href="#calibre_link-344">order</a></em> of our <em class="calibre7">z</em>-domain transfer function and the order of our filter are defined by the largest exponential order of <em class="calibre7">z</em> in either the numerator or the denominator in <a href="#calibre_link-794">Eq. (6-25)</a>.</p>
<p class="calibre3">There are two things we need to know about an IIR filter: its frequency response and whether or not the filter is stable. <a href="#calibre_link-794">Equation (6-25)</a> is the origin of that information. We can evaluate the denominator of <a href="#calibre_link-794">Eq. (6-25)</a> to determine the positions of the filter’s poles on the <em class="calibre7">z</em>-plane indicating the filter’s stability. Next, from <a href="#calibre_link-794">Eq. (6-25)</a> we develop an expression for the IIR filter’s frequency response.</p>
<p class="calibre3">Remember, now, just as the Laplace transfer function <em class="calibre7">H</em>(<em class="calibre7">s</em>) in <a href="#calibre_link-795">Eq. (6-9)</a> was a complex-valued surface on the <em class="calibre7">s</em>-plane, <em class="calibre7">H</em>(<em class="calibre7">z</em>) is a complex-valued surface above, or below, the <em class="calibre7">z</em>-plane. The intersection of that <em class="calibre7">H</em>(<em class="calibre7">z</em>) surface and the perimeter of a cylinder representing the <em class="calibre7">z</em> = <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup> unit circle is the filter’s complex frequency response. This means that substituting <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup> for <em class="calibre7">z</em> in <a href="#calibre_link-794">Eq. (6-25)</a>’s transfer function gives us the expression for the filter’s <em class="calibre7">H</em>(ω) frequency response as</p>
<p class="caption"><a id="calibre_link-797"></a>(6-26)</p>
<p class="image"><img src="images/001698.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">In rectangular form, using Euler’s identity, <em class="calibre7">e<sup class="calibre10">−j</sup></em><sup class="calibre10">ω</sup> = cos(ω)−<em class="calibre7">j</em>sin(ω), the filter’s <em class="calibre7">H</em>(ω) frequency response is</p>
<p class="caption"><a id="calibre_link-796"></a>(6-27)</p>
<p class="image"><img src="images/001208.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Shortly, we’ll use the above expressions to analyze an actual IIR filter.</p>
<p class="calibre3">Pausing a moment to gather our thoughts, we realize that <em class="calibre7">H</em>(ω) is the ratio of complex functions and we can use <a href="#calibre_link-796">Eq. (6-27)</a> to compute the <a id="calibre_link-2473"></a>magnitude and phase response of IIR filters as a function of the frequency ω. And again, just what is ω? It’s the normalized frequency represented by the angle around the unit circle in <a href="#calibre_link-785">Figure 6-13</a>, having a range of −π≤ω≤+ω radians/sample. In terms of our old friend <em class="calibre7">f</em><sub class="calibre12">s</sub> Hz, <a href="#calibre_link-796">Eq. (6-27)</a> applies over the equivalent frequency range of −<em class="calibre7">f</em><sub class="calibre12">s</sub>/2 to +<em class="calibre7">f</em><sub class="calibre12">s</sub>/2 Hz. So, for example, if digital data is arriving at the filter’s input at a rate of <em class="calibre7">f</em><sub class="calibre12">s</sub> =1000 samples/second, we could use <a href="#calibre_link-796">Eq. (6-27)</a> to plot the filter’s frequency magnitude response over the frequency range of −500 Hz to +500 Hz.</p>
<p class="calibre3"><a id="calibre_link-2753"></a></p>
<h4 class="calibre13">6.4.2 IIR Filter Analysis Example</h4>
<p class="calibre3">Although <a href="#calibre_link-794">Eqs. (6-25)</a> and <a href="#calibre_link-797">(6-26)</a> look somewhat complicated at first glance, let’s illustrate their simplicity and utility by analyzing the simple 2nd-order lowpass IIR filter in <a href="#calibre_link-798">Figure 6-18(a)</a> whose positive cutoff frequency is ω = π/5 (<em class="calibre7">f</em><sub class="calibre12">s</sub>/10 Hz).</p>
<p class="caption"><a id="calibre_link-798"></a><strong class="calibre9">Figure 6-18</strong> Second-order lowpass IIR filter example.</p>
<p class="image"><img src="images/000093.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">By inspection, we can write the filter’s time-domain difference equation as</p>
<p class="caption"><a id="calibre_link-799"></a>(6-28)</p>
<p class="image"><img src="images/000246.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2475"></a>There are two ways to obtain the <em class="calibre7">z-</em>domain expression of our filter. The first way is to look at <a href="#calibre_link-799">Eq. (6-28)</a> and by inspection write</p>
<p class="caption"><a id="calibre_link-800"></a>(6-29)</p>
<p class="image"><img src="images/001087.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The second way to obtain the desired <em class="calibre7">z-</em>domain expression is to redraw <a href="#calibre_link-798">Figure 6-18(a)</a> with the <em class="calibre7">z</em>-domain notation as in <a href="#calibre_link-798">Figure 6-18(b)</a>. Then by inspection of <a href="#calibre_link-798">Figure 6-18(b)</a> we could have written <a href="#calibre_link-800">Eq. (6-29)</a>.</p>
<p class="calibre3">A piece of advice for the reader to remember: although not obvious in this IIR filter analysis example, it’s often easier to determine a digital network’s transfer function using the <em class="calibre7">z</em>-domain notation of <a href="#calibre_link-798">Figure 6-18(b)</a> rather than using the time-domain notation of <a href="#calibre_link-798">Figure 6-18(a)</a>. (Writing the <em class="calibre7">z</em>-domain expression for a network based on the <a href="#calibre_link-798">Figure 6-18(b)</a> notation, rather than writing a time-domain expression based on the <a href="#calibre_link-798">Figure 6-18(a)</a> time notation, generally yields fewer unknown variables in our network analysis equations.) Over the years of analyzing digital networks, I regularly remind myself, “<em class="calibre7">z</em>-domain produces less pain.” Keep this advice in mind if you attempt to solve the homework problems at the end of this chapter.</p>
<p class="calibre3">Back to our example: We can obtain the desired <em class="calibre7">H</em>(<em class="calibre7">z</em>) filter transfer function by rearranging <a href="#calibre_link-800">Eq. (6-29)</a>, or by using <a href="#calibre_link-794">Eq. (6-25)</a>. Either method yields</p>
<p class="caption"><a id="calibre_link-804"></a>(6-30)</p>
<p class="image"><img src="images/000145.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Replacing <em class="calibre7">z</em> with <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup>, we see that the frequency response of our example IIR filter is</p>
<p class="caption"><a id="calibre_link-2754"></a>(6-31)</p>
<p class="image"><img src="images/000831.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We’re almost there. Remembering Euler’s equations and that cos(0) = 1 and sin(0) = 0, we can write the rectangular form of <em class="calibre7">H</em>(ω) as</p>
<p class="caption"><a id="calibre_link-801"></a>(6-32)</p>
<p class="image"><img src="images/000457.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-801">Equation (6-32)</a> is what we’re after here, and if we compute that messy expression’s magnitude over the frequency range of −π≤ω≤π, we produce the |<em class="calibre7">H</em>(ω)| shown as the solid curve in <a href="#calibre_link-802">Figure 6-19(a)</a>. For comparison purposes <a id="calibre_link-2331"></a>we also show a 5-tap lowpass FIR filter magnitude response in <a href="#calibre_link-802">Figure 6-19(a)</a>. Although both filters require the same computational workload, five multiplications per filter output sample, the lowpass IIR filter has the superior frequency magnitude response. Notice the steeper magnitude response roll-off and lower sidelobes of the IIR filter relative to the FIR filter. (To make this IIR and FIR filter comparison valid, the coefficients used for both filters were chosen so that each filter would approximate the ideal lowpass frequency response shown in <a href="#calibre_link-803">Figure 5-17(a)</a>.)</p>
<p class="caption"><a id="calibre_link-2755"></a><a id="calibre_link-802"></a><strong class="calibre9">Figure 6-19</strong> Performances of the example IIR filter (solid curves) in <a href="#calibre_link-798">Figure 6-18</a> and a 5-tap FIR filter (dashed curves): (a) magnitude responses; (b) phase responses; (c) IIR filter impulse response; (d) IIR filter poles and zeros.</p>
<p class="image"><img src="images/000703.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">A word of warning here. It’s easy to inadvertently reverse some of the signs for the terms in the denominator of <a href="#calibre_link-801">Eq. (6-32)</a>, so be careful if you attempt these calculations at home. Some authors avoid this problem by showing the <em class="calibre7">a</em>(<em class="calibre7">k</em>) coefficients in <a href="#calibre_link-790">Figure 6-17</a> as negative values, so that the summation in the denominator of <a href="#calibre_link-794">Eq. (6-25)</a> is always positive. Moreover, some commercial software IIR design routines provide <em class="calibre7">a</em>(<em class="calibre7">k</em>) coefficients whose signs must be reversed before they can be applied to the IIR structure in <a href="#calibre_link-790">Figure 6-17</a>. (If, while using software routines to design or analyze IIR filters, your results are very strange or unexpected, the first thing to do is reverse the signs of the <em class="calibre7">a</em>(<em class="calibre7">k</em>) coefficients and see if that doesn’t solve the problem.)</p>
<p class="calibre3">The solid curve in <a href="#calibre_link-802">Figure 6-19(b)</a> is our IIR filter’s ø(ω) phase response. Notice its nonlinearity relative to the FIR filter’s phase response. (Remember, now, we’re only interested in the filter phase responses over the lowpass filter’s passband. So those phase discontinuities for the FIR filter are of no consequence.) Phase nonlinearity is inherent in IIR filters and, based on the ill effects of nonlinear phase introduced in the group delay discussion of <a href="#calibre_link-370">Section 5.8</a>, we must carefully consider its implications whenever we decide to use an IIR filter instead of an FIR filter in any given application. The question any filter designer must ask and answer is “How much phase distortion can I tolerate to realize the benefits of the reduced computational workload and high data rates afforded by IIR filters?”</p>
<p class="calibre3"><a href="#calibre_link-802">Figure 6-19(c)</a> shows our filter’s time-domain <em class="calibre7">h</em>(<em class="calibre7">k</em>) impulse response. Knowing that the filter’s phase response is nonlinear, we should expect the impulse response to be asymmetrical as it indeed is. That figure also illustrates why the term <em class="calibre7"><a href="#calibre_link-741">infinite impulse response</a></em> is used to describe IIR filters. If we used infinite-precision arithmetic in our filter implementation, the <em class="calibre7">h</em>(<em class="calibre7">k</em>) impulse response would be infinite in duration. In practice, of course, a filter’s output samples are represented by a finite number of binary bits. This means that a stable IIR filter’s <em class="calibre7">h</em>(<em class="calibre7">k</em>) samples will decrease in amplitude, as time index <em class="calibre7">k</em> increases, and eventually reach an amplitude level that’s less than the smallest representable binary value. After that, all future <em class="calibre7">h</em>(<em class="calibre7">k</em>) samples will be zero-valued.</p>
<p class="calibre3">To determine our IIR filter’s stability, we must find the roots of the 2nd-order polynomial of <em class="calibre7">H</em>(<em class="calibre7">z</em>)’s denominator in <a href="#calibre_link-804">Eq. (6-30)</a>. Those roots are the <em class="calibre7">z</em>-plane poles of <em class="calibre7">H</em>(<em class="calibre7">z</em>) and if their magnitudes are less than one, the IIR filter is stable. To <a id="calibre_link-2279"></a>determine the two pole locations, <em class="calibre7">p</em><sub class="calibre12">0</sub> and <em class="calibre7">p</em><sub class="calibre12">1</sub>, first we multiply <em class="calibre7">H</em>(<em class="calibre7">z</em>) by <em class="calibre7">z</em><sup class="calibre10">2</sup>/<em class="calibre7">z</em><sup class="calibre10">2</sup> to obtain polynomials with positive exponents. After doing so, <em class="calibre7">H</em>(<em class="calibre7">z</em>) becomes</p>
<p class="caption"><a id="calibre_link-805"></a>(6-33)</p>
<p class="image"><img src="images/000877.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Factoring <a href="#calibre_link-805">Eq. (6-33)</a> using the quadratic factorization formula from <a href="#calibre_link-806">Eq. (6-15)</a>, we obtain the ratio of factors</p>
<p class="caption"><a id="calibre_link-807"></a>(6-34)</p>
<p class="image"><img src="images/001734.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So when <em class="calibre7">z</em> = <em class="calibre7">p</em><sub class="calibre12">0</sub> = 0.597 − <em class="calibre7">j</em>0.282, or when <em class="calibre7">z</em> = <em class="calibre7">p</em><sub class="calibre12">1</sub> = 0.597 + <em class="calibre7">j</em>0.282, the filter’s <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function’s denominator is zero and |<em class="calibre7">H</em>(<em class="calibre7">z</em>)| is infinite. We show the <em class="calibre7">p</em><sub class="calibre12">0</sub> and <em class="calibre7">p</em><sub class="calibre12">1</sub> pole locations in <a href="#calibre_link-802">Figure 6-19(d)</a>. Because those pole locations are inside the unit circle (their magnitudes are less than one), our example IIR filter is unconditionally stable. The two factors in the numerator of <a href="#calibre_link-807">Eq. (6-34)</a> correspond to two <em class="calibre7">z</em>-plane zeros at <em class="calibre7">z</em> = <em class="calibre7">z</em><sub class="calibre12">0</sub> = <em class="calibre7">z</em><sub class="calibre12">1</sub> = −1 (at a continuous-time frequency of ±<em class="calibre7">f</em><sub class="calibre12">s</sub>/2), shown in <a href="#calibre_link-802">Figure 6-19(d)</a>.</p>
<p class="calibre3">To help us understand the relationship between the poles/zeros of <em class="calibre7">H</em>(<em class="calibre7">z</em>) and the magnitude of the <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function, we show a crude depiction of the |<em class="calibre7">H</em>(<em class="calibre7">z</em>)| surface as a function of <em class="calibre7">z</em> in <a href="#calibre_link-808">Figure 6-20(a)</a>.</p>
<p class="caption"><a id="calibre_link-808"></a><strong class="calibre9">Figure 6-20</strong> IIR filter’s |<em class="calibre7">H</em>(<em class="calibre7">z</em>)| surface: (a) pole locations; (b) frequency magnitude response.</p>
<p class="image"><img src="images/001348.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Continuing to review the |<em class="calibre7">H</em>(<em class="calibre7">z</em>)| surface, we can show its intersection with the unit circle as the bold curve in <a href="#calibre_link-808">Figure 6-20(b)</a>. Because <em class="calibre7">z</em> = <em class="calibre7">r</em>e<sup class="calibre10"><em class="calibre7">j</em>ω</sup>, with <em class="calibre7">r</em> restricted to unity, then <em class="calibre7">z</em> = e<sup class="calibre10"><em class="calibre7">j</em>ω</sup> and the bold curve is |<em class="calibre7">H(z</em>)|<sub class="calibre12">|z|=1</sub> = |<em class="calibre7">H</em>(ω)|, representing the lowpass filter’s frequency magnitude response on the <em class="calibre7">z</em>-plane. If we were to unwrap the bold |<em class="calibre7">H</em>(ω)| curve in <a href="#calibre_link-808">Figure 6-20(b)</a> and lay it on a flat surface, we would have the |<em class="calibre7">H</em>(ω)| curve in <a href="#calibre_link-802">Figure 6-19(a)</a>. Neat, huh?</p>
<p class="calibre3"><a id="calibre_link-621"></a></p>
<h3 class="calibre6">6.5 Using Poles and Zeros to Analyze IIR Filters</h3>
<p class="calibre3">In the last section we discussed methods for finding an IIR filter’s <em class="calibre7">z</em>-domain <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function in order to determine the filter’s frequency response and stability. In this section we show how to use a digital filter’s pole/zero locations to analyze that filter’s frequency-domain performance. To understand this process, first we must identify the two most common algebraic forms used to express a filter’s <em class="calibre7">z</em>-domain transfer function.</p>
<p class="calibre3"><a id="calibre_link-2756"></a></p>
<h4 class="calibre13">6.5.1 IIR Filter Transfer Function Algebra</h4>
<p class="calibre3">We have several ways to write the <em class="calibre7">H</em>(<em class="calibre7">z</em>) = <em class="calibre7">Y</em>(<em class="calibre7">z</em>)/<em class="calibre7">X</em>(<em class="calibre7">z</em>) <em class="calibre7">z</em>-domain transfer function of an IIR filter. For example, similar to <a href="#calibre_link-804">Eq. (6-30)</a>, we can write <em class="calibre7">H</em>(<em class="calibre7">z</em>) in the <a id="calibre_link-2757"></a>form of a ratio of polynomials in negative powers of <em class="calibre7">z</em>. For a 4th-order IIR filter such an <em class="calibre7">H</em>(<em class="calibre7">z</em>) expression would be</p>
<p class="caption"><a id="calibre_link-809"></a>(6-35)</p>
<p class="image"><img src="images/000760.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2334"></a>Expressions like <a href="#calibre_link-809">Eq. (6-35)</a> are super-useful because we can replace <em class="calibre7">z</em> with <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup> to obtain an expression for the frequency response of the filter. We used that substitution in the last section.</p>
<p class="calibre3">On the other hand, multiplying <a href="#calibre_link-809">Eq. (6-35)</a> by <em class="calibre7">z</em><sup class="calibre10">4</sup>/<em class="calibre7">z</em><sup class="calibre10">4</sup>, we can express <em class="calibre7">H</em>(<em class="calibre7">z</em>) in the <em class="calibre7">polynomial</em> form</p>
<p class="caption"><a id="calibre_link-810"></a>(6-36)</p>
<p class="image"><img src="images/001616.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Expressions in the form of <a href="#calibre_link-810">Eq. (6-36)</a> are necessary so we can factor (find the roots of) the polynomials to obtain values (locations) of the numerator zeros and denominator poles, such as in the following <em class="calibre7">factored</em> form:</p>
<p class="caption"><a id="calibre_link-811"></a>(6-37)</p>
<p class="image"><img src="images/000639.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Such an <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function has four zeros (<em class="calibre7">z</em><sub class="calibre12">0</sub>, <em class="calibre7">z</em><sub class="calibre12">1</sub>, <em class="calibre7">z</em><sub class="calibre12">2</sub>, and <em class="calibre7">z</em><sub class="calibre12">3</sub>) and four poles (<em class="calibre7">p</em><sub class="calibre12">0</sub>, <em class="calibre7">p</em><sub class="calibre12">1</sub>, <em class="calibre7">p</em><sub class="calibre12">2</sub>, and <em class="calibre7">p</em><sub class="calibre12">3</sub>). We’re compelled to examine a filter’s <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function in the factored form of <a href="#calibre_link-811">Eq. (6-37)</a> because the <em class="calibre7">p<sub class="calibre12">k</sub></em> pole values tell us whether or not the IIR filter is stable. If the magnitudes of all <em class="calibre7">p<sub class="calibre12">k</sub></em> poles are less than one, the filter is stable. The filter zeros, <em class="calibre7">z<sub class="calibre12">k</sub></em>, do not affect filter stability.</p>
<p class="calibre3">As an aside, while we won’t encounter such filters until <a href="#calibre_link-187">Chapter 7</a> and <a href="#calibre_link-291">Chapter 10</a>, it is possible to have a digital filter whose transfer function, in the factored form of <a href="#calibre_link-811">Eq. (6-37)</a>, has common (identical) factors in its numerator and denominator. Those common factors produce a zero and a pole that lie exactly on top of each other. Like matter and anti-matter, such zero-pole combinations annihilate each other, leaving neither a zero nor a pole at that <em class="calibre7">z</em>-plane location.</p>
<p class="calibre3">Multiplying the factors in <a href="#calibre_link-811">Eq. (6-37)</a>, a process called “expanding the transfer function” allows us to go from the factored form of <a href="#calibre_link-811">Eq. (6-37)</a> to the polynomial form in <a href="#calibre_link-810">Eq. (6-36)</a>. As such, in our digital filter analysis activities we can translate back and forth between the polynomial and factored forms of <em class="calibre7">H</em>(<em class="calibre7">z</em>).</p>
<p class="calibre3">Next we review the process of analyzing a digital filter given the filter’s poles and zeros.</p>
<p class="calibre3"><a id="calibre_link-2758"></a></p>
<h4 class="calibre13">6.5.2 Using Poles/Zeros to Obtain Transfer Functions</h4>
<p class="calibre3">As it turns out, we can analyze an IIR filter’s frequency-domain performance based solely on the filter’s poles and zeros. Given that we know the values of a filter’s <em class="calibre7">z<sub class="calibre12">k</sub></em> zeros and <em class="calibre7">p<sub class="calibre12">k</sub></em> poles, we can write the factored form of the filter’s transfer function as</p>
<p class="caption"><a id="calibre_link-2759"></a><a id="calibre_link-2760"></a>(6-38)</p>
<p class="image"><img src="images/001493.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">G</em> = <em class="calibre7">G</em><sub class="calibre12">1</sub>/<em class="calibre7">G</em><sub class="calibre12">2</sub> is an arbitrary gain constant. Thus, knowing a filter’s <em class="calibre7">z<sub class="calibre12">k</sub></em> zeros and <em class="calibre7">p<sub class="calibre12">k</sub></em> poles, we can determine the filter’s transfer function to within a constant scale factor <em class="calibre7">G</em>.</p>
<p class="calibre3">Again, filter zeros are associated with decreased frequency magnitude response, and filter poles are associated with increased frequency magnitude response. For example, if we know that a filter has no <em class="calibre7">z</em>-plane zeros, and one pole at <em class="calibre7">p</em><sub class="calibre12">0</sub> = 0.8, we can write its transfer function as</p>
<p class="caption"><a id="calibre_link-2761"></a>(6-39)</p>
<p class="image"><img src="images/000531.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The characteristics of such a filter are depicted in <a href="#calibre_link-812">Figure 6-21(a)</a>. The |<em class="calibre7">H</em><sub class="calibre12">1</sub>(ω)| frequency magnitude response in the figure is normalized so that the peak magnitude is unity. Because the <em class="calibre7">p</em><sub class="calibre12">0</sub> pole is closest to the ω = 0 radians/sample frequency point (<em class="calibre7">z</em> = 1) on the unit circle, the filter is a lowpass filter. Additionally, because |<em class="calibre7">p</em><sub class="calibre12">0</sub>| is less than one, the filter is unconditionally stable.</p>
<p class="caption"><a id="calibre_link-812"></a><strong class="calibre9">Figure 6-21</strong> IIR filter poles/zeros and normalized frequency magnitude responses.</p>
<p class="image"><img src="images/000700.jpg" alt="image" class="calibre2" /></p>
<p class="image"><img src="images/000779.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If a filter has a zero at <em class="calibre7">z</em><sub class="calibre12">0</sub> = 1, and a pole at <em class="calibre7">p</em><sub class="calibre12">0</sub> = −0.8, we write its transfer function as</p>
<p class="caption"><a id="calibre_link-2762"></a>(6-40)</p>
<p class="image"><img src="images/001391.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The characteristics of this filter are shown in <a href="#calibre_link-812">Figure 6-21(b)</a>. Because the pole is closest to the ω = π radians/sample frequency point (<em class="calibre7">z</em> = −1) on the unit circle, the filter is a highpass filter. Notice that the zero located at <em class="calibre7">z</em> = 1 causes the filter to have infinite attenuation at ω = 0 radians/sample (zero Hz). Because this pole/zero filter analysis topic is so important, let us look at several more pole/zero examples.</p>
<p class="calibre3">Consider a filter having two complex conjugate zeros at −0.707 ± <em class="calibre7">j</em>0.707, as well as two complex conjugate poles at 0.283 ± <em class="calibre7">j</em>0.283. This filter’s transfer function is</p>
<p class="caption"><a id="calibre_link-2763"></a>(6-41)</p>
<p class="image"><img src="images/000430.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2764"></a>The properties of this <em class="calibre7">H</em><sub class="calibre12">3</sub>(<em class="calibre7">z</em>) filter are presented in <a href="#calibre_link-812">Figure 6-21(c)</a>. The two poles on the right side of the <em class="calibre7">z</em>-plane make this a lowpass filter having a wider passband than the above <em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">z</em>) lowpass filter. Two zeros are on the unit circle at angles of ω = ±3π/4 radians, causing the filter to have infinite attenuation at the frequencies ω = ±3π/4 radians/sample (±3<em class="calibre7">f<sub class="calibre12">s</sub></em>/8 Hz) as seen in the |<em class="calibre7">H</em><sub class="calibre12">3</sub>(ω)| magnitude response.</p>
<p class="calibre3"><a id="calibre_link-2765"></a>If we add a <em class="calibre7">z</em>-plane zero at <em class="calibre7">z</em> = 1 to the above <em class="calibre7">H</em><sub class="calibre12">3</sub>(<em class="calibre7">z</em>), we create an <em class="calibre7">H</em><sub class="calibre12">4</sub>(<em class="calibre7">z</em>) filter whose transfer function is</p>
<p class="caption"><a id="calibre_link-2766"></a>(6-42)</p>
<p class="image"><img src="images/001779.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The characteristics of this filter are shown in <a href="#calibre_link-812">Figure 6-21(d)</a>. The zero at <em class="calibre7">z</em> = 1 yields infinite attenuation at ω = 0 radians/sample (zero Hz), creating a bandpass filter. Because the <em class="calibre7">p</em><sub class="calibre12">0</sub> and <em class="calibre7">p</em><sub class="calibre12">1</sub> poles of <em class="calibre7">H</em><sub class="calibre12">4</sub>(<em class="calibre7">z</em>) are oriented at angles of <a id="calibre_link-2236"></a>θ = ±π/4 radians, the filter’s passbands are centered in the vicinity of frequencies ω = ±π/4 radians/sample (±<em class="calibre7">f<sub class="calibre12">s</sub></em>/8 Hz).</p>
<p class="calibre3">Next, if we increase the magnitude of the <em class="calibre7">H</em><sub class="calibre12">4</sub>(<em class="calibre7">z</em>) filter’s poles, making them equal to 0.636 ± <em class="calibre7">j</em>0.636, we position the conjugate poles much closer to the unit circle as shown by the <em class="calibre7">H</em><sub class="calibre12">5</sub>(<em class="calibre7">z</em>) characteristics in <a href="#calibre_link-812">Figure 6-21(e)</a>. The <em class="calibre7">H</em><sub class="calibre12">5</sub>(<em class="calibre7">z</em>) filter transfer function is</p>
<p class="caption"><a id="calibre_link-910"></a>(6-43)</p>
<p class="image"><img src="images/000318.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">There are two issues to notice in this scenario. First, poles near the unit circle now have a much more profound effect on the filter’s magnitude response. The poles’ infinite gains cause the <em class="calibre7">H</em><sub class="calibre12">5</sub>(<em class="calibre7">z</em>) passbands to be very narrow (sharp). Second, when a pole is close to the unit circle, the center frequency of its associated passband can be accurately estimated to be equal to the pole’s angle. That is, <a href="#calibre_link-812">Figure 6-21(e)</a> shows us that with the poles’ angles being θ = ±π/4 radians, the center frequencies of the narrow passbands are <em class="calibre7">very</em> nearly equal to ω = ±π/4 radians/sample (±<em class="calibre7">f<sub class="calibre12">s</sub></em>/8 Hz).</p>
<p class="calibre3">For completeness, one last pole/zero topic deserves mention. Consider a finite impulse response (FIR) filter&mdash;a digital filter whose <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function denominator is unity. For an FIR filter to have linear phase each <em class="calibre7">z</em>-plane zero located at <em class="calibre7">z</em> = <em class="calibre7">z</em><sub class="calibre12">0</sub> = <em class="calibre7">Me<sup class="calibre10">j</sup></em><sup class="calibre10">α</sup>, where <em class="calibre7">M</em> ≠ 1, must be accompanied by a zero having an angle of −α and a magnitude of 1/<em class="calibre7">M</em>. (Proof of this restriction is available in reference <a href="#calibre_link-813">[10]</a>.) We show this restriction in <a href="#calibre_link-812">Figure 6-21(f)</a> where the <em class="calibre7">z</em><sub class="calibre12">0</sub> zero is accompanied by the <em class="calibre7">z</em><sub class="calibre12">3</sub> zero. If the FIR filter’s transfer function polynomial has real-valued <em class="calibre7">b</em><sub class="calibre12">k</sub> coefficients, then a <em class="calibre7">z</em><sub class="calibre12">0</sub> zero not on the <em class="calibre7">z</em>-plane’s real axis will be accompanied by a complex conjugate zero at <em class="calibre7">z</em> = <em class="calibre7">z</em><sub class="calibre12">2</sub>. Likewise, for the FIR filter to have linear phase the <em class="calibre7">z</em><sub class="calibre12">2</sub> zero must be accompanied by the <em class="calibre7">z</em><sub class="calibre12">1</sub> zero. Of course, the <em class="calibre7">z</em><sub class="calibre12">1</sub> and the <em class="calibre7">z</em><sub class="calibre12">3</sub> zeros are complex conjugates of each other.</p>
<p class="calibre3">To conclude this section, we provide the following brief list of <em class="calibre7">z</em>-plane pole/zero properties that we should keep in mind as we work with digital filters:</p>
<p class="indenthangingb">• Filter poles are associated with increased frequency magnitude response (gain).</p>
<p class="indenthangingb">• Filter zeros are associated with decreased frequency magnitude response (attenuation).</p>
<p class="indenthangingb">• To be unconditionally stable all filter poles must reside inside the unit circle.</p>
<p class="indenthangingb">• Filter zeros do not affect filter stability.</p>
<p class="indenthangingb">• The closer a pole (zero) is to the unit circle, the stronger will be its effect on the filter’s gain (attenuation) at the frequency associated with the pole’s (zero’s) angle.</p>
<p class="indenthangingb"><a id="calibre_link-2155"></a>• A pole (zero) located on the unit circle produces infinite filter gain (attenuation).</p>
<p class="indenthangingb">• If a pole is at the same <em class="calibre7">z</em>-plane location as a zero, they cancel each other.</p>
<p class="indenthangingb">• Poles or zeros located at the origin of the <em class="calibre7">z</em>-plane do not affect the frequency response of the filter.</p>
<p class="indenthangingb">• Filters whose transfer function denominator (numerator) polynomial has real-valued coefficients have poles (zeros) located on the real <em class="calibre7">z</em>-plane axis, or pairs of poles (zeros) that are complex conjugates of each other.</p>
<p class="indenthangingb">• For an FIR filter (transfer function denominator is unity) to have linear phase, any zero on the <em class="calibre7">z</em>-plane located at <em class="calibre7">z</em><sub class="calibre12">0</sub> = <em class="calibre7">Me<sup class="calibre10">j</sup></em><sup class="calibre10">α</sup>, where <em class="calibre7">z</em><sub class="calibre12">0</sub> is not on the unit circle and α is not zero, must be accompanied by a reciprocal zero whose location is 1/<em class="calibre7">z</em><sub class="calibre12">0</sub> = <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>α</sup>/<em class="calibre7">M</em>.</p>
<p class="indenthangingb">• What the last two bullets mean is that if an FIR filter has real-valued coefficients, is linear phase, and has a <em class="calibre7">z</em>-plane zero not located on the real <em class="calibre7">z</em>-plane axis or on the unit circle, that <em class="calibre7">z</em>-plane zero is a member of a “gang of four” zeros. If we know the <em class="calibre7">z</em>-plane location of one of those four zeros, then we know the location of the other three zeros.</p>
<p class="calibre3"><a id="calibre_link-622"></a></p>
<h3 class="calibre6">6.6 Alternate IIR Filter Structures</h3>
<p class="calibre3">In the literature of DSP, it’s likely that you will encounter IIR filters other than the Direct Form I structure of the IIR filter in <a href="#calibre_link-790">Figure 6-17</a>. This point of our IIR filter studies is a good time to introduce those alternate IIR filter structures (block diagrams).</p>
<p class="calibre3"><a id="calibre_link-818"></a></p>
<h4 class="calibre13">6.6.1 Direct Form I, Direct Form II, and Transposed Structures</h4>
<p class="calibre3">The Direct Form I structure of the IIR filter in <a href="#calibre_link-790">Figure 6-17</a> can be converted to several alternate forms. It’s easy to explore this idea by assuming that there are two equal-length delay lines, letting <em class="calibre7">M</em> = <em class="calibre7">N</em> = 2 as in <a href="#calibre_link-814">Figure 6-22(a)</a>, and thinking of the feedforward and feedback portions as two separate filter stages. Because both stages of the filter are linear and time invariant, we can swap them, as shown in <a href="#calibre_link-814">Figure 6-22(b)</a>, with no change in the <em class="calibre7">y</em>(<em class="calibre7">n</em>) output.</p>
<p class="caption"><a id="calibre_link-814"></a><strong class="calibre9">Figure 6-22</strong> Rearranged 2nd-order IIR filter structures: (a) Direct Form I; (b) modified Direct Form I; (c) Direct Form II; (d) transposed Direct Form II.</p>
<p class="image"><img src="images/001409.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The two identical delay lines in <a href="#calibre_link-814">Figure 6-22(b)</a> provide the motivation for this reorientation. Because the sequence <em class="calibre7">g</em>(<em class="calibre7">n</em>) is being shifted down along both delay lines in <a href="#calibre_link-814">Figure 6-22(b)</a>, we can eliminate one of the delay paths and arrive at the simplified Direct Form II filter structure shown in <a href="#calibre_link-814">Figure 6-22(c)</a>, where only half the delay storage registers are required compared to the Direct Form I structure.</p>
<p class="calibre3">Another popular IIR structure is the <em class="calibre7">transposed</em> form of the Direct Form II filter. We obtain a transposed form by starting with the Direct Form II filter, <a id="calibre_link-2212"></a>convert its signal nodes to adders, convert its adders to signal nodes, reverse the direction of its arrows, and swap <em class="calibre7">x</em>(<em class="calibre7">n</em>) and <em class="calibre7">y</em>(<em class="calibre7">n</em>). (The transposition steps can also be applied to FIR filters.) Following these steps yields the transposed Direct Form II structure given in <a href="#calibre_link-814">Figure 6-22(d)</a>.</p>
<p class="calibre3">All the filters in <a href="#calibre_link-814">Figure 6-22</a> have the same performance just so long as infinite-precision arithmetic is used. However, using quantized binary arithmetic to represent our filter coefficients, and with truncation or rounding being used to combat binary overflow errors, the various filters in <a href="#calibre_link-814">Figure 6-22</a> exhibit different quantization noise and stability characteristics. In fact, the transposed Direct Form II structure was developed because it has improved behavior over the Direct Form II structure when fixed-point binary arithmetic is used. Common consensus among IIR filter designers is that the Direct Form I filter has the most resistance to coefficient quantization and stability problems. We’ll revisit these finite-precision arithmetic issues in <a href="#calibre_link-623">Section 6.7</a>.</p>
<p class="calibre3">By the way, because of the feedback nature of IIR filters, they’re often referred to as <em class="calibre7">recursive</em> filters. Similarly, FIR filters are often called <em class="calibre7">nonrecursive</em> <a id="calibre_link-2215"></a>filters. A common misconception is that all <em class="calibre7">recursive</em> filters are IIR. This not true because FIR filters can be implemented with recursive structures. (<a href="#calibre_link-187">Chapters 7</a> and <a href="#calibre_link-291">10</a> discuss filters having feedback but whose impulse responses are finite in duration.) So, the terminology <em class="calibre7">recursive</em> and <em class="calibre7">nonrecursive</em> should be applied to a filter’s structure, and the terms <em class="calibre7">IIR</em> and <em class="calibre7">FIR</em> should only be used to describe the time duration of the filter’s impulse response[<a href="#calibre_link-815">11</a>,<a href="#calibre_link-816">12</a>].</p>
<p class="calibre3"><a id="calibre_link-2767"></a></p>
<h4 class="calibre13">6.6.2 The Transposition Theorem</h4>
<p class="calibre3">There is a process in DSP that allows us to change the structure (the block diagram implementation) of a linear time-invariant digital network without changing the network’s transfer function (its frequency response). That network conversion process follows what is called the <em class="calibre7">transposition theorem.</em> That theorem is important because a transposed version of some digital network might be easier to implement, or may exhibit more accurate processing, than the original network.</p>
<p class="calibre3">We primarily think of the transposition theorem as it relates to digital filters, so below are the steps to transpose a digital filter (or any linear time-invariant network for that matter):</p>
<p class="indenthangingn1"><strong class="calibre9">1.</strong> Reverse the direction of all signal-flow arrows.</p>
<p class="indenthangingn1"><strong class="calibre9">2.</strong> Convert all adders to signal nodes.</p>
<p class="indenthangingn1"><strong class="calibre9">3.</strong> Convert all signal nodes to adders.</p>
<p class="indenthangingn1"><strong class="calibre9">4.</strong> Swap the <em class="calibre7">x</em>(<em class="calibre7">n</em>) input and <em class="calibre7">y</em>(<em class="calibre7">n</em>) output labels.</p>
<p class="calibre3">An example of this transposition process is shown in <a href="#calibre_link-817">Figure 6-23</a>. The Direct Form II IIR filter in <a href="#calibre_link-817">Figure 6-23(a)</a> is transposed to the structure shown in <a href="#calibre_link-817">Figure 6-23(b)</a>. By convention, we flip the network in <a href="#calibre_link-817">Figure 6-23(b)</a> from left to right so that the <em class="calibre7">x</em>(<em class="calibre7">n</em>) input is on the left as shown in <a href="#calibre_link-817">Figure 6-23(c)</a>.</p>
<p class="caption"><a id="calibre_link-817"></a><strong class="calibre9">Figure 6-23</strong> Converting a Direct Form II filter to its transposed form.</p>
<p class="image"><img src="images/000223.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Notice that the transposed filter contains the same number of delay elements, multipliers, and addition operations as the original filter, and both filters have the same transfer function given by</p>
<p class="caption"><a id="calibre_link-2768"></a>(6-44)</p>
<p class="image"><img src="images/001161.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">When implemented using infinite-precision arithmetic, the Direct Form II and the transposed Direct Form II filters have identical frequency response properties. As mentioned in <a href="#calibre_link-818">Section 6.6.1</a>, however, the transposed Direct Form II structure is less susceptible to the errors that can occur when finite-precision binary arithmetic, for example, in a 16-bit processor, is used to represent data values and filter coefficients within a filter implementation. That property is because Direct Form II filters implement their (possibly high-gain) <a id="calibre_link-2156"></a>feedback pole computations before their feedforward zeros computations, and this can lead to problematic (large) intermediate data values which must be truncated. The transposed Direct Form II filters, on the other hand, implement their zeros computations first followed by their pole computations.</p>
<p class="calibre3"><a id="calibre_link-623"></a></p>
<h3 class="calibre6">6.7 Pitfalls in Building IIR Filters</h3>
<p class="calibre3">There’s an old saying in engineering: “It’s one thing to design a system on paper, and another thing to actually build one and make it work.” (Recall the Tacoma Narrows Bridge episode!) Fabricating a working system based on theoretical designs can be difficult in practice. Let’s see why this is often true for IIR digital filters.</p>
<p class="calibre3">Again, the IIR filter structures in <a href="#calibre_link-798">Figures 6-18</a> and <a href="#calibre_link-814">6-22</a> are called Direct Form implementations of an IIR filter. That’s because they’re all equivalent to directly implementing the general time-domain expression for an <em class="calibre7">M</em>th-order <a id="calibre_link-2104"></a>IIR filter given in <a href="#calibre_link-791">Eq. (6-21)</a>. As it turns out, there can be stability problems and frequency response distortion errors when Direct Form implementations are used for high-order filters. Such problems arise because we’re forced to represent the IIR filter coefficients and results of intermediate filter calculations with binary numbers having a finite number of bits. There are three major categories of finite-word-length errors that plague IIR filter implementations: coefficient quantization, overflow errors, and roundoff errors.</p>
<p class="calibre3">Coefficient quantization (limited-precision coefficients) will result in filter pole and zero shifting on the <em class="calibre7">z</em>-plane, and a frequency magnitude response that may not meet our requirements, and the response distortion worsens for higher-order IIR filters.</p>
<p class="calibre3">Overflow, the second finite-word-length effect that troubles IIR filters, is what happens when the result of an arithmetic operation is too large to be represented in the fixed-length hardware registers assigned to contain that result. Because we perform so many additions when we implement IIR filters, overflow is always a potential problem. With no precautions being taken to handle overflow, large nonlinearity errors can result in our filter output samples&mdash;often in the form of <em class="calibre7">overflow oscillations</em>.</p>
<p class="calibre3">The most common way of dealing with binary overflow errors is called <em class="calibre7">roundoff,</em> or rounding, where a data value is represented by, or rounded off to, the <em class="calibre7">b</em>-bit binary number that’s nearest the unrounded data value. It’s usually valid to treat roundoff errors as a random process, but conditions occur in IIR filters where rounding can cause the filter output to oscillate forever even when the filter input sequence is all zeros. This situation, caused by the roundoff noise being highly correlated with the signal, going by the names <em class="calibre7">limit cycles</em> and <em class="calibre7">deadband effects</em>, has been well analyzed in the literature[<a href="#calibre_link-819">13</a>,<a href="#calibre_link-820">14</a>]. We can demonstrate limit cycles by considering the 2nd-order IIR filter in <a href="#calibre_link-821">Figure 6-24(a)</a> whose time-domain expression is</p>
<p class="caption"><a id="calibre_link-2769"></a>(6-45)</p>
<p class="image"><img src="images/000206.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-821"></a><strong class="calibre9">Figure 6-24</strong> Limit cycle oscillations due to rounding: (a) 2nd-order IIR filter; (b) one possible time-domain response of the IIR filter.</p>
<p class="image"><img src="images/000853.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Let’s assume this filter rounds the adder’s output to the nearest integer value. If the situation ever arises where <em class="calibre7">y</em>(−2) = 0, <em class="calibre7">y</em>(−1) = 8, and <em class="calibre7">x</em>(0) and all successive <em class="calibre7">x</em>(<em class="calibre7">n</em>) inputs are zero, the filter output goes into endless oscillation as shown in <a href="#calibre_link-821">Figure 6-24(b)</a>. If this filter were to be used in an audio application, when the input signal went silent the listener could end up hearing an audio tone instead of silence. The dashed line in <a href="#calibre_link-821">Figure 6-24(b)</a> shows the filter’s stable response to this particular situation if no rounding is used. With rounding, however, this IIR filter certainly lives up to its name. (Welcome to the world of binary arithmetic!)</p>
<p class="calibre3">There are several ways to reduce the ill effects of coefficient quantization errors and limit cycles. We can increase the word widths of the hardware registers that contain the results of intermediate calculations. Because roundoff limit cycles affect the least significant bits of an arithmetic result, larger word <a id="calibre_link-2167"></a>sizes diminish the impact of limit cycles should they occur. To avoid filter input sequences of all zeros, some practitioners add a <em class="calibre7">dither sequence</em> to the filter’s input signal sequence. A dither sequence is a sequence of low-amplitude pseudo-random numbers that interferes with an IIR filter’s roundoff error generation tendency, allowing the filter output to reach zero should the input signal remain at zero. Dithering, however, decreases the effective signal-to-noise ratio of the filter output[<a href="#calibre_link-816">12</a>]. Finally, to avoid limit cycle problems, we can just use an FIR filter. Because FIR filters by definition have finite-length impulse responses, and have no feedback paths, they cannot support output oscillations of any kind.</p>
<p class="calibre3">As for overflow errors, we can eliminate them if we increase the word width of hardware registers so overflow never takes place in the IIR filter. Filter input signals can be scaled (reduced in amplitude by multiplying signals within the filter by a factor less than one) so overflow is avoided. We discuss such filter scaling in <a href="#calibre_link-625">Section 6.9</a>. Overflow oscillations can be avoided by using saturation arithmetic logic where signal values aren’t permitted to exceed a fixed limit when an overflow condition is detected[<a href="#calibre_link-822">15</a>,<a href="#calibre_link-823">16</a>]. It may be useful for the reader to keep in mind that when the signal data is represented in two’s complement arithmetic, multiple summations resulting in intermediate overflow errors cause no problems if we can guarantee that the final magnitude <a id="calibre_link-2043"></a>of the sum of the numbers is not too large for the final accumulator register. Of course, standard floating-point number formats can greatly reduce the errors associated with overflow oscillations and limit cycles<a href="#calibre_link-824">[17]</a>. (We discuss floating-point number formats in <a href="#calibre_link-292">Chapter 12</a>.)</p>
<p class="calibre3">These quantized coefficient and overflow errors, caused by finite-width words, have different effects depending on the IIR filter structure used. Referring to <a href="#calibre_link-814">Figure 6-22</a>, practice has shown the Direct Form II structure to be the most error-prone IIR filter implementation.</p>
<p class="calibre3">The most popular technique for minimizing the errors associated with finite-word-length widths is to design IIR filters comprising a cascade string, or parallel combination, of low-order filters. The next section tells us why.</p>
<p class="calibre3"><a id="calibre_link-624"></a></p>
<h3 class="calibre6">6.8 Improving IIR Filters with Cascaded Structures</h3>
<p class="calibre3">Filter designers minimize IIR filter stability and quantization noise problems in high-performance filters by implementing combinations of cascaded lower-performance filters. Before we consider this design idea, let’s review several important issues regarding the behavior of combinations of multiple filters.</p>
<p class="calibre3"><a id="calibre_link-130"></a></p>
<h4 class="calibre13">6.8.1 Cascade and Parallel Filter Properties</h4>
<p class="calibre3">Here we summarize the <em class="calibre7">combined</em> behavior of linear time-invariant filters (be they IIR or FIR) connected in cascade and in parallel. As indicated in <a href="#calibre_link-825">Figure 6-25(a)</a>, the resultant transfer function of two cascaded filter transfer functions is the product of those functions, or</p>
<p class="caption"><a id="calibre_link-2770"></a>(6-46)</p>
<p class="image"><img src="images/001050.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-825"></a><strong class="calibre9">Figure 6-25</strong> Combinations of two filters: (a) cascaded filters; (b) parallel filters.</p>
<p class="image"><img src="images/001473.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">with an overall frequency response of</p>
<p class="caption"><a id="calibre_link-827"></a>(6-47)</p>
<p class="image"><img src="images/000105.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">It’s also important to know that the resultant impulse response of cascaded filters is</p>
<p class="caption"><a id="calibre_link-2771"></a>(6-48)</p>
<p class="image"><img src="images/000541.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where “*” means convolution.</p>
<p class="calibre3">As shown in <a href="#calibre_link-825">Figure 6-25(b)</a>, the combined transfer function of two filters connected in parallel is the sum of their transfer functions, or</p>
<p class="caption"><a id="calibre_link-2772"></a>(6-49)</p>
<p class="image"><img src="images/000056.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">with an overall frequency response of</p>
<p class="caption"><a id="calibre_link-2773"></a>(6-50)</p>
<p class="image"><img src="images/000439.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2397"></a>The resultant impulse response of parallel filters is the sum of their individual impulse responses, or</p>
<p class="caption"><a id="calibre_link-2774"></a>(6-51)</p>
<p class="image"><img src="images/001290.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">While we are on the subject of cascaded filters, let’s develop a rule of thumb for estimating the combined passband ripple of the two cascaded filters in <a href="#calibre_link-825">Figure 6-25(a)</a>. The cascaded passband ripple is a function of each individual filter’s passband ripple. If we represent an arbitrary filter’s peak passband ripple on a linear (not dB) vertical axis as shown in <a href="#calibre_link-826">Figure 6-26</a>, we can begin our cascaded ripple estimation.</p>
<p class="caption"><a id="calibre_link-826"></a><strong class="calibre9">Figure 6-26</strong> Definition of filter passband ripple <em class="calibre7">R</em>.</p>
<p class="image"><img src="images/000299.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">From <a href="#calibre_link-827">Eq. (6-47)</a>, the upper bound (the peak) of a cascaded filter’s passband response, 1 + <em class="calibre7">R</em><sub class="calibre12">cas</sub>, is the product of the two <em class="calibre7">H</em><sub class="calibre12">1</sub>(ω) and <em class="calibre7">H</em><sub class="calibre12">2</sub>(ω) filters’ peak passband responses, or</p>
<p class="caption"><a id="calibre_link-2775"></a>(6-52)</p>
<p class="image"><img src="images/000328.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2337"></a>For small values of <em class="calibre7">R</em><sub class="calibre12">1</sub> and <em class="calibre7">R</em><sub class="calibre12">2</sub>, the <em class="calibre7">R</em><sub class="calibre12">1</sub><em class="calibre7">R</em><sub class="calibre12">2</sub> term becomes negligible, and we state our rule of thumb as</p>
<p class="caption"><a id="calibre_link-2776"></a>(6-53)</p>
<p class="image"><img src="images/001172.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Thus, in designs using two cascaded filters it’s prudent to specify their individual passband ripple values to be roughly half the desired <em class="calibre7">R</em><sub class="calibre12">cas</sub> ripple specification for the final combined filter, or</p>
<p class="caption"><a id="calibre_link-2777"></a>(6-54)</p>
<p class="image"><img src="images/000213.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2778"></a></p>
<h4 class="calibre13">6.8.2 Cascading IIR Filters</h4>
<p class="calibre3">Experienced filter designers routinely partition high-order IIR filters into a string of 2nd-order IIR filters arranged in cascade because these lower-order filters are easier to design, are less susceptible to coefficient quantization errors and stability problems, and their implementations allow easier data word scaling to reduce the potential overflow effects of data word size growth.</p>
<p class="calibre3">Optimizing the partitioning of a high-order filter into multiple 2nd-order filter sections is a challenging task, however. For example, say we have the 6th-order Direct Form I filter in <a href="#calibre_link-828">Figure 6-27(a)</a> that we want to partition into three 2nd-order sections. In factoring the 6th-order filter’s <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function, we could get up to three separate sets of feedforward coefficients in the factored <em class="calibre7">H</em>(<em class="calibre7">z</em>) numerator: <em class="calibre7">b</em>′(<em class="calibre7">k</em>), <em class="calibre7">b</em>″(<em class="calibre7">k</em>), and <em class="calibre7">b</em>′′′(<em class="calibre7">k</em>). Likewise, we could have up to three separate sets of feedback coefficients in the factored denominator: <em class="calibre7">a</em>′(<em class="calibre7">k</em>), <em class="calibre7">a</em>″(<em class="calibre7">k</em>), and <em class="calibre7">a</em>′′′(<em class="calibre7">k</em>). Because there are three 2nd-order sections, there are three factorial, or six, ways of <em class="calibre7">pairing</em> the sets of coefficients. Notice in <a href="#calibre_link-828">Figure 6-27(b)</a> how the first section uses the <em class="calibre7">a</em>′(<em class="calibre7">k</em>) and <em class="calibre7">b</em>′(<em class="calibre7">k</em>) coefficients, and the second section uses the <em class="calibre7">a</em>″(<em class="calibre7">k</em>) and <em class="calibre7">b</em>″(<em class="calibre7">k</em>) coefficients. We could just as well have interchanged the sets of coefficients so the first 2nd-order section uses the <em class="calibre7">a</em>′(<em class="calibre7">k</em>) and <em class="calibre7">b</em>″(<em class="calibre7">k</em>) coefficients, and the second section uses the <em class="calibre7">a</em>″(<em class="calibre7">k</em>) and <em class="calibre7">b</em>′(<em class="calibre7">k</em>) coefficients. So, there are six different mathematically equivalent ways of combining the sets of coefficients. Add to this the fact that for each different combination of low-order sections there are three factorial distinct ways those three separate 2nd-order sections can be arranged in cascade.</p>
<p class="caption"><a id="calibre_link-828"></a><strong class="calibre9">Figure 6-27</strong> IIR filter partitioning: (a) initial 6th-order IIR filter; (b) three 2nd-order sections.</p>
<p class="image"><img src="images/000923.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">This means if we want to partition a 2<em class="calibre7">M</em>-order IIR filter into <em class="calibre7">M</em> distinct 2nd-order sections, there are <em class="calibre7">M</em> factorial squared, (<em class="calibre7">M</em>!)<sup class="calibre10">2</sup>, ways to do so. As such, there are then (3!)<sup class="calibre10">2</sup> = 24 different cascaded filters we could obtain when going from <a href="#calibre_link-828">Figure 6-27(a)</a> to <a href="#calibre_link-828">Figure 6-27(b)</a>. To further complicate this filter partitioning problem, the errors due to coefficient quantization will, in general, be different for each possible filter combination. Although full details of this subject are outside the scope of this introductory text, ambitious readers can find further material on optimizing cascaded filter sections in references <a href="#calibre_link-820">[14]</a> and <a href="#calibre_link-829">[18]</a>, and in Part 3 of reference <a href="#calibre_link-830">[19]</a>.</p>
<p class="calibre3"><a id="calibre_link-2779"></a>One simple (although perhaps not optimum) method for arranging cascaded 2nd-order sections has been proposed<a href="#calibre_link-829">[18]</a>. First, factor a high-order IIR filter’s <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function into a ratio of the form</p>
<p class="caption"><a id="calibre_link-2780"></a>(6-55)</p>
<p class="image"><img src="images/001059.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">with the <em class="calibre7">z<sub class="calibre12">k</sub></em> zeros in the numerator and <em class="calibre7">p<sub class="calibre12">k</sub></em> poles in the denominator. (Ideally you have a signal processing software package to perform the factorization.) Next, the 2nd-order section assignments go like this:</p>
<p class="indenthangingn1"><strong class="calibre9">1.</strong> Find the pole, or pole pair, in <em class="calibre7">H</em>(<em class="calibre7">z</em>) closest to the unit circle.</p>
<p class="indenthangingn1"><strong class="calibre9">2.</strong> Find the zero, or zero pair, closest to the pole, or pole pair, found in Step 1.</p>
<p class="indenthangingn1"><a id="calibre_link-2023"></a><strong class="calibre9">3.</strong> Combine those poles and zeros into a single 2nd-order filter section. This means your first 2nd-order section may be something like</p>
<p class="caption"><a id="calibre_link-2781"></a>(6-56)</p>
<p class="image"><img src="images/000111.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn1"><strong class="calibre9">4.</strong> Repeat Steps 1 to 3 until all poles and zeros have been combined into 2nd-order sections.</p>
<p class="indenthangingn1"><strong class="calibre9">5.</strong> The final ordering (cascaded sequence) of the sections is based on how far the sections’ poles are from the unit circle. Order the sections in either increasing or decreasing pole distances from the unit circle.</p>
<p class="indenthangingn1"><strong class="calibre9">6.</strong> Implement your filter as cascaded 2nd-order sections in the order from Step 5.</p>
<p class="calibre3">In digital filter vernacular, a 2nd-order IIR filter is called a <em class="calibre7">biquad</em> for two reasons. First, the filter’s <em class="calibre7">z</em>-domain transfer function includes two quadratic polynomials. Second, the word <em class="calibre7">biquad</em> sounds cool.</p>
<p class="calibre3">By the way, we started our 2nd-order sectioning discussion with a high-order Direct Form I filter in <a href="#calibre_link-828">Figure 6-27(a)</a>. We chose that filter form because it’s the structure most resistant to coefficient quantization and overflow problems. As seen in <a href="#calibre_link-828">Figure 6-27(a)</a>, we have redundant delay elements. These can be combined, as shown in <a href="#calibre_link-831">Figure 6-28</a>, to reduce our temporary storage requirements as we did with the Direct Form II structure in <a href="#calibre_link-814">Figure 6-22</a>.</p>
<p class="caption"><a id="calibre_link-831"></a><strong class="calibre9">Figure 6-28</strong> Cascaded Direct Form I filters with reduced temporary data storage.</p>
<p class="image"><img src="images/001629.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">There’s much material in the literature concerning finite word effects as they relate to digital IIR filters. (References <a href="#calibre_link-829">[18]</a>, <a href="#calibre_link-832">[20]</a>, and <a href="#calibre_link-833">[21]</a> discuss quantization noise effects in some detail as well as providing extensive bibliographies on the subject.)</p>
<p class="calibre3"><a id="calibre_link-625"></a></p>
<h3 class="calibre6"><a id="calibre_link-2294" class="calibre5"></a>6.9 Scaling the Gain of IIR Filters</h3>
<p class="calibre3">In order to impose limits on the magnitudes of data values within an IIR filter, we may wish to change the passband gain of that filter[<a href="#calibre_link-834">22</a>,<a href="#calibre_link-835">23</a>].</p>
<p class="calibre3">For example, consider the 1st-order lowpass IIR filter in <a href="#calibre_link-836">Figure 6-29(a)</a> that has a DC gain (gain at zero Hz) of 3.615. (This means that, just as with FIR filters, the sum of the IIR filter’s impulse response samples is equal to the DC gain of 3.615.)</p>
<p class="caption"><a id="calibre_link-836"></a><strong class="calibre9">Figure 6-29</strong> Lowpass IIR filters: (a) DC gain = 3.615; (b) DC gain = 1.</p>
<p class="image"><img src="images/000369.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The DC gain of an IIR filter is the sum of the filter’s feedforward coefficients divided by 1 minus the sum of the filter’s feedback coefficients. (We leave the proof of that statement as a homework problem.) That is, the DC gain of the <a href="#calibre_link-836">Figure 6-29(a)</a> 1st-order filter is</p>
<p class="caption"><a id="calibre_link-2782"></a>(6-57)</p>
<p class="image"><img src="images/000951.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Now let’s say we want, for some reason, the filter’s DC gain to be one (unity gain). This is easy to accomplish. We merely divide the filter’s feedforward coefficients by the original DC gain as</p>
<p class="caption"><a id="calibre_link-2783"></a>(6-58)</p>
<p class="image"><img src="images/000305.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Doing so gives us a new filter whose feedforward coefficients are those shown in <a href="#calibre_link-836">Figure 6-29(b)</a>. That new lowpass filter has a DC gain of one. Changing a filter’s coefficients in this way is called <em class="calibre7">filter scaling</em>. Happily, this filter scaling does not change the shape of the original filter’s frequency magnitude or phase response.</p>
<p class="calibre3">Likewise, to force the passband gain of a highpass filter to be unity, we divide the filter’s feedforward coefficients by the original filter’s frequency magnitude response at <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 (half the sampling rate).</p>
<p class="calibre3"><a id="calibre_link-2784"></a>Unlike passive analog (continuous-time) filters that operate by attenuating spectral energy in their stopbands, digital IIR filters operate by amplifying spectral energy in their passbands. Because of this positive passband gain behavior, there is another type of IIR filter scaling that’s used in many situations. It is possible that an IIR filter may have a passband gain so high that the filter generates internal sample values too large to be accommodated by the hardware, with its internal binary number format, used to implement the filter. Stated in different words, it’s possible for a filter to generate internal data values so large that they overflow the registers in which the data is to be stored. This situation can also occur when multiple 2nd-order IIR filters are cascaded as discussed in <a href="#calibre_link-624">Section 6.8</a>.</p>
<p class="calibre3">In such cases, should we wish to reduce the passband gain of an IIR filter without changing the shape of its frequency magnitude or phase responses, we can do so by implementing one of the filters shown in <a href="#calibre_link-837">Figure 6-30</a>.</p>
<p class="caption"><a id="calibre_link-837"></a><strong class="calibre9">Figure 6-30</strong> Scaled IIR filter structures: (a) Direct Form I; (b) Direct Form II.</p>
<p class="image"><img src="images/000988.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If an IIR filter has an original passband gain of <em class="calibre7">G</em><sub class="calibre12">IIR</sub>, we can change that passband gain by modifying the original filter’s coefficients using the scalar <a id="calibre_link-1974"></a><em class="calibre7">G</em><sub class="calibre12">1</sub> and <em class="calibre7">G</em><sub class="calibre12">2</sub> gain factors shown in <a href="#calibre_link-837">Figure 6-30</a>. Changing a filter’s coefficients in this way is also called <em class="calibre7">filter scaling</em>. The passband gain of a scaled filter is</p>
<p class="caption"><a id="calibre_link-838"></a>(6-59)</p>
<p class="image"><img src="images/000842.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The general philosophy in these matters is to choose factors <em class="calibre7">G</em><sub class="calibre12">1</sub> and <em class="calibre7">G</em><sub class="calibre12">2</sub> so that we preserve the filter’s output signal quality (called the <em class="calibre7">signal-to-noise ratio</em>, SNR, as discussed in <a href="#calibre_link-292">Chapter 12</a> and <a href="#calibre_link-27">Appendix D</a>) as much as possible. This means keeping all internal sample values as large as can be accommodated by the filter hardware registers. The problem is, there’s no simple way to determine the values of <em class="calibre7">G</em><sub class="calibre12">1</sub> and <em class="calibre7">G</em><sub class="calibre12">2</sub>. The suggested procedure is to select one of the <a href="#calibre_link-837">Figure 6-30</a> implementations and apply the expected input signal to the filter. Next we experiment with different values for gain factors <em class="calibre7">G</em><sub class="calibre12">1</sub> and <em class="calibre7">G</em><sub class="calibre12">2</sub> from <a href="#calibre_link-838">Eq. (6-59)</a> until the final filter gain, <em class="calibre7">G</em><sub class="calibre12">IIR-scaled</sub>, is an acceptable value. Following that, we select an alternate <a href="#calibre_link-837">Figure 6-30</a> filter structure and experiment with different values for gains <em class="calibre7">G</em><sub class="calibre12">1</sub> and <em class="calibre7">G</em><sub class="calibre12">2</sub> to see if we can improve on the previous scaled-filter structure.</p>
<p class="calibre3">For computational efficiency reasons, if we’re able to set <em class="calibre7">G</em><sub class="calibre12">2</sub> to be the reciprocal of an integer power of two, then we can eliminate one of the multiplies in <a href="#calibre_link-837">Figure 6-30</a>. That is, in this scenario the multiply by <em class="calibre7">G</em><sub class="calibre12">2</sub> operation can then be implemented with binary right shifts. Then again, perhaps factors <em class="calibre7">G</em><sub class="calibre12">1</sub> and <em class="calibre7">G</em><sub class="calibre12">2</sub> can be chosen so that one of the modified filter coefficients is unity in order to eliminate a multiply operation.</p>
<p class="calibre3">Now that we have some understanding of the performance and implementation structures of IIR filters, let’s briefly introduce three filter design techniques. These IIR design methods go by the impressive names of <em class="calibre7">impulse invariance</em>, <em class="calibre7">bilinear transform</em>, and <em class="calibre7">optimized</em> methods. The first two methods use <em class="calibre7">analytical</em>, pencil and paper algebra, filter design techniques to approximate continuous analog filters. (By “analog filters” we mean those hardware filters made up of resistors, capacitors, and perhaps operational amplifiers.)</p>
<p class="calibre3">Because analog filter design methods are very well understood, designers can take advantage of an abundant variety of analog filter design techniques to design, say, a digital IIR Butterworth filter with its very flat passband response, or perhaps go with a Chebyshev filter with its fluctuating passband response and sharper passband-to-stopband cutoff characteristics. The <em class="calibre7">optimized methods</em> (by far the most popular way of designing IIR filters) comprise linear algebra algorithms available in commercial filter design software packages.</p>
<p class="calibre3">The impulse invariance, bilinear transform filter design methods are somewhat involved, so a true DSP beginner is justified in skipping those subjects upon first reading this book. However, those filter design topics may well be valuable sometime in your future as your DSP knowledge, experience, and challenges grow.</p>
<p class="calibre3"><a id="calibre_link-626"></a></p>
<h3 class="calibre6"><a id="calibre_link-2213" class="calibre5"></a>6.10 Impulse Invariance IIR Filter Design Method</h3>
<p class="calibre3">The impulse invariance method of IIR filter design is based upon the notion that we can design a discrete filter whose time-domain impulse response is a sampled version of the impulse response of a continuous analog filter. If that analog filter (often called the <em class="calibre7">prototype filter</em>) has some desired frequency response, then our IIR filter will yield a discrete approximation of that desired response. The impulse response equivalence of this design method is depicted in <a href="#calibre_link-839">Figure 6-31</a>, where we use the conventional notation of δ to represent an impulse function and <em class="calibre7">h<sub class="calibre12">c</sub></em>(<em class="calibre7">t</em>) is the analog filter’s impulse response. We use the subscript “<em class="calibre7">c</em>” in <a href="#calibre_link-839">Figure 6-31(a)</a> to emphasize the continuous nature of the analog filter. <a href="#calibre_link-839">Figure 6-31(b)</a> illustrates the definition of the discrete filter’s impulse response: the filter’s time-domain output sequence when the input is a single unity-valued sample (impulse) preceded and followed by all zero-valued samples. Our goal is to design a digital filter whose impulse response is a sampled version of the analog filter’s continuous impulse response. Implied in the correspondence of the continuous and discrete impulse responses is the property that we can map each pole on the <em class="calibre7">s</em>-plane for the analog filter’s <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) transfer function to a pole on the <em class="calibre7">z</em>-plane for the discrete IIR filter’s <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function. What designers have found is that the impulse invariance method does yield useful IIR filters, as long as the sampling rate is high relative to the bandwidth of the signal to be filtered. In other words, IIR filters designed using the impulse invariance method are susceptible to aliasing problems because practical analog filters cannot be perfectly band-limited. Aliasing will occur in an IIR filter’s frequency response as shown in <a href="#calibre_link-840">Figure 6-32</a>.</p>
<p class="caption"><a id="calibre_link-1963"></a><a id="calibre_link-839"></a><strong class="calibre9">Figure 6-31</strong> Impulse invariance design equivalence of (a) analog filter continuous impulse response; (b) digital filter discrete impulse response.</p>
<p class="image"><img src="images/000681.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-840"></a><strong class="calibre9">Figure 6-32</strong> Aliasing in the impulse invariance design method: (a) prototype analog filter magnitude response; (b) replicated magnitude responses where <em class="calibre7">H</em><sub class="calibre12">IIR</sub>(ω) is the discrete Fourier transform of <em class="calibre7">h</em>(<em class="calibre7">n</em>) = <em class="calibre7">h<sub class="calibre12">c</sub></em>(<em class="calibre7">nt<sub class="calibre12">s</sub></em>); (c) potential resultant IIR filter magnitude response with aliasing effects.</p>
<p class="image"><img src="images/001320.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">From what we’ve learned in <a href="#calibre_link-287">Chapter 2</a> about the spectral replicating effects of sampling, if <a href="#calibre_link-840">Figure 6-32(a)</a> is the spectrum of the continuous <em class="calibre7">h<sub class="calibre12">c</sub></em>(<em class="calibre7">t</em>) impulse response, then the spectrum of the discrete <em class="calibre7">h<sub class="calibre12">c</sub></em>(<em class="calibre7">nt<sub class="calibre12">s</sub></em>) sample sequence is the replicated spectra in <a href="#calibre_link-840">Figure 6-32(b)</a>.</p>
<p class="calibre3">In <a href="#calibre_link-840">Figure 6-32(c)</a> we show the possible effect of aliasing where the dashed curve is a desired <em class="calibre7">H</em><sub class="calibre12">IIR</sub>(ω) frequency magnitude response. However, the actual frequency magnitude response, indicated by the solid curve, can occur when we use the impulse invariance design method. For this reason, we prefer to make the sample frequency <em class="calibre7">f<sub class="calibre12">s</sub></em> as large as possible to minimize the overlap between the primary frequency response curve and its replicated images spaced at multiples of ±<em class="calibre7">f<sub class="calibre12">s</sub></em> Hz.</p>
<p class="calibre3">Due to the aliasing behavior of the impulse invariance design method, this filter design process should never be used to design highpass digital filters. To see how aliasing can affect IIR filters designed with this method, let’s <a id="calibre_link-2338"></a>list the necessary impulse invariance design steps and then go through a lowpass filter design example.</p>
<p class="calibre3">There are two different methods for designing IIR filters using impulse invariance. The first method, which we’ll call Method 1, requires that an inverse Laplace transform as well as a <em class="calibre7">z-</em>transform be performed[<a href="#calibre_link-841">24</a>,<a href="#calibre_link-842">25</a>]. The second impulse invariance design technique, Method 2, uses a direct substitution process to avoid the inverse Laplace and <em class="calibre7">z-</em>transformations at the expense of needing partial fraction expansion algebra necessary to handle polynomials[<a href="#calibre_link-832">20</a>,<a href="#calibre_link-833">21</a>,<a href="#calibre_link-843">26</a>,<a href="#calibre_link-844">27</a>]. Both of these methods seem complicated when described in words, but they’re really not as difficult as they sound. Let’s compare the two methods by listing the steps required for each of them. The impulse invariance design Method 1 goes like this:</p>
<p class="indenthanging3"><strong class="calibre9">Method 1, Step 1:</strong> Design (or have someone design for you) a prototype analog filter with the desired frequency response.<sup class="calibre10"><a id="calibre_link-846"></a><a href="#calibre_link-845">†</a></sup> The result of this step is a continuous Laplace transfer function <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) expressed as the ratio of two polynomials, such as</p>
<p class="footnotes"><a id="calibre_link-845"></a><sup class="calibre11"><a href="#calibre_link-846">†</a></sup> In a lowpass filter design, for example, the filter type (Chebyshev, Butterworth, elliptic), filter order (number of poles), and the cutoff frequency are parameters to be defined in this step.</p>
<p class="caption"><a id="calibre_link-855"></a>(6-60)</p>
<p class="image"><img src="images/001703.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging4">which is the general form of <a href="#calibre_link-766">Eq. (6-10)</a> with <em class="calibre7">N</em> &lt; <em class="calibre7">M</em>, and <em class="calibre7">a</em>(<em class="calibre7">k</em>) and <em class="calibre7">b</em>(<em class="calibre7">k</em>) are constants.</p>
<p class="indenthanging3"><strong class="calibre9">Method 1, Step 2:</strong> Determine the analog filter’s continuous time-domain impulse response <em class="calibre7">h<sub class="calibre12">c</sub></em>(<em class="calibre7">t</em>) from the <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) Laplace transfer function. I hope this can be done using Laplace tables as opposed to actually evaluating an inverse Laplace transform equation.</p>
<p class="indenthanging3"><strong class="calibre9">Method 1, Step 3:</strong> Determine the digital filter’s sampling frequency <em class="calibre7">f<sub class="calibre12">s</sub></em>, and calculate the sample period as <em class="calibre7">t<sub class="calibre12">s</sub></em> = 1/<em class="calibre7">f<sub class="calibre12">s</sub></em>. The <em class="calibre7">f<sub class="calibre12">s</sub></em> sampling rate is chosen based on the absolute frequency, in Hz, of the prototype analog filter. Because of the aliasing problems associated with this impulse invariance design method, later, we’ll see why <em class="calibre7">f<sub class="calibre12">s</sub></em> should be made as large as is practical.</p>
<p class="indenthanging3"><a id="calibre_link-2785"></a><strong class="calibre9">Method 1, Step 4:</strong> Find the <em class="calibre7">z-</em>transform of the continuous <em class="calibre7">h<sub class="calibre12">c</sub></em>(<em class="calibre7">t</em>) to obtain the IIR filter’s <em class="calibre7">z-</em>domain transfer function <em class="calibre7">H</em>(<em class="calibre7">z</em>) in the form of a ratio of polynomials in <em class="calibre7">z</em>.</p>
<p class="indenthanging3"><strong class="calibre9">Method 1, Step 5:</strong> Substitute the value (not the variable) <em class="calibre7">t<sub class="calibre12">s</sub></em> for the continuous variable <em class="calibre7">t</em> in the <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function obtained in Step 4. In performing this step, we are ensuring, as in <a href="#calibre_link-839">Figure 6-31</a>, that the IIR filter’s discrete <em class="calibre7">h</em>(<em class="calibre7">n</em>) impulse response is a sampled version of the continuous filter’s <em class="calibre7">h<sub class="calibre12">c</sub></em>(<em class="calibre7">t</em>) impulse response so that <em class="calibre7">h</em>(<em class="calibre7">n</em>) = <em class="calibre7">h<sub class="calibre12">c</sub></em>(<em class="calibre7">nt<sub class="calibre12">s</sub></em>), for 0 ≤ <em class="calibre7">n</em> ≤ ∞.</p>
<p class="indenthanging3"><strong class="calibre9">Method 1, Step 6:</strong> Our <em class="calibre7">H</em>(<em class="calibre7">z</em>) from Step 5 will now be of the general form</p>
<p class="caption"><a id="calibre_link-847"></a>(6-61)</p>
<p class="image"><img src="images/000721.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging4">Because the process of sampling the continuous impulse response results in a digital filter frequency response that’s scaled by a factor of 1/<em class="calibre7">t<sub class="calibre12">s</sub></em>, many filter designers find it appropriate to include the <em class="calibre7">t<sub class="calibre12">s</sub></em> factor in <a href="#calibre_link-847">Eq. (6-61)</a>. So we can rewrite <a href="#calibre_link-847">Eq. (6-61)</a> as</p>
<p class="caption"><a id="calibre_link-848"></a>(6-62)</p>
<p class="image"><img src="images/001577.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging4">Incorporating the value of <em class="calibre7">t<sub class="calibre12">s</sub></em> in <a href="#calibre_link-848">Eq. (6-62)</a>, then, makes the IIR filter time-response scaling independent of the sampling rate, and the discrete filter will have the same gain as the prototype analog filter.<sup class="calibre10"><a id="calibre_link-850"></a><a href="#calibre_link-849">†</a></sup></p>
<p class="footnotes"><a id="calibre_link-849"></a><sup class="calibre11"><a href="#calibre_link-850">†</a></sup> Some authors have chosen to include the <em class="calibre7">t<sub class="calibre14">s</sub></em> factor in the discrete <em class="calibre7">h</em>(<em class="calibre7">n</em>) impulse response in the above Step 4, that is, make <em class="calibre7">h</em>(<em class="calibre7">n</em>) = <em class="calibre7">t<sub class="calibre14">s</sub>h<sub class="calibre14">c</sub></em>(<em class="calibre7">nt<sub class="calibre14">s</sub></em>)[<a href="#calibre_link-832">20</a>, <a href="#calibre_link-851">28</a>]. The final result of this, of course, is the same as that obtained by including <em class="calibre7">t<sub class="calibre14">s</sub></em> as described in Step 6.</p>
<p class="indenthanging3"><strong class="calibre9">Method 1, Step 7:</strong> Because <a href="#calibre_link-847">Eq. (6-61)</a> is in the form of <a href="#calibre_link-794">Eq. (6-25)</a>, by inspection, we can express the filter’s time-domain difference equation in the general form of <a href="#calibre_link-791">Eq. (6-21)</a> as</p>
<p class="caption"><a id="calibre_link-852"></a>(6-63)</p>
<p class="image"><img src="images/000604.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging4"><a id="calibre_link-2340"></a>Choosing to incorporate <em class="calibre7">t<sub class="calibre12">s</sub></em>, as in <a href="#calibre_link-848">Eq. (6-62)</a>, to make the digital filter’s gain equal to the prototype analog filter’s gain by multiplying the <em class="calibre7">b</em>(<em class="calibre7">k</em>) coefficients by the sample period <em class="calibre7">t<sub class="calibre12">s</sub></em> leads to an IIR filter time-domain expression of the form</p>
<p class="caption"><a id="calibre_link-853"></a>(6-64)</p>
<p class="image"><img src="images/001463.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging4">Notice how the signs changed for the <em class="calibre7">a</em>(<em class="calibre7">k</em>) coefficients from <a href="#calibre_link-847">Eqs. (6-61)</a> and <a href="#calibre_link-848">(6-62)</a> to <a href="#calibre_link-852">Eqs. (6-63)</a> and <a href="#calibre_link-853">(6-64)</a>. These sign changes always seem to cause problems for beginners, so watch out. Also, keep in mind that the time-domain expressions in <a href="#calibre_link-852">Eqs. (6-63)</a> and <a href="#calibre_link-853">(6-64)</a> apply only to the filter structure in <a href="#calibre_link-798">Figure 6-18</a>. The <em class="calibre7">a</em>(<em class="calibre7">k</em>) and <em class="calibre7">b</em>(<em class="calibre7">k</em>), or <em class="calibre7">t<sub class="calibre12">s</sub></em> · <em class="calibre7">b</em>(<em class="calibre7">k</em>), coefficients, however, can be applied to the improved IIR structure shown in <a href="#calibre_link-814">Figure 6-22</a> to complete our design.</p>
<p class="calibre3">Before we go through an actual example of this design process, let’s discuss the other impulse invariance design method.</p>
<p class="calibre3">The impulse invariance Design Method 2, also called the standard <em class="calibre7">z</em>-transform method, takes a different approach. It mathematically partitions the prototype analog filter into multiple single-pole continuous filters and then approximates each one of those by a single-pole digital filter. The set of <em class="calibre7">M</em> single-pole digital filters is then algebraically combined to form an <em class="calibre7">M</em>-pole, <em class="calibre7">M</em>th-ordered IIR filter. This process of breaking the analog filter to discrete filter approximation into manageable pieces is shown in <a href="#calibre_link-854">Figure 6-33</a>. The steps necessary to perform an impulse invariance Method 2 design are:</p>
<p class="caption"><a id="calibre_link-854"></a><strong class="calibre9">Figure 6-33</strong> Mathematical flow of the impulse invariance design Method 2.</p>
<p class="image"><img src="images/000140.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging3"><strong class="calibre9">Method 2, Step 1:</strong> Obtain the Laplace transfer function <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) for the prototype analog filter in the form of <a href="#calibre_link-855">Eq. (6-60)</a>. (Same as Method 1, Step 1.)</p>
<p class="indenthanging3"><strong class="calibre9">Method 2, Step 2:</strong> Select an appropriate sampling frequency <em class="calibre7">f<sub class="calibre12">s</sub></em> and calculate the sample period as <em class="calibre7">t<sub class="calibre12">s</sub></em> = 1/<em class="calibre7">f<sub class="calibre12">s</sub></em>. (Same as Method 1, Step 3.)</p>
<p class="indenthanging3"><strong class="calibre9">Method 2, Step 3:</strong> Express the analog filter’s Laplace transfer function <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) as the sum of single-pole filters. This requires us to use partial fraction expansion methods to express the ratio of polynomials in <a href="#calibre_link-855">Eq. (6-60)</a> in the form of</p>
<p class="caption"><a id="calibre_link-2786"></a><a id="calibre_link-856"></a>(6-65)</p>
<p class="image"><img src="images/000502.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging4">where <em class="calibre7">M</em> &gt; <em class="calibre7">N</em>, the individual <em class="calibre7">A<sub class="calibre12">k</sub></em> factors are constants, and the <em class="calibre7">k</em>th pole is located at <em class="calibre7">−p<sub class="calibre12">k</sub></em> on the <em class="calibre7">s</em>-plane. We’ll denote the <em class="calibre7">k</em>th single-pole analog filter as <em class="calibre7">H<sub class="calibre12">k</sub></em>(<em class="calibre7">s</em>), or</p>
<p class="caption"><a id="calibre_link-2787"></a>(6-66)</p>
<p class="image"><img src="images/000520.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging3"><strong class="calibre9">Method 2, Step 4:</strong> Substitute 1 − <em class="calibre7">e<sup class="calibre10">−p<sub class="calibre15">k</sub>t<sub class="calibre15">s</sub></sup> z</em><sup class="calibre10">−1</sup> for s + <em class="calibre7">p<sub class="calibre12">k</sub></em> in <a href="#calibre_link-856">Eq. (6-65)</a>. This mapping of each <em class="calibre7">H<sub class="calibre12">k</sub></em>(<em class="calibre7">s</em>) pole, located at <em class="calibre7">s</em> = <em class="calibre7">−p<sub class="calibre12">k</sub></em> on the <em class="calibre7">s</em>-plane, to the <em class="calibre7">z</em> = <em class="calibre7">e<sup class="calibre10">−p<sub class="calibre15">k</sub>t<sub class="calibre15">s</sub></sup></em> location on the <em class="calibre7">z</em>-plane is how we approximate the impulse response of each single-pole analog filter by a <a id="calibre_link-2788"></a>single-pole digital filter. (The reader can find the derivation of this 1 − <em class="calibre7">e<sup class="calibre10">−p<sub class="calibre15">k</sub>t<sub class="calibre15">s</sub></sup> z</em><sup class="calibre10">−1</sup> substitution, illustrated in our <a href="#calibre_link-854">Figure 6-33</a>, in references <a href="#calibre_link-832">[20]</a>, <a href="#calibre_link-833">[21]</a>, and <a href="#calibre_link-843">[26]</a>.) So, the <em class="calibre7">k</em>th analog single-pole filter <em class="calibre7">H<sub class="calibre12">k</sub></em>(<em class="calibre7">s</em>) is approximated by a single-pole digital filter whose <em class="calibre7">z-</em>domain transfer function is</p>
<p class="caption"><a id="calibre_link-2789"></a>(6-67)</p>
<p class="image"><img src="images/000398.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging4">The final combined discrete filter transfer function <em class="calibre7">H</em>(<em class="calibre7">z</em>) is the sum of the single-poled discrete filters, or</p>
<p class="caption"><a id="calibre_link-857"></a>(6-68)</p>
<p class="image"><img src="images/001249.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging4">Keep in mind that the above <em class="calibre7">H</em>(<em class="calibre7">z</em>) is not a function of time. The <em class="calibre7">t<sub class="calibre12">s</sub></em> factor in <a href="#calibre_link-857">Eq. (6-68)</a> is a constant equal to the discrete-time sample period.</p>
<p class="indenthanging3"><strong class="calibre9">Method 2, Step 5:</strong> Calculate the <em class="calibre7">z-</em>domain transfer function of the sum of the <em class="calibre7">M</em> single-pole digital filters in the form of a ratio of two polynomials in <em class="calibre7">z</em>. Because the <em class="calibre7">H</em>(<em class="calibre7">z</em>) in <a href="#calibre_link-857">Eq. (6-68)</a> will be a series of fractions, we’ll have to combine those fractions over a common denominator to get a single ratio of polynomials in the familiar form of</p>
<p class="caption"><a id="calibre_link-858"></a>(6-69)</p>
<p class="image"><img src="images/000287.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging3"><strong class="calibre9">Method 2, Step 6:</strong> Just as in Method 1, Step 6, by inspection, we can express the filter’s time-domain equation in the general form of</p>
<p class="caption"><a id="calibre_link-859"></a>(6-70)</p>
<p class="image"><img src="images/001129.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging4">Again, notice the <em class="calibre7">a</em>(<em class="calibre7">k</em>) coefficient sign changes from <a href="#calibre_link-858">Eq. (6-69)</a> to <a href="#calibre_link-859">Eq. (6-70)</a>. As described in Method 1, Steps 6 and 7, if we choose to make the digital filter’s gain equal to the prototype analog filter’s gain by multiplying the <em class="calibre7">b</em>(<em class="calibre7">k</em>) coefficients by the sample period <em class="calibre7">t<sub class="calibre12">s</sub></em>, then the IIR filter’s time-domain expression will be in the form</p>
<p class="caption"><a id="calibre_link-2339"></a><a id="calibre_link-860"></a>(6-71)</p>
<p class="image"><img src="images/000176.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging4">yielding a final <em class="calibre7">H</em>(<em class="calibre7">z</em>) <em class="calibre7">z-</em>domain transfer function of</p>
<p class="caption"><a id="calibre_link-2790"></a>(6-71′)</p>
<p class="image"><img src="images/001018.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging4">Finally, we can implement the improved IIR structure shown in <a href="#calibre_link-814">Figure 6-22</a> using the <em class="calibre7">a</em>(<em class="calibre7">k</em>) and <em class="calibre7">b</em>(<em class="calibre7">k</em>) coefficients from <a href="#calibre_link-859">Eq. (6-70)</a> or the <em class="calibre7">a</em>(<em class="calibre7">k</em>) and <em class="calibre7">t<sub class="calibre12">s</sub></em>·<em class="calibre7">b</em>(<em class="calibre7">k</em>) coefficients from <a href="#calibre_link-860">Eq. (6-71)</a>.</p>
<p class="calibre3">To provide a more meaningful comparison between the two impulse invariance design methods, let’s dive in and go through an IIR filter design example using both methods.</p>
<p class="calibre3"><a id="calibre_link-2791"></a></p>
<h4 class="calibre13">6.10.1 Impulse Invariance Design Method 1 Example</h4>
<p class="calibre3">Assume that we need to design an IIR filter that approximates a 2nd-order Chebyshev prototype analog lowpass filter whose passband ripple is 1 dB. Our <em class="calibre7">f<sub class="calibre12">s</sub></em> sampling rate is 100 Hz (<em class="calibre7">t<sub class="calibre12">s</sub></em> = 0.01), and the filter’s 1 dB cutoff frequency is 20 Hz. Our prototype analog filter will have a frequency magnitude response like that shown in <a href="#calibre_link-861">Figure 6-34</a>.</p>
<p class="caption"><a id="calibre_link-861"></a><strong class="calibre9">Figure 6-34</strong> Frequency magnitude response of the example prototype analog filter.</p>
<p class="image"><img src="images/000755.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Given the above filter requirements, assume that the analog prototype filter design effort results in the <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) Laplace transfer function of</p>
<p class="caption"><a id="calibre_link-862"></a>(6-72)</p>
<p class="image"><img src="images/000067.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">It’s the transfer function in <a href="#calibre_link-862">Eq. (6-72)</a> that we intend to approximate with our discrete IIR filter. To find the analog filter’s impulse response, we’d like to get <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) into a form that allows us to use Laplace transform tables to find <em class="calibre7">h<sub class="calibre12">c</sub></em>(<em class="calibre7">t</em>). Searching through systems analysis textbooks, we find the following Laplace transform pair:</p>
<p class="caption"><a id="calibre_link-863"></a>(6-73)</p>
<p class="image"><img src="images/000751.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2792"></a>Our intent, then, is to modify <a href="#calibre_link-862">Eq. (6-72)</a> to get it into the form on the left side of <a href="#calibre_link-863">Eq. (6-73)</a>. We do this by realizing that the Laplace transform expression in <a href="#calibre_link-863">Eq. (6-73)</a> can be rewritten as</p>
<p class="caption"><a id="calibre_link-864"></a>(6-74)</p>
<p class="image"><img src="images/001775.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we set <a href="#calibre_link-862">Eq. (6-72)</a> equal to the right side of <a href="#calibre_link-864">Eq. (6-74)</a>, we can solve for <em class="calibre7">A</em>, α, and ω. Doing that,</p>
<p class="caption"><a id="calibre_link-865"></a>(6-75)</p>
<p class="image"><img src="images/000797.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Solving <a href="#calibre_link-865">Eq. (6-75)</a> for <em class="calibre7">A</em>, α, and ω, we first find</p>
<p class="caption"><a id="calibre_link-868"></a>(6-76)</p>
<p class="image"><img src="images/001655.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2793"></a>(6-77)</p>
<p class="image"><img src="images/000680.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">so</p>
<p class="caption"><a id="calibre_link-869"></a>(6-78)</p>
<p class="image"><img src="images/000943.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">and</p>
<p class="caption"><a id="calibre_link-2794"></a>(6-79)</p>
<p class="image"><img src="images/001807.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">OK, we can now express <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) in the desired form of the left side of <a href="#calibre_link-864">Eq. (6-74)</a> as</p>
<p class="caption"><a id="calibre_link-2795"></a>(6-80)</p>
<p class="image"><img src="images/000833.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2796"></a>Using the Laplace transform pair in <a href="#calibre_link-863">Eq. (6-73)</a>, the time-domain impulse response of the prototype analog filter becomes</p>
<p class="caption"><a id="calibre_link-866"></a>(6-81)</p>
<p class="image"><img src="images/001692.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">OK, we’re ready to perform Method 1, Step 4, to determine the discrete IIR filter’s <em class="calibre7">z-</em>domain transfer function <em class="calibre7">H</em>(<em class="calibre7">z</em>) by performing the <em class="calibre7">z-</em>transform of <em class="calibre7">h<sub class="calibre12">c</sub></em>(<em class="calibre7">t</em>). Again, scanning through digital signal processing textbooks or a good math reference book, we find the following <em class="calibre7">z-</em>transform pair where the time-domain expression is in the same form as <a href="#calibre_link-866">Eq. (6-81)</a>’s <em class="calibre7">h<sub class="calibre12">c</sub></em>(<em class="calibre7">t</em>) impulse response:</p>
<p class="caption"><a id="calibre_link-867"></a>(6-82)</p>
<p class="image"><img src="images/000714.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Remember, now, the α and ω in <a href="#calibre_link-867">Eq. (6-82)</a> are generic and are not related to the α and ω values in <a href="#calibre_link-868">Eqs. (6-76)</a> and <a href="#calibre_link-869">(6-78)</a>. Substituting the constants from <a href="#calibre_link-866">Eq. (6-81)</a> into the right side of <a href="#calibre_link-867">Eq. (6-82)</a>, we get the <em class="calibre7">z-</em>transform of the IIR filter as</p>
<p class="caption"><a id="calibre_link-870"></a>(6-83)</p>
<p class="image"><img src="images/001569.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Performing Method 1, Step 5, we substitute the <em class="calibre7">t<sub class="calibre12">s</sub></em> value of 0.01 for the continuous variable <em class="calibre7">t</em> in <a href="#calibre_link-870">Eq. (6-83)</a>, yielding the final <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function of</p>
<p class="caption"><a id="calibre_link-871"></a>(6-84)</p>
<p class="image"><img src="images/000594.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">OK, hang in there; we’re almost finished. Here are the final steps of Method 1. Because of the transfer function <em class="calibre7">H</em>(<em class="calibre7">z</em>) = <em class="calibre7">Y</em>(<em class="calibre7">z</em>)/<em class="calibre7">X</em>(<em class="calibre7">z</em>), we can cross-multiply the denominators to rewrite the bottom line of <a href="#calibre_link-871">Eq. (6-84)</a> as</p>
<p class="caption"><a id="calibre_link-872"></a>(6-85)</p>
<p class="image"><img src="images/001456.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2341"></a>By inspection of <a href="#calibre_link-872">Eq. (6-85)</a>, we can now get the time-domain expression for our IIR filter. Performing Method 1, Steps 6 and 7, we multiply the <em class="calibre7">x</em>(<em class="calibre7">n−</em>1) coefficient by the sample period value of <em class="calibre7">t<sub class="calibre12">s</sub></em> = 0.01 to allow for proper scaling as</p>
<p class="caption"><a id="calibre_link-873"></a>(6-86)</p>
<p class="image"><img src="images/000494.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">and there we (finally) are. The coefficients from <a href="#calibre_link-873">Eq. (6-86)</a> are what we use in implementing the improved IIR structure shown in <a href="#calibre_link-814">Figure 6-22</a> to approximate the original 2nd-order Chebyshev analog lowpass filter.</p>
<p class="calibre3">Let’s see if we get the same result if we use the impulse invariance design Method 2 to approximate the example prototype analog filter.</p>
<p class="calibre3"><a id="calibre_link-2797"></a></p>
<h4 class="calibre13">6.10.2 Impulse Invariance Design Method 2 Example</h4>
<p class="calibre3">Given the original prototype filter’s Laplace transfer function as</p>
<p class="caption"><a id="calibre_link-874"></a>(6-87)</p>
<p class="image"><img src="images/001160.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">and the value of <em class="calibre7">t<sub class="calibre12">s</sub></em> = 0.01 for the sample period, we’re ready to proceed with Method 2’s Step 3. To express <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) as the sum of single-pole filters, we’ll have to factor the denominator of <a href="#calibre_link-874">Eq. (6-87)</a> and use partial fraction expansion methods. For convenience, let’s start by replacing the constants in <a href="#calibre_link-874">Eq. (6-87)</a> with variables in the form of</p>
<p class="caption"><a id="calibre_link-875"></a>(6-88)</p>
<p class="image"><img src="images/000028.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">b</em> = 137.94536, and <em class="calibre7">c</em> = 17410.145. Next, using <a href="#calibre_link-806">Eq. (6-15)</a> with <em class="calibre7">a</em> = 1, we can factor the quadratic denominator of <a href="#calibre_link-875">Eq. (6-88)</a> into</p>
<p class="caption"><a id="calibre_link-876"></a>(6-89)</p>
<p class="image"><img src="images/001240.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we substitute the values for <em class="calibre7">b</em> and <em class="calibre7">c</em> in <a href="#calibre_link-876">Eq. (6-89)</a>, we’ll find that the quantity under the radical sign is negative. This means that the factors in the denominator of <a href="#calibre_link-876">Eq. (6-89)</a> are complex. Because we have lots of algebra ahead of us, let’s replace the radicals in <a href="#calibre_link-876">Eq. (6-89)</a> with the <em class="calibre7">imaginary</em> term <em class="calibre7">jR,</em> where <img src="images/000999.jpg" alt="image" class="calibre2" /> and <em class="calibre7">R</em> = |(<em class="calibre7">b</em><sup class="calibre10">2</sup>−4<em class="calibre7">c</em>)/4|, such that</p>
<p class="caption"><a id="calibre_link-877"></a>(6-90)</p>
<p class="image"><img src="images/000280.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2798"></a>OK, partial fraction expansion methods allow us to partition <a href="#calibre_link-877">Eq. (6-90)</a> into two separate fractions of the form</p>
<p class="caption"><a id="calibre_link-2799"></a>(6-91)</p>
<p class="image"><img src="images/001122.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where the <em class="calibre7">K</em><sub class="calibre12">1</sub> constant can be found to be equal to <em class="calibre7">jc</em>/2<em class="calibre7">R</em> and constant <em class="calibre7">K</em><sub class="calibre12">2</sub> is the complex conjugate of <em class="calibre7">K</em><sub class="calibre12">1</sub>, or <em class="calibre7">K</em><sub class="calibre12">2</sub> = −<em class="calibre7">jc</em>/2<em class="calibre7">R</em>. (To learn the details of partial fraction expansion methods, the interested reader should investigate standard college algebra or engineering mathematics textbooks.) Thus, <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) can be of the form in <a href="#calibre_link-856">Eq. (6-65)</a> or</p>
<p class="caption"><a id="calibre_link-878"></a>(6-92)</p>
<p class="image"><img src="images/000169.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We can see from <a href="#calibre_link-878">Eq. (6-92)</a> that our 2nd-order prototype filter has two poles, one located at <em class="calibre7">p</em><sub class="calibre12">1</sub> = −<em class="calibre7">b</em>/2 − <em class="calibre7">jR</em> and the other at <em class="calibre7">p</em><sub class="calibre12">2</sub> = −<em class="calibre7">b</em>/2 + <em class="calibre7">jR</em>. We’re now ready to map those two poles from the <em class="calibre7">s</em>-plane to the <em class="calibre7">z</em>-plane as called out in Method 2, Step 4. Making our 1 − <em class="calibre7">e<sup class="calibre10">−p<sub class="calibre15">k</sub>t<sub class="calibre15">s</sub></sup> z</em><sup class="calibre10">−1</sup> substitution for the <em class="calibre7">s</em> + <em class="calibre7">p<sub class="calibre12">k</sub></em> terms in <a href="#calibre_link-878">Eq. (6-92)</a>, we have the following expression for the <em class="calibre7">z-</em>domain single-pole digital filters:</p>
<p class="caption"><a id="calibre_link-879"></a>(6-93)</p>
<p class="image"><img src="images/001011.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Our objective in Method 2, Step 5, is to massage <a href="#calibre_link-879">Eq. (6-93)</a> into the form of <a href="#calibre_link-858">Eq. (6-69)</a>, so that we can determine the IIR filter’s feedforward and feedback coefficients. Putting both fractions in <a href="#calibre_link-879">Eq. (6-93)</a> over a common denominator gives us</p>
<p class="caption"><a id="calibre_link-2800"></a>(6-94)</p>
<p class="image"><img src="images/000059.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Collecting like terms in the numerator and multiplying out the denominator gives us</p>
<p class="caption"><a id="calibre_link-880"></a>(6-95)</p>
<p class="image"><img src="images/001393.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Factoring the exponentials and collecting like terms of powers of <em class="calibre7">z</em> in <a href="#calibre_link-880">Eq. (6-95)</a>,</p>
<p class="caption"><a id="calibre_link-2177"></a><a id="calibre_link-2801"></a>(6-96)</p>
<p class="image"><img src="images/001765.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Continuing to simplify our <em class="calibre7">H</em>(<em class="calibre7">z</em>) expression by factoring out the real part of the exponentials,</p>
<p class="caption"><a id="calibre_link-881"></a>(6-97)</p>
<p class="image"><img src="images/000789.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We now have <em class="calibre7">H</em>(<em class="calibre7">z</em>) in a form with all the like powers of <em class="calibre7">z</em> combined into single terms, and <a href="#calibre_link-881">Eq. (6-97)</a> looks something like the desired form of <a href="#calibre_link-858">Eq. (6-69)</a>. Knowing that the final coefficients of our IIR filter must be real numbers, the question is “What do we do with those imaginary <em class="calibre7">j</em> terms in <a href="#calibre_link-881">Eq. (6-97)</a>?” Once again, Euler to the rescue.<sup class="calibre10"><a id="calibre_link-883"></a><a href="#calibre_link-882">†</a></sup> Using Euler’s equations for sinusoids, we can eliminate the imaginary exponentials and <a href="#calibre_link-881">Eq. (6-97)</a> becomes</p>
<p class="footnotes"><a id="calibre_link-882"></a><sup class="calibre11"><a href="#calibre_link-883">†</a></sup> From Euler, we know that sin(ø) = (<em class="calibre7">e<sup class="calibre11">j</sup></em><sup class="calibre11">ø</sup> − <em class="calibre7">e</em><sup class="calibre11">−<em class="calibre7">j</em>ø</sup>)/2<em class="calibre7">j</em>, and cos(ø) = (<em class="calibre7">e<sup class="calibre11">j</sup></em><sup class="calibre11">ø</sup> + <em class="calibre7">e</em><sup class="calibre11">−<em class="calibre7">j</em>ø</sup>)/2.</p>
<p class="caption"><a id="calibre_link-884"></a>(6-98)</p>
<p class="image"><img src="images/001644.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we plug the values <em class="calibre7">c</em> = 17410.145, <em class="calibre7">b</em> = 137.94536, <em class="calibre7">R</em> = 112.48517, and <em class="calibre7">t<sub class="calibre12">s</sub></em> = 0.01 into <a href="#calibre_link-884">Eq. (6-98)</a>, we get the following IIR filter transfer function:</p>
<p class="caption"><a id="calibre_link-885"></a>(6-99)</p>
<p class="image"><img src="images/000672.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Because the transfer function <em class="calibre7">H</em>(<em class="calibre7">z</em>) = <em class="calibre7">Y</em>(<em class="calibre7">z</em>)/<em class="calibre7">X</em>(<em class="calibre7">z</em>), we can again cross-multiply the denominators to rewrite <a href="#calibre_link-885">Eq. (6-99)</a> as</p>
<p class="caption"><a id="calibre_link-886"></a>(6-100)</p>
<p class="image"><img src="images/001097.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2802"></a>Now we take the inverse <em class="calibre7">z-</em>transform of <a href="#calibre_link-886">Eq. (6-100)</a>, by inspection, to get the time-domain expression for our IIR filter as</p>
<p class="caption"><a id="calibre_link-2803"></a>(6-101)</p>
<p class="image"><img src="images/000153.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">One final step remains. To force the IIR filter gain to be equal to the prototype analog filter’s gain, we multiply the <em class="calibre7">x</em>(<em class="calibre7">n−</em>1) coefficient by the sample period <em class="calibre7">t<sub class="calibre12">s</sub></em> as suggested in Method 2, Step 6. In this case, there’s only one <em class="calibre7">x</em>(<em class="calibre7">n</em>) coefficient, giving us</p>
<p class="caption"><a id="calibre_link-2804"></a>(6-102)</p>
<p class="image"><img src="images/000994.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">That compares well with the Method 1 result in <a href="#calibre_link-873">Eq. (6-86)</a>. (Isn’t it comforting to work a problem two different ways and get the same result?)</p>
<p class="calibre3"><a href="#calibre_link-887">Figure 6-35</a> shows, in graphical form, the result of our IIR design example. The <em class="calibre7">s</em>-plane pole locations of the prototype filter and the <em class="calibre7">z</em>-plane poles of the IIR filter are shown in <a href="#calibre_link-887">Figure 6-35(a)</a>. Because the <em class="calibre7">s</em>-plane poles are to the left of the origin and the <em class="calibre7">z</em>-plane poles are inside the unit circle, both the prototype analog and the discrete IIR filters are stable. We find the prototype filter’s <em class="calibre7">s</em>-plane pole locations by evaluating <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) in <a href="#calibre_link-878">Eq. (6-92)</a>. When <em class="calibre7">s</em> = −<em class="calibre7">b</em>/2 − <em class="calibre7">jR,</em> the denominator of the first term in <a href="#calibre_link-878">Eq. (6-92)</a> becomes zero and <em class="calibre7">H</em><sub class="calibre12">c</sub>(<em class="calibre7">s</em>) is infinitely large. That <em class="calibre7">s</em> = −<em class="calibre7">b</em>/2 − <em class="calibre7">jR</em> value is the location of the lower <a id="calibre_link-2342"></a><em class="calibre7">s</em>-plane pole in <a href="#calibre_link-887">Figure 6-35(a)</a>. When <em class="calibre7">s</em> = −<em class="calibre7">b</em>/2 + <em class="calibre7">jR,</em> the denominator of the second term in <a href="#calibre_link-878">Eq. (6-92)</a> becomes zero and <em class="calibre7">s</em> = −<em class="calibre7">b</em>/2 + <em class="calibre7">jR</em> is the location of the second <em class="calibre7">s</em>-plane pole.</p>
<p class="caption"><a id="calibre_link-887"></a><strong class="calibre9">Figure 6-35</strong> Impulse invariance design example filter characteristics: (a) <em class="calibre7">s-</em>plane pole locations of prototype analog filter and <em class="calibre7">z-</em>plane pole locations of discrete IIR filter; (b) frequency magnitude response of the discrete IIR filter.</p>
<p class="image"><img src="images/001388.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The IIR filter’s <em class="calibre7">z</em>-plane pole locations are found from <a href="#calibre_link-879">Eq. (6-93)</a>. If we multiply the numerators and denominators of <a href="#calibre_link-879">Eq. (6-93)</a> by <em class="calibre7">z</em>,</p>
<p class="caption"><a id="calibre_link-888"></a>(6-103)</p>
<p class="image"><img src="images/000734.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">In <a href="#calibre_link-888">Eq. (6-103)</a>, when <em class="calibre7">z</em> is set equal to <em class="calibre7">e</em><sup class="calibre10">(−<em class="calibre7">b</em>/2 + <em class="calibre7">jR</em>)<em class="calibre7">t</em><sub class="calibre15">s</sub></sup>, the denominator of the first term in <a href="#calibre_link-888">Eq. (6-103)</a> becomes zero and <em class="calibre7">H</em>(<em class="calibre7">z</em>) becomes infinitely large. The value of <em class="calibre7">z</em> of</p>
<p class="caption"><a id="calibre_link-2805"></a>(6-104)</p>
<p class="image"><img src="images/000890.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">defines the location of the lower <em class="calibre7">z</em>-plane pole in <a href="#calibre_link-887">Figure 6-35(a)</a>. Specifically, this lower pole is located at a distance of <em class="calibre7">e<sup class="calibre10">−bt<sub class="calibre15">s</sub></sup></em><sup class="calibre10">/2</sup> = 0.5017 from the origin, at an angle of θ = −<em class="calibre7">Rt<sub class="calibre12">s</sub></em> radians, or −64.45°. Being conjugate poles, the upper <em class="calibre7">z</em>-plane pole is located the same distance from the origin at an angle of θ = <em class="calibre7">Rt<sub class="calibre12">s</sub></em> radians, or +64.45°. <a href="#calibre_link-887">Figure 6-35(b)</a> illustrates the frequency magnitude response of the IIR filter in Hz.</p>
<p class="calibre3">Two different implementations of our IIR filter are shown in <a href="#calibre_link-889">Figure 6-36</a>. <a href="#calibre_link-889">Figure 6-36(a)</a> is an implementation of our 2nd-order IIR filter based on the general IIR structure given in <a href="#calibre_link-814">Figure 6-22</a>, and <a href="#calibre_link-889">Figure 6-36(b)</a> shows the 2nd-order IIR filter implementation based on the alternate structure from <a href="#calibre_link-812">Figure 6-21(b)</a>. Knowing that the <em class="calibre7">b</em>(0) coefficient on the left side of <a href="#calibre_link-889">Figure 6-36(b)</a> is zero, we arrive at the simplified structure on the right side of <a href="#calibre_link-889">Figure 6-36(b)</a>. Looking carefully at <a href="#calibre_link-889">Figure 6-36(a)</a> and the right side of <a href="#calibre_link-889">Figure 6-36(b)</a>, we can see that they are equivalent.</p>
<p class="caption"><a id="calibre_link-889"></a><strong class="calibre9">Figure 6-36</strong> Implementations of the impulse invariance design example filter.</p>
<p class="image"><img src="images/000205.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Although both impulse invariance design methods are covered in the literature, we might ask, “Which one is preferred?” There’s no definite answer to that question because it depends on the <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) of the prototype analog filter. Although our Method 2 example above required more algebra than Method 1, if the prototype filter’s <em class="calibre7">s-</em>domain poles were located only on the real axis, Method 2 would have been much simpler because there would be no complex variables to manipulate. In general, Method 2 is more popular for two reasons: (1) the inverse Laplace and <em class="calibre7">z-</em>transformations, although straightforward in our Method 1 example, can be very difficult for higher-order filters, and (2) unlike Method 1, Method 2 can be coded in a software routine or a computer spreadsheet.</p>
<p class="calibre3"><a id="calibre_link-2806"></a>Upon examining the frequency magnitude response in <a href="#calibre_link-887">Figure 6-35(b)</a>, we can see that this 2nd-order IIR filter’s roll-off is not particularly steep. This is, admittedly, a simple low-order filter, but its attenuation slope is so gradual that it doesn’t appear to be of much use as a lowpass filter.<sup class="calibre10"><a id="calibre_link-891"></a><a href="#calibre_link-890">†</a></sup> We can also see that the filter’s passband ripple is greater than the desired value of 1 dB in <a href="#calibre_link-861">Figure 6-34</a>. What we’ll find is that it’s not the low order of the filter that contributes to its poor performance, but the sampling rate used. That 2nd-order IIR filter response is repeated as the shaded curve in <a href="#calibre_link-359">Figure 6-37</a>. If we increased the sampling rate to 200 Hz, we’d get the frequency response shown by the dashed curve in <a href="#calibre_link-359">Figure 6-37</a>. Increasing the sampling rate to 400 Hz results in the much improved frequency response indicated by the solid line in the figure. Sampling rate changes do not affect our filter order or implementation structure. Remember, if we change the sampling rate, only the sample period <em class="calibre7">t<sub class="calibre12">s</sub></em> changes in our design equations, resulting in a different set of filter coefficients for each new sampling rate. So we can see that the smaller we <a id="calibre_link-2015"></a>make <em class="calibre7">t<sub class="calibre12">s</sub></em> (larger <em class="calibre7">f<sub class="calibre12">s</sub></em>), the better the resulting filter when either impulse invariance design method is used because the replicated spectral overlap indicated in <a href="#calibre_link-840">Figure 6-32(b)</a> is reduced due to the larger <em class="calibre7">f<sub class="calibre12">s</sub></em> sampling rate. The bottom line here is that impulse invariance IIR filter design techniques are most appropriate for narrowband filters, that is, lowpass filters whose cutoff frequencies are much smaller than the sampling rate.</p>
<p class="footnotes"><a id="calibre_link-890"></a><sup class="calibre11"><a href="#calibre_link-891">†</a></sup> A piece of advice: whenever you encounter any frequency representation (be it a digital filter magnitude response or a signal spectrum) that has nonzero values at +<em class="calibre7">f<sub class="calibre14">s</sub></em>/2, be suspicious&mdash;be very suspicious&mdash;that aliasing is taking place.</p>
<p class="caption"><a id="calibre_link-359"></a><strong class="calibre9">Figure 6-37</strong> IIR filter frequency magnitude response, on a linear scale, at three separate sampling rates. Notice how the filter’s absolute cutoff frequency of 20 Hz shifts relative to the different <em class="calibre7">f<sub class="calibre12">s</sub></em> sampling rates.</p>
<p class="image"><img src="images/000830.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The second analytical technique for analog filter approximation, the bilinear transform method, alleviates the impulse invariance method’s aliasing problems at the expense of what’s called <em class="calibre7">frequency warping.</em> Specifically, there’s a nonlinear distortion between the prototype analog filter’s frequency scale and the frequency scale of the approximating IIR filter designed using the bilinear transform. Let’s see why.</p>
<p class="calibre3"><a id="calibre_link-627"></a></p>
<h3 class="calibre6">6.11 Bilinear Transform IIR Filter Design Method</h3>
<p class="calibre3">There’s a popular analytical IIR filter design technique known as the <em class="calibre7">bilinear transform</em> method. Like the impulse invariance method, this design technique approximates a prototype analog filter defined by the continuous Laplace transfer function <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) with a discrete filter whose transfer function is <em class="calibre7">H</em>(<em class="calibre7">z</em>). However, the bilinear transform method has great utility because</p>
<p class="indenthangingb">• it allows us simply to substitute a function of <em class="calibre7">z</em> for <em class="calibre7">s</em> in <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) to get <em class="calibre7">H</em>(<em class="calibre7">z</em>), thankfully eliminating the need for Laplace and <em class="calibre7">z-</em>transformations as well as any necessity for partial fraction expansion algebra;</p>
<p class="indenthangingb"><a id="calibre_link-2018"></a>• it maps the entire <em class="calibre7">s</em>-plane to the <em class="calibre7">z</em>-plane, enabling us to completely avoid the frequency-domain aliasing problems we had with the impulse invariance design method; and</p>
<p class="indenthangingb">• it induces a nonlinear distortion of <em class="calibre7">H</em>(<em class="calibre7">z</em>)’s frequency axis, relative to the original prototype analog filter’s frequency axis, that sharpens the final roll-off of digital lowpass filters.</p>
<p class="calibre3">Don’t worry. We’ll explain each one of these characteristics and see exactly what they mean to us as we go about designing an IIR filter.</p>
<p class="calibre3">If the transfer function of a prototype analog filter is <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>), then we can obtain the discrete IIR filter <em class="calibre7">z-</em>domain transfer function <em class="calibre7">H</em>(<em class="calibre7">z</em>) by substituting the following for <em class="calibre7">s</em> in <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>)</p>
<p class="caption"><a id="calibre_link-894"></a>(6-105)</p>
<p class="image"><img src="images/001744.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where, again, <em class="calibre7">t<sub class="calibre12">s</sub></em> is the discrete filter’s sampling period (1/<em class="calibre7">f<sub class="calibre12">s</sub></em>). Just as in the impulse invariance design method, when using the bilinear transform method, we’re interested in where the analog filter’s poles end up on the <em class="calibre7">z</em>-plane after the transformation. This <em class="calibre7">s</em>-plane to <em class="calibre7">z</em>-plane mapping behavior is exactly what makes the bilinear transform such an attractive design technique.<sup class="calibre10"><a id="calibre_link-893"></a><a href="#calibre_link-892">†</a></sup></p>
<p class="footnotes"><a id="calibre_link-892"></a><sup class="calibre11"><a href="#calibre_link-893">†</a></sup> The bilinear transform is a technique in the theory of complex variables for mapping a function on the complex plane of one variable to the complex plane of another variable. It maps circles and straight lines to straight lines and circles, respectively.</p>
<p class="calibre3">Let’s investigate the major characteristics of the bilinear transform’s <em class="calibre7">s</em>-plane to <em class="calibre7">z</em>-plane mapping. First we’ll show that any pole on the left side of the <em class="calibre7">s</em>-plane will map to the inside of the unit circle in the <em class="calibre7">z</em>-plane. It’s easy to show this by solving <a href="#calibre_link-894">Eq. (6-105)</a> for <em class="calibre7">z</em> in terms of <em class="calibre7">s</em>. Multiplying <a href="#calibre_link-894">Eq. (6-105)</a> by (<em class="calibre7">t<sub class="calibre12">s</sub></em>/2)(1 + <em class="calibre7">z</em><sup class="calibre10">−1</sup>) and collecting like terms of <em class="calibre7">z</em> leads us to</p>
<p class="caption"><a id="calibre_link-895"></a>(6-106)</p>
<p class="image"><img src="images/000771.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we designate the real and imaginary parts of <em class="calibre7">s</em> as</p>
<p class="caption"><a id="calibre_link-2807"></a>(6-107)</p>
<p class="image"><img src="images/001627.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where the subscript in the radian frequency ω<em class="calibre7"><sub class="calibre12">a</sub></em> signifies <em class="calibre7">analog</em>, <a href="#calibre_link-895">Eq. (6-106)</a> becomes</p>
<p class="caption"><a id="calibre_link-896"></a>(6-108)</p>
<p class="image"><img src="images/000651.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2016"></a>We see in <a href="#calibre_link-896">Eq. (6-108)</a> that <em class="calibre7">z</em> is complex, comprising the ratio of two complex expressions. As such, if we denote <em class="calibre7">z</em> as a magnitude at an angle in the form of <em class="calibre7">z</em> = |<em class="calibre7">z</em>|∠θ<em class="calibre7"><sub class="calibre12">z</sub></em>, we know that the magnitude of <em class="calibre7">z</em> is given by</p>
<p class="caption"><a id="calibre_link-897"></a>(6-109)</p>
<p class="image"><img src="images/000029.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">OK, if σ is negative (σ &lt; 0), the numerator of the ratio on the right side of <a href="#calibre_link-897">Eq. (6-109)</a> will be less than the denominator, and |<em class="calibre7">z</em>| will be less than 1. On the other hand, if σ is positive (σ &gt; 0), the numerator will be larger than the denominator, and |<em class="calibre7">z</em>| will be greater than 1. This confirms that when using the bilinear transform defined by <a href="#calibre_link-894">Eq. (6-105)</a>, any pole located on the left side of the <em class="calibre7">s</em>-plane (σ &lt; 0) will map to a <em class="calibre7">z</em>-plane location inside the unit circle. This characteristic ensures that any stable <em class="calibre7">s</em>-plane pole of a prototype analog filter will map to a stable <em class="calibre7">z</em>-plane pole for our discrete IIR filter. Likewise, any analog filter pole located on the right side of the <em class="calibre7">s</em>-plane (σ &gt; 0) will map to a <em class="calibre7">z</em>-plane location outside the unit circle when using the bilinear transform. This reinforces our notion that to avoid filter instability, during IIR filter design, we should avoid allowing any <em class="calibre7">z</em>-plane poles to lie outside the unit circle.</p>
<p class="calibre3">Next, let’s show that the <em class="calibre7">j</em>ω<em class="calibre7"><sub class="calibre12">a</sub></em> axis of the <em class="calibre7">s</em>-plane maps to the perimeter of the unit circle in the <em class="calibre7">z</em>-plane. We can do this by setting σ = 0 in <a href="#calibre_link-896">Eq. (6-108)</a> to get</p>
<p class="caption"><a id="calibre_link-898"></a>(6-110)</p>
<p class="image"><img src="images/000383.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Here, again, we see in <a href="#calibre_link-898">Eq. (6-110)</a> that <em class="calibre7">z</em> is a complex number comprising the ratio of two complex numbers, and we know the magnitude of this <em class="calibre7">z</em> is given by</p>
<p class="caption"><a id="calibre_link-899"></a>(6-111)</p>
<p class="image"><img src="images/001235.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The magnitude of <em class="calibre7">z</em> in <a href="#calibre_link-899">Eq. (6-111)</a> is <em class="calibre7">always</em> 1. So, as we stated, when using the bilinear transform, the <em class="calibre7">j</em>ω<em class="calibre7"><sub class="calibre12">a</sub></em> axis of the <em class="calibre7">s</em>-plane maps to the perimeter of the unit circle in the <em class="calibre7">z</em>-plane. However, this frequency mapping from the <em class="calibre7">s</em>-plane to the unit circle in the <em class="calibre7">z</em>-plane is not linear. It’s important to know why this frequency nonlinearity, or warping, occurs and to understand its effects. So we shall, by showing the relationship between the <em class="calibre7">s</em>-plane frequency and the <em class="calibre7">z</em>-plane frequency that we’ll designate as ω<sub class="calibre12"><em class="calibre7">d</em></sub>.</p>
<p class="calibre3">If we define <em class="calibre7">z</em> on the unit circle in polar form as <em class="calibre7">z</em> = <em class="calibre7">re</em><sup class="calibre10">−<em class="calibre7">j</em>ω<em class="calibre7">d</em></sup> as we did for <a href="#calibre_link-785">Figure 6-13</a>, where <em class="calibre7">r</em> is 1 and ω<em class="calibre7"><sub class="calibre12">d</sub></em> is the angle, we can substitute <em class="calibre7">z</em> = <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω<em class="calibre7">d</em></sup> in <a href="#calibre_link-894">Eq. (6-105)</a> as</p>
<p class="caption"><a id="calibre_link-2176"></a><a id="calibre_link-2808"></a>(6-112)</p>
<p class="image"><img src="images/000272.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we show <em class="calibre7">s</em> in its rectangular form and partition the ratio in brackets into half-angle expressions,</p>
<p class="caption"><a id="calibre_link-900"></a>(6-113)</p>
<p class="image"><img src="images/001115.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Using Euler’s relationships of sin(ø) = (<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ø</sup> − <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>ø</sup>)/2<em class="calibre7">j</em> and cos(ø) = (<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ø</sup> + <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>ø</sup>)/2, we can convert the right side of <a href="#calibre_link-900">Eq. (6-113)</a> to rectangular form as</p>
<p class="caption"><a id="calibre_link-901"></a>(6-114)</p>
<p class="image"><img src="images/000166.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we now equate the real and imaginary parts of <a href="#calibre_link-901">Eq. (6-114)</a>, we see that σ = 0, and</p>
<p class="caption"><a id="calibre_link-902"></a>(6-115)</p>
<p class="image"><img src="images/001006.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The analog frequency ω<em class="calibre7"><sub class="calibre12">a</sub></em> (radians/second) can have any value and its equivalent <em class="calibre7">f<sub class="calibre12">a</sub></em> cyclic frequency is</p>
<p class="caption"><a id="calibre_link-2809"></a>(6-115′)</p>
<p class="image"><img src="images/000054.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Rearranging <a href="#calibre_link-902">Eq. (6-115)</a> to give us the useful expression for the <em class="calibre7">z</em>-domain frequency ω<em class="calibre7"><sub class="calibre12">d</sub></em>, in terms of the <em class="calibre7">s</em>-domain frequency ω<em class="calibre7"><sub class="calibre12">a</sub></em>, we write</p>
<p class="caption"><a id="calibre_link-903"></a>(6-116)</p>
<p class="image"><img src="images/000279.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">It’s critical to notice that the range of ω<em class="calibre7"><sub class="calibre12">d</sub></em> is ±π, and the dimensions of digital frequency ω<em class="calibre7"><sub class="calibre12">d</sub></em> are radians/sample (not radians/second). The important relationship in <a href="#calibre_link-903">Eq. (6-116)</a>, which accounts for the so-called frequency warping <a id="calibre_link-2810"></a>due to the bilinear transform, is illustrated in <a href="#calibre_link-904">Figure 6-38</a>. Notice that because tan<sup class="calibre10">−1</sup>(ω<em class="calibre7"><sub class="calibre12">a</sub>t<sub class="calibre12">s</sub></em>/2) approaches π/2 as ω<em class="calibre7"><sub class="calibre12">a</sub></em> becomes large, ω<em class="calibre7"><sub class="calibre12">d</sub></em> must then approach twice that value, or π. This means that no matter how large the <em class="calibre7">s</em>-plane’s analog ω<em class="calibre7"><sub class="calibre12">a</sub></em> becomes, the <em class="calibre7">z</em>-plane’s ω<em class="calibre7"><sub class="calibre12">d</sub></em> will never be greater than π radians/sample (<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz).</p>
<p class="caption"><a id="calibre_link-904"></a><strong class="calibre9">Figure 6-38</strong> Nonlinear relationship between the <em class="calibre7">z-</em>domain frequency ω<em class="calibre7"><sub class="calibre12">d</sub></em> and the <em class="calibre7">s-</em>domain frequency ω<em class="calibre7"><sub class="calibre12">a</sub></em>.</p>
<p class="image"><img src="images/001455.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Remember how we considered <a href="#calibre_link-786">Figure 6-14</a> and stated that only the −π <em class="calibre7">f<sub class="calibre12">s</sub></em> to +π <em class="calibre7">f<sub class="calibre12">s</sub></em> radians/second frequency range for ω<em class="calibre7"><sub class="calibre12">a</sub></em> can be accounted for on the <em class="calibre7">z</em>-plane? Well, our new mapping from the bilinear transform maps the entire <em class="calibre7">s</em>-plane to the <em class="calibre7">z</em>-plane, and not just the primary strip of the <em class="calibre7">s</em>-plane shown in <a href="#calibre_link-786">Figure 6-14</a>. Now, just as a walk along the <em class="calibre7">j</em>ω<em class="calibre7"><sub class="calibre12">a</sub></em> frequency axis on the <em class="calibre7">s</em>-plane takes us to infinity in either direction, a trip halfway around the unit circle in a counterclockwise direction takes us from ω<em class="calibre7"><sub class="calibre12">a</sub></em> = 0 to ω<em class="calibre7"><sub class="calibre12">a</sub></em> = +∞ radians/second. As such, the bilinear transform maps the <em class="calibre7">s</em>-plane’s entire <em class="calibre7">j</em>ω<em class="calibre7"><sub class="calibre12">a</sub></em> axis onto the unit circle in the <em class="calibre7">z</em>-plane. We illustrate these bilinear transform mapping properties in <a href="#calibre_link-905">Figure 6-39</a>.</p>
<p class="caption"><a id="calibre_link-905"></a><strong class="calibre9">Figure 6-39</strong> Bilinear transform mapping of the <em class="calibre7">s</em>-plane to the <em class="calibre7">z</em>-plane.</p>
<p class="image"><img src="images/000277.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2019"></a>In an attempt to show the practical implications of this frequency warping, let’s relate the <em class="calibre7">s</em>-plane and <em class="calibre7">z</em>-plane frequencies to a more practical measure of frequencies in Hz. Because a ω<em class="calibre7"><sub class="calibre12">d</sub></em> frequency of ω<em class="calibre7"><sub class="calibre12">d</sub></em> = π radians/sample corresponds to a cyclic frequency of <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz, we relate ω<em class="calibre7"><sub class="calibre12">d</sub></em> and a digital cyclic frequency <em class="calibre7">f<sub class="calibre12">d</sub></em> using</p>
<p class="caption"><a id="calibre_link-906"></a>(6-117)</p>
<p class="image"><img src="images/001757.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Substituting <a href="#calibre_link-906">Eq. (6-117)</a> into <a href="#calibre_link-902">Eq. (6-115)</a>, and recalling that ω<em class="calibre7"><sub class="calibre12">a</sub></em> = 2π<em class="calibre7">f<sub class="calibre12">a</sub></em>, gives us</p>
<p class="caption"><a id="calibre_link-907"></a>(6-118)</p>
<p class="image"><img src="images/000785.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Solving <a href="#calibre_link-907">Eq. (6-118)</a> for <em class="calibre7">f<sub class="calibre12">d</sub></em> yields</p>
<p class="caption"><a id="calibre_link-908"></a>(6-119)</p>
<p class="image"><img src="images/001639.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-908">Equation (6-119)</a> is plotted in <a href="#calibre_link-909">Figure 6-40(a)</a>. <a href="#calibre_link-907">Equations (6-118)</a> and <a href="#calibre_link-908">(6-119)</a> are very useful! They relate the analog <em class="calibre7">s</em>-plane frequency <em class="calibre7">f<sub class="calibre12">a</sub></em> in Hz to the digital <em class="calibre7">z</em>-plane’s warped frequency <em class="calibre7">f<sub class="calibre12">d</sub></em> in Hz. This important nonlinear relationship is plotted in <a href="#calibre_link-909">Figure 6-40(b)</a>. There we see that the <em class="calibre7">f<sub class="calibre12">d</sub></em> frequency warping (compression) becomes more severe as <em class="calibre7">f<sub class="calibre12">d</sub></em> approaches <em class="calibre7">f<sub class="calibre12">s</sub></em>/2.</p>
<p class="caption"><a id="calibre_link-909"></a><strong class="calibre9">Figure 6-40</strong> Nonlinear relationship between the <em class="calibre7">f<sub class="calibre12">d</sub></em> and <em class="calibre7">f<sub class="calibre12">a</sub></em> frequencies: (a) frequency warping curve; (b) <em class="calibre7">s</em>-domain frequency response transformation to a <em class="calibre7">z</em>-domain frequency response; (c) example |<em class="calibre7">H<sub class="calibre12">a</sub></em>(<em class="calibre7">f<sub class="calibre12">a</sub></em>)| and transformed |<em class="calibre7">H<sub class="calibre12">d</sub></em>(<em class="calibre7">f<sub class="calibre12">d</sub></em>)|.</p>
<p class="image"><img src="images/000904.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So what does all this <em class="calibre7">f<sub class="calibre12">a</sub></em> to <em class="calibre7">f<sub class="calibre12">d</sub></em> mapping rigmarole mean? It means two things. First, if a bandpass analog filter’s upper cutoff frequency is <em class="calibre7">f<sub class="calibre12">a</sub></em><sub class="calibre12">1</sub> Hz, a bilinear-transform-designed digital bandpass filter operating at a sample rate of <em class="calibre7">f<sub class="calibre12">s</sub></em> Hz will have an upper cutoff frequency of <em class="calibre7">f<sub class="calibre12">d</sub></em><sub class="calibre12">1</sub> Hz as shown in <a href="#calibre_link-909">Figure 6-40(c)</a>. Likewise if a bilinear-transform-designed digital bandpass filter is desired to have an upper cutoff frequency of <em class="calibre7">f<sub class="calibre12">d</sub></em><sub class="calibre12">1</sub> Hz, then the original prototype analog bandpass filter must be designed (prewarped) to have an upper cutoff frequency of <em class="calibre7">f<sub class="calibre12">a</sub></em><sub class="calibre12">1</sub> Hz using <a href="#calibre_link-907">Eq. (6-118)</a>.</p>
<p class="calibre3">Second, no IIR filter response aliasing can occur with the bilinear transform design method. No matter what the shape, or bandwidth, of the |<em class="calibre7">H<sub class="calibre12">a</sub></em>(<em class="calibre7">f<sub class="calibre12">a</sub></em>)| prototype analog filter, none of the |<em class="calibre7">H<sub class="calibre12">d</sub></em>(<em class="calibre7">f<sub class="calibre12">d</sub></em>)| magnitude responses can extend beyond half the sampling rate of <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz&mdash;and that’s what makes the bilinear transform IIR filter design method as popular as it is.</p>
<p class="calibre3">The steps necessary to perform an IIR filter design using the bilinear transform method are as follows:</p>
<p class="indenthanging2"><strong class="calibre9">Step 1:</strong> Obtain the Laplace transfer function <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) for the prototype analog filter in the form of <a href="#calibre_link-910">Eq. (6-43)</a>.</p>
<p class="indenthanging2"><strong class="calibre9">Step 2:</strong> Determine the digital filter’s equivalent sampling frequency <em class="calibre7">f<sub class="calibre12">s</sub></em> and establish the sample period <em class="calibre7">t<sub class="calibre12">s</sub></em> = 1/<em class="calibre7">f<sub class="calibre12">s</sub></em>.</p>
<p class="indenthanging2"><a id="calibre_link-2811"></a><strong class="calibre9">Step 3:</strong> In the Laplace <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) transfer function, substitute the expression</p>
<p class="caption"><a id="calibre_link-913"></a>(6-120)</p>
<p class="image"><img src="images/001520.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging5">for the variable <em class="calibre7">s</em> to get the IIR filter’s <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function.</p>
<p class="indenthanging2"><strong class="calibre9">Step 4:</strong> Multiply the numerator and denominator of <em class="calibre7">H</em>(<em class="calibre7">z</em>) by the appropriate power of (1 + <em class="calibre7">z</em><sup class="calibre10">−1</sup>) and grind through the algebra to collect terms of like powers of <em class="calibre7">z</em> in the form</p>
<p class="caption"><a id="calibre_link-2014"></a><a id="calibre_link-917"></a>(6-121)</p>
<p class="image"><img src="images/000555.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging2"><strong class="calibre9">Step 5:</strong> Just as in the impulse invariance design methods, by inspection, we can express the IIR filter’s time-domain equation in the general form of</p>
<p class="caption"><a id="calibre_link-911"></a>(6-122)</p>
<p class="image"><img src="images/001414.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging5">Although the expression in <a href="#calibre_link-911">Eq. (6-122)</a> only applies to the filter structure in <a href="#calibre_link-798">Figure 6-18</a>, to complete our design, we can apply the <em class="calibre7">a</em>(<em class="calibre7">k</em>) and <em class="calibre7">b</em>(<em class="calibre7">k</em>) coefficients to the improved IIR structure shown in <a href="#calibre_link-814">Figure 6-22</a>.</p>
<p class="calibre3">To show just how straightforward the bilinear transform design method is, let’s use it to solve the IIR filter design problem first presented for the impulse invariance design method.</p>
<p class="calibre3"><a id="calibre_link-2812"></a></p>
<h4 class="calibre13">6.11.1 Bilinear Transform Design Example</h4>
<p class="calibre3">Again, our goal is to design an IIR filter that approximates the 2nd-order Chebyshev prototype analog lowpass filter, shown in <a href="#calibre_link-826">Figure 6-26</a>, whose passband ripple is 1 dB. The <em class="calibre7">f<sub class="calibre12">s</sub></em> sampling rate is 100 Hz (<em class="calibre7">t<sub class="calibre12">s</sub></em> = 0.01), and the filter’s 1 dB cutoff frequency is 20 Hz. As before, given the original prototype filter’s Laplace transfer function as</p>
<p class="caption"><a id="calibre_link-912"></a>(6-123)</p>
<p class="image"><img src="images/000498.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">and the value of <em class="calibre7">t<sub class="calibre12">s</sub></em> = 0.01 for the sample period, we’re ready to proceed with Step 3. For convenience, let’s replace the constants in <a href="#calibre_link-912">Eq. (6-123)</a> with variables in the form of</p>
<p class="caption"><a id="calibre_link-914"></a>(6-124)</p>
<p class="image"><img src="images/001308.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">b</em> = 137.94536 and <em class="calibre7">c</em> = 17410.145. Performing the substitution of <a href="#calibre_link-913">Eq. (6-120)</a> in <a href="#calibre_link-914">Eq. (6-124)</a>,</p>
<p class="caption"><a id="calibre_link-2813"></a><a id="calibre_link-2814"></a>(6-125)</p>
<p class="image"><img src="images/000341.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To simplify our algebra a little, let’s substitute the variable <em class="calibre7">a</em> for the fraction 2/<em class="calibre7">t<sub class="calibre12">s</sub></em> to give</p>
<p class="caption"><a id="calibre_link-2815"></a>(6-126)</p>
<p class="image"><img src="images/001186.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Proceeding with Step 4, we multiply <a href="#calibre_link-897">Eq. (109)</a>’s numerator and denominator by (1 + <em class="calibre7">z</em><sup class="calibre10">−1</sup>)<sup class="calibre10">2</sup> to yield</p>
<p class="caption"><a id="calibre_link-915"></a>(6-127)</p>
<p class="image"><img src="images/000228.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Multiplying through by the factors in the denominator of <a href="#calibre_link-915">Eq. (6-127)</a>, and collecting like powers of <em class="calibre7">z</em>,</p>
<p class="caption"><a id="calibre_link-916"></a>(6-128)</p>
<p class="image"><img src="images/001071.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We’re almost there. To get <a href="#calibre_link-916">Eq. (6-128)</a> into the form of <a href="#calibre_link-917">Eq. (6-121)</a> with a constant term of one in the denominator, we divide <a href="#calibre_link-916">Eq. (6-128)</a>’s numerator and denominator by (<em class="calibre7">a</em><sup class="calibre10">2</sup> + <em class="calibre7">ab</em> + <em class="calibre7">c</em>), giving us</p>
<p class="caption"><a id="calibre_link-918"></a>(6-129)</p>
<p class="image"><img src="images/000127.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We now have <em class="calibre7">H</em>(<em class="calibre7">z</em>) in a form with all the like powers of <em class="calibre7">z</em> combined into single terms, and <a href="#calibre_link-918">Eq. (6-129)</a> looks something like the desired form of <a href="#calibre_link-917">Eq. (6-121)</a>. If we plug the values <em class="calibre7">a</em> = 2/<em class="calibre7">t<sub class="calibre12">s</sub></em> = 200, <em class="calibre7">b</em> = 137.94536, and <em class="calibre7">c</em> = 17410.145 into <a href="#calibre_link-918">Eq. (6-129)</a>, we get the following IIR filter transfer function:</p>
<p class="caption"><a id="calibre_link-919"></a>(6-130)</p>
<p class="image"><img src="images/000718.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2017"></a>and there we are. Now, by inspection of <a href="#calibre_link-919">Eq. (6-130)</a>, we get the time-domain expression for our IIR filter as</p>
<p class="caption"><a id="calibre_link-2816"></a>(6-131)</p>
<p class="image"><img src="images/000859.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The frequency magnitude response of our bilinear transform IIR design example is shown as the dark curve in <a href="#calibre_link-920">Figure 6-41(a)</a>, where, for comparison, we’ve shown the result of that impulse invariance design example as the shaded curve. Notice how the bilinear-transform-designed filter’s magnitude response approaches zero at the folding frequency of <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 = 50 Hz. This is as it should be&mdash;that’s the whole purpose of the bilinear transform design method. <a href="#calibre_link-920">Figure 6-41(b)</a> illustrates the nonlinear phase response of the bilinear-transform-designed IIR filter.</p>
<p class="caption"><a id="calibre_link-920"></a><strong class="calibre9">Figure 6-41</strong> Comparison of the bilinear transform and impulse invariance design IIR filters: (a) frequency magnitude responses; (b) phase of the bilinear transform IIR filter.</p>
<p class="image"><img src="images/001525.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We might be tempted to think that not only is the bilinear transform design method easier to perform than the impulse invariance design method, but that it gives us a much sharper roll-off for our lowpass filter. Well, the frequency warping of the bilinear transform method does compress (sharpen) the roll-off portion of a lowpass filter, as we saw in <a href="#calibre_link-909">Figure 6-40</a>, but an additional reason for the improved response is the price we pay in terms of the <a id="calibre_link-2407"></a>additional complexity of the implementation of our IIR filter. We see this by examining the implementation of our IIR filter as shown in <a href="#calibre_link-921">Figure 6-42</a>. Notice that our new filter requires five multiplications per filter output sample where the impulse invariance design filter in <a href="#calibre_link-831">Figure 6-28(a)</a> required only three multiplications per filter output sample. The additional multiplications are, of course, required by the additional feedforward <em class="calibre7">z</em> terms in the numerator of <a href="#calibre_link-919">Eq. (6-130)</a>. These added <em class="calibre7">b</em>(<em class="calibre7">k</em>) coefficient terms in the <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function correspond to zeros in the <em class="calibre7">z</em>-plane created by the bilinear transform that did not occur in the impulse invariance design method.</p>
<p class="caption"><a id="calibre_link-921"></a><strong class="calibre9">Figure 6-42</strong> Implementation of the bilinear transform design example filter.</p>
<p class="image"><img src="images/000031.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Because our example prototype analog lowpass filter had a cutoff frequency that was <em class="calibre7">f<sub class="calibre12">s</sub></em>/5, we don’t see a great deal of frequency warping in the bilinear transform curve in <a href="#calibre_link-920">Figure 6-41</a>. (In fact, Kaiser has shown that when <em class="calibre7">f<sub class="calibre12">s</sub></em> is large, the impulse invariance and bilinear transform design methods result in essentially identical <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer functions<a href="#calibre_link-829">[18]</a>.) Had our cutoff frequency been a larger percentage of <em class="calibre7">f<sub class="calibre12">s</sub></em>, bilinear transform warping would have been more serious, and our resultant |<em class="calibre7">H<sub class="calibre12">d</sub></em>(<em class="calibre7">f<sub class="calibre12">d</sub></em>)| cutoff frequency would have been below the desired value. What the pros do to avoid this is to <em class="calibre7">prewarp</em> the prototype analog filter’s cutoff frequency requirement before the analog <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) transfer function is derived in Step 1.</p>
<p class="calibre3">In that way, they compensate for the bilinear transform’s frequency warping before it happens. We can use <a href="#calibre_link-902">Eq. (6-115)</a> to determine the prewarped prototype analog filter lowpass cutoff frequency that we want mapped to the desired IIR lowpass cutoff frequency. We plug the desired IIR cutoff frequency ω<em class="calibre7"><sub class="calibre12">d</sub></em> in <a href="#calibre_link-902">Eq. (6-115)</a> to calculate the prototype analog ω<em class="calibre7"><sub class="calibre12">a</sub></em> cutoff frequency used to derive the prototype analog filter’s <em class="calibre7">H<sub class="calibre12">c</sub></em>(<em class="calibre7">s</em>) transfer function.</p>
<p class="calibre3">Although we explained how the bilinear transform design method avoids the impulse invariance method’s inherent frequency response aliasing, it’s important to remember that we still have to avoid filter input data aliasing. No matter what kind of digital filter or filter design method is used, the original <a id="calibre_link-2393"></a>input signal data must always be obtained using a sampling scheme that avoids the aliasing described in <a href="#calibre_link-287">Chapter 2</a>. If the original input data contains errors due to sample rate aliasing, no filter can remove those errors.</p>
<p class="calibre3">Our introductions to the impulse invariance and bilinear transform design techniques have, by necessity, presented only the essentials of those two design methods. Although rigorous mathematical treatment of the impulse invariance and bilinear transform design methods is inappropriate for an introductory text such as this, more detailed coverage is available to the interested reader[<a href="#calibre_link-832">20</a>,<a href="#calibre_link-833">21</a>,<a href="#calibre_link-842">25</a>,<a href="#calibre_link-843">26</a>]. References <a href="#calibre_link-842">[25]</a> and <a href="#calibre_link-843">[26]</a>, by the way, have excellent material on the various prototype analog filter types used as a basis for the analytical IIR filter design methods. Although our examples of IIR filter design using the impulse invariance and bilinear transform techniques approximated analog lowpass filters, it’s important to remember that these techniques apply equally well to designing bandpass and highpass IIR filters. To design a highpass IIR filter, for example, we’d merely start our design with a Laplace transfer function for the prototype analog highpass filter. Our IIR digital filter design would then proceed to approximate that prototype highpass filter.</p>
<p class="calibre3">As we have seen, the impulse invariance and bilinear transform design techniques are both powerful and a bit difficult to perform. The mathematics is intricate and the evaluation of the design equations is arduous for all but the simplest filters. As such, we’ll introduce a third class of IIR filter design methods based on software routines that take advantage of <em class="calibre7">iterative optimization</em> computing techniques. In this case, the designer defines the desired filter frequency response, and the algorithm begins generating successive approximations until the IIR filter coefficients converge (ideally) to an optimized design.</p>
<p class="calibre3"><a id="calibre_link-628"></a></p>
<h3 class="calibre6">6.12 Optimized IIR Filter Design Method</h3>
<p class="calibre3">The final class of IIR filter design methods we’ll introduce is broadly categorized as optimization methods. These IIR filter design techniques were developed for the situation when the desired IIR filter frequency response was not of the standard lowpass, bandpass, or highpass form. When the desired response has an arbitrary shape, closed-form expressions for the filter’s <em class="calibre7">z-</em>transform do not exist, and we have no explicit equations to work with to determine the IIR filter’s coefficients. For this general IIR filter design problem, algorithms were developed to solve sets of linear, or nonlinear, equations on a computer. These software routines mandate that the designer describe, in some way, the desired IIR filter frequency response. The algorithms, then, assume a filter transfer function <em class="calibre7">H</em>(<em class="calibre7">z</em>) as a ratio of polynomials in <em class="calibre7">z</em> and start to calculate the filter’s frequency response. Based on some error criteria, the algorithm begins iteratively adjusting the filter’s coefficients to minimize the error between the desired and the actual filter frequency response. The process ends when the error cannot be further minimized, or a predefined <a id="calibre_link-2817"></a>number of iterations has occurred, and the final filter coefficients are presented to the filter designer. Although these optimization algorithms are too mathematically complex to cover in any detail here, descriptions of the most popular optimization schemes are readily available in the literature [<a href="#calibre_link-832">20</a>,<a href="#calibre_link-833">21</a>,<a href="#calibre_link-922">29</a>&ndash;<a href="#calibre_link-923">34</a>].</p>
<p class="calibre3">The reader may ask, “If we’re not going to cover optimization methods in any detail, why introduce the subject here at all?” The answer is that if we spend much time designing IIR filters, we’ll end up using optimization techniques in the form of computer software routines most of the time. The vast majority of commercially available digital signal processing software packages include one or more IIR filter design routines that are based on optimization methods. When a computer-aided design technique is available, filter designers are inclined to use it to design the simpler lowpass, bandpass, or highpass forms even though analytical techniques exist. With all due respect to Laplace, Heaviside, and Kaiser, why plow through all the <em class="calibre7">z-</em>transform design equations when the desired frequency response can be applied to a software routine to yield acceptable filter coefficients in a few seconds?</p>
<p class="calibre3">As it turns out, using commercially available optimized IIR filter design routines is very straightforward. Although they come in several flavors, most optimization routines only require the designer to specify a few key amplitude and frequency values, and the desired order of the IIR filter (the number of feedback taps), and the software computes the final feedforward and feedback coefficients. In specifying a lowpass IIR filter, for example, a software design routine might require us to specify the values for δ<em class="calibre7"><sub class="calibre12">p</sub></em>, δ<em class="calibre7"><sub class="calibre12">s</sub></em>, <em class="calibre7">f</em><sub class="calibre12">1</sub>, and <em class="calibre7">f</em><sub class="calibre12">2</sub> shown in <a href="#calibre_link-924">Figure 6-43</a>. Some optimization design routines require the user to specify the order of the IIR filter. Those routines then compute the filter coefficients that best approach the required frequency response. Some software routines, on the other hand, don’t require <a id="calibre_link-2227"></a>the user to specify the filter order. They compute the minimum order of the filter that actually meets the desired frequency response.</p>
<p class="caption"><a id="calibre_link-924"></a><strong class="calibre9">Figure 6-43</strong> Example lowpass IIR filter design parameters required for the optimized IIR filter design method.</p>
<p class="image"><img src="images/000968.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-629"></a></p>
<h3 class="calibre6">6.13 A Brief Comparison of IIR and FIR Filters</h3>
<p class="calibre3">The question naturally arises as to which filter type, IIR or FIR, is best suited for a given digital filtering application. That’s not an easy question to answer, but we can point out a few factors that should be kept in mind. First, we can <a id="calibre_link-2368"></a>assume that the differences in the ease of design between the two filter types are unimportant. There are usually more important performance and implementation properties to consider than design difficulty when choosing between an IIR and an FIR filter. One design consideration that may be significant is the IIR filter’s ability to simulate a predefined prototype analog filter. FIR filters do not have this design flexibility.</p>
<p class="calibre3">From a hardware standpoint, with so many fundamental differences between IIR and FIR filters, our choice must be based on those filter characteristics that are most and least important to us. For example, if we need a filter with exactly linear phase, then an FIR filter is the only way to go. If, on the other hand, our design requires a filter to accept very high data rates and slight phase nonlinearity is tolerable, we might lean toward IIR filters with their reduced number of necessary multipliers per output sample.</p>
<p class="calibre3">One caveat, though: Just because an FIR filter has, say, three times the number of multiplies per output sample relative to an IIR filter, that does not mean the IIR filter will execute faster on a programmable DSP chip. Typical DSP chips have a <em class="calibre7">zero-overhead looping</em> capability whose parallelism speeds the execution of <em class="calibre7">multiply and accumulate</em> (MAC) routines, with which FIR filtering is included. The code for IIR filtering has more data/coefficient pointer bookkeeping to accommodate than FIR filter code. So, if you’re choosing between an IIR filter requiring <em class="calibre7">K</em> multiplies per output sample and an FIR filter needing 2<em class="calibre7">K</em> (or 3<em class="calibre7">K</em>) multiplies per output sample, code both filters and measure their execution speeds.</p>
<p class="calibre3"><a href="#calibre_link-925">Table 6-1</a> presents a brief comparison of IIR and FIR filters based on several performance and implementation properties.</p>
<p class="caption"><a id="calibre_link-925"></a><strong class="calibre9">Table 6-1</strong> IIR and Nonrecursive FIR Filter Characteristics Comparison</p>
<p class="image"><img src="images/001605.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-630"></a></p>
<h3 class="calibre6">References</h3>
<p class="chapterendnote"><a id="calibre_link-754"></a>[1] Churchill, R. V. <em class="calibre7">Modern Operational Mathematics in Engineering</em>, McGraw-Hill, New York, 1944, pp. 307&ndash;334.</p>
<p class="chapterendnote"><a id="calibre_link-2818"></a>[2] Aseltine, J. A. <em class="calibre7">Transform Method in Linear System Analysis</em>, McGraw-Hill, New York, 1958, pp. 287&ndash;292.</p>
<p class="chapterendnote"><a id="calibre_link-755"></a>[3] Nixon, F. E. <em class="calibre7">Handbook of Laplace Transformation: Tables and Examples</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1960.</p>
<p class="chapterendnote"><a id="calibre_link-780"></a>[4] Kaiser, J. F. “Digital Filters,” in <em class="calibre7">System Analysis by Digital Computer</em>, ed. by F. F. Kuo and J. F. Kaiser, John Wiley and Sons, New York, 1966, pp. 218&ndash;277.</p>
<p class="chapterendnote"><a id="calibre_link-781"></a>[5] Kaiser, J. F. “Design Methods for Sampled Data Filters,” <em class="calibre7">Proc. First Annual Allerton Conference on Circuit and System Theory,</em> 1963, <a href="#calibre_link-187">Chapter 7</a>, pp. 221&ndash;236.</p>
<p class="chapterendnote"><a id="calibre_link-782"></a>[6] Ragazzini, J. R., and Franklin, G. F. <em class="calibre7">Sampled-Data Control Systems</em>, McGraw-Hill, New York, 1958, pp. 52&ndash;83.</p>
<p class="chapterendnote"><a id="calibre_link-2819"></a><a id="calibre_link-2820"></a>[7] Milne-Thomson, L. M. <em class="calibre7">The Calculus of Finite Differences</em>, Macmillan, London, 1951, pp. 232&ndash;251.</p>
<p class="chapterendnote"><a id="calibre_link-2821"></a>[8] Truxal, J. G. <em class="calibre7">Automatic Feedback Control System Synthesis</em>, McGraw-Hill, New York, 1955, p. 283.</p>
<p class="chapterendnote"><a id="calibre_link-783"></a>[9] Blackman, R. B. <em class="calibre7">Linear Data-Smoothing and Prediction in Theory and Practice</em>, Addison Wesley, Reading, Massachusetts, 1965, pp. 81&ndash;84.</p>
<p class="chapterendnote"><a id="calibre_link-813"></a>[10] Oppenheim, A., Schafer, R., and Buck, J. <em class="calibre7">Discrete-Time Signal Processing</em>, 2nd ed., Prentice Hall, Upper Saddle River, New Jersey, 1999, pp. 306&ndash;307.</p>
<p class="chapterendnote"><a id="calibre_link-815"></a>[11] Gold, B., and Jordan, K. L., Jr. “A Note on Digital Filter Synthesis,” <em class="calibre7">Proceedings of the IEEE,</em> Vol. 56, October 1968, p. 1717.</p>
<p class="chapterendnote"><a id="calibre_link-816"></a>[12] Rabiner, L. R., et al. “Terminology in Digital Signal Processing,” <em class="calibre7">IEEE Trans. on Audio and Electroacoustics</em>, Vol. AU-20, No. 5, December 1972, p. 327.</p>
<p class="chapterendnote"><a id="calibre_link-819"></a>[13] Jackson, L. B. “On the Interaction of Roundoff Noise and Dynamic Range and Dynamic Range in Digital Filters,” <em class="calibre7">Bell System Technical Journal</em>, Vol. 49, February 1970, pp. 159&ndash;184.</p>
<p class="chapterendnote"><a id="calibre_link-820"></a>[14] Jackson, L. B. “Roundoff Noise Analysis for Fixed-Point Digital Filters Realized in Cascade or Parallel Form,” <em class="calibre7">IEEE Trans. Audio Electroacoustics</em>, Vol. AU-18, June 1970, pp. 107&ndash;122.</p>
<p class="chapterendnote"><a id="calibre_link-822"></a>[15] Sandberg, I. W. “A Theorem Concerning Limit Cycles in Digital Filters,” <em class="calibre7">Proc. Seventh Annual Allerton Conference on Circuit and System Theory</em>, Monticello, Illinois, October 1969.</p>
<p class="chapterendnote"><a id="calibre_link-823"></a>[16] Ebert, P. M., et al. “Overflow Oscillations in Digital Filters,” <em class="calibre7">Bell System Technical Journal</em>, Vol. 48, November 1969, pp. 2999&ndash;3020.</p>
<p class="chapterendnote"><a id="calibre_link-824"></a>[17] Oppenheim, A. V. “Realization of Digital Filters Using Block Floating Point Arithmetic,” <em class="calibre7">IEEE Trans. Audio Electroacoustics</em>, Vol. AU-18, June 1970, pp. 130&ndash;136.</p>
<p class="chapterendnote"><a id="calibre_link-829"></a>[18] Kaiser, J. F. “Some Practical Considerations in the Realization of Linear Digital Filters,” <em class="calibre7">Proc. Third Annual Allerton Conference on Circuit and System Theory</em>, 1965, pp. 621&ndash;633.</p>
<p class="chapterendnote"><a id="calibre_link-830"></a>[19] Rabiner, L. R., and Rader, C. M., eds. <em class="calibre7">Digital Signal Processing</em>, IEEE Press, New York, 1972, p. 361.</p>
<p class="chapterendnote"><a id="calibre_link-832"></a>[20] Oppenheim, A. V., and Schafer, R. W. <em class="calibre7">Discrete Time Signal Processing</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1989, p. 406.</p>
<p class="chapterendnote"><a id="calibre_link-833"></a>[21] Rabiner, L. R., and Gold, B. <em class="calibre7">Theory and Application of Digital Signal Processing</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1975, p. 216.</p>
<p class="chapterendnote"><a id="calibre_link-834"></a>[22] Grover, D. “Subject: Re: How to Arrange the (Gain, Pole, Zero) of the Cascaded Biquad Filter.” Usenet group <em class="calibre7">comp.dsp</em> post, December 28, 2000.</p>
<p class="chapterendnote"><a id="calibre_link-835"></a>[23] Grover, D., and Deller, J. <em class="calibre7">Digital Signal Processing and the Microcontroller,</em> Prentice Hall, Upper Saddle River, New Jersey, 1998.</p>
<p class="chapterendnote"><a id="calibre_link-2822"></a><a id="calibre_link-841"></a>[24] Stearns, S. D. <em class="calibre7">Digital Signal Analysis</em>, Hayden Book Co., Rochelle Park, New Jersey, 1975, p. 114.</p>
<p class="chapterendnote"><a id="calibre_link-842"></a>[25] Stanley, W. D., et al. <em class="calibre7">Digital Signal Processing</em>, Reston Publishing Co., Reston, Virginia, 1984, p. 191.</p>
<p class="chapterendnote"><a id="calibre_link-843"></a>[26] Williams, C. S. <em class="calibre7">Designing Digital Filters</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1986, pp. 166&ndash;186.</p>
<p class="chapterendnote"><a id="calibre_link-844"></a>[27] Johnson, M. “Implement Stable IIR Filters Using Minimal Hardware,” <em class="calibre7">EDN</em>, April 14, 1983.</p>
<p class="chapterendnote"><a id="calibre_link-851"></a>[28] Oppenheim, A. V., Willsky, A. S., and Young, I. T. <em class="calibre7">Signals and Systems</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1983, p. 659.</p>
<p class="chapterendnote"><a id="calibre_link-922"></a>[29] Deczky, A. G. “Synthesis of Digital Recursive Filters Using the Minimum P Error Criterion,” <em class="calibre7">IEEE Trans. on Audio and Electroacoustics</em>, Vol. AU-20, No. 2, October 1972, p. 257.</p>
<p class="chapterendnote"><a id="calibre_link-2823"></a>[30] Steiglitz, K. “Computer-Aided Design of Recursive Digital Filters,” <em class="calibre7">IEEE Trans. on Audio and Electroacoustics</em>, Vol. 18, No. 2, 1970, p. 123.</p>
<p class="chapterendnote"><a id="calibre_link-2824"></a>[31] Richards, M. A. “Application of Deczky’s Program for Recursive Filter Design to the Design of Recursive Decimators,” <em class="calibre7">IEEE Trans. on Acoustics, Speech, and Signal Processing</em>, Vol. ASSP-30, October 1982, p. 811.</p>
<p class="chapterendnote"><a id="calibre_link-2825"></a>[32] Parks, T. W., and Burrus, C. S. <em class="calibre7">Digital Filter Design</em>, John Wiley and Sons, New York, 1987, p. 244.</p>
<p class="chapterendnote"><a id="calibre_link-2826"></a>[33] Rabiner, L., Graham, Y., and Helms, H. “Linear Programming Design of IIR Digital Filters with Arbitrary Magnitude Functions,” <em class="calibre7">IEEE Trans. on Acoustics, Speech, and Signal Processing.</em>, Vol. ASSP-22, No. 2, April 1974, p. 117.</p>
<p class="chapterendnote"><a id="calibre_link-923"></a>[34] Friedlander, B., and Porat, B. “The Modified Yule-Walker Method of ARMA Spectral Estimation,” <em class="calibre7">IEEE Trans. on Aerospace Electronic Systems</em>, Vol. AES-20, No. 2, March 1984, pp. 158&ndash;173.</p>
<p class="calibre3"><a id="calibre_link-631"></a></p>
<h3 class="calibre6"><a id="calibre_link-2827" class="calibre5"></a>Chapter 6 Problems</h3>
<p class="indenthanging"><strong class="calibre9">6.1</strong> Review the <em class="calibre7">z</em>-plane depiction in <a href="#calibre_link-926">Figure P6-1</a>. Draw a rough sketch of the Laplace <em class="calibre7">s</em>-plane showing a shaded area (on the <em class="calibre7">s</em>-plane) that corresponds to the shaded circular band in <a href="#calibre_link-926">Figure P6-1</a>.</p>
<p class="caption"><a id="calibre_link-926"></a><strong class="calibre9">Figure P6-1</strong></p>
<p class="image"><img src="images/000528.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">6.2</strong> Write the <em class="calibre7">H</em>(<em class="calibre7">z</em>) <em class="calibre7">z</em>-domain transfer function equations for the filters described by the following difference equations:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> <em class="calibre7">y</em>(<em class="calibre7">n</em>) = <em class="calibre7">x</em>(<em class="calibre7">n</em>) − <em class="calibre7">y</em>(<em class="calibre7">n</em>−2),</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> <em class="calibre7">y</em>(<em class="calibre7">n</em>) = <em class="calibre7">x</em>(<em class="calibre7">n</em>) + 3<em class="calibre7">x</em>(<em class="calibre7">n</em>−1) + 2<em class="calibre7">x</em>(<em class="calibre7">n</em>−2) − <em class="calibre7">y</em>(<em class="calibre7">n</em>−3),</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> <em class="calibre7">y</em>(<em class="calibre7">n</em>) = <em class="calibre7">x</em>(<em class="calibre7">n</em>) + <em class="calibre7">x</em>(<em class="calibre7">n</em>−1) + <em class="calibre7">x</em>(<em class="calibre7">n</em>−3) + <em class="calibre7">x</em>(<em class="calibre7">n</em>−4) − <em class="calibre7">y</em>(<em class="calibre7">n</em>−2).</p>
<p class="indenthanging"><strong class="calibre9">6.3</strong> Knowing the <em class="calibre7"><a href="#calibre_link-344">order</a></em> of a digital filter is important information. It typically gives us a direct indication of the computational workload (number of additions and multiplications) necessary to compute a single filter output sample. State the order of the filters in Problem 6.2.</p>
<p class="indenthanging"><strong class="calibre9">6.4</strong> Write the <em class="calibre7">H</em>(ω) frequency response equations, in both polar and rectangular form, for the filters in Problem 6.2. By “polar form” we mean we want <em class="calibre7">H</em>(ω) expressed as a ratio of terms using <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">jk</em>ω</sup>, where <em class="calibre7">k</em> is an integer. By “rectangular form” we mean we want <em class="calibre7">H</em>(ω) expressed as a ratio in the form of</p>
<p class="image"><img src="images/000667.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">where <em class="calibre7">a</em>, <em class="calibre7">b</em>, <em class="calibre7">c</em>, and <em class="calibre7">d</em> are cosine and/or sine functions whose arguments are <em class="calibre7">k</em>ω.</p>
<p class="indentpara">(<strong class="calibre9">Note:</strong> This problem is <em class="calibre7">not</em> “busy work.” The rectangular form of <em class="calibre7">H</em>(ω) is the expression you would model using generic signal processing software to compute and plot a filter’s magnitude and phase response in the frequency domain.)</p>
<p class="indenthanging"><a id="calibre_link-2828"></a><strong class="calibre9">6.5</strong> Considering the <em class="calibre7">z</em>-domain transfer function associated with a digital filter:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What does it mean if the filter has one or more poles outside the <em class="calibre7">z</em>-plane’s unit circle?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What does it mean if the filter has a zero lying exactly on the <em class="calibre7">z</em>-plane’s unit circle?</p>
<p class="indenthanging"><strong class="calibre9">6.6</strong> In the literature of DSP, we usually see filter transfer functions expressed in terms of <em class="calibre7">z</em> where <em class="calibre7">z</em> always has a negative exponent. But sometimes we see transfer functions in terms of <em class="calibre7">z</em> having positive exponents. For example, you might encounter an IIR filter’s transfer function expressed as</p>
<p class="image"><img src="images/001329.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the transfer function expression equivalent to <em class="calibre7">H</em>(<em class="calibre7">z</em>) in terms of <em class="calibre7">z</em> with <em class="calibre7">z</em> having negative-only exponents?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Is this IIR filter stable? Justify your answer.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Draw the Direct Form I structure (block diagram), showing the filter’s coefficients.</p>
<p class="indenthangingn"><strong class="calibre9">(d)</strong> Draw the Direct Form II structure, showing the filter’s coefficients.</p>
<p class="indenthanging"><strong class="calibre9">6.7</strong> Although we didn’t need to use the <em class="calibre7">z</em>-transform to analyze the tapped-delay line (nonrecursive) FIR filters in <a href="#calibre_link-79">Chapter 5</a>, we could have done so. Let’s try an FIR filter analysis example using the <em class="calibre7">z</em>-transform. For the filter in <a href="#calibre_link-927">Figure P6-7</a>:</p>
<p class="caption"><a id="calibre_link-927"></a><strong class="calibre9">Figure P6-7</strong></p>
<p class="image"><img src="images/001386.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Write the time-domain difference equation describing the filter output <em class="calibre7">y</em>(<em class="calibre7">n</em>) in terms of the <em class="calibre7">x</em>(<em class="calibre7">n</em>) input and the <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Write the <em class="calibre7">z</em>-transform of the <em class="calibre7">y</em>(<em class="calibre7">n</em>) difference equation from Part (a).</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Write the <em class="calibre7">z</em>-domain transfer function, <em class="calibre7">H</em>(<em class="calibre7">z</em>) = <em class="calibre7">Y</em>(<em class="calibre7">z</em>)/<em class="calibre7">X</em>(<em class="calibre7">z</em>), of the filter.</p>
<p class="indenthangingn"><strong class="calibre9">(d)</strong> What is the order of this FIR filter?</p>
<p class="indenthanging"><a id="calibre_link-2829"></a><strong class="calibre9">6.8</strong> Thinking about IIR digital filters:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Is it true that to determine the frequency response of an IIR filter, we need to know both the filter’s time-domain difference equation <em class="calibre7">and</em> the impulse response of that filter? Explain your answer.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> If we know the <em class="calibre7">H</em>(<em class="calibre7">z</em>) <em class="calibre7">z</em>-domain transfer function equation for a digital filter, what must we do to determine the frequency response of that filter?</p>
<p class="indenthanging"><strong class="calibre9">6.9</strong> Draw the Direct Form I and the Direct Form II block diagrams of the filter represented by the following <em class="calibre7">z</em>-domain transfer function:</p>
<p class="image"><img src="images/000125.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">6.10</strong> Consider the two filters in <a href="#calibre_link-928">Figure P6-10</a>. (Notice the minus sign at the first adder in <a href="#calibre_link-928">Figure P6-10(b)</a>.) Determine whether each filter is an IIR or an FIR filter. Justify your answers.</p>
<p class="caption"><a id="calibre_link-928"></a><strong class="calibre9">Figure P6-10</strong></p>
<p class="image"><img src="images/001689.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">6.11</strong> The author once read a design document describing how an engineer was tasked to implement Network A in <a href="#calibre_link-929">Figure P6-11(a)</a>, using a programmable DSP chip, as part of a specialized digital filter. The engineer suggested that, due to the chip’s internal architecture, for computational speed reasons Network B shown in <a href="#calibre_link-929">Figure P6-11(b)</a> should be used instead of Network A. He also stated that the frequency magnitude responses of the two networks are identical. Is that last statement true? Justify your answer.</p>
<p class="caption"><a id="calibre_link-929"></a><strong class="calibre9">Figure P6-11</strong></p>
<p class="image"><img src="images/001277.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><a id="calibre_link-2830"></a><strong class="calibre9">6.12</strong> Prove that the <em class="calibre7">z</em>-plane pole locations for the two filters in <a href="#calibre_link-930">Figure P6-12</a> are identical.</p>
<p class="caption"><a id="calibre_link-930"></a><strong class="calibre9">Figure P6-12</strong></p>
<p class="image"><img src="images/000314.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara"><strong class="calibre9">Hint:</strong> For Filter #2, write two different equations for <em class="calibre7">U</em>(<em class="calibre7">z</em>) and set those equations equal to each other.</p>
<p class="indenthanging"><strong class="calibre9">6.13</strong> The discrete-sequence output of commercial analog-to-digital (A/D) converters is often contaminated with a DC bias (a constant-level amplitude offset). Stated in different words, even though the converter’s analog <em class="calibre7">x</em>(<em class="calibre7">t</em>) input signal’s average value is zero, the converter’s <em class="calibre7">x</em>(<em class="calibre7">n</em>) output sequence may have a small nonzero average. As such, depending on the application, A/D converters are sometimes followed by an IIR filter shown in <a href="#calibre_link-931">Figure P6-13</a> that removes the DC bias level from the filter’s <em class="calibre7">x</em>(<em class="calibre7">n</em>) input sequence. (The coefficient <em class="calibre7">A</em> is a positive value slightly less than unity.)</p>
<p class="indenthangingn"><a id="calibre_link-2831"></a><strong class="calibre9">(a)</strong> Derive the <em class="calibre7">z</em>-domain transfer function of the DC bias removal filter.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Prove that the filter has a <em class="calibre7">z</em>-plane zero at <em class="calibre7">z</em> = 1, yielding the desired infinite attenuation at the cyclic frequency of zero Hz.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Draw the block diagram of the Direct Form II version of the DC bias removal filter.</p>
<p class="caption"><a id="calibre_link-931"></a><strong class="calibre9">Figure P6-13</strong></p>
<p class="image"><img src="images/001156.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">6.14</strong> Assume we have the software code to implement a notch filter (a filter that attenuates a very narrow band of frequencies and passes frequencies that are above and below the notch’s ω<sub class="calibre12">c</sub> center frequency), and the software documentation states the filter is defined by the following transfer function:</p>
<p class="image"><img src="images/001211.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> If <em class="calibre7">R</em> = 0.9, draw the locations of the notch filter’s poles and zeros on the <em class="calibre7">z</em>-plane in relation to the notch frequency ω<em class="calibre7"><sub class="calibre12">c</sub></em>.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Let’s say we’re processing the signal from a photodiode light sensor in our laboratory and our signal’s time samples are arriving at a sample rate of <em class="calibre7">f<sub class="calibre12">s</sub></em> = 1.8 kHz. Assume that 120 Hz <em class="calibre7">flicker</em> noise from fluorescent lights is contaminating our photodiode output signal. What would be the correct value for ω<em class="calibre7"><sub class="calibre12">c</sub></em> to use in the notch filter code to attenuate the 120 Hz noise? Show your work.</p>
<p class="indenthanging"><strong class="calibre9">6.15</strong> Show that for a 2nd-order FIR filter, whose <em class="calibre7">z</em>-domain transfer function is</p>
<p class="center"><em class="calibre7">H</em>(<em class="calibre7">z</em>) = 1 + <em class="calibre7">Bz</em><sup class="calibre10">−1</sup> + <em class="calibre7">z</em><sup class="calibre10">−2</sup>,</p>
<p class="indentpara">the sum of the locations of the filter’s two <em class="calibre7">z</em>-plane zeros is equal to −<em class="calibre7">B</em>.</p>
<p class="indenthanging"><strong class="calibre9">6.16</strong> Consider the filter in <a href="#calibre_link-932">Figure P6-16</a>.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Determine the <em class="calibre7">z</em>-domain transfer function, <em class="calibre7">H</em>(<em class="calibre7">z</em>) = <em class="calibre7">Y</em>(<em class="calibre7">z</em>)/<em class="calibre7">X</em>(<em class="calibre7">z</em>), of the filter.</p>
<p class="indenthangingn"><a id="calibre_link-2832"></a><strong class="calibre9">(b)</strong> Draw the <em class="calibre7">z</em>-plane pole/zero diagram of the filter.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Using the notion of pole-zero cancellation, draw the block diagram of an exact equivalent, but simpler, filter having fewer multipliers than shown in <a href="#calibre_link-932">Figure P6-16</a>.</p>
<p class="caption"><a id="calibre_link-932"></a><strong class="calibre9">Figure P6-16</strong></p>
<p class="image"><img src="images/000203.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">6.17</strong> Assume we have a digital filter (having real-valued coefficients) whose complex frequency response is the product of an <em class="calibre7">M</em>(ω) magnitude response and a θ(ω) phase response as</p>
<p class="center"><em class="calibre7">H</em>(ω) <em class="calibre7">= M</em>(ω)e<sup class="calibre10"><em class="calibre7">j</em>θ(ω)</sup></p>
<p class="indentpara">where ω is a normalized frequency variable (in the range of −π to π, corresponding to a cyclic frequency range of −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 to <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz) measured in radians/sample. Is it possible to have such a real-coefficient filter whose θ(ω) phase response is of the form</p>
<p class="center">θ(ω) = <em class="calibre7">C</em></p>
<p class="indentpara">where <em class="calibre7">C</em> is a nonzero constant? Explain your answer.</p>
<p class="indenthanging"><strong class="calibre9">6.18</strong> Determine the <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function of the recursive network in <a href="#calibre_link-933">Figure P6-18</a>.</p>
<p class="caption"><a id="calibre_link-933"></a><strong class="calibre9">Figure P6-18</strong></p>
<p class="image"><img src="images/001044.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><a id="calibre_link-2833"></a><strong class="calibre9">6.19</strong> The recursive networks (networks with feedback) that we discussed in this chapter, if they’re simple enough, can be analyzed with pencil and paper. This problem gives us practice in such an analysis and prompts us to recall the process of converting a geometric series into a <em class="calibre7">closed-form</em> equation.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Looking at the discrete network in <a href="#calibre_link-934">Figure P6-19</a>, show that the <em class="calibre7">y</em>(<em class="calibre7">n</em>) output is equal to <em class="calibre7">D</em>/<em class="calibre7">Q</em> for large values of time index <em class="calibre7">n</em> when the <em class="calibre7">x</em>(<em class="calibre7">n</em>) input samples have a constant amplitude of <em class="calibre7">D</em>. (To keep the system stable, assume that <em class="calibre7">Q</em> is a positive number less than one and the network is “at rest” at time <em class="calibre7">n</em> = 0. That is, <em class="calibre7">w</em>(0) = 0.)</p>
<p class="caption"><a id="calibre_link-934"></a><strong class="calibre9">Figure P6-19</strong></p>
<p class="image"><img src="images/000632.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara1"><strong class="calibre9">Hint:</strong> Write equations for <em class="calibre7">y</em>(<em class="calibre7">n</em>) when <em class="calibre7">n</em> = 0, 1, 2, 3, . . . etc., and develop a general series expression for the <em class="calibre7">y</em>(<em class="calibre7">n</em>) output in terms of <em class="calibre7">D</em>, <em class="calibre7">Q</em>, and <em class="calibre7">n</em>. Next, use <a href="#calibre_link-294">Appendix B</a> to obtain a closed-form (no summation sign) expression for the <em class="calibre7">y</em>(<em class="calibre7">n</em>) when <em class="calibre7">n</em> is a large number.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> When we arrive at a solution to a problem, it’s reassuring to verify (double-check) that solution using a different technique. Following this advice, determine the <em class="calibre7">z</em>-domain <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function of the network in <a href="#calibre_link-934">Figure P6-19</a> and show that its zero Hz (DC) gain is 1/<em class="calibre7">Q</em>, verifying your solution to Part (a) of this problem.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Prove that the recursive network is stable if <em class="calibre7">Q</em> is in the range 0 &lt; <em class="calibre7">Q</em> ≤ 1.</p>
<p class="indenthanging"><strong class="calibre9">6.20</strong> A discrete system that has at least one pole on the <em class="calibre7">z</em>-plane’s unit circle is called a <em class="calibre7">discrete resonator</em>, such as the system in <a href="#calibre_link-935">Figure P6-20</a>. Such resonators have impulse responses that oscillate indefinitely.</p>
<p class="caption"><a id="calibre_link-935"></a><strong class="calibre9">Figure P6-20</strong></p>
<p class="image"><img src="images/000939.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><a id="calibre_link-2834"></a><strong class="calibre9">(a)</strong> Draw the <em class="calibre7">z</em>-plane pole/zero diagram of the resonator in the figure.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> At what frequency, measured in terms of the <em class="calibre7">x</em>(<em class="calibre7">n</em>) input <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate, does the pole of this system reside?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Draw the time-domain impulse response of the system in <a href="#calibre_link-935">Figure P6-20</a>.</p>
<p class="indenthangingn"><strong class="calibre9">(d)</strong> Comment on how the frequency of the oscillating impulse response output samples relates to the system’s pole location on the <em class="calibre7">z</em>-plane.</p>
<p class="indenthanging"><strong class="calibre9">6.21</strong> Given the following six difference equations for various digital filters, determine which equation is associated with which |<em class="calibre7">H</em><sub class="calibre12">?</sub>(<em class="calibre7">f</em>)| filter frequency magnitude response in <a href="#calibre_link-936">Figure P6-21</a>. Justify your answers.</p>
<p class="caption"><a id="calibre_link-936"></a><strong class="calibre9">Figure P6-21</strong></p>
<p class="image"><img src="images/001803.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">6.22</strong> A standard 2nd-order IIR filter (a <em class="calibre7">biquad</em>) is shown in its Direct Form I structure in <a href="#calibre_link-937">Figure P6-22</a>. Knowing the DC gain (the value <em class="calibre7">H</em>(ω) at ω = 0 radians/sample) of a filter is critical information when we implement filtering using <a id="calibre_link-2835"></a>binary arithmetic. What is the DC gain of the filter in terms of the filter’s coefficients?</p>
<p class="caption"><a id="calibre_link-937"></a><strong class="calibre9">Figure P6-22</strong></p>
<p class="image"><img src="images/001397.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">6.23</strong> Review the brief description of <em class="calibre7"><a href="#calibre_link-82">allpass filters</a></em> in <a href="#calibre_link-83">Appendix F</a>.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Prove that the 1st-order allpass filter, defined by the following <em class="calibre7">H</em><sub class="calibre12">ap</sub>(<em class="calibre7">z</em>) transfer function, has an |<em class="calibre7">H</em><sub class="calibre12">ap</sub>(ω)| frequency magnitude response that is unity over its full operating frequency range of −π ≤ ω ≤ π radians/sample (−<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 ≤ <em class="calibre7">f</em> ≤ <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz):</p>
<p class="image"><img src="images/000249.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">Variable <em class="calibre7">K</em> is a real-valued scalar constant.</p>
<p class="indentpara2"><strong class="calibre9">Hint:</strong> Rather than prove |<em class="calibre7">H</em><sub class="calibre12">ap</sub>(ω)| = 1 for all ω, prove that the frequency magnitude response squared, |<em class="calibre7">H</em><sub class="calibre12">ap</sub>(ω)|<sup class="calibre10">2</sup>, is equal to unity for all ω.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Draw the Direct Form I and Direct Form II block diagrams of the <em class="calibre7">H</em>(<em class="calibre7">z</em>) allpass filter.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Explain why the <em class="calibre7">H</em><sub class="calibre12">ap</sub>(<em class="calibre7">z</em>) allpass filter can never have a transfer function <em class="calibre7">zero</em> on its <em class="calibre7">z</em>-plane’s unit circle.</p>
<p class="indenthanging"><strong class="calibre9">6.24</strong> A simple 1st-order IIR filter, whose <em class="calibre7">z</em>-domain transfer function is</p>
<p class="image"><img src="images/001090.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">has been proposed for use in synthesizing (simulating) guitar music. Is the <em class="calibre7">H</em><sub class="calibre12">g</sub>(<em class="calibre7">z</em>) filter a lowpass or a highpass filter? Justify your answer. [Karjalainen, M., et al. “Towards High-Quality Sound Synthesis of the Guitar and String <a id="calibre_link-2836"></a>Instruments,” <em class="calibre7">International Computer Music Conference</em>, September 10&ndash;15, 1993, Tokyo, Japan.]</p>
<p class="indenthanging"><strong class="calibre9">6.25</strong> There are general 2nd-order recursive networks used in practice, such as that shown in <a href="#calibre_link-938">Figure P6-25</a>, where the <em class="calibre7">a</em>(0) coefficient is not unity. Assuming you need to analyze such a network, determine its <em class="calibre7">z</em>-domain transfer function that includes the <em class="calibre7">a</em>(0) coefficient. Show your steps.</p>
<p class="caption"><a id="calibre_link-938"></a><strong class="calibre9">Figure P6-25</strong></p>
<p class="image"><img src="images/001688.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">6.26</strong> Consider the recursive highpass filter shown in <a href="#calibre_link-939">Figure P6-26(a)</a>.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Derive the <em class="calibre7">H</em>(ω) frequency response equation for the filter.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What is the location of the filter’s single <em class="calibre7">z</em>-plane pole?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> The |<em class="calibre7">H</em>(ω)| frequency magnitude response of the filter is shown in <a href="#calibre_link-939">Figure P6-26(b)</a>. What are the values of magnitudes <em class="calibre7">M</em><sub class="calibre12">0</sub> and <em class="calibre7">M</em><sub class="calibre12">π</sub>? Show your work.</p>
<p class="caption"><a id="calibre_link-939"></a><strong class="calibre9">Figure P6-26</strong></p>
<p class="image"><img src="images/000712.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><a id="calibre_link-2837"></a><strong class="calibre9">6.27</strong> The recursive network shown in <a href="#calibre_link-940">Figure P6-27</a> can be used to compute the <em class="calibre7">N</em>-point average of <em class="calibre7">N</em> input samples. Although this process works well, it has the disadvantage that as time index <em class="calibre7">n</em> (where <em class="calibre7">n</em> = 1, 2, 3, 4, ...) increases, it requires the real-time computation of both the 1/<em class="calibre7">n</em> and (<em class="calibre7">n</em>−1)<em class="calibre7">n</em> coefficients upon the arrival of each new <em class="calibre7">x</em>(<em class="calibre7">n</em>) input sample.</p>
<p class="caption"><a id="calibre_link-940"></a><strong class="calibre9">Figure P6-27</strong></p>
<p class="image"><img src="images/000268.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> A clever DSP engineer always tries to minimize computations. Show how to modify the network’s diagram so that the real-time coefficient-computation workload is reduced.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Our <em class="calibre7">N</em>-point averager network has a feedback loop, with possible stability problems. Show how your solution to Part (a) of this problem is a stable network as <em class="calibre7">n</em> increases starting at <em class="calibre7">n</em> = 1.</p>
<p class="indenthanging"><strong class="calibre9">6.28</strong> Given the <em class="calibre7">z</em>-plane pole/zero plot, associated with a 2nd-order IIR digital filter, in <a href="#calibre_link-941">Figure P6-28</a>:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer function, in terms of <em class="calibre7">z</em><sup class="calibre10">−1</sup> and <em class="calibre7">z</em><sup class="calibre10">−2</sup>, of the <a href="#calibre_link-941">Figure P6-28</a> filter having two poles and a single zero on the <em class="calibre7">z</em>-plane? Show how you arrived at your answer.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Draw the Direct Form I block diagram of the <em class="calibre7">H</em>(<em class="calibre7">z</em>) filter that implements the transfer function arrived at in Part (a) of this problem.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Draw a new block diagram of the <em class="calibre7">H</em>(<em class="calibre7">z</em>) filter that eliminates one of the multipliers in the Direct Form I block diagram.</p>
<p class="caption"><a id="calibre_link-941"></a><strong class="calibre9">Figure P6-28</strong></p>
<p class="image"><img src="images/001111.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><a id="calibre_link-2838"></a><strong class="calibre9">6.29</strong> In the text’s <a href="#calibre_link-621">Section 6.5</a> we learned to derive a filter transfer function based on knowing the locations of the filter’s poles and zeros. We implied that the roots of polynomial <em class="calibre7">P</em>,</p>
<p class="center"><em class="calibre7">P</em> = <em class="calibre7">z</em><sup class="calibre10">2</sup> + <em class="calibre7">bz</em> + <em class="calibre7">c</em>,</p>
<p class="indentpara">are equal to the roots of polynomial <em class="calibre7">Q</em>, where</p>
<p class="center"><em class="calibre7">Q</em> = <em class="calibre7">GP</em> = <em class="calibre7">Gz</em><sup class="calibre10">2</sup> + <em class="calibre7">Gbz</em> + <em class="calibre7">Gc</em>,</p>
<p class="indentpara">with variable <em class="calibre7">G</em> being a real-valued constant. Prove that the roots of <em class="calibre7">P</em> are indeed equal to the roots of <em class="calibre7">Q</em>.</p>
<p class="indenthanging"><strong class="calibre9">6.30</strong> Given the <em class="calibre7">z</em>-plane pole/zero plots in <a href="#calibre_link-942">Figure P6-30</a>, associated with the <em class="calibre7">H</em>(<em class="calibre7">z</em>) transfer functions of four digital filters, draw a rough sketch of the four filters’ frequency magnitude responses over the frequency range of −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 to <em class="calibre7">f<sub class="calibre12">s</sub></em>/2, where <em class="calibre7">f<sub class="calibre12">s</sub></em> is the filter’s input signal sample rate.</p>
<p class="caption"><a id="calibre_link-942"></a><strong class="calibre9">Figure P6-30</strong></p>
<p class="image"><img src="images/000511.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara"><strong class="calibre9">Note:</strong> The two poles, near <em class="calibre7">z</em> = 1 in <a href="#calibre_link-942">Figure P6-30(c)</a>, are lying exactly on top of two zeros.</p>
<p class="indenthanging"><a id="calibre_link-2839"></a><strong class="calibre9">6.31</strong> Assume that you must implement the lowpass <em class="calibre7">H</em>(<em class="calibre7">z</em>) filter shown in <a href="#calibre_link-943">Figure P6-31</a>. Good DSP engineers always simplify their digital networks whenever possible. Show a simplified block diagram of the filter, without changing the filter’s frequency response, that has a reduced computational workload and reduced data storage (number of delay elements).</p>
<p class="caption"><a id="calibre_link-943"></a><strong class="calibre9">Figure P6-31</strong></p>
<p class="image"><img src="images/001601.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara"><strong class="calibre9">Hint:</strong> Study the filter’s <em class="calibre7">z</em>-plane pole/zero diagram.</p>
<p class="indenthanging"><strong class="calibre9">6.32</strong> In <a href="#calibre_link-79">Chapter 5</a> we had a homework problem whose solution revealed that the 3-tap FIR notch filter in <a href="#calibre_link-944">Figure P6-32(a)</a> has complex conjugate <em class="calibre7">z</em>-plane zeros on the unit circle as shown in <a href="#calibre_link-944">Figure P6-32(b)</a>. That efficient filter, useful for attenuating narrowband noise located at a normalized frequency of ω<sub class="calibre12">n</sub> (−π ≤ ω<sub class="calibre12">n</sub> ≤ π), has a frequency magnitude response shown in <a href="#calibre_link-944">Figure P6-32(c)</a>. If we want the FIR filter’s stopband notches to be narrower, we can implement the 2nd-order IIR filter shown in <a href="#calibre_link-944">Figure P6-32(d)</a> that has conjugate <em class="calibre7">z</em>-plane poles at a radius of <em class="calibre7">R</em> just inside the unit circle as shown in <a href="#calibre_link-944">Figure P6-32(e)</a>. The frequency magnitude response of the IIR notch filter is given in <a href="#calibre_link-944">Figure P6-32(f)</a>. Here’s the problem: Express the <a href="#calibre_link-944">Figure P6-32(d)</a> IIR filter’s <em class="calibre7">a</em>(1) and <em class="calibre7">a</em>(2) coefficients, in terms of ω<sub class="calibre12">n</sub> and <em class="calibre7">R</em>, that will place the <em class="calibre7">z</em>-plane poles as shown in <a href="#calibre_link-944">Figure P6-32(e)</a>. Show your work.</p>
<p class="caption"><a id="calibre_link-944"></a><strong class="calibre9">Figure P6-32</strong></p>
<p class="image"><img src="images/000417.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara"><strong class="calibre9">Hint:</strong> Recall Euler’s identity: 2cos(θ) = (<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">θ</sup> + <em class="calibre7">e<sup class="calibre10">−j</sup></em><sup class="calibre10">θ</sup>).</p>
<p class="indenthanging"><a id="calibre_link-2840"></a><strong class="calibre9">6.33</strong> Let’s exercise our IIR filter analysis skills. Suppose your colleague proposes the 2nd-order IIR filter shown in <a href="#calibre_link-945">Figure P6-33(a)</a> to provide narrow passband filtering as shown in <a href="#calibre_link-945">Figure P6-33(b)</a>. (The |<em class="calibre7">H</em>(ω)| frequency axis uses the discrete-signal frequency variable ω (radians/sample) with ω = π corresponding to a cyclic frequency of <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz.)</p>
<p class="caption"><a id="calibre_link-2841"></a><a id="calibre_link-945"></a><strong class="calibre9">Figure P6-33</strong></p>
<p class="image"><img src="images/000168.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Is this 2nd-order IIR filter unconditionally stable?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Over what range of negative values of the <em class="calibre7">A</em> coefficient will the filter be stable?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> For what negative value of <em class="calibre7">A</em> will the filter be <em class="calibre7">conditionally</em> stable (at least one pole on, and no poles outside, the unit circle)?</p>
<p class="indenthangingn"><strong class="calibre9">(d)</strong> What is the resonant frequency (positive frequency) of the filter in terms of the <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate (in Hz) of the <em class="calibre7">x</em>(<em class="calibre7">n</em>) input?</p>
<p class="indentpara1"><strong class="calibre9">Hint:</strong> If the <em class="calibre7">z</em>-plane’s positive-frequency pole is near the unit circle, think about how the angle of that pole is related to the filter’s resonant frequency measured in Hz.</p>
<p class="indenthanging"><strong class="calibre9">6.34</strong> Think about a 4th-order (5-tap) tapped-delay line finite impulse response (FIR) filter whose <em class="calibre7">z</em>-domain transfer function is</p>
<p class="center"><em class="calibre7">H</em>(<em class="calibre7">z</em>) = <em class="calibre7">b</em><sub class="calibre12">0</sub> + <em class="calibre7">b</em><sub class="calibre12">1</sub><em class="calibre7">z</em><sup class="calibre10">−1</sup> + <em class="calibre7">b</em><sub class="calibre12">2</sub><em class="calibre7">z</em><sup class="calibre10">−2</sup>+ <em class="calibre7">b</em><sub class="calibre12">3</sub><em class="calibre7">z</em><sup class="calibre10">−3</sup>+ <em class="calibre7">b</em><sub class="calibre12">4</sub><em class="calibre7">z</em><sup class="calibre10">−4</sup>.</p>
<p class="indentpara">Assume the filter has real-valued <em class="calibre7">b<sub class="calibre12">k</sub></em> coefficients and that the filter is a linear-phase filter. If one of the filter’s <em class="calibre7">z</em>-plane zeros has a value of <em class="calibre7">z</em><sub class="calibre12">0</sub> = 0.5657 + <em class="calibre7">j</em>0.5657, what are the values of the other three <em class="calibre7">z</em>-plane zeros of this filter?</p>
<p class="indenthanging"><strong class="calibre9">6.35</strong> Here’s an interesting problem. As of this writing, in an application note on their website (<a href="http://www.zilog.com">www.zilog.com</a>), the skilled folks at Zilog Inc. describe a multistage digital bandpass filter used to detect the pitch (frequency) of a musical tone. A two-stage Direct Form II version, where each stage is a 2nd-order IIR filter, of this detection system is the cascaded bandpass filter shown in <a href="#calibre_link-946">Figure P6-35(a)</a>. The frequency magnitude responses of the first and second filters, over the positive frequency range, are provided in <a href="#calibre_link-946">Figure P6-35(b)</a>, and the combined (cascaded) frequency magnitude response is provided in <a href="#calibre_link-946">Figure P6-35(c)</a>.</p>
<p class="caption"><a id="calibre_link-946"></a><strong class="calibre9">Figure P6-35</strong></p>
<p class="image"><img src="images/001753.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Given that the sample rate of the signal is <em class="calibre7">f<sub class="calibre12">s</sub></em> = 8000 samples/second, what musical note will the <a href="#calibre_link-946">Figure P6-35(a)</a> two-stage bandpass filter detect? That is, what musical note is closest to the <em class="calibre7">f</em><sub class="calibre12">c</sub> center frequency of the two-stage <a id="calibre_link-2842"></a>filter’s passband in <a href="#calibre_link-946">Figure P6-35(c)</a>? Explain how you arrived at your answer. For your convenience, the frequencies of several musical notes of an equal-tempered scale are provided in the following table.</p>
<p class="caption"><a id="calibre_link-2843"></a><strong class="calibre9">Table P6-1</strong> Musical Note Frequencies</p>
<p class="image"><img src="images/000626.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><a id="calibre_link-2844"></a><strong class="calibre9">(b)</strong> Finally, are the two 2nd-order IIR filters stable? Explain how you arrived at your answer.</p>
<p class="indenthanging"><strong class="calibre9">6.36</strong> Consider the Direct Form II IIR filter shown in <a href="#calibre_link-947">Figure P6-36</a>, which requires three multiplies per filter output sample. Smart DSP engineers reduce computations wherever possible. Draw a block diagram of a filter equivalent to that in <a href="#calibre_link-947">Figure P6-36</a> that requires fewer than three multiplies per filter output sample.</p>
<p class="caption"><a id="calibre_link-947"></a><strong class="calibre9">Figure P6-36</strong></p>
<p class="image"><img src="images/000780.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">6.37</strong> In high-speed, hardware-only, linear-phase filtering, the transposed structure of a tapped-delay line FIR filter is often preferred over a traditional tapped-delay line FIR filter. That’s because the parallel structure of transposed FIR filters reduces the time required to perform multiple addition operations. Draw the transposed structure of the traditional FIR filter in <a href="#calibre_link-948">Figure P6-37</a>. In your solution, make sure the <em class="calibre7">x</em>(<em class="calibre7">n</em>) input is on the left-hand side.</p>
<p class="caption"><a id="calibre_link-948"></a><strong class="calibre9">Figure P6-37</strong></p>
<p class="image"><img src="images/001634.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">6.38</strong> Draw the transposed structures of the networks in <a href="#calibre_link-949">Figure P6-38</a>. In your solutions, make sure the <em class="calibre7">x</em>(<em class="calibre7">n</em>) inputs are on the left-hand side.</p>
<p class="caption"><a id="calibre_link-2845"></a><a id="calibre_link-949"></a><strong class="calibre9">Figure P6-38</strong></p>
<p class="image"><img src="images/000662.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">6.39</strong> In the text we discussed the problem of <em class="calibre7">limit cycles</em> in IIR filters when finite-precision values (finite binary word width) are used to represent data values. To reiterate that concept, the unit-sample impulse response of the 1st-order IIR filter in <a href="#calibre_link-950">Figure P6-39(a)</a> is shown in <a href="#calibre_link-950">Figure P6-39(c)</a>. That impulse <a id="calibre_link-2846"></a>response was computed using the very high precision of a 64-bit floating-point binary number system within the filter. In <a href="#calibre_link-950">Figure P6-39(c)</a> we see that this stable IIR filter’s <em class="calibre7">y</em>(<em class="calibre7">n</em>) impulse response properly decays toward zero amplitude as time advances.</p>
<p class="caption"><a id="calibre_link-950"></a><strong class="calibre9">Figure P6-39</strong></p>
<p class="image"><img src="images/001516.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">In fixed-point binary filter implementations, if rounding is used to limit the binary word width (the precision of data sample values) at the output of the filter’s adder, the ill effects of <em class="calibre7">limit cycles</em> may occur. This rounding operation is shown in <a href="#calibre_link-950">Figure P6-39(b)</a> where the <em class="calibre7">y</em>(<em class="calibre7">n</em>) output is rounded to a value that is a multiple of a rounding precision factor whose value is <em class="calibre7">q</em>. If rounding to the nearest <em class="calibre7">q</em> = 0.1 value is implemented, the filter’s impulse response exhibits unwanted limit cycles as shown in <a href="#calibre_link-950">Figure P6-39(d)</a>, where the <em class="calibre7">y</em>(<em class="calibre7">n</em>) impulse response continually oscillates between ±0.1 as time advances.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Reducing the value of the rounding precision factor <em class="calibre7">q</em> is supposed to help reduce the level of the unwanted limit cycle oscillations. Plot the unit-sample impulse response of the quantizing filter in <a href="#calibre_link-950">Figure P6-39(b)</a> when <em class="calibre7">q</em> = 0.05.</p>
<p class="indentpara1"><strong class="calibre9">Note:</strong> If an <em class="calibre7">A</em>(<em class="calibre7">n</em>) data value is exactly between two multiples of <em class="calibre7">q</em>, round away from zero.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Comparing <a href="#calibre_link-950">Figure P6-39(c)</a>, <a href="#calibre_link-950">Figure P6-39(d)</a>, and your solution from the above Part (a), make a statement regarding how the peak-to-peak amplitude of the quantizing filter’s limit cycle behavior is related to the value of the rounding precision factor <em class="calibre7">q</em>.</p>
<p class="indenthanging"><strong class="calibre9">6.40</strong> Given the <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">k</em>) and <em class="calibre7">h</em><sub class="calibre12">2</sub>(<em class="calibre7">k</em>) impulse responses of the two filters in <a href="#calibre_link-951">Figure P6-40</a>, what is the impulse response of the <em class="calibre7">h</em><sub class="calibre12">Cas</sub>(<em class="calibre7">k</em>) cascaded combination filter?</p>
<p class="caption"><a id="calibre_link-951"></a><strong class="calibre9">Figure P6-40</strong></p>
<p class="image"><img src="images/001596.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">6.41</strong> Here’s a problem whose solution may, someday, be useful to the reader. Many commercial digital filter design software packages require the user to specify a <em class="calibre7">desired</em> filter’s maximum passband ripple, in terms of a linear <em class="calibre7">peak deviation</em> parameter represented by <em class="calibre7">R</em>, for a lowpass filter magnitude response in <a href="#calibre_link-952">Figure P6-41</a>.</p>
<p class="caption"><a id="calibre_link-2847"></a><a id="calibre_link-952"></a><strong class="calibre9">Figure P6-41</strong></p>
<p class="image"><img src="images/000408.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Let’s say that in a lowpass filter design effort, we only know the desired passband ripple specified in terms of a peak-peak logarithmic (dB) parameter <em class="calibre7">P</em> shown in <a href="#calibre_link-952">Figure P6-41</a>. If <em class="calibre7">P</em> = 2 dB, what is <em class="calibre7">R</em>? Stated in different words, if we only have the <em class="calibre7">P</em> = 2 dB desired passband ripple value available to us, what <em class="calibre7">R</em> value must we specify in our filter design software? Show how you arrived at your solution.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Given your solution to the above Part (a), now derive a general equation that defines the linear <em class="calibre7">R</em> deviation parameter in terms of the logarithmic (dB) peak-peak passband ripple parameter <em class="calibre7">P</em>.</p>
<p class="indenthanging"><strong class="calibre9">6.42</strong> Many digital filters are implemented as both cascaded (series) and parallel combinations of subfilters. Given the four individual <em class="calibre7">H<sub class="calibre12">k</sub></em>(ω) subfilter frequency responses in <a href="#calibre_link-953">Figure P6-42</a>, what is the equation for the overall frequency response of this combination of subfilters in terms of <em class="calibre7">H</em><sub class="calibre12">1</sub>(ω), <em class="calibre7">H</em><sub class="calibre12">2</sub>(ω), <em class="calibre7">H</em><sub class="calibre12">3</sub>(ω), and <em class="calibre7">H</em><sub class="calibre12">4</sub>(ω)?</p>
<p class="caption"><a id="calibre_link-953"></a><strong class="calibre9">Figure P6-42</strong></p>
<p class="image"><img src="images/000448.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><a id="calibre_link-2848"></a><strong class="calibre9">6.43</strong> Many feedback systems can be reduced to the form of the <em class="calibre7">generic feedback</em> system shown in <a href="#calibre_link-954">Figure P6-43(a)</a>.</p>
<p class="caption"><a id="calibre_link-954"></a><strong class="calibre9">Figure P6-43</strong></p>
<p class="image"><img src="images/001302.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Prove that the <em class="calibre7">z</em>-domain transfer function of the feedback system in <a href="#calibre_link-954">Figure P6-43(a)</a> is the following expression:</p>
<p class="image"><img src="images/000147.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara1"><strong class="calibre9">Note:</strong> The above <em class="calibre7">H</em>(<em class="calibre7">z</em>) expression is well known, particularly in the field of digital control systems, because it is encountered so often in practice.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> If we replace the <em class="calibre7">z</em> variable in <em class="calibre7">H</em>(<em class="calibre7">z</em>) with <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup>, we obtain an <em class="calibre7">H</em>(ω) equation, describing the frequency response of the system in <a href="#calibre_link-954">Figure P6-43(a)</a>, whose generic form is</p>
<p class="image"><img src="images/001440.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara1">(Notice that we don’t use the <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup> term, for example <em class="calibre7">H</em>(<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup>), in our notation for a frequency response. We use the standard <em class="calibre7">H</em>(ω) notation instead.) With the above <em class="calibre7">H</em>(ω) equation in mind, what is the expression for the <em class="calibre7">H</em>(ω) frequency response of the system shown in <a href="#calibre_link-954">Figure P6-43(b)</a>?</p>
<p class="indentpara1"><strong class="calibre9">Hint:</strong> Use the principles of cascaded and parallel subsystems to obtain a simplified network structure.</p>
<p class="indenthanging"><strong class="calibre9">6.44</strong> In the text we discussed the analysis of digital filters comprising the parallel combination of two subfilters. Using a highpass filter whose impulse response is the <em class="calibre7">h</em><sub class="calibre12">High</sub>(<em class="calibre7">k</em>) samples in <a href="#calibre_link-955">Figure P6-44(a)</a>, we can implement a lowpass filter if we’re able to build a parallel network whose impulse response is the <em class="calibre7">h</em><sub class="calibre12">Par</sub>(<em class="calibre7">k</em>) samples in <a href="#calibre_link-955">Figure P6-44(b)</a>. The parallel network’s <em class="calibre7">h</em><sub class="calibre12">Par</sub>(<em class="calibre7">k</em>) samples are defined by</p>
<p class="image"><a id="calibre_link-2849"></a><img src="images/000035.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-955"></a><strong class="calibre9">Figure P6-44</strong></p>
<p class="image"><img src="images/000337.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> If the parallel lowpass filter network is that shown in <a href="#calibre_link-955">Figure P6-44(c)</a>, what is the impulse response of the <em class="calibre7">h</em>(<em class="calibre7">k</em>) subfilter?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Draw the parallel lowpass filter network showing what processing elements are in the <em class="calibre7">h</em>(<em class="calibre7">k</em>) subfilter block.</p>
<p class="indenthanging"><strong class="calibre9">6.45</strong> Assume we are given the lowpass filter shown in <a href="#calibre_link-956">Figure P6-45</a> and, based on the IIR discussion in the text’s <a href="#calibre_link-625">Section 6.9</a>, we must <em class="calibre7">scale</em> the filter to reduce its passband gain without changing its frequency response shape. Draw a block diagram of the scaled filter.</p>
<p class="caption"><a id="calibre_link-2850"></a><a id="calibre_link-956"></a><strong class="calibre9">Figure P6-45</strong></p>
<p class="image"><img src="images/001183.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">6.46</strong> You’re working on a project to upgrade an analog temperature-sensing and processing system. Your job is to design a digital integrator, to replace an analog integrator whose Laplace <em class="calibre7">s</em>-domain transfer function is</p>
<p class="image"><img src="images/000880.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">that will receive a new temperature sample once every 2 seconds. Because ideal integrators have a frequency magnitude response of zero at high frequencies, your digital integrator must have a frequency magnitude response less than 0.01 at <em class="calibre7">f<sub class="calibre12">s</sub></em>/2.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the <em class="calibre7">z</em>-domain transfer function of a digital integrator replacement for <em class="calibre7">H</em>(<em class="calibre7">s</em>) designed using the impulse invariance Method 2 design technique?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What is the <em class="calibre7">z</em>-domain transfer function of a digital integrator designed using the bilinear transform design technique?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Verify that each of your digital integrators has a <em class="calibre7">z</em>-plane pole at the same frequency at which the <em class="calibre7">H</em>(<em class="calibre7">s</em>) analog integrator had an <em class="calibre7">s</em>-plane pole.</p>
<p class="indenthangingn"><strong class="calibre9">(d)</strong> Which of the two digital integrators, from Part (a) and Part (b), will you submit as your final design, and why?</p>
<p class="indenthanging"><strong class="calibre9">6.47</strong> Due to its simplicity, the 1st-order analog lowpass filter shown in <a href="#calibre_link-957">Figure P6-47(a)</a> is often used to attenuate high-frequency noise in a <em class="calibre7">v</em><sub class="calibre12">in</sub>(<em class="calibre7">t</em>) input signal voltage. This lowpass filter’s <em class="calibre7">s</em>-domain transfer function is</p>
<p class="image"><img src="images/001737.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-957"></a><strong class="calibre9">Figure P6-47</strong></p>
<p class="image"><img src="images/001324.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Determine a digital filter’s <em class="calibre7">H</em><sub class="calibre12">ii</sub>(<em class="calibre7">z</em>) <em class="calibre7">z</em>-domain transfer function that simulates <em class="calibre7">H</em>(<em class="calibre7">s</em>), using the impulse invariance Method 2 process. Draw the digital <a id="calibre_link-2851"></a>filter’s Direct Form II block diagram (structure) where the coefficients are in terms of <em class="calibre7">R</em> and <em class="calibre7">C</em>. For simplicity, assume that <em class="calibre7">t<sub class="calibre12">s</sub></em> = 1.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Determine a digital filter’s <em class="calibre7">H</em><sub class="calibre12">bt</sub>(<em class="calibre7">z</em>) <em class="calibre7">z</em>-domain transfer function that simulates <em class="calibre7">H</em>(<em class="calibre7">s</em>), using the bilinear transform process. Draw the digital filter’s Direct Form II block diagram where the coefficients are in terms of <em class="calibre7">R</em> and <em class="calibre7">C</em>. Again, assume that <em class="calibre7">t<sub class="calibre12">s</sub></em> = 1.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> When properly designed, the filters’ normalized frequency magnitude responses, |<em class="calibre7">H</em><sub class="calibre12">ii</sub>| and |<em class="calibre7">H</em><sub class="calibre12">bt</sub>|, are those shown in <a href="#calibre_link-957">Figure P6-47(b)</a> (plotted on a logarithmic vertical scale). Why does the |<em class="calibre7">H</em><sub class="calibre12">bt</sub>| response have such large attenuation at high frequencies?</p>
<p class="indenthanging"><strong class="calibre9">6.48</strong> A 1st-order analog highpass filter’s <em class="calibre7">s</em>-domain transfer function is</p>
<p class="image"><img src="images/000764.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">Determine a digital filter’s <em class="calibre7">H</em>(<em class="calibre7">z</em>) <em class="calibre7">z</em>-domain transfer function that simulates <em class="calibre7">H</em>(<em class="calibre7">s</em>) using the bilinear transform process. Given that frequency ω<sub class="calibre12">o</sub> = 62.832 radians/second, assume that the digital filter’s sample rate is <em class="calibre7">f<sub class="calibre12">s</sub></em> = 100 Hz. Manipulate your final <em class="calibre7">H</em>(<em class="calibre7">z</em>) expression so that it is in the following form:</p>
<p class="image"><img src="images/000950.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara"><a id="calibre_link-2852"></a>where <em class="calibre7">A</em>, <em class="calibre7">B</em>, and <em class="calibre7">C</em> are constants. The above <em class="calibre7">H</em>(<em class="calibre7">z</em>) form enables convenient modeling of the digital filter’s transfer function using commercial signal processing software.</p>
<p class="indenthanging"><strong class="calibre9">6.49</strong> Let’s plow through the algebra to design a 2nd-order digital IIR filter that approximates an analog lowpass filter. Assume the filter’s <em class="calibre7">s</em>-domain transfer function is</p>
<p class="image"><img src="images/000642.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">and the digital filter’s sample rate is 1000 samples/second. Derive, using the bilinear transform, the <em class="calibre7">z</em>-domain transfer function equation of the discrete filter that simulates the above <em class="calibre7">H</em>(<em class="calibre7">s</em>) continuous lowpass filter.</p>
<p class="indenthanging"><strong class="calibre9">6.50</strong> Let’s say that your colleague has designed a prototype analog lowpass filter whose <em class="calibre7">cutoff</em> frequency is 3.8 kHz. (By “cutoff frequency” we mean the frequency where the lowpass filter’s magnitude response is 3 dB below its average passband magnitude response.) Next, assume your colleague wants you to use the bilinear transform method to design a digital filter whose performance is equivalent to that of the analog filter when the sample rate is <em class="calibre7">f<sub class="calibre12">s</sub></em> = 11 kHz.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Given that the analog lowpass filter’s <em class="calibre7">f<sub class="calibre12">a</sub></em> cutoff frequency is 3.8 kHz, what will be the <em class="calibre7">f<sub class="calibre12">d</sub></em> cutoff frequency of the digital lowpass filter in Hz?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Given that we want the digital lowpass filter’s cutoff frequency to be <em class="calibre7">exactly</em> 3.8 kHz, the prototype analog filter will have to be redesigned. What should be the <em class="calibre7">f<sub class="calibre12">a</sub></em> cutoff frequency of the new analog lowpass filter?</p>
</div>


</body></html>
