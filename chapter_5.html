<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><title>Understanding Digital Signal Processing</title>
<style type="text/css">
body {
  -webkit-text-size-adjust: 260%; /* text */
  zoom: 1.7; /* graphics */
  font-family: "BookerlyLCD";
}
a {
  color: #005090;
  text-decoration: none;
}
a {font-variant-numeric: oldstyle-nums proportional-nums;}
p.caption {font-variant-numeric: oldstyle-nums proportional-nums;}
</style>
</head><body>


<div class="calibre" id="calibre_link-572">
<p class="calibre3"><a id="calibre_link-2482"></a></p>
<h2 class="calibre8"><a id="calibre_link-2483" class="calibre5"></a>Contents</h2>
<p class="toc-chapter"><strong class="calibre9"><a href="#calibre_link-607">5 FINITE IMPULSE RESPONSE FILTERS</a></strong></p>
<p class="toc-section"><a href="#calibre_link-608">5.1 An Introduction to Finite Impulse Response (FIR) Filters</a></p>
<p class="toc-section"><a href="#calibre_link-609">5.2 Convolution in FIR Filters</a></p>
<p class="toc-section"><a href="#calibre_link-610">5.3 Lowpass FIR Filter Design</a></p>
<p class="toc-section"><a href="#calibre_link-611">5.4 Bandpass FIR Filter Design</a></p>
<p class="toc-section"><a href="#calibre_link-612">5.5 Highpass FIR Filter Design</a></p>
<p class="toc-section"><a href="#calibre_link-613">5.6 Parks-McClellan Exchange FIR Filter Design Method</a></p>
<p class="toc-section"><a href="#calibre_link-182">5.7 Half-band FIR Filters</a></p>
<p class="toc-section"><a href="#calibre_link-370">5.8 Phase Response of FIR Filters</a></p>
<p class="toc-section"><a href="#calibre_link-614">5.9 A Generic Description of Discrete Convolution</a></p>
<p class="toc-section"><a id="calibre_link-2485"></a><a href="#calibre_link-615">5.10 Analyzing FIR Filters</a></p>
<p class="toc-section1"><a href="#calibre_link-616">References</a></p>

</div>


<div class="calibre" id="calibre_link-607">
<p class="calibre3"><a id="calibre_link-79"></a></p>
<h2 class="calibre8"><a id="calibre_link-1975" class="calibre5"></a>5 Finite Impulse Response Filters</h2>
<p class="image"><img src="images/000741.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The filtering of digitized data, if not the most fundamental, is certainly the oldest discipline in the field of digital signal processing. Digital filtering’s origins go back 50 years. The growing availability of digital computers in the early 1950s led to efforts in the smoothing of discrete sampled data and the analysis of discrete data control systems. However, it wasn’t until the early to mid-1960s, around the time the Beatles came to America, that the analysis and development of digital equivalents of analog filters began in earnest. That’s when digital signal processing experts realized that computers could go beyond the mere analysis of digitized signals into the domain of actually changing signal characteristics through filtering. Today, digital filtering is so widespread that the quantity of literature pertaining to it exceeds that of any other topic in digital signal processing. In this chapter, we introduce the fundamental attributes of digital filters, learn how to quantify their performance, and review the principles associated with the design of finite impulse response digital filters.</p>
<p class="calibre3">So let’s get started by illustrating the concept of filtering a time-domain signal as shown in <a href="#calibre_link-1047">Figure 5-1</a>.</p>
<p class="caption"><a id="calibre_link-1047"></a><strong class="calibre9">Figure 5-1</strong> Filters: (a) an analog filter with a noisy tone input and a reduced-noise tone output; (b) the digital equivalent of the analog filter.</p>
<p class="image"><img src="images/000953.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">In general, filtering is the processing of a time-domain signal resulting in some change in that signal’s original spectral content. The change is usually the reduction, or filtering out, of some unwanted input spectral components; that is, filters allow certain frequencies to pass while attenuating other frequencies. <a href="#calibre_link-1047">Figure 5-1</a> shows both analog and digital versions of a filtering process. Where an analog filter operates on a continuous signal, a digital filter processes a sequence of discrete sample values. The digital filter in <a href="#calibre_link-1047">Figure 5-1(b)</a>, of course, can be a software program in a computer, a programmable hardware processor, or a dedicated integrated circuit. Traditional linear digital <a id="calibre_link-2431"></a>filters typically come in two flavors: <em class="calibre7"><a href="#calibre_link-1048">finite impulse response</a></em> (FIR) filters and <em class="calibre7"><a href="#calibre_link-741">infinite impulse response</a></em> (IIR) filters. Because FIR filters are the simplest type of digital filter to analyze, we’ll examine them in this chapter and cover IIR filters in <a href="#calibre_link-289">Chapter 6</a>.</p>
<p class="calibre3"><a id="calibre_link-608"></a></p>
<h3 class="calibre6">5.1 An Introduction to Finite Impulse Response (FIR) Filters</h3>
<p class="calibre3">Given a finite duration of nonzero input values, an FIR filter will always have a finite duration of nonzero output values, and that’s how FIR filters got their name. So, if the FIR filter’s input suddenly becomes a sequence of all zeros, the filter’s output will eventually be all zeros. While not sounding all that unusual, this characteristic is, however, very important, and we’ll soon find out why, as we learn more about digital filters.</p>
<p class="calibre3">FIR filters use addition to calculate their outputs in a manner much the same as the process of averaging uses addition. In fact, averaging is a kind of FIR filter that we can illustrate with an example. Let’s say we’re counting the number of cars that pass over a bridge every minute, and we need to know the average number of cars per minute over five-minute intervals; that is, every minute we’ll calculate the average number of cars/minute over the last five minutes. If the results of our car counting for the first ten minutes are those values shown in the center column of <a href="#calibre_link-1049">Table 5-1</a>, then the average number of cars/minute over the previous five one-minute intervals is listed in the right column of the table. We’ve added the number of cars for the first five <a id="calibre_link-2663"></a>one-minute intervals and divided by 5 to get our first five-minute average output value, (10+22+24+42+37)/5 = 27. Next we’ve averaged the number of cars/minute for the second to the sixth one-minute intervals to get our second five-minute average output of 40.4. Continuing, we average the number of cars/minute for the third to the seventh one-minute intervals to get our third average output of 53.8, and so on. With the number of cars/minute for the one-minute intervals represented by the dashed line in <a href="#calibre_link-1050">Figure 5-2</a>, we show our five-minute average output as the solid line. (<a href="#calibre_link-1050">Figure 5-2</a> shows cars/minute input values beyond the first ten minutes listed in <a href="#calibre_link-1049">Table 5-1</a> to illustrate a couple of important ideas to be discussed shortly.)</p>
<p class="caption"><a id="calibre_link-1049"></a><strong class="calibre9">Table 5-1</strong> Values for the Averaging Example</p>
<p class="image"><img src="images/000866.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1050"></a><strong class="calibre9">Figure 5-2</strong> Averaging the number of cars/minute. The dashed line shows the individual cars/minute, and the solid line is the number of cars/minute averaged over the last five minutes.</p>
<p class="image"><img src="images/000005.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">There’s much to learn from this simple averaging example. In <a href="#calibre_link-1050">Figure 5-2</a>, notice that the sudden changes in our input sequence of cars/minute are flattened out by our averager. The averager output sequence is considerably smoother than the input sequence. Knowing that sudden transitions in a time sequence represent high-frequency components, we can say that our averager is behaving like a lowpass filter and smoothing sudden changes in the input. Is our averager an FIR filter? It sure is&mdash;no previous averager output value is used to determine a current output value; only input values are used to calculate output values. In addition, we see that, if the bridge were suddenly closed at the end of the 19th minute, the dashed line immediately goes to zero cars/minute at the end of the 20th minute, and the averager’s output in <a id="calibre_link-2033"></a><a href="#calibre_link-1050">Figure 5-2</a> approaches and settles to a value of zero by the end of the 24th minute.</p>
<p class="calibre3"><a href="#calibre_link-1050">Figure 5-2</a> shows the first averager output sample occurring at the end of the 5th minute because that’s when we first have five input samples to calculate a valid average. The 5th output of our averager can be denoted as <em class="calibre7">y</em><sub class="calibre12">ave</sub>(5) where</p>
<p class="caption"><a id="calibre_link-1054"></a>(5-1)</p>
<p class="image"><img src="images/000124.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">In the general case, if the <em class="calibre7">k</em>th input sample is <em class="calibre7">x</em>(<em class="calibre7">k</em>), then the <em class="calibre7">n</em>th output is</p>
<p class="caption"><a id="calibre_link-1051"></a>(5-2)</p>
<p class="image"><img src="images/000962.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Look at <a href="#calibre_link-1051">Eq. (5-2)</a> carefully now. It states that the <em class="calibre7">n</em>th output is the average of the <em class="calibre7">n</em>th input sample and the four previous input samples.</p>
<p class="calibre3">We can formalize the digital filter nature of our averager by creating the block diagram in <a href="#calibre_link-1052">Figure 5-3</a> showing how the averager calculates its output samples.</p>
<p class="caption"><a id="calibre_link-1052"></a><strong class="calibre9">Figure 5-3</strong> Averaging filter block diagram when the fifth input sample value, 37, is applied.</p>
<p class="image"><img src="images/000844.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">This block diagram, referred to as the filter <em class="calibre7"><a href="#calibre_link-1053">structure</a></em>, is a physical depiction of how we might calculate our averaging filter outputs with the input sequence of values shifted, in order, from left to right along the top of the filter as new output calculations are performed. This structure, implementing <a href="#calibre_link-1054">Eqs. (5-1)</a> and <a href="#calibre_link-1051">(5-2)</a>, shows those values used when the first five input sample values are available. The delay elements in <a href="#calibre_link-1052">Figure 5-3</a>, called <em class="calibre7">unit delays</em>, <a id="calibre_link-2216"></a>merely indicate a shift register arrangement where input sample values are temporarily stored during an output calculation.</p>
<p class="calibre3">In averaging, we add five numbers and divide the sum by 5 to get our answer. In a conventional FIR filter implementation, we can just as well multiply each of the five input samples by the coefficient 1/5 and then perform the summation as shown in <a href="#calibre_link-1055">Figure 5-4(a)</a>. Of course, the two methods in <a href="#calibre_link-1052">Figures 5-3</a> and <a href="#calibre_link-1055">5-4(a)</a> are equivalent because <a href="#calibre_link-1051">Eq. (5-2)</a> describing the structure shown in <a href="#calibre_link-1052">Figure 5-3</a> is equivalent to</p>
<p class="caption"><a id="calibre_link-1058"></a>(5-3)</p>
<p class="image"><img src="images/000539.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1055"></a><strong class="calibre9">Figure 5-4</strong> Alternate averaging filter structure: (a) input values used for the fifth output value; (b) input values used for the sixth output value; (c) input values used for the seventh output value.</p>
<p class="image"><img src="images/001705.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">which describes the structure in <a href="#calibre_link-1055">Figure 5-4(a)</a>.<sup class="calibre10"><a id="calibre_link-1057"></a><a href="#calibre_link-1056">†</a></sup></p>
<p class="footnotes"><a id="calibre_link-1056"></a><sup class="calibre11"><a href="#calibre_link-1057">†</a></sup> We’ve used the venerable distributive law for multiplication and addition of scalars, <em class="calibre7">a</em>(<em class="calibre7">b</em>+<em class="calibre7">c</em>+<em class="calibre7">d</em>) = <em class="calibre7">ab</em>+<em class="calibre7">ac</em>+<em class="calibre7">ad</em>, in moving <a href="#calibre_link-1051">Eq. (5-2)</a>’s factor of 1/5 inside the summation in <a href="#calibre_link-1058">Eq. (5-3)</a>.</p>
<p class="calibre3">Let’s make sure we understand what’s happening in <a href="#calibre_link-1055">Figure 5-4(a)</a>. Each of the first five input values is multiplied by 1/5, and the five products are summed to give the fifth filter output value. The left-to-right sample shifting is illustrated in <a href="#calibre_link-1055">Figures 5-4(b)</a> and <a href="#calibre_link-1055">5-4(c)</a>. To calculate the filter’s sixth output value, the input sequence is right-shifted, discarding the first input value of 10, and the sixth input value, 77, is accepted on the left. Likewise, to calculate the filter’s seventh output value, the input sequence is right-shifted, discarding the second value of 22, and the seventh input value, 89, arrives on the left. So, when a new input sample value is applied, the filter discards the oldest sample value, multiplies the samples by the coefficients of 1/5, and sums the products to get a single new output value. The filter’s structure using this bucket brigade shifting process is often called a <em class="calibre7"><a href="#calibre_link-1059">transversal filter</a></em> due to the <a id="calibre_link-2281"></a>cross-directional flow of the input samples. Because we <em class="calibre7">tap off</em> five separate input sample values to calculate an output value, the structure in <a href="#calibre_link-1055">Figure 5-4</a> is called a 5-tap tapped-delay line FIR filter, in digital filter vernacular.</p>
<p class="calibre3">One important and, perhaps, most interesting aspect of understanding FIR filters is learning how to predict their behavior when sinusoidal samples of various frequencies are applied to the input, i.e., how to estimate their frequency-domain response. Two factors affect an FIR filter’s frequency response: the number of taps and the specific values used for the multiplication coefficients. We’ll explore these two factors using our averaging example and, then, see how we can use them to design FIR filters. This brings us to the point where we have to introduce the C word: <em class="calibre7">convolution.</em> (Actually, we already slipped a convolution equation in on the reader without saying so. It was <a href="#calibre_link-1058">Eq. (5-3)</a>, and we’ll examine it in more detail later.)</p>
<p class="calibre3"><a id="calibre_link-609"></a></p>
<h3 class="calibre6"><a id="calibre_link-2240" class="calibre5"></a>5.2 Convolution in FIR Filters</h3>
<p class="calibre3">OK, here’s where we get serious about understanding the mathematics behind FIR filters. We can graphically depict <a href="#calibre_link-1058">Eq. (5-3)</a>’s and <a href="#calibre_link-1055">Figure 5-4</a>’s calculations as shown in <a href="#calibre_link-1060">Figure 5-5</a>. Also, let’s be formal and use the standard notation of digital filters for indexing the input samples and the filter coefficients by <a id="calibre_link-2241"></a>starting with an initial index value of zero; that is, we’ll call the initial input value the 0th sample <em class="calibre7">x</em>(0). The next input sample is represented by the term <em class="calibre7">x</em>(1), the following input sample is called <em class="calibre7">x</em>(2), and so on. Likewise, our five coefficient values will be indexed from zero to four, <em class="calibre7">h</em>(0) through <em class="calibre7">h</em>(4). (This indexing scheme makes the equations describing our example consistent with conventional filter notation found in the literature.)</p>
<p class="caption"><a id="calibre_link-1060"></a><strong class="calibre9">Figure 5-5</strong> Averaging filter convolution: (a) first five input samples aligned with the stationary filter coefficients, index <em class="calibre7">n</em> = 4; (b) input samples shift to the right and index <em class="calibre7">n</em> = 5; (c) index <em class="calibre7">n</em> = 6; (d) index <em class="calibre7">n</em> = 7; (e) index <em class="calibre7">n</em> = 8.</p>
<p class="image"><img src="images/000723.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">In <a href="#calibre_link-1058">Eq. (5-3)</a> we used the factor of 1/5 as the filter coefficients multiplied by our averaging filter’s input samples. The left side of <a href="#calibre_link-1060">Figure 5-5</a> shows the alignment of those coefficients, black squares, with the filter input sample values represented by the white squares. Notice in <a href="#calibre_link-1060">Figures 5-5(a)</a> through <a href="#calibre_link-1060">5-5(e)</a> that we’re marching the input samples to the right, and, at each step, we calculate the filter output sample value using <a href="#calibre_link-1058">Eq. (5-3)</a>. The output samples on the right side of <a href="#calibre_link-1060">Figure 5-5</a> match the first five values represented by the black squares in <a href="#calibre_link-1050">Figure 5-2</a>. The input samples in <a href="#calibre_link-1060">Figure 5-5</a> are those values represented by the white squares in <a href="#calibre_link-1050">Figure 5-2</a>. Notice that the time order of the inputs in <a href="#calibre_link-1060">Figure 5-5</a> has been reversed from the input sequence order in <a href="#calibre_link-1050">Figure 5-2</a>! That is, the input sequence has been flipped in the time domain in <a href="#calibre_link-1060">Figure 5-5</a>. This time order reversal is what happens to the input data using the filter structure in <a href="#calibre_link-1055">Figure 5-4</a>.</p>
<p class="calibre3">Repeating the first part of <a href="#calibre_link-1058">Eq. (5-3)</a> and omitting the subscript on the output term, our original FIR filter’s <em class="calibre7">y</em>(<em class="calibre7">n</em>)th output is given by</p>
<p class="caption"><a id="calibre_link-1061"></a>(5-4)</p>
<p class="image"><img src="images/001167.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Because we’ll explore filters whose coefficients are not all the same value, we need to represent the individual filter coefficients by a variable, such as the term <em class="calibre7">h</em>(<em class="calibre7">k</em>), for example. Thus we can rewrite the averaging filter’s output from <a href="#calibre_link-1061">Eq. (5-4)</a> in a more general way as</p>
<p class="caption"><a id="calibre_link-1062"></a>(5-5)</p>
<p class="image"><img src="images/000893.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">h</em>(0) through <em class="calibre7">h</em>(4) all equal 1/5. <a href="#calibre_link-1062">Equation (5-5)</a> is a concise way of describing the filter structure in <a href="#calibre_link-1055">Figure 5-4</a> and the process illustrated in <a href="#calibre_link-1060">Figure 5-5</a>.</p>
<p class="calibre3">Let’s take <a href="#calibre_link-1062">Eq. (5-5)</a> one step further and say, for a general <em class="calibre7">M</em>-tap FIR filter, the <em class="calibre7">n</em>th output is</p>
<p class="caption"><a id="calibre_link-1063"></a>(5-6)</p>
<p class="image"><img src="images/000891.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2228"></a>Well, there it is. <a href="#calibre_link-1063">Eq. (5-6)</a> is the infamous convolution equation as it applies to digital FIR filters. Beginners in the field of digital signal processing often have trouble understanding the concept of convolution. It need not be that way. <a href="#calibre_link-1063">Eq. (5-6)</a> is merely a series of multiplications followed by the addition of the products. The process is actually rather simple. We just flip the time order of an input sample sequence and start stepping the flipped sequence across the filter’s coefficients as shown in <a href="#calibre_link-1060">Figure 5-5</a>. For each new filter input sample, we sum a series of products to compute a single filter output value.</p>
<p class="calibre3">Let’s pause for a moment and introduce a new term that’s important to keep in mind, the <em class="calibre7"><a href="#calibre_link-1064">impulse response</a></em>. The impulse response of a filter is exactly what its name implies&mdash;it’s the filter’s output time-domain sequence when the input is a single unity-valued sample (impulse) preceded and followed by zero-valued samples. <a href="#calibre_link-1065">Figure 5-6</a> illustrates this idea in the same way we determined the filter’s output sequence in <a href="#calibre_link-1060">Figure 5-5</a>. The left side of <a href="#calibre_link-1065">Figure 5-6</a> shows the <a id="calibre_link-2233"></a>alignment of the filter coefficients, black squares, with the filter input impulse sample values represented by the white squares. Again, in <a href="#calibre_link-1065">Figures 5-6(a)</a> through <a href="#calibre_link-1065">5-6(e)</a> we’re shifting the input samples to the right, and, at each step, we calculate the filter output sample value using <a href="#calibre_link-1061">Eq. (5-4)</a>. The output samples on the right side of <a href="#calibre_link-1065">Figure 5-6</a> are the filter’s impulse response. Notice the key point here: the FIR filter’s impulse response is identical to the five filter coefficient values. For this reason, the terms <em class="calibre7">FIR filter coefficients</em> and <em class="calibre7"><a href="#calibre_link-1064">impulse response</a></em> are synonymous. Thus, when someone refers to the impulse response of an FIR filter, they’re also talking about the coefficients. Because there are a finite number of coefficients, the impulse response will be finite in time duration (finite impulse response, FIR).</p>
<p class="caption"><a id="calibre_link-1065"></a><strong class="calibre9">Figure 5-6</strong> Convolution of filter coefficients and an input impulse to obtain the filter’s output impulse response: (a) impulse sample aligned with the first filter coefficient, index <em class="calibre7">n</em> = 4; (b) impulse sample shifts to the right and index <em class="calibre7">n</em> = 5; (c) index <em class="calibre7">n</em> = 6; (d) index <em class="calibre7">n</em> = 7; (e) index <em class="calibre7">n</em> = 8.</p>
<p class="image"><img src="images/001579.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Returning to our averaging filter, recall that coefficients (or impulse response) <em class="calibre7">h</em>(0) through <em class="calibre7">h</em>(4) were all equal to 1/5. As it turns out, our filter’s performance can be improved by using coefficients whose values are not all the same. By “performance” we mean how well the filter passes desired signals and attenuates unwanted signals. We judge that performance by determining the shape of the filter’s frequency-domain response that we obtain by the convolution property of linear systems. To describe this concept, let’s repeat <a href="#calibre_link-1063">Eq. (5-6)</a> using the abbreviated notation of</p>
<p class="caption"><a id="calibre_link-1066"></a>(5-7)</p>
<p class="image"><img src="images/000400.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where the * symbol means convolution. (<a href="#calibre_link-1066">Equation 5-7</a> is read as “<em class="calibre7">y</em> of <em class="calibre7">n</em> equals the convolution of <em class="calibre7">h</em> of <em class="calibre7">k</em> and <em class="calibre7">x</em> of <em class="calibre7">n</em>.”) The process of convolution, as it applies to FIR filters, is as follows: the discrete Fourier transform (DFT) of the convolution of a filter’s impulse response (coefficients) and an input sequence is equal to the product of the spectrum of the input sequence and the DFT of the impulse response. The idea we’re trying to convey here is that if two time-domain sequences <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">n</em>) have DFTs of <em class="calibre7">H</em>(<em class="calibre7">m</em>) and <em class="calibre7">X</em>(<em class="calibre7">m</em>), respectively, then the DFT of <em class="calibre7">y</em>(<em class="calibre7">n</em>) = <em class="calibre7">h</em>(<em class="calibre7">k</em>) <sub class="calibre12">*</sub> <em class="calibre7">x</em>(<em class="calibre7">n</em>) is <em class="calibre7">H</em>(<em class="calibre7">m</em>) · <em class="calibre7">X</em>(<em class="calibre7">m</em>). Making this point in a more compact way, we state this relationship with the expression</p>
<p class="caption"><a id="calibre_link-1067"></a>(5-8)</p>
<p class="image"><img src="images/000617.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">With IDFT indicating the inverse DFT, <a href="#calibre_link-1067">Eq. (5-8)</a> indicates that two sequences resulting from <em class="calibre7">h</em>(<em class="calibre7">k</em>)<sub class="calibre12">*</sub><em class="calibre7">x</em>(<em class="calibre7">n</em>) and <em class="calibre7">H</em>(<em class="calibre7">m</em>)·<em class="calibre7">X</em>(<em class="calibre7">m</em>) are Fourier transform pairs. So taking the DFT of <em class="calibre7">h</em>(<em class="calibre7">k</em>)<sub class="calibre12">*</sub><em class="calibre7">x</em>(<em class="calibre7">n</em>) gives us the product <em class="calibre7">H</em>(<em class="calibre7">m</em>)·<em class="calibre7">X</em>(<em class="calibre7">m</em>) that is the spectrum of our filter output <em class="calibre7">Y</em>(<em class="calibre7">m</em>). Likewise, we can determine <em class="calibre7">h</em>(<em class="calibre7">k</em>)<sub class="calibre12">*</sub><em class="calibre7">x</em>(<em class="calibre7">n</em>) by taking the inverse DFT of <em class="calibre7">H</em>(<em class="calibre7">m</em>)·<em class="calibre7">X</em>(<em class="calibre7">m</em>). The very important conclusion to learn from <a href="#calibre_link-1067">Eq. (5-8)</a> is that convolution in the time domain is equivalent to multiplication in the frequency domain. To help us appreciate this principle, <a href="#calibre_link-1068">Figure 5-7</a> sketches the relationship between convolution in the time domain and multiplication in the frequency domain. The process of convolution with regard to linear systems is discussed in more detail in <a href="#calibre_link-614">Section 5.9</a>. The beginner is encouraged <a id="calibre_link-2224"></a>to review that material to get a general idea of why and when the convolution process can be used to analyze digital filters.</p>
<p class="caption"><a id="calibre_link-1068"></a><strong class="calibre9">Figure 5-7</strong> Relationships of convolution as applied to FIR digital filters.</p>
<p class="image"><img src="images/000607.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1067">Equation (5-8)</a> and the relationships in <a href="#calibre_link-1068">Figure 5-7</a> tell us what we need to do to determine the frequency response of an FIR filter. The product <em class="calibre7">X</em>(<em class="calibre7">m</em>)·<em class="calibre7">H</em>(<em class="calibre7">m</em>) is the DFT of the filter output. Because <em class="calibre7">X</em>(<em class="calibre7">m</em>) is the DFT of the filter’s input sequence, the frequency response of the filter is then defined as <em class="calibre7">H</em>(<em class="calibre7">m</em>), the DFT of the filter’s impulse response <em class="calibre7">h</em>(<em class="calibre7">k</em>).<sup class="calibre10"><a id="calibre_link-1072"></a><a href="#calibre_link-1069">†</a></sup> Getting back to our original problem, we can determine our averaging filter’s frequency-domain response by taking the DFT of the individual filter coefficients (impulse response) in <a href="#calibre_link-1061">Eq. (5-4)</a>. If we take the five <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficient values of 1/5 and append 59 zeros, we have the sequence depicted in <a href="#calibre_link-1070">Figure 5-8(a)</a>. Performing a 64-point DFT on that sequence, and normalizing the DFT magnitudes, gives us the filter’s frequency magnitude response |<em class="calibre7">H</em>(<em class="calibre7">m</em>)| in <a href="#calibre_link-1070">Figure 5-8(b)</a> and phase response shown in <a href="#calibre_link-1070">Figure 5-8(c)</a>.<sup class="calibre10"><a id="calibre_link-1074"></a><a href="#calibre_link-1071">††</a></sup> <em class="calibre7">H</em>(<em class="calibre7">m</em>) is our old friend, the sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> function from <a href="#calibre_link-597">Section 3.13</a>.</p>
<p class="footnotes"><a id="calibre_link-1069"></a><sup class="calibre11"><a href="#calibre_link-1072">†</a></sup> We use the term <em class="calibre7"><a href="#calibre_link-1064">impulse response</a></em> here, instead of <em class="calibre7"><a href="#calibre_link-1073">coefficients</a></em>, because this concept also applies to IIR filters. IIR filter frequency responses are also equal to the DFT of their impulse responses.</p>
<p class="footnotes"><a id="calibre_link-1071"></a><sup class="calibre11"><a href="#calibre_link-1074">††</a></sup> There’s nothing sacred about using a 64-point DFT here. We could just as well have appended only enough zeros to take a 16- or 32-point FFT. We chose 64 points to get a frequency resolution that would make the shape of the response in <a href="#calibre_link-1070">Figure 5-8(b)</a> reasonably smooth. Remember, the more points in the FFT, the finer the frequency granularity&mdash;right?</p>
<p class="caption"><a id="calibre_link-2234"></a><a id="calibre_link-1070"></a><strong class="calibre9">Figure 5-8</strong> Averaging FIR filter: (a) filter coefficient sequence <em class="calibre7">h</em>(<em class="calibre7">k</em>) with appended zeros; (b) normalized discrete frequency magnitude response |<em class="calibre7">H</em>(<em class="calibre7">m</em>)| of the <em class="calibre7">h</em>(<em class="calibre7">k</em>) filter coefficients; (c) phase-angle response of <em class="calibre7">H</em>(<em class="calibre7">m</em>) in degrees.</p>
<p class="image"><img src="images/001465.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Let’s relate the discrete frequency response samples in <a href="#calibre_link-1070">Figures 5-8(b)</a> and <a href="#calibre_link-1070">5-8(c)</a> to the physical dimension of the sample frequency <em class="calibre7">f<sub class="calibre12">s</sub></em>. We know, from <a href="#calibre_link-592">Section 3.5</a> and our experience with the DFT, that the <em class="calibre7">m</em> = <em class="calibre7">N</em>/2 discrete frequency sample, <em class="calibre7">m</em> = 32 in this case, is equal to the folding frequency, or half the sample rate, <em class="calibre7">f<sub class="calibre12">s</sub></em>/2. Keeping this in mind, we can convert the discrete frequency axis in <a href="#calibre_link-1070">Figure 5-8</a> to that shown in <a href="#calibre_link-1075">Figure 5-9</a>. In <a href="#calibre_link-1075">Figure 5-9(a)</a>, notice that the filter’s magnitude response is, of course, periodic in the frequency domain with a period of the equivalent sample rate <em class="calibre7">f<sub class="calibre12">s</sub></em>. Because we’re primarily interested in the filter’s response between 0 and half the sample rate, <a href="#calibre_link-1075">Figure 5-9(c)</a> shows that frequency band in greater detail, affirming the notion that averaging behaves like a lowpass filter. It’s a relatively poor lowpass filter compared to an arbitrary, <em class="calibre7">ideal</em> lowpass filter indicated by the dashed lines in <a href="#calibre_link-1075">Figure 5-9(c)</a>, but our averaging filter will attenuate higher-frequency inputs relative to its response to low-frequency input signals.</p>
<p class="caption"><a id="calibre_link-1075"></a><strong class="calibre9">Figure 5-9</strong> Averaging FIR filter frequency response shown as continuous curves: (a) normalized frequency magnitude response, |<em class="calibre7">H</em>(<em class="calibre7">m</em>)|; (b) phase-angle response of <em class="calibre7">H</em>(<em class="calibre7">m</em>) in degrees; (c) the filter’s magnitude response between zero Hz and half the sample rate, <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz.</p>
<p class="image"><img src="images/000504.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We can demonstrate this by way of example. Suppose we applied a low-frequency sinewave to a 5-point averaging FIR filter as shown by the white <a id="calibre_link-2235"></a>squares in <a href="#calibre_link-1076">Figure 5-10(a)</a>. The input sinewave’s frequency is <em class="calibre7">f</em><sub class="calibre12">s</sub>/32 Hz and its peak amplitude is unity. The filter’s output sequence is shown by the black squares.</p>
<p class="caption"><a id="calibre_link-1076"></a><strong class="calibre9">Figure 5-10</strong> Averaging FIR filter input and output responses: (a) with an input sinewave of frequency <em class="calibre7">f<sub class="calibre12">s</sub></em>/32; (b) with an input sinewave of frequency 3<em class="calibre7">f<sub class="calibre12">s</sub></em>/32.</p>
<p class="image"><img src="images/001364.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1076">Figure 5-10(a)</a> is rich in information! First, the filter’s output is a sinewave of the same frequency as the input. This is a characteristic of a linear system. We apply a single sinewave input, and the output will be a single sinewave (shifted in phase and perhaps reduced in amplitude) of the same frequency as the input. Second, notice that the initial four output samples are not exactly sinusoidal. Those output samples are the <em class="calibre7">transient response</em> of the filter. With tapped-delay line FIR filters, the sample length of that transient response is equal to the number of filter unit-delay elements <em class="calibre7">D</em>, after which the filter’s output begins its steady-state time response.</p>
<p class="calibre3">The above transient response property is important. It means that tapped-delay line FIR filter outputs are not valid until <em class="calibre7">D</em>+1 input samples have been applied to the filter. That is, the output samples are not valid until <a id="calibre_link-2273"></a>the filter’s delay line is filled with input data. So, for an FIR filter having <em class="calibre7">D</em> = 70 unit-delay elements the first 70 output samples are not valid and would be ignored in practice. WARNING: There are tapped-delay line FIR filters, used in practice, that have more unit-delay elements than nonzero-valued tap coefficients. The transient response length for those filters, measured in samples, is equal to the number of unit-delay elements, <em class="calibre7">D</em> (and is unrelated to the number of nonzero-valued tap coefficients).</p>
<p class="calibre3">The filter’s output sinewave peak amplitude is reduced to a value of 0.96 and the output sinewave is delayed from the input by a phase angle of 22.5 degrees. Notice that the time delay between the input and output sinewaves, in <a href="#calibre_link-1076">Figure 5-10(a)</a>, is two samples in duration. (Although we discuss this time delay topic in more detail later, for now we’ll just say that, because the filter’s coefficients are symmetrical, the input/output delay measured in samples is equal to half the number of unit-delay elements in the filter’s tapped-delay line.)</p>
<p class="calibre3">Next, if we applied a higher-frequency sinewave of 3<em class="calibre7">f</em><sub class="calibre12">s</sub>/32 Hz to our 5-tap FIR filter as shown in <a href="#calibre_link-1076">Figure 5-10(b)</a>, the filter output is a sinewave of frequency 3<em class="calibre7">f</em><sub class="calibre12">s</sub>/32 Hz and its peak amplitude is even further reduced to a value of 0.69. That’s the nature of lowpass filters&mdash;they attenuate higher-frequency inputs more than they attenuate low-frequency inputs. As in <a href="#calibre_link-1076">Figure 5-10(a)</a>, the time delay between the input and output sinewaves, in <a href="#calibre_link-1076">Figure 5-10(b)</a>, is two samples in duration (corresponding to a phase-angle delay of 67.5 degrees). That property, where the input/output delay does not depend on frequency, <a id="calibre_link-2432"></a>is a very beneficial property of FIR filters having symmetrical coefficients. We’ll discuss this important issue again later in this chapter. In <a href="#calibre_link-1076">Figure 5-10(b)</a> we see that the nonsinusoidal filter output transient response is even more obvious than it was in <a href="#calibre_link-1076">Figure 5-10(a)</a>.</p>
<p class="calibre3">Although the output amplitudes and phase delays in <a href="#calibre_link-1076">Figure 5-10</a> were measured values from actually performing a 5-tap FIR filter process on the input sinewaves’ samples, we could have obtained those amplitude and phase delay values directly from <a href="#calibre_link-1070">Figures 5-8(b)</a> and <a href="#calibre_link-1070">5-8(c)</a>. The point is, we don’t have to implement an FIR filter and apply various sinewave inputs to discover what its frequency response will be. We need merely take the DFT of the FIR filter’s coefficients (impulse response) to determine the filter’s frequency response as we did for <a href="#calibre_link-1070">Figure 5-8</a>.</p>
<p class="calibre3"><a href="#calibre_link-1077">Figure 5-11</a> is another depiction of how well our 5-tap averaging FIR filter performs, where the dashed line is the filter’s magnitude response |<em class="calibre7">H</em>(<em class="calibre7">m</em>)|, and the shaded line is the |<em class="calibre7">X</em>(<em class="calibre7">m</em>)| magnitude spectrum of the filter’s input values (the white squares in <a href="#calibre_link-1050">Figure 5-2</a>). The solid line is the magnitude spectrum of the filter’s output sequence, which is shown by the black squares in <a href="#calibre_link-1050">Figure 5-2</a>. So in <a href="#calibre_link-1077">Figure 5-11</a>, the solid output spectrum is the product of the dashed filter response curve and the shaded input spectrum, or |<em class="calibre7">X</em>(<em class="calibre7">m</em>)·<em class="calibre7">H</em>(<em class="calibre7">m</em>)|. Again, we see that our averager does indeed attenuate the higher-frequency portion of the input spectrum.</p>
<p class="caption"><a id="calibre_link-1077"></a><strong class="calibre9">Figure 5-11</strong> Averaging FIR filter input magnitude spectrum, frequency magnitude response, and output magnitude spectrum.</p>
<p class="image"><img src="images/000402.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Let’s pause for a moment to let all of this soak in a little. So far we’ve gone through the averaging filter example to establish that</p>
<p class="indenthangingb">• FIR filters perform time-domain convolution by summing the products of the shifted input samples and a sequence of filter coefficients,</p>
<p class="indenthangingb"><a id="calibre_link-1956"></a>• an FIR filter’s output sequence is equal to the convolution of the input sequence and a filter’s impulse response (coefficients),</p>
<p class="indenthangingb">• an FIR filter’s frequency response is the DFT of the filter’s impulse response,</p>
<p class="indenthangingb">• an FIR filter’s output spectrum is the product of the input spectrum and the filter’s frequency response, and</p>
<p class="indenthangingb">• convolution in the time domain and multiplication in the frequency domain are Fourier transform pairs.</p>
<p class="calibre3">OK, here’s where FIR filters start to get really interesting. Let’s change the values of the five filter coefficients to modify the frequency response of our 5-tap lowpass filter. In fact, <a href="#calibre_link-1078">Figure 5-12(a)</a> shows our original five filter coefficients and two other arbitrary sets of 5-tap coefficients. <a href="#calibre_link-1078">Figure 5-12(b)</a> compares the frequency magnitude responses of those three sets of coefficients. Again, the frequency responses are obtained by taking the DFT of the three individual sets of coefficients and plotting the magnitude of the transforms, as we did for <a href="#calibre_link-1075">Figure 5-9(c)</a>. So we see three important characteristics in <a href="#calibre_link-1078">Figure 5-12</a>. First, as we expected, different sets of coefficients give us different frequency magnitude responses. Second, a sudden change in the values of the coefficient sequence, such as the 0.2 to 0 transition in the first coefficient set, causes ripples, or sidelobes, in the frequency response. Third, if we minimize the suddenness of the changes in the coefficient values, such as the third set of coefficients in <a href="#calibre_link-1078">Figure 5-12(a)</a>, we reduce the sidelobe ripples in the frequency response. However, reducing the sidelobes results in increasing the main lobe width of our lowpass filter. (As we’ll see, this is exactly the same effect encountered in the discussion of window functions used with the DFT in <a href="#calibre_link-594">Section 3.9</a>.)</p>
<p class="caption"><a id="calibre_link-1078"></a><strong class="calibre9">Figure 5-12</strong> Three sets of 5-tap lowpass filter coefficients: (a) sets of coefficients: 0.2, 0.2, 0.2, 0.2, 0.2; 0.1, 0.2, 0.2, 0.2, 0.1; and 0.04, 0.12, 0.2, 0.12, 0.04; (b) frequency magnitude response of three lowpass FIR filters using those sets of coefficients.</p>
<p class="image"><img src="images/001251.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To reiterate the function of the filter coefficients, <a href="#calibre_link-118">Figure 5-13</a> shows the 5-tap FIR filter structure using the third set of coefficients from <a href="#calibre_link-1078">Figure 5-12</a>. The implementation of constant-coefficient transversal FIR filters does not get any more complicated than that shown in <a href="#calibre_link-118">Figure 5-13</a>. It’s that simple. We can have a filter with more than 5 taps, but the input signal sample shifting, the multiplications by the constant coefficients, and the summation are all there is to it. (By constant coefficients, we don’t mean coefficients whose values are all the same; we mean coefficients whose values remain unchanged, or time invariant. There is a class of digital filters, called adaptive filters, whose coefficient values are periodically changed to adapt to changing input signal parameters. While we won’t discuss these adaptive filters in this introductory text, their descriptions are available in the literature[<a href="#calibre_link-1079">1</a>&ndash;<a href="#calibre_link-1080">5</a>].)</p>
<p class="caption"><a id="calibre_link-118"></a><strong class="calibre9">Figure 5-13</strong> Five-tap lowpass FIR filter implementation using the coefficients 0.04, 0.12, 0.2, 0.12, and 0.04.</p>
<p class="image"><img src="images/000289.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So far, our description of an FIR filter implementation has been presented from a hardware perspective. In <a href="#calibre_link-118">Figure 5-13</a>, to calculate a single filter output sample, five multiplications and five additions must take place before the arrival of the next input sample value. In a software implementation of a 5-tap FIR filter, however, all of the input data samples would be <a id="calibre_link-2664"></a>previously stored in memory. The software filter routine’s job, then, is to access different five-sample segments of the <em class="calibre7">x</em>(<em class="calibre7">n</em>) input data space, perform the calculations shown in <a href="#calibre_link-118">Figure 5-13</a>, and store the resulting filter <em class="calibre7">y</em>(<em class="calibre7">n</em>) output sequence in an array of memory locations.<sup class="calibre10"><a id="calibre_link-1082"></a><a href="#calibre_link-1081">†</a></sup></p>
<p class="footnotes"><a id="calibre_link-1081"></a><sup class="calibre11"><a href="#calibre_link-1082">†</a></sup> In reviewing the literature of FIR filters, the reader will often find the term <em class="calibre7">z</em><sup class="calibre11">−1</sup> replacing the delay function in <a href="#calibre_link-118">Figure 5-13</a>. This equivalence is explained in the next chapter when we study IIR filters.</p>
<p class="calibre3"><a id="calibre_link-2092"></a>Now that we have a basic understanding of what a digital FIR filter is, let’s see what effect is had by using more than 5 filter taps by learning to design FIR filters.</p>
<p class="calibre3"><a id="calibre_link-610"></a></p>
<h3 class="calibre6">5.3 Lowpass FIR Filter Design</h3>
<p class="calibre3">OK, instead of just accepting a given set of FIR filter coefficients and analyzing their frequency response, let’s reverse the process and design our own lowpass FIR filter. The design procedure starts with the determination of a <em class="calibre7">desired</em> frequency response followed by calculating the filter coefficients that will give us that response. There are two predominant techniques used to design FIR filters: the window method and the so-called optimum method. Let’s discuss them in that order.</p>
<p class="calibre3"><a id="calibre_link-2665"></a></p>
<h4 class="calibre13">5.3.1 Window Design Method</h4>
<p class="calibre3">The window method of FIR filter design (also called the Fourier series method) begins with our deciding what frequency response we want for our lowpass filter. We can start by considering a continuous lowpass filter, and simulating that filter with a digital filter. We’ll define the continuous frequency response <em class="calibre7">H</em>(<em class="calibre7">f</em>) to be ideal, i.e., a lowpass filter with unity gain at low frequencies and zero gain (infinite attenuation) beyond some <em class="calibre7"><a href="#calibre_link-1083">cutoff frequency</a></em>, as shown in <a href="#calibre_link-1084">Figure 5-14(a)</a>. Representing this <em class="calibre7">H</em>(<em class="calibre7">f</em>) response by a discrete frequency response is straightforward enough because the idea of a discrete frequency response is essentially the same as a continuous frequency response&mdash;with one important difference. As described in <a href="#calibre_link-584">Sections 2.2</a> and <a href="#calibre_link-597">3.13</a>, discrete frequency-domain representations are always periodic with the <a id="calibre_link-2666"></a>period being the sample rate <em class="calibre7">f<sub class="calibre12">s</sub></em>. The discrete representation of our ideal, continuous lowpass filter <em class="calibre7">H</em>(<em class="calibre7">f</em>) is the periodic response <em class="calibre7">H</em>(<em class="calibre7">m</em>) depicted by the frequency-domain samples in <a href="#calibre_link-1084">Figure 5-14(b)</a>.</p>
<p class="caption"><a id="calibre_link-1084"></a><strong class="calibre9">Figure 5-14</strong> Lowpass filter frequency responses: (a) continuous frequency response <em class="calibre7">H</em>(<em class="calibre7">f</em>); (b) periodic, discrete frequency response <em class="calibre7">H</em>(<em class="calibre7">m</em>).</p>
<p class="image"><img src="images/001131.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We have two ways to determine our lowpass filter’s time-domain coefficients. The first way is algebraic:</p>
<p class="indenthangingn1"><strong class="calibre9">1.</strong> Develop an expression for the discrete frequency response <em class="calibre7">H</em>(<em class="calibre7">m</em>).</p>
<p class="indenthangingn1"><strong class="calibre9">2.</strong> Apply that expression to the inverse DFT equation to get the time domain <em class="calibre7">h</em>(<em class="calibre7">k</em>).</p>
<p class="indenthangingn1"><strong class="calibre9">3.</strong> Evaluate that <em class="calibre7">h</em>(<em class="calibre7">k</em>) expression as a function of time index <em class="calibre7">k.</em></p>
<p class="calibre3">The second method is to define the individual frequency-domain samples representing <em class="calibre7">H</em>(<em class="calibre7">m</em>) and then have a software routine perform the inverse DFT of those samples, giving us the FIR filter coefficients. In either method, we need only define the periodic <em class="calibre7">H</em>(<em class="calibre7">m</em>) over a single period of <em class="calibre7">f<sub class="calibre12">s</sub></em> Hz. As it turns out, defining <em class="calibre7">H</em>(<em class="calibre7">m</em>) in <a href="#calibre_link-1084">Figure 5-14(b)</a> over the frequency span −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 to <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 is the easiest form to analyze algebraically, and defining <em class="calibre7">H</em>(<em class="calibre7">m</em>) over the frequency span 0 to <em class="calibre7">f<sub class="calibre12">s</sub></em> is the best representation if we use the inverse DFT to obtain our filter’s coefficients. Let’s try both methods to determine the filter’s time-domain coefficients.</p>
<p class="calibre3">In the algebraic method, we can define an arbitrary discrete frequency response <em class="calibre7">H</em>(<em class="calibre7">m</em>) using <em class="calibre7">N</em> samples to cover the −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 to <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 frequency range and establish <em class="calibre7">K</em> unity-valued samples for the passband of our lowpass filter as shown in <a href="#calibre_link-1085">Figure 5-15</a>. To determine <em class="calibre7">h</em>(<em class="calibre7">k</em>) algebraically we need to take the inverse DFT of <em class="calibre7">H</em>(<em class="calibre7">m</em>) in the form of</p>
<p class="caption"><a id="calibre_link-1086"></a>(5-9)</p>
<p class="image"><img src="images/001476.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1085"></a><strong class="calibre9">Figure 5-15</strong> Arbitrary, discrete lowpass FIR filter frequency response defined over <em class="calibre7">N</em> frequency-domain samples covering the frequency range of <em class="calibre7">f<sub class="calibre12">s</sub></em> Hz.</p>
<p class="image"><img src="images/000178.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where our time-domain index is <em class="calibre7">k</em>. The solution to <a href="#calibre_link-1086">Eq. (5-9)</a>, derived in <a href="#calibre_link-597">Section 3.13</a> as Eq. (3-59), is repeated here as</p>
<p class="caption"><a id="calibre_link-1087"></a>(5-10)</p>
<p class="image"><img src="images/001374.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2667"></a>If we evaluate <a href="#calibre_link-1087">Eq. (5-10)</a> as a function of <em class="calibre7">k</em>, we get the sequence shown in <a href="#calibre_link-1088">Figure 5-16</a>, taking the form of the classic sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> function. By reviewing the material in <a href="#calibre_link-597">Section 3.13</a>, it’s easy to see the great deal of algebraic manipulation required to arrive at <a href="#calibre_link-1087">Eq. (5-10)</a> from <a href="#calibre_link-1086">Eq. (5-9)</a>. So much algebra, in fact, with its many opportunities for making errors, that digital filter designers like to avoid evaluating <a href="#calibre_link-1086">Eq. (5-9)</a> algebraically. They prefer to use software routines to perform inverse DFTs (in the form of an inverse FFT) to determine <em class="calibre7">h</em>(<em class="calibre7">k</em>), and so will we.</p>
<p class="caption"><a id="calibre_link-1088"></a><strong class="calibre9">Figure 5-16</strong> Time-domain <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients obtained by evaluating <a href="#calibre_link-1087">Eq. (5-10)</a>.</p>
<p class="image"><img src="images/001733.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We can demonstrate the software inverse DFT method of FIR filter design with an example. Let’s say we need to design a lowpass FIR filter simulating the continuous frequency response shown in <a href="#calibre_link-803">Figure 5-17(a)</a>. The discrete representation of the filter’s frequency response <em class="calibre7">H</em>(<em class="calibre7">m</em>) is shown in <a href="#calibre_link-803">Figure 5-17(b)</a>, where we’ve used <em class="calibre7">N</em> = 32 points to represent the frequency-domain variable <em class="calibre7">H</em>(<em class="calibre7">f</em>). Because it’s equivalent to <a href="#calibre_link-803">Figure 5-17(b)</a> but avoids the negative values of the frequency index <em class="calibre7">m</em>, we represent the discrete frequency <a id="calibre_link-2245"></a>samples over the range 0 to <em class="calibre7">f<sub class="calibre12">s</sub></em> in <a href="#calibre_link-803">Figure 5-17(c)</a>, as opposed to the −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 to +<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 range in <a href="#calibre_link-803">Figure 5-17(b)</a>. OK, we’re almost there. Using a 32-point inverse FFT to implement a 32-point inverse DFT of the <em class="calibre7">H</em>(<em class="calibre7">m</em>) sequence in <a href="#calibre_link-803">Figure 5-17(c)</a>, we get the 32 <em class="calibre7">h</em>(<em class="calibre7">k</em>) values depicted by the dots from <em class="calibre7">k</em> = −15 to <em class="calibre7">k</em> = 16 in <a href="#calibre_link-1089">Figure 5-18(a)</a>.<sup class="calibre10"><a id="calibre_link-1091"></a><a href="#calibre_link-1090">†</a></sup> We have one more step to perform. Because we want our final 31-tap <em class="calibre7">h</em>(<em class="calibre7">k</em>) filter coefficients to be symmetrical with their peak value in the center of the coefficient sample set, we drop the <em class="calibre7">k</em> = 16 sample and shift the <em class="calibre7">k</em> index to the left from <a href="#calibre_link-1089">Figure 5-18(a)</a>, giving us the desired sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> form of <em class="calibre7">h</em>(<em class="calibre7">k</em>) as shown in <a href="#calibre_link-1089">Figure 5-18(b)</a>. This shift of the index <em class="calibre7">k</em> will not change the frequency magnitude response of our FIR filter. (Remember from our discussion of the DFT shifting theorem in <a href="#calibre_link-113">Section 3.6</a> that a shift in the time domain manifests itself only as a linear phase shift in the frequency domain with no change in the frequency-domain magnitude.) The sequence in <a href="#calibre_link-1089">Figure 5-18(b)</a>, then, is now the coefficients we use in the convolution process of <a href="#calibre_link-1060">Figure 5-5</a> to implement a lowpass FIR filter.</p>
<p class="footnotes"><a id="calibre_link-1090"></a><sup class="calibre11"><a href="#calibre_link-1091">†</a></sup> If you want to use this FIR design method but only have a forward FFT software routine available, <a href="#calibre_link-680">Section 13.6</a> shows a slick way to perform an inverse FFT with the forward FFT algorithm.</p>
<p class="caption"><a id="calibre_link-803"></a><strong class="calibre9">Figure 5-17</strong> An ideal lowpass filter: (a) continuous frequency response <em class="calibre7">H</em>(<em class="calibre7">f</em>); (b) discrete response <em class="calibre7">H</em>(<em class="calibre7">m</em>) over the range −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 to <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz; (c) discrete response <em class="calibre7">H</em>(<em class="calibre7">m</em>) over the range 0 to <em class="calibre7">f<sub class="calibre12">s</sub></em> Hz.</p>
<p class="image"><img src="images/000069.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1089"></a><strong class="calibre9">Figure 5-18</strong> Inverse DFT of the discrete response in <a href="#calibre_link-803">Figure 5-17(c)</a>: (a) normal inverse DFT indexing for <em class="calibre7">k</em>; (b) symmetrical coefficients used for a 31-tap lowpass FIR filter.</p>
<p class="image"><img src="images/000912.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">It’s important to demonstrate that the more <em class="calibre7">h</em>(<em class="calibre7">k</em>) terms we use as filter coefficients, the closer we’ll approximate our ideal lowpass filter response. Let’s be conservative, just use the center nine <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients, and see what our filter response looks like. Again, our filter’s magnitude response in this case will be the DFT of those nine coefficients as shown on the right side of <a href="#calibre_link-745">Figure 5-19(a)</a>. The ideal filter’s frequency response is also shown for reference as the dashed curve. (To show the details of its shape, we’ve used a continuous curve for |<em class="calibre7">H</em>(<em class="calibre7">m</em>)| in <a href="#calibre_link-745">Figure 5-19(a)</a>, but we have to remember that |<em class="calibre7">H</em>(<em class="calibre7">m</em>)| is really a <a id="calibre_link-2249"></a>sequence of discrete values.) Notice that using nine coefficients gives us a lowpass filter, but it’s certainly far from ideal. Using more coefficients to improve our situation, <a href="#calibre_link-745">Figure 5-19(b)</a> shows 19 coefficients and their corresponding frequency magnitude response that is beginning to look more like our desired rectangular response. Notice that magnitude fluctuations, or ripples, are evident in the passband of our <em class="calibre7">H</em>(<em class="calibre7">m</em>) filter response. Continuing, using all 31 of the <em class="calibre7">h</em>(<em class="calibre7">k</em>) values for our filter coefficients results in the frequency response in <a href="#calibre_link-745">Figure 5-19(c)</a>. Our filter’s response is getting better (approaching the ideal), but those conspicuous passband magnitude ripples are still present.</p>
<p class="caption"><a id="calibre_link-745"></a><strong class="calibre9">Figure 5-19</strong> Coefficients and frequency responses of three lowpass filters: (a) 9-tap FIR filter; (b) 19-tap FIR filter; (c) frequency response of the full 31-tap FIR filter.</p>
<p class="image"><img src="images/001776.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">It’s important that we understand why those passband ripples are in the lowpass FIR filter response in <a href="#calibre_link-745">Figure 5-19</a>. Recall the above discussion of convolving the 5-tap averaging filter coefficients, or impulse response, with an input data sequence to obtain the averager’s output. We established that convolution in the time domain is equivalent to multiplication in the frequency domain, which we symbolized with <a href="#calibre_link-1067">Eq. (5-8)</a> and repeat here as</p>
<p class="caption"><a id="calibre_link-1092"></a>(5-11)</p>
<p class="image"><img src="images/000186.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2244"></a>This association between convolution in the time domain and multiplication in the frequency domain, sketched in <a href="#calibre_link-1068">Figure 5-7</a>, indicates that if two time-domain sequences <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">n</em>) have DFTs of <em class="calibre7">H</em>(<em class="calibre7">m</em>) and <em class="calibre7">X</em>(<em class="calibre7">m</em>), respectively, then the DFT of <em class="calibre7">h</em>(<em class="calibre7">k</em>) <sub class="calibre12">*</sub> <em class="calibre7">x</em>(<em class="calibre7">n</em>) is <em class="calibre7">H</em>(<em class="calibre7">m</em>) · <em class="calibre7">X</em>(<em class="calibre7">m</em>). No restrictions whatsoever need be placed on what the time-domain sequences <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">n</em>) in <a href="#calibre_link-1092">Eq. (5-11)</a> actually represent. As detailed later in <a href="#calibre_link-614">Section 5.9</a>, convolution in one domain is equivalent to multiplication in the other domain, allowing us to state that multiplication in the time domain is equivalent to convolution in the frequency domain, or</p>
<p class="caption"><a id="calibre_link-1093"></a>(5-12)</p>
<p class="image"><img src="images/001026.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Now we’re ready to understand why the magnitude ripples are present in <a href="#calibre_link-745">Figure 5-19</a>.</p>
<p class="calibre3">Rewriting <a href="#calibre_link-1093">Eq. (5-12)</a> and replacing the <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">n</em>) expressions with <em class="calibre7">h</em><sup class="calibre10">∞</sup>(<em class="calibre7">k</em>) and <em class="calibre7">w</em>(<em class="calibre7">k</em>), respectively,</p>
<p class="caption"><a id="calibre_link-1095"></a>(5-13)</p>
<p class="image"><img src="images/000078.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Let’s say that <em class="calibre7">h</em><sup class="calibre10">∞</sup>(<em class="calibre7">k</em>) represents an infinitely long sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> sequence of ideal lowpass FIR filter coefficients and that <em class="calibre7">w</em>(<em class="calibre7">k</em>) represents a window sequence that we use to truncate the sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> terms as shown in <a href="#calibre_link-1094">Figure 5-20</a>. Thus, the <em class="calibre7">w</em>(<em class="calibre7">k</em>) sequence is a finite-length set of unity values and its DFT is <em class="calibre7">W</em>(<em class="calibre7">m</em>). The length of <em class="calibre7">w</em>(<em class="calibre7">k</em>) is merely the number of coefficients, or taps, we intend to use to implement our lowpass FIR filter. With <em class="calibre7">h</em><sup class="calibre10">∞</sup>(<em class="calibre7">k</em>) defined as such, the product <a id="calibre_link-2668"></a><em class="calibre7">h</em><sup class="calibre10">∞</sup>(<em class="calibre7">k</em>) · <em class="calibre7">w</em>(<em class="calibre7">k</em>) represents the truncated set of filter coefficients <em class="calibre7">h</em>(<em class="calibre7">k</em>) in <a href="#calibre_link-745">Figures 5-19(a)</a> and <a href="#calibre_link-745">5-19(b)</a>. So, from <a href="#calibre_link-1095">Eq. (5-13)</a>, the FIR filter’s true frequency response <em class="calibre7">H</em>(<em class="calibre7">m</em>) is the convolution</p>
<p class="caption"><a id="calibre_link-2669"></a>(5-14)</p>
<p class="image"><img src="images/000921.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1094"></a><strong class="calibre9">Figure 5-20</strong> Infinite <em class="calibre7">h</em><sup class="calibre10">∞</sup>(<em class="calibre7">k</em>) sequence windowed by <em class="calibre7">w</em>(<em class="calibre7">k</em>) to define the final filter coefficients <em class="calibre7">h</em>(<em class="calibre7">k</em>).</p>
<p class="image"><img src="images/000799.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We depict this convolution in <a href="#calibre_link-1096">Figure 5-21</a> where, to keep the figure from being so busy, we show <em class="calibre7">H</em><sup class="calibre10">∞</sup>(<em class="calibre7">m</em>) (the DFT of the <em class="calibre7">h</em><sup class="calibre10">∞</sup>(<em class="calibre7">k</em>) coefficients) as the gray rectangle. Keep in mind that it’s really a sequence of constant-amplitude sample values.</p>
<p class="caption"><a id="calibre_link-1096"></a><strong class="calibre9">Figure 5-21</strong> Convolution <em class="calibre7">W</em>(<em class="calibre7">m</em>)<sub class="calibre12">*</sub><em class="calibre7">H</em><sup class="calibre10">∞</sup>(<em class="calibre7">m</em>): (a) unshifted <em class="calibre7">W</em>(<em class="calibre7">m</em>) and <em class="calibre7">H</em><sup class="calibre10">∞</sup>(<em class="calibre7">m</em>); (b) shift of <em class="calibre7">W</em>(<em class="calibre7">m</em>) leading to ripples within <em class="calibre7">H</em>(<em class="calibre7">m</em>)’s positive-frequency passband; (c) shift of <em class="calibre7">W</em>(<em class="calibre7">m</em>) causing response roll-off near <em class="calibre7">H</em>(<em class="calibre7">m</em>)’s positive cutoff frequency; (d) shift of <em class="calibre7">W</em>(<em class="calibre7">m</em>) causing ripples beyond <em class="calibre7">H</em>(<em class="calibre7">m</em>)’s positive cutoff frequency.</p>
<p class="image"><img src="images/001659.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Let’s look at <a href="#calibre_link-1096">Figure 5-21(a)</a> very carefully to see why all three |<em class="calibre7">H</em>(<em class="calibre7">m</em>)|s exhibit passband ripple in <a href="#calibre_link-745">Figure 5-19</a>. We can view a particular sample value <a id="calibre_link-2247"></a>of the <em class="calibre7">H</em>(<em class="calibre7">m</em>) = <em class="calibre7">H</em><sup class="calibre10">∞</sup>(<em class="calibre7">m</em>) <sub class="calibre12">*</sub> <em class="calibre7">W</em>(<em class="calibre7">m</em>) convolution as being the sum of the products of <em class="calibre7">H</em><sup class="calibre10">∞</sup>(<em class="calibre7">m</em>) and <em class="calibre7">W</em>(<em class="calibre7">m</em>) for a particular frequency shift of <em class="calibre7">W</em>(<em class="calibre7">m</em>). <em class="calibre7">H</em><sup class="calibre10">∞</sup>(<em class="calibre7">m</em>) and the unshifted <em class="calibre7">W</em>(<em class="calibre7">m</em>) are shown in <a href="#calibre_link-1096">Figure 5-21</a>(a.) With an assumed value of unity for all of <em class="calibre7">H</em><sup class="calibre10">∞</sup>(<em class="calibre7">m</em>), a particular <em class="calibre7">H</em>(<em class="calibre7">m</em>) value is now merely the sum of the <em class="calibre7">W</em>(<em class="calibre7">m</em>) samples that overlap the <em class="calibre7">H</em><sup class="calibre10">∞</sup>(<em class="calibre7">m</em>) rectangle. So, with a <em class="calibre7">W</em>(<em class="calibre7">m</em>) frequency shift of 0 Hz, the sum of the <em class="calibre7">W</em>(<em class="calibre7">m</em>) samples that overlap the <em class="calibre7">H</em><sup class="calibre10">∞</sup>(<em class="calibre7">m</em>) rectangle in <a href="#calibre_link-1096">Figure 5-21(a)</a> is the value of <em class="calibre7">H</em>(<em class="calibre7">m</em>) at 0 Hz. As <em class="calibre7">W</em>(<em class="calibre7">m</em>) is shifted to the right to give us additional positive-frequency <em class="calibre7">H</em>(<em class="calibre7">m</em>) values, we can see that the sum of the positive and negative values of <em class="calibre7">W</em>(<em class="calibre7">m</em>) under the rectangle oscillates during the shifting of <em class="calibre7">W</em>(<em class="calibre7">m</em>). As the convolution shift proceeds, <a href="#calibre_link-1096">Figure 5-21(b)</a> shows why there are ripples in the passband of <em class="calibre7">H</em>(<em class="calibre7">m</em>)&mdash;again, the sum of the positive and negative <em class="calibre7">W</em>(<em class="calibre7">m</em>) samples under the <em class="calibre7">H</em><sup class="calibre10">∞</sup>(<em class="calibre7">m</em>) rectangle continues to vary as the <em class="calibre7">W</em>(<em class="calibre7">m</em>) function is shifted. The <em class="calibre7">W</em>(<em class="calibre7">m</em>) frequency shift, indicated in <a href="#calibre_link-1096">Figure 5-21(c)</a>, where the peak of <em class="calibre7">W</em>(<em class="calibre7">m</em>)’s main lobe is now outside the <em class="calibre7">H</em><sup class="calibre10">∞</sup>(<em class="calibre7">m</em>) rectangle, corresponds to the frequency where <em class="calibre7">H</em>(<em class="calibre7">m</em>)’s passband begins to roll off. <a href="#calibre_link-1096">Figure 5-21(d)</a> shows that, as the <em class="calibre7">W</em>(<em class="calibre7">m</em>) shift continues, there will be ripples in <em class="calibre7">H</em>(<em class="calibre7">m</em>) beyond the positive cutoff frequency.<sup class="calibre10"><a id="calibre_link-1098"></a><a href="#calibre_link-1097">†</a></sup> The point of all of this is that the ripples in <em class="calibre7">H</em>(<em class="calibre7">m</em>) are caused by the sidelobes of <em class="calibre7">W</em>(<em class="calibre7">m</em>).</p>
<p class="footnotes"><a id="calibre_link-1097"></a><sup class="calibre11"><a href="#calibre_link-1098">†</a></sup> In <a href="#calibre_link-1096">Figure 5-21(b)</a>, had we started to shift <em class="calibre7">W</em>(<em class="calibre7">m)</em> to the left in order to determine the negative-frequency portion of <em class="calibre7">H</em>(<em class="calibre7">m</em>), we would have obtained the mirror image of the positive-frequency portion of <em class="calibre7">H</em>(<em class="calibre7">m</em>).</p>
<p class="calibre3"><a href="#calibre_link-1099">Figure 5-22</a> helps us answer the question “How many sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> coefficients do we have to use (or how wide must <em class="calibre7">w</em>(<em class="calibre7">k</em>) be) to get nice sharp falling edges and no ripples in our <em class="calibre7">H</em>(<em class="calibre7">m</em>) passband?” The answer is that we can’t get there from here. It doesn’t matter how many sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> coefficients (filter taps) we use; there will always be filter passband ripple. As long as <em class="calibre7">w</em>(<em class="calibre7">k</em>) is a finite number of unity values (i.e., a rectangular window of finite width), there will be sidelobe ripples in <em class="calibre7">W</em>(<em class="calibre7">m</em>), and this will induce passband ripples in the final <em class="calibre7">H</em>(<em class="calibre7">m</em>) frequency response. To illustrate that increasing the number of sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> coefficients doesn’t reduce passband ripple, we repeat the 31-tap lowpass filter response in <a href="#calibre_link-1099">Figure 5-22(a)</a>. The frequency response, using 63 coefficients, is shown in <a href="#calibre_link-1099">Figure 5-22(b)</a>, and the passband ripple remains. We can make the filter’s transition region narrower using additional <em class="calibre7">h</em>(<em class="calibre7">k</em>) filter coefficients, but we cannot eliminate the passband ripple. That ripple, known as Gibbs’s phenomenon, manifests itself anytime a function (<em class="calibre7">w</em>(<em class="calibre7">k</em>) in this case) with an instantaneous discontinuity is represented by a Fourier series[<a href="#calibre_link-1100">6</a>&ndash;<a href="#calibre_link-1101">8</a>]. No finite set of sinusoids will be able to change fast enough to be exactly equal to an instantaneous discontinuity. Another way to state this Gibbs’s dilemma is that, no matter how wide our <em class="calibre7">w</em>(<em class="calibre7">k</em>) window is, <em class="calibre7">W</em>(<em class="calibre7">m</em>) will always have sidelobe ripples. As shown in <a href="#calibre_link-1099">Figure 5-22(b)</a>, we can use more coefficients by extending the width of the rectangular <em class="calibre7">w</em>(<em class="calibre7">k</em>) to narrow the filter transition region, but a wider <em class="calibre7">w</em>(<em class="calibre7">k</em>) does not eliminate the filter passband ripple, nor does it even <a id="calibre_link-2253"></a>reduce their peak-to-peak ripple magnitudes, as long as <em class="calibre7">w</em>(<em class="calibre7">k</em>) has sudden discontinuities.</p>
<p class="caption"><a id="calibre_link-1099"></a><strong class="calibre9">Figure 5-22</strong> Passband ripple and transition regions: (a) for a 31-tap lowpass filter; (b) for a 63-tap lowpass filter.</p>
<p class="image"><img src="images/001231.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2670"></a></p>
<h4 class="calibre13">5.3.2 Windows Used in FIR Filter Design</h4>
<p class="calibre3">OK. The good news is that we can minimize FIR passband ripple with window functions the same way we minimized DFT leakage in <a href="#calibre_link-594">Section 3.9</a>. Here’s how. Looking back at <a href="#calibre_link-1094">Figure 5-20</a>, by truncating the infinitely long <em class="calibre7">h</em><sup class="calibre10">∞</sup>(<em class="calibre7">k</em>) sequence through multiplication by the rectangular <em class="calibre7">w</em>(<em class="calibre7">k</em>), our final <em class="calibre7">h</em>(<em class="calibre7">k</em>) exhibited ripples in the frequency-domain passband. <a href="#calibre_link-1096">Figure 5-21</a> shows us that the passband ripples were caused by <em class="calibre7">W</em>(<em class="calibre7">m</em>)’s sidelobes that, in turn, were caused by the sudden discontinuities from zero to one and one to zero in <em class="calibre7">w</em>(<em class="calibre7">k</em>). If we think of <em class="calibre7">w</em>(<em class="calibre7">k</em>) in <a href="#calibre_link-1094">Figure 5-20</a> as a rectangular window, then it is <em class="calibre7">w</em>(<em class="calibre7">k</em>)’s abrupt amplitude changes that are the source of our filter passband ripple. The window FIR design method is the technique of reducing <em class="calibre7">w</em>(<em class="calibre7">k</em>)’s discontinuities by using window functions other than the rectangular window.</p>
<p class="calibre3">Consider <a href="#calibre_link-1102">Figure 5-23</a> to see how a nonrectangular window function can be used to design low-ripple FIR digital filters. Imagine if we replaced <a href="#calibre_link-1094">Figure 5-20</a>’s <a id="calibre_link-2028"></a>rectangular <em class="calibre7">w</em>(<em class="calibre7">k</em>) with the Blackman window function whose discrete values are defined as</p>
<p class="caption"><a id="calibre_link-1103"></a>(5-15)</p>
<p class="image"><img src="images/000385.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1102"></a><strong class="calibre9">Figure 5-23</strong> Coefficients and frequency response of a 31-tap Blackman-windowed FIR filter: (a) defining the windowed filter coefficients <em class="calibre7">h</em>(<em class="calibre7">k</em>); (b) low-ripple 31-tap frequency response; (c) low-ripple 63-tap frequency response.</p>
<p class="image"><img src="images/000269.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2671"></a>This situation is depicted for <em class="calibre7">N</em> = 31 in <a href="#calibre_link-1102">Figure 5-23(a)</a>, where <a href="#calibre_link-1103">Eq. (5-15)</a>’s <em class="calibre7">w</em>(<em class="calibre7">k</em>) looks very much like the Hanning window function in <a href="#calibre_link-1104">Figure 3-17(a)</a>. This Blackman window function results in the 31 smoothly tapered <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients at the bottom of <a href="#calibre_link-1102">Figure 5-23(a)</a>. Notice two things about the resulting <em class="calibre7">H</em>(<em class="calibre7">m</em>) in <a href="#calibre_link-1102">Figure 5-23(b)</a>. First, the good news. The passband ripples are greatly reduced from those evident in <a href="#calibre_link-1099">Figure 5-22(a)</a>&mdash;so our Blackman window function did its job. Second, the price we paid for reduced passband ripple is a wider <em class="calibre7">H</em>(<em class="calibre7">m</em>) transition region. We can get a steeper filter response roll-off by increasing the number of taps in our FIR filter. <a href="#calibre_link-1102">Figure 5-23(c)</a> shows the improved frequency response had we used a 63-coefficient Blackman window function for a 63-tap FIR filter. So using a nonrectangular window function reduces passband ripple at the expense of slower passband to stopband roll-off.</p>
<p class="calibre3">A graphical comparison of the frequency responses for the rectangular and Blackman windows is provided in <a href="#calibre_link-1105">Figure 5-24</a>. (The curves in <a href="#calibre_link-1105">Figure 5-24</a> were obtained for the window functions defined by 16 discrete samples, <a id="calibre_link-2051"></a>to which 496 zeros were appended, applied to a 512-point DFT.) The sidelobe magnitudes of the Blackman window’s |<em class="calibre7">W</em>(<em class="calibre7">m</em>)| are too small to see on a linear scale. We can see those sidelobe details by plotting the two windows’ frequency responses on a logarithmic scale and normalizing each plot so that their main lobe peak values are both zero dB. For a given window function, we can get the log magnitude response of <em class="calibre7">W</em><sub class="calibre12">dB</sub>(<em class="calibre7">m</em>) by using the expression</p>
<p class="caption"><a id="calibre_link-1106"></a>(5-16)</p>
<p class="image"><img src="images/000808.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1105"></a><strong class="calibre9">Figure 5-24</strong> Rectangular versus Blackman window frequency magnitude responses: (a) |<em class="calibre7">W</em>(<em class="calibre7">m</em>)| on a linear scale; (b) normalized logarithmic scale of <em class="calibre7">W</em><sub class="calibre12">dB</sub>(<em class="calibre7">m</em>).</p>
<p class="image"><img src="images/001112.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">(The |<em class="calibre7">W</em>(0)| term in <a href="#calibre_link-1106">Eq. (5-16)</a> is the magnitude of <em class="calibre7">W</em>(<em class="calibre7">m</em>) at the peak of the main lobe when <em class="calibre7">m</em> = 0.) <a href="#calibre_link-1105">Figure 5-24(b)</a> shows us the greatly reduced sidelobe levels of the Blackman window and how that window’s main lobe is almost three times as wide as the rectangular window’s main lobe.</p>
<p class="calibre3">Of course, we could have used any of the other window functions, discussed in <a href="#calibre_link-594">Section 3.9</a>, for our lowpass FIR filter. That’s why this FIR filter design technique is called the window design method. We pick a window function and multiply it by the sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> values from <em class="calibre7">H</em><sup class="calibre10">∞</sup>(<em class="calibre7">m</em>) in <a href="#calibre_link-1102">Figure 5-23(a)</a> to get our final <em class="calibre7">h</em>(<em class="calibre7">k</em>) filter coefficients. It’s that simple. Before we leave the window method of FIR filter design, let’s introduce two other interesting window functions.</p>
<p class="calibre3">Although the Blackman window and those windows discussed in <a href="#calibre_link-594">Section 3.9</a> are useful in FIR filter design, we have little control over their frequency responses; that is, our only option is to select some window function and accept its corresponding frequency response. Wouldn’t it be nice to have more flexibility in trading off, or striking a compromise between, a window’s main lobe width and sidelobe levels? Fortunately, there are two popular window functions that give us this opportunity. Called the Chebyshev (or Dolph-Chebyshev) and the Kaiser window functions, they’re defined by the following formidable expressions:</p>
<p class="caption"><a id="calibre_link-1108"></a>(5-17)</p>
<p class="image"><img src="images/001666.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1111"></a>(5-18)</p>
<p class="image"><img src="images/000453.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2469"></a>Two typical Chebyshev and Kaiser window functions and their frequency magnitude responses are shown in <a href="#calibre_link-1107">Figure 5-25</a>. For comparison, the rectangular and Blackman window functions are also shown in that figure. (Again, the curves in <a href="#calibre_link-1107">Figure 5-25(b)</a> were obtained for window functions defined by 32 discrete time samples, with 480 zeros appended, applied to a 512-point DFT.)</p>
<p class="caption"><a id="calibre_link-1107"></a><strong class="calibre9">Figure 5-25</strong> Typical window functions used with digital filters: (a) window coefficients in the time domain; (b) frequency-domain magnitude responses in dB.</p>
<p class="image"><img src="images/000163.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1108">Equation (5-17)</a> was originally based on the analysis of antenna arrays using the mathematics of Chebyshev polynomials[<a href="#calibre_link-1109">9</a>&ndash;<a href="#calibre_link-1110">11</a>]. <a href="#calibre_link-1111">Equation (5-18)</a> evolved from Kaiser’s approximation of prolate spheroid functions using zeroth-order Bessel functions[<a href="#calibre_link-1112">12</a>&ndash;<a href="#calibre_link-1113">13</a>]. For each sample of the <em class="calibre7">N</em>-length sequence inside the brackets of the numerator of <a href="#calibre_link-1111">Eq. (5-18)</a>, as well as for the <a id="calibre_link-2470"></a>β term in the denominator, the <em class="calibre7">I</em><sub class="calibre12">o</sub>(<em class="calibre7">x</em>) zeroth-order Bessel function values can be approximated using</p>
<p class="caption"><a id="calibre_link-1114"></a>(5-18′)</p>
<p class="image"><img src="images/001549.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">In theory the upper limit of the summation in <a href="#calibre_link-1114">Eq. (5-18′)</a> should be infinity but, fortunately, 25 summations give us sufficient accuracy when evaluating <em class="calibre7">I</em><sub class="calibre12">o</sub>(<em class="calibre7">x</em>).</p>
<p class="calibre3">Don’t be intimidated by the complexity of <a href="#calibre_link-1108">Eqs. (5-17)</a> and <a href="#calibre_link-1111">(5-18)</a>&mdash;at this point, we need not be concerned with the mathematical details of their development. We just need to realize that the γ and β control parameters give us control over the Chebyshev and Kaiser windows’ main lobe widths and the sidelobe levels.</p>
<p class="calibre3">Let’s see how this works for Chebyshev window functions, having four separate values of γ, and their frequency responses shown in <a href="#calibre_link-1115">Figure 5-26</a>. FIR filter designers applying the window method typically use predefined software routines to obtain their Chebyshev window coefficients. Commercial digital signal processing software packages allow the user to specify three things: the window function (Chebyshev in this case), the desired number of coefficients (the number of taps in the FIR filter), and the value of γ. Selecting different values for γ enables us to adjust the sidelobe levels and see what effect those values have on main lobe width, a capability that we didn’t have with the Blackman window or the window functions discussed in <a href="#calibre_link-594">Section 3.9</a>. The Chebyshev window function’s stopband attenuation, in dB, is equal to</p>
<p class="caption"><a id="calibre_link-1116"></a>(5-19)</p>
<p class="image"><img src="images/001716.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1115"></a><strong class="calibre9">Figure 5-26</strong> Chebyshev window functions for various γ values: (a) window coefficients in the time domain; (b) frequency-domain magnitude responses in dB.</p>
<p class="image"><img src="images/001004.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So, for example, if we needed our sidelobe levels to be no greater than −60 dB below the main lobe, we use <a href="#calibre_link-1116">Eq. (5-19)</a> to establish a γ value of 3.0 and let the software generate the Chebyshev window coefficients.<sup class="calibre10"><a id="calibre_link-1118"></a><a href="#calibre_link-1117">†</a></sup></p>
<p class="footnotes"><a id="calibre_link-1117"></a><sup class="calibre11"><a href="#calibre_link-1118">†</a></sup> By the way, some digital signal processing software packages require that we specify <em class="calibre7">Atten</em><sub class="calibre14">Cheb</sub> in decibels instead of γ. That way, we don’t have to bother using <a href="#calibre_link-1116">Eq. (5-19)</a> at all.</p>
<p class="calibre3">The same process applies to the Kaiser window, as shown in <a href="#calibre_link-1119">Figure 5-27</a>. Commercial software packages allow us to specify β in <a href="#calibre_link-1111">Eq. (5-18)</a> and provide us with the associated window coefficients. The curves in <a href="#calibre_link-1119">Figure 5-27(b)</a>, obtained for Kaiser window functions defined by 32 discrete samples, show that we can select the desired sidelobe levels and see what effect this has on the main lobe width.</p>
<p class="caption"><a id="calibre_link-1119"></a><strong class="calibre9">Figure 5-27</strong> Kaiser window functions for various β values: (a) window coefficients in the time domain; (b) frequency-domain magnitude responses in dB.</p>
<p class="image"><img src="images/000051.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Chebyshev or Kaiser, which is the best window to use? It depends on the application. Returning to <a href="#calibre_link-1107">Figure 5-25(b)</a>, notice that, unlike the constant <a id="calibre_link-2672"></a>sidelobe peak levels of the Chebyshev window, the Kaiser window’s sidelobes decrease with increased frequency. However, the Kaiser sidelobes are higher than the Chebyshev window’s sidelobes near the main lobe. Our primary trade-off here is trying to reduce the sidelobe levels without broadening the main lobe too much. Digital filter designers typically experiment with various values of γ and β for the Chebyshev and Kaiser windows to get the optimum <em class="calibre7">W</em><sub class="calibre12">dB</sub>(<em class="calibre7">m</em>) for a particular application. (For that matter, the Blackman window’s very low sidelobe levels outweigh its wide main lobe in many applications.) For some reason, algorithms for computing Chebyshev window functions are not readily available in the literature of DSP. To remedy that situation, <a href="#calibre_link-299">Appendix I</a> presents a straightforward procedure for computing <em class="calibre7">N</em>-sample Chebyshev window sequences.</p>
<p class="calibre3"><a id="calibre_link-1993"></a>To conclude this section, remember that different window functions have their own individual advantages and disadvantages for FIR filter design. Regardless of the non-rectangular window function used, they always decrease an FIR filter’s passband ripple over that of the rectangular window. For the enthusiastic reader, a thorough discussion of many window functions can be found in reference <a href="#calibre_link-1120">[14]</a>.</p>
<p class="calibre3"><a id="calibre_link-611"></a></p>
<h3 class="calibre6">5.4 Bandpass FIR Filter Design</h3>
<p class="calibre3">The window method of lowpass FIR filter design can be used as the first step in designing a bandpass FIR filter. Let’s say we want a 31-tap FIR filter with the frequency response shown in <a href="#calibre_link-1099">Figure 5-22(a)</a>, but instead of being centered <a id="calibre_link-2673"></a>about zero Hz, we want the filter’s passband to be centered about <em class="calibre7">f<sub class="calibre12">s</sub></em>/4 Hz. If we define a lowpass FIR filter’s coefficients as <em class="calibre7">h</em><sub class="calibre12">lp</sub>(<em class="calibre7">k</em>), our problem is to find the <em class="calibre7">h</em><sub class="calibre12">bp</sub>(<em class="calibre7">k</em>) coefficients of a bandpass FIR filter. As shown in <a href="#calibre_link-1121">Figure 5-28</a>, we can shift <em class="calibre7">H</em><sub class="calibre12">lp</sub>(<em class="calibre7">m</em>)’s frequency response by multiplying the filter’s <em class="calibre7">h</em><sub class="calibre12">lp</sub>(<em class="calibre7">k</em>) lowpass coefficients by a sinusoid of <em class="calibre7">f<sub class="calibre12">s</sub></em>/4 Hz. That sinusoid is represented by the <em class="calibre7">s</em><sub class="calibre12">shift</sub>(<em class="calibre7">k</em>) sequence in <a href="#calibre_link-1121">Figure 5-28(a)</a>, whose values are a sinewave sampled at a rate of four samples per cycle. Our final 31-tap <em class="calibre7">h</em><sub class="calibre12">bp</sub>(<em class="calibre7">k</em>) FIR bandpass filter coefficients are</p>
<p class="caption"><a id="calibre_link-1122"></a>(5-20)</p>
<p class="image"><img src="images/001434.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1121"></a><strong class="calibre9">Figure 5-28</strong> Bandpass filter with frequency response centered at <em class="calibre7">f</em><sub class="calibre12">s</sub>/4: (a) generating 31-tap filter coefficients <em class="calibre7">h</em><sub class="calibre12">bp</sub>(<em class="calibre7">k</em>); (b) frequency magnitude response |<em class="calibre7">H</em><sub class="calibre12">bp</sub>(<em class="calibre7">m</em>)|.</p>
<p class="image"><img src="images/000900.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2248"></a>whose frequency magnitude response |<em class="calibre7">H</em><sub class="calibre12">bp</sub>(<em class="calibre7">m</em>)| is shown as the solid curves in <a href="#calibre_link-1121">Figure 5-28(b)</a>. The actual magnitude of |<em class="calibre7">H</em><sub class="calibre12">bp</sub>(<em class="calibre7">m</em>)| is half that of the original |<em class="calibre7">H</em><sub class="calibre12">lp</sub>(<em class="calibre7">m</em>)| because half the values in <em class="calibre7">h</em><sub class="calibre12">bp</sub>(<em class="calibre7">k</em>) are zero when <em class="calibre7">s</em><sub class="calibre12">shift</sub>(<em class="calibre7">k</em>) corresponds exactly to <em class="calibre7">f<sub class="calibre12">s</sub></em>/4. This effect has an important practical implication. It means that, when we design an <em class="calibre7">N</em>-tap bandpass FIR filter centered at a frequency of <em class="calibre7">f<sub class="calibre12">s</sub></em>/4 Hz, we only need to perform approximately <em class="calibre7">N</em>/2 multiplications for each filter output sample. (There’s no reason to multiply an input sample value, <em class="calibre7">x</em>(<em class="calibre7">n</em>−<em class="calibre7">k</em>), by zero before we sum all the products from <a href="#calibre_link-1063">Eq. (5-6)</a> and <a href="#calibre_link-118">Figure 5-13</a>, right? We just don’t bother to perform the unnecessary multiplications at all.) Of course, when the bandpass FIR filter’s center frequency is other than <em class="calibre7">f<sub class="calibre12">s</sub></em>/4, we’re forced to perform the full number of <em class="calibre7">N</em> multiplications for each FIR filter output sample.</p>
<p class="calibre3">Notice, here, that the <em class="calibre7">h</em><sub class="calibre12">lp</sub>(<em class="calibre7">k</em>) lowpass coefficients in <a href="#calibre_link-1121">Figure 5-28(a)</a> have not been multiplied by any window function. In practice, we’d use an <em class="calibre7">h</em><sub class="calibre12">lp</sub>(<em class="calibre7">k</em>) that has been windowed prior to implementing <a href="#calibre_link-1122">Eq. (5-20)</a> to reduce the passband ripple. If we wanted to center the bandpass filter’s response at some frequency other than <em class="calibre7">f<sub class="calibre12">s</sub></em>/4, we merely need to modify <em class="calibre7">s</em><sub class="calibre12">shift</sub>(<em class="calibre7">k</em>) to represent sampled values of a sinusoid whose frequency is equal to the desired bandpass center frequency. That new <em class="calibre7">s</em><sub class="calibre12">shift</sub>(<em class="calibre7">k</em>) sequence would then be used in <a href="#calibre_link-1122">Eq. (5-20)</a> to get the new <em class="calibre7">h</em><sub class="calibre12">bp</sub>(<em class="calibre7">k</em>).</p>
<p class="calibre3"><a id="calibre_link-612"></a></p>
<h3 class="calibre6">5.5 Highpass FIR Filter Design</h3>
<p class="calibre3">Going one step further, we can use the bandpass FIR filter design technique to design a highpass FIR filter. To obtain the coefficients for a highpass filter, we need only modify the shifting sequence <em class="calibre7">s</em><sub class="calibre12">shift</sub>(<em class="calibre7">k</em>) to make it represent a sampled sinusoid whose frequency is <em class="calibre7">f<sub class="calibre12">s</sub></em>/2. This process is shown in <a href="#calibre_link-1123">Figure 5-29</a>. Our final 31-tap highpass FIR filter’s <em class="calibre7">h</em><sub class="calibre12">hp</sub>(<em class="calibre7">k</em>) coefficients are</p>
<p class="caption"><a id="calibre_link-1124"></a>(5-21)</p>
<p class="image"><img src="images/000472.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1123"></a><strong class="calibre9">Figure 5-29</strong> Highpass filter with frequency response centered at <em class="calibre7">f<sub class="calibre12">s</sub></em>/2: (a) generating 31-tap filter coefficients <em class="calibre7">h</em><sub class="calibre12">hp</sub>(<em class="calibre7">k</em>); (b) frequency magnitude response |<em class="calibre7">H</em><sub class="calibre12">hp</sub>(<em class="calibre7">m</em>)|.</p>
<p class="image"><img src="images/001754.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">whose |<em class="calibre7">H</em><sub class="calibre12">hp</sub>(<em class="calibre7">m</em>)| frequency response is the solid curve in <a href="#calibre_link-1123">Figure 5-29(b)</a>. Because <em class="calibre7">s</em><sub class="calibre12">shift</sub>(<em class="calibre7">k</em>) in <a href="#calibre_link-1123">Figure 5-29(a)</a> has alternating plus and minus ones, we can see that <em class="calibre7">h</em><sub class="calibre12">hp</sub>(<em class="calibre7">k</em>) is merely <em class="calibre7">h</em><sub class="calibre12">lp</sub>(<em class="calibre7">k</em>) with the sign changed for every other coefficient. Unlike |<em class="calibre7">H</em><sub class="calibre12">bp</sub>(<em class="calibre7">m</em>)| in <a href="#calibre_link-1121">Figure 5-28(b)</a>, the |<em class="calibre7">H</em><sub class="calibre12">hp</sub>(<em class="calibre7">m</em>)| response in <a href="#calibre_link-1123">Figure 5-29(b)</a> has the same amplitude as the original |<em class="calibre7">H</em><sub class="calibre12">lp</sub>(<em class="calibre7">m</em>)|.</p>
<p class="calibre3">Again, notice that the <em class="calibre7">h</em><sub class="calibre12">lp</sub>(<em class="calibre7">k</em>) lowpass coefficients in <a href="#calibre_link-1123">Figure 5-29(a)</a> have not been modified by any window function. In practice, we’d use a windowed <em class="calibre7">h</em><sub class="calibre12">lp</sub>(<em class="calibre7">k</em>) to reduce the passband ripple before implementing <a href="#calibre_link-1124">Eq. (5-21)</a>.</p>
<p class="calibre3"><a id="calibre_link-613"></a></p>
<h3 class="calibre6"><a id="calibre_link-2250" class="calibre5"></a>5.6 Parks-McClellan Exchange FIR Filter Design Method</h3>
<p class="calibre3">Let’s introduce one last FIR filter design technique that has found wide acceptance in practice. The Parks-McClellan FIR filter design method (also called the Remez Exchange, or Optimal method<sup class="calibre10"><a id="calibre_link-1127"></a><a href="#calibre_link-1125">†</a></sup>) is a popular technique used to design high-performance FIR filters. To use this design method, we have to visualize a desired frequency response <em class="calibre7">H</em><sub class="calibre12">d</sub>(<em class="calibre7">m</em>) like that shown in <a href="#calibre_link-1126">Figure 5-30</a>.</p>
<p class="footnotes"><a id="calibre_link-1125"></a><sup class="calibre11"><a href="#calibre_link-1127">†</a></sup> Remez is pronounced re-’m<img src="images/000571.jpg" alt="image" class="calibre2" />.</p>
<p class="caption"><a id="calibre_link-2674"></a><a id="calibre_link-1126"></a><strong class="calibre9">Figure 5-30</strong> Desired frequency response definition of a lowpass FIR filter using the Parks-McClellan Exchange design method.</p>
<p class="image"><img src="images/000781.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We have to establish a desired passband cutoff frequency <em class="calibre7">f</em><sub class="calibre12">pass</sub> and the frequency where the attenuated stopband begins, <em class="calibre7">f</em><sub class="calibre12">stop</sub>. In addition, we must establish the variables δ<em class="calibre7"><sub class="calibre12">p</sub></em> and δ<em class="calibre7"><sub class="calibre12">s</sub></em> that define our desired passband and stopband ripple. Passband and stopband ripples, in decibels, are related to δ<em class="calibre7"><sub class="calibre12">p</sub></em> and δ<em class="calibre7"><sub class="calibre12">s</sub></em> by<a href="#calibre_link-1128">[15]</a></p>
<p class="caption"><a id="calibre_link-1129"></a>(5-22)</p>
<p class="image"><img src="images/001792.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">and</p>
<p class="caption"><a id="calibre_link-2675"></a>(5-22′)</p>
<p class="image"><img src="images/000564.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">(Some of the early journal papers describing the Parks-McClellan design method used the equally valid expression −20 · log<sub class="calibre12">10</sub>(δ<em class="calibre7"><sub class="calibre12">p</sub></em>) to define the passband ripple in dB. However, <a href="#calibre_link-1129">Eq. (5-22)</a> is the most common form used today.) Next, we apply these parameters to a computer software routine that generates the filter’s <em class="calibre7">N</em> time-domain <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients where <em class="calibre7">N</em> is the minimum number of filter taps to achieve the desired filter response.</p>
<p class="calibre3">On the other hand, some software Parks-McClellan routines assume that we want δ<em class="calibre7"><sub class="calibre12">p</sub></em> and δ<em class="calibre7"><sub class="calibre12">s</sub></em> to be as small as possible and require us only to define the desired values of the <em class="calibre7">H</em><sub class="calibre12">d</sub>(<em class="calibre7">m</em>) response as shown by the solid black dots in <a href="#calibre_link-1130">Figure 5-31</a>. The software then adjusts the values of the undefined (shaded dots) values of <em class="calibre7">H</em><sub class="calibre12">d</sub>(<em class="calibre7">m</em>) to minimize the error between our desired and actual frequency response while minimizing δ<em class="calibre7"><sub class="calibre12">p</sub></em> and δ<em class="calibre7"><sub class="calibre12">s</sub></em>. The filter designer has the option to define some of the <em class="calibre7">H</em><sub class="calibre12">d</sub>(<em class="calibre7">m</em>) values in the transition band, and the software calculates the remaining undefined <em class="calibre7">H</em><sub class="calibre12">d</sub>(<em class="calibre7">m</em>) transition band values. With this version of the Parks-McClellan algorithm, the issue of most <a id="calibre_link-2375"></a>importance becomes how we define the transition region. We want to minimize its width while, at the same time, minimizing passband and stopband ripple. So exactly how we design an FIR filter using the Parks-McClellan Exchange technique is specific to the available filter design software. Although the mathematics involved in the development of the Parks-McClellan Exchange method is rather complicated, we don’t have to worry about that here[<a href="#calibre_link-1131">16</a>&ndash;<a href="#calibre_link-1132">20</a>]. Just remember that the Parks-McClellan Exchange design method gives us a Chebyshev-type filter whose actual frequency response is as close as possible to the desired <em class="calibre7">H</em><sub class="calibre12">d</sub>(<em class="calibre7">m</em>) response for a given number of filter taps.</p>
<p class="caption"><a id="calibre_link-1130"></a><strong class="calibre9">Figure 5-31</strong> Alternate method for defining the desired frequency response of a lowpass FIR filter using the Parks-McClellan Exchange technique.</p>
<p class="image"><img src="images/001635.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To illustrate the advantage of the Parks-McClellan method, the solid curve in <a href="#calibre_link-1133">Figure 5-32</a> shows the frequency response of a 31-tap FIR designed using this technique. For comparison, <a href="#calibre_link-1133">Figure 5-32</a> also shows the frequency responses of two 31-tap FIR filters for the same passband width using the Chebyshev and Kaiser windowing techniques. Notice how the three filters have roughly the same stopband sidelobe levels, near the main lobe, but that the Parks-McClellan filter has the more desirable (steeper) transition band roll-off.</p>
<p class="caption"><a id="calibre_link-1133"></a><strong class="calibre9">Figure 5-32</strong> Frequency response comparison of three 31-tap FIR filters: Parks-McClellan, Chebyshev windowed, and Kaiser windowed.</p>
<p class="image"><img src="images/000664.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The Parks-McClellan Exchange filter design method revolutionized the art of, and has become the predominant technique for, designing linear-phase FIR filters. As a historical note, when Profs. Parks and McClellan (James McClellan was a graduate student at the time) developed their triumphant filter design method in 1971, they submitted a paper to <em class="calibre7">Electronics Letters</em> to publicize their achievement. Surprisingly, the editors of <em class="calibre7">Electronics Letters</em> rejected the paper because the reviewers didn’t believe that such a flexible, and optimized, FIR design procedure was possible. A description of Parks and McClellan’s revolutionary design method was eventually published in reference<a href="#calibre_link-1134">[17]</a>. That story is reminiscent of when Decca Records auditioned a group of four young musicians in 1961. Decca executives decided <em class="calibre7">not</em> to sign the <a id="calibre_link-2306"></a>group to a contract. You may have heard of that musical group&mdash;they were called the Beatles.</p>
<p class="calibre3"><a id="calibre_link-182"></a></p>
<h3 class="calibre6">5.7 Half-band FIR Filters</h3>
<p class="calibre3">There’s a specialized FIR filter that’s proved very useful in signal decimation and interpolation applications[<a href="#calibre_link-1135">21</a>&ndash;<a href="#calibre_link-1136">25</a>]. Called a <em class="calibre7"><a href="#calibre_link-986">half-band</a></em> FIR filter, its frequency magnitude response is symmetrical about the <em class="calibre7">f<sub class="calibre12">s</sub></em>/4 point as shown in <a href="#calibre_link-1137">Figure 5-33(a)</a>. As such, the sum of <em class="calibre7">f</em><sub class="calibre12">pass</sub> and <em class="calibre7">f</em><sub class="calibre12">stop</sub> is <em class="calibre7">f<sub class="calibre12">s</sub></em>/2. When the filter has an odd number of taps, this symmetry has the beautiful property that the filter’s time-domain impulse response has every other filter coefficient being zero, except the center coefficient. This enables us to avoid approximately half the number of multiplications when implementing this kind of filter. By way of example, <a href="#calibre_link-1137">Figure 5-33(b)</a> shows the coefficients for a 31-tap half-band filter where Δ<em class="calibre7">f</em> was defined to be approximately <em class="calibre7">f<sub class="calibre12">s</sub></em>/32 using the Parks-McClellan FIR filter design method.</p>
<p class="caption"><a id="calibre_link-1137"></a><strong class="calibre9">Figure 5-33</strong> Half-band FIR filter: (a) frequency magnitude response [transition region centered at <em class="calibre7">f<sub class="calibre12">s</sub></em>/4]; (b) 31-tap filter coefficients; (c) 7-tap half-band filter structure.</p>
<p class="image"><img src="images/001517.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Notice how the alternating <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients are zero, so we perform 17 multiplications per output sample instead of the expected 31 multiplications. Stated in different words, we achieve the performance of a 31-tap filter at the computational expense of only 17 multiplies per output sample. In the general case, for an <em class="calibre7">N</em>-tap half-band FIR filter, we’ll only need to perform (<em class="calibre7">N</em> + 1)/2 + 1 multiplications per output sample. (<a href="#calibre_link-148">Section 13.7</a> shows a technique to further reduce the number of necessary multiplies for linear-phase tapped-delay line FIR filters, including half-band filters.) The structure of a simple seven-coefficient half-band filter is shown in <a href="#calibre_link-1137">Figure 5-33(c)</a>, with the <em class="calibre7">h</em>(1) and <em class="calibre7">h</em>(5) multipliers absent.</p>
<p class="calibre3"><a id="calibre_link-2676"></a>Be aware, there’s a restriction on the number of half-band filter coefficients. To build linear-phase <em class="calibre7">N</em>-tap half-band FIR filters, having alternating zero-valued coefficients, <em class="calibre7">N</em> + 1 <em class="calibre7">must</em> be an integer multiple of four. If this restriction is not met, for example when <em class="calibre7">N</em> = 9, the first and last coefficients of the filter will both be equal to zero and can be discarded, yielding a 7-tap half-band filter.</p>
<p class="calibre3">On a practical note, there are two issues to keep in mind when we use an FIR filter design software package to design a half-band filter. First, assuming that the modeled filter has a passband gain of unity, ensure that your filter has a gain of 0.5 (−6 dB) at a frequency of <em class="calibre7">f<sub class="calibre12">s</sub></em>/4. Second, unavoidable numerical computation errors will yield alternate filter coefficients that are indeed very small but not exactly zero-valued as we desire. So in our filter modeling efforts, we must force those very small coefficient values to zero before we proceed to analyze half-band filter frequency responses.</p>
<p class="calibre3">You might sit back and think, “OK, these half-band filters are mildly interesting, but they’re certainly not worth writing home about.” As it turns out, half-band filters are very important because they’re widely used in applications with which you’re familiar&mdash;like pagers, cell phones, digital receivers/televisions, <a id="calibre_link-2229"></a>CD/DVD players, etc. We’ll learn more about half-band filter applications in <a href="#calibre_link-291">Chapter 10</a>.</p>
<p class="calibre3"><a id="calibre_link-370"></a></p>
<h3 class="calibre6">5.8 Phase Response of FIR Filters</h3>
<p class="calibre3">Although we illustrated a couple of output phase shift examples for our original averaging FIR filter in <a href="#calibre_link-1076">Figure 5-10</a>, the subject of FIR phase response deserves additional attention. One of the dominant features of FIR filters is their linear phase response which we can demonstrate by way of example. Given the 25 <em class="calibre7">h</em>(<em class="calibre7">k</em>) FIR filter coefficients in <a href="#calibre_link-1138">Figure 5-34(a)</a>, we can perform a DFT to determine the filter’s <em class="calibre7">H</em>(<em class="calibre7">m</em>) frequency response. The normalized real part, imaginary part, and magnitude of <em class="calibre7">H</em>(<em class="calibre7">m</em>) are shown in <a href="#calibre_link-1138">Figures 5-34(b)</a> and <a href="#calibre_link-1138">5-34(c)</a>, respectively.<sup class="calibre10"><a id="calibre_link-1141"></a><a href="#calibre_link-1139">†</a></sup> Being complex values, each <em class="calibre7">H</em>(<em class="calibre7">m</em>) sample value can be described by its real and imaginary parts, or equivalently, by its magnitude |<em class="calibre7">H</em>(<em class="calibre7">m</em>)| and its phase <em class="calibre7">H</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>) shown in <a href="#calibre_link-1140">Figure 5-35(a)</a>.</p>
<p class="footnotes"><a id="calibre_link-1139"></a><sup class="calibre11"><a href="#calibre_link-1141">†</a></sup> Any DFT size greater than the <em class="calibre7">h</em>(<em class="calibre7">k</em>) width of 25 is sufficient to obtain <em class="calibre7">H</em>(<em class="calibre7">m</em>). The <em class="calibre7">h</em>(<em class="calibre7">k</em>) sequence was padded with 103 zeros to take a 128-point DFT, resulting in the <em class="calibre7">H</em>(<em class="calibre7">m</em>) sample values in <a href="#calibre_link-1138">Figure 5-34</a>.</p>
<p class="caption"><a id="calibre_link-1138"></a><strong class="calibre9">Figure 5-34</strong> FIR filter frequency response <em class="calibre7">H</em>(<em class="calibre7">m</em>): (a) <em class="calibre7">h</em>(<em class="calibre7">k</em>) filter coefficients; (b) real and imaginary parts of <em class="calibre7">H</em>(<em class="calibre7">m</em>); (c) magnitude of <em class="calibre7">H</em>(<em class="calibre7">m</em>).</p>
<p class="image"><img src="images/000552.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1140"></a><strong class="calibre9">Figure 5-35</strong> FIR filter phase response <em class="calibre7">H</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>) in degrees: (a) calculated <em class="calibre7">H</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>); (b) polar plot of <em class="calibre7">H</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>)’s first ten phase angles in degrees; (c) actual <em class="calibre7">H</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>).</p>
<p class="image"><img src="images/001411.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The phase of a complex quantity is, of course, the arctangent of the imaginary part divided by the real part, or ø = tan <sup class="calibre10">−1</sup>(imag/real). Thus the phase of <em class="calibre7">H</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>) is determined from the samples in <a href="#calibre_link-1138">Figure 5-34(b)</a>.</p>
<p class="calibre3">The phase response in <a href="#calibre_link-1140">Figure 5-35(a)</a> certainly looks linear over selected frequency ranges, but what do we make of those sudden jumps, or discontinuities, in this phase response? If we were to plot the angles of <em class="calibre7">H</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>) starting with the <em class="calibre7">m</em> = 0 sample on a polar graph, using the nonzero real part of <em class="calibre7">H</em>(0), and the zero-valued imaginary part of <em class="calibre7">H</em>(0), we’d get the zero-angled <em class="calibre7">H</em><sub class="calibre12">ø</sub>(0) phasor shown on the right side of <a href="#calibre_link-1140">Figure 5-35(b)</a>. Continuing to use the real and imaginary parts of <em class="calibre7">H</em>(<em class="calibre7">m</em>) to plot additional phase angles results in the phasors going clockwise around the circle in increments of −33.75°. It’s at the <em class="calibre7">H</em><sub class="calibre12">ø</sub>(6) that we discover the cause of the first discontinuity in <a href="#calibre_link-1140">Figure 5-35(a)</a>. Taking the real and imaginary parts of <em class="calibre7">H</em>(6), we’d plot our phasor oriented at an angle of −202.5°. But <a href="#calibre_link-1140">Figure 5-35(a)</a> shows that <em class="calibre7">H</em><sub class="calibre12">ø</sub>(6) is equal to 157.5°. The problem lies in the software routine used to generate the arctangent values plotted in <a href="#calibre_link-1140">Figure 5-35(a)</a>. The software adds 360° to any negative angles in the range of −180° &gt; ø ≥ −360°, i.e., angles in the upper half of the circle. This makes ø a positive angle in the range of 0° &lt; ø ≤ 180° and that’s what gets plotted. (This apparent discontinuity between <em class="calibre7">H</em><sub class="calibre12">ø</sub>(5) and <em class="calibre7">H</em><sub class="calibre12">ø</sub>(6) is called <em class="calibre7"><a href="#calibre_link-1142">phase wrapping</a></em>.) So the true <em class="calibre7">H</em><sub class="calibre12">ø</sub>(6) of −202.5° is converted to a +157.5° as shown in parentheses in <a href="#calibre_link-1140">Figure 5-35(b)</a>. If we continue our polar plot for additional <em class="calibre7">H</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>) values, we’ll see that their phase angles continue to decrease with an angle increment of −33.75°. If we compensate for the software’s behavior and <a id="calibre_link-2230"></a>plot phase angles more negative than −180°, by <em class="calibre7">unwrapping</em> the phase, we get the true <em class="calibre7">H</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>) shown in <a href="#calibre_link-1140">Figure 5-35(c)</a>.</p>
<p class="calibre3">Notice that <em class="calibre7">H</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>) is, indeed, linear over the passband of <em class="calibre7">H</em>(<em class="calibre7">m</em>). It’s at <em class="calibre7">H</em><sub class="calibre12">ø</sub>(17) that our particular <em class="calibre7">H</em>(<em class="calibre7">m</em>) experiences a polarity change of its real part while its imaginary part remains negative&mdash;this induces a true phase-angle discontinuity that really is a constituent of <em class="calibre7">H</em>(<em class="calibre7">m</em>) at <em class="calibre7">m</em> = 17. (Additional phase discontinuities occur each time the real part of <em class="calibre7">H</em>(<em class="calibre7">m</em>) reverses polarity, as shown in <a href="#calibre_link-1140">Figure 5-35(c)</a>.) The reader may wonder why we care about the linear phase response of <em class="calibre7">H</em>(<em class="calibre7">m</em>). The answer, an important one, requires us to introduce the notion of group delay.</p>
<p class="calibre3"><a id="calibre_link-2225"></a><em class="calibre7"><a href="#calibre_link-363">Group delay</a></em> is defined as the negative of the derivative of the phase with respect to frequency, or <em class="calibre7">G</em> = −dø/d<em class="calibre7">f</em>. For FIR filters, then, group delay is the slope of the <em class="calibre7">H</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>) response curve. When the group delay is constant, as it is over the passband of all FIR filters having symmetrical coefficients, all frequency components of the filter input signal are delayed by an equal amount of time <em class="calibre7">G</em> before they reach the filter’s output. This means that no phase distortion is induced in the filter’s desired output signal, and this is crucial in communications signals. For amplitude modulation (AM) signals, constant group delay preserves the time waveform shape of the signal’s modulation envelope. That’s important because the modulation portion of an AM signal contains the <a id="calibre_link-2677"></a>signal’s information. Conversely, a nonlinear phase will distort the audio of AM broadcast signals, blur the edges of television video images, blunt the sharp edges of received radar pulses, and increase data errors in digital communications signals. (Group delay is sometimes called <em class="calibre7"><a href="#calibre_link-365">envelope delay</a></em> because group delay was originally the subject of analysis due to its effect on the envelope, or modulation signal, of amplitude modulation AM systems.) Of course we’re not really concerned with the group delay outside the passband because signal energy outside the passband is what we’re trying to eliminate through filtering.</p>
<p class="calibre3">Over the passband frequency range for a linear-phase, <em class="calibre7">S</em>-tap FIR filter, group delay has been shown to be given by</p>
<p class="caption"><a id="calibre_link-1144"></a>(5-23)</p>
<p class="image"><img src="images/001220.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">D</em> = <em class="calibre7">S</em>−1 is the number of unit-delay elements in the filter’s delay line, and <em class="calibre7">t<sub class="calibre12">s</sub></em> is the sample period (1/<em class="calibre7">f<sub class="calibre12">s</sub></em>).<sup class="calibre10"><a id="calibre_link-1145"></a><a href="#calibre_link-1143">†</a></sup> This group delay is measured in seconds. Eliminating the <em class="calibre7">t<sub class="calibre12">s</sub></em> factor in <a href="#calibre_link-1144">Eq. (5-23)</a> would change its dimensions to samples. The value <em class="calibre7">G,</em> measured in samples, is always an integer for odd-tap FIR filters and a noninteger for even-tap filters.</p>
<p class="footnotes"><a id="calibre_link-1143"></a><sup class="calibre11"><a href="#calibre_link-1145">†</a></sup> As derived in <a href="#calibre_link-465">Section 3.4</a> of reference <a href="#calibre_link-1131">[16]</a>, and page 597 of reference <a href="#calibre_link-1146">[19]</a>.</p>
<p class="calibre3">Although we used a 128-point DFT to obtain the frequency responses in <a href="#calibre_link-1138">Figures 5-34</a> and <a href="#calibre_link-1140">5-35</a>, we could just as well have used <em class="calibre7">N</em> = 32-point or <em class="calibre7">N</em> = 64-point DFTs. These smaller DFTs give us the phase response curves shown in <a href="#calibre_link-1147">Figures 5-36(a)</a> and <a href="#calibre_link-1147">5-36(b)</a>. Notice how different the phase response curves are when <em class="calibre7">N</em> = 32 in <a href="#calibre_link-1147">Figure 5-36(a)</a> compared to when <em class="calibre7">N</em> = 128 in <a href="#calibre_link-1147">Figure 5-36(c)</a>. The phase-angle resolution is much finer in <a href="#calibre_link-1147">Figure 5-36(c)</a>. The passband phase-angle resolution, or increment Δø, is given by</p>
<p class="caption"><a id="calibre_link-2678"></a>(5-24)</p>
<p class="image"><img src="images/000914.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1147"></a><strong class="calibre9">Figure 5-36</strong> FIR filter phase response <em class="calibre7">H</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>) in degrees: (a) calculated using a 32-point DFT; (b) using a 64-point DFT; (c) using a 128-point DFT.</p>
<p class="image"><img src="images/000449.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">N</em> is the number of points in the DFT. So, for our <em class="calibre7">S</em> = 25-tap filter in <a href="#calibre_link-1138">Figure 5-34(a)</a>, <em class="calibre7">G</em> = 12, and Δø is equal to −12 · 360°/32 = −135° in <a href="#calibre_link-1147">Figure 5-36(a)</a>, and Δø is −33.75° in <a href="#calibre_link-1147">Figure 5-36(c)</a>. If we look carefully at the sample values in <a href="#calibre_link-1147">Figure 5-36(a)</a>, we’ll see that they’re all included within the samples in <a href="#calibre_link-1147">Figures 5-36(b)</a> and <a href="#calibre_link-1147">5-36(c)</a>.</p>
<p class="calibre3">Let’s conclude this FIR phase discussion by reiterating the meaning of phase response. The phase, or phase delay, at the output of an FIR filter is the phase of the first output sample relative to the phase of the filter’s first input sample. Over the passband, that phase shift, of course, is a linear function of frequency. This will be true only as long as the filter has symmetrical coefficients. <a href="#calibre_link-1076">Figure 5-10</a> is a good illustration of an FIR filter’s output phase delay.</p>
<p class="calibre3"><a id="calibre_link-2679"></a>For FIR filters, the output phase shift measured in degrees, for the passband frequency <em class="calibre7">f</em> = <em class="calibre7">mf<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em>, is expressed as</p>
<p class="caption"><a id="calibre_link-1148"></a>(5-25)</p>
<p class="image"><img src="images/000653.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We can illustrate <a href="#calibre_link-1148">Eq. (5-25)</a> and show the relationship between the phase responses in <a href="#calibre_link-1147">Figure 5-36</a> by considering the phase delay associated with the frequency of <em class="calibre7">f<sub class="calibre12">s</sub></em>/32 in <a href="#calibre_link-1149">Table 5-2</a>. The subject of group delay is described <a id="calibre_link-2159"></a>further in <a href="#calibre_link-83">Appendix F</a>, where an example of envelope delay distortion, due to a filter’s nonlinear phase, is illustrated.</p>
<p class="caption"><a id="calibre_link-1149"></a><strong class="calibre9">Table 5-2</strong> Values Used in <a href="#calibre_link-1148">Eq. (5-25)</a> for the Frequency <em class="calibre7">f<sub class="calibre12">s</sub></em>/32</p>
<p class="image"><img src="images/001722.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-614"></a></p>
<h3 class="calibre6">5.9 A Generic Description of Discrete Convolution</h3>
<p class="calibre3">Although convolution was originally an analysis tool used to prove continuous signal processing theorems, we now know that convolution affects every aspect of digital signal processing. Convolution influences our results whenever we analyze or filter any finite set of data samples from a linear time-invariant system. Convolution not only constrains DFTs to be just approximations of the continuous Fourier transform; it is the reason that discrete spectra are periodic in the frequency domain. It’s interesting to note that, although we use the process of convolution to implement FIR digital filters, convolution effects induce frequency response ripple, preventing us from ever building a perfect digital filter. Its influence is so pervasive that to repeal the law of convolution, quoting a phrase from Dr. Who, would “unravel the entire causal nexus” of digital signal processing.</p>
<p class="calibre3">Convolution has always been a somewhat difficult concept for the beginner to grasp. That’s not too surprising for several reasons. Convolution’s effect on discrete signal processing is not intuitively obvious for those without experience working with discrete signals, and the mathematics of convolution does seem a little puzzling at first. Moreover, in their sometimes justified haste, many authors present the convolution equation and abruptly start using it as an analysis tool without explaining its origin and meaning. For example, this author once encountered what was called a <em class="calibre7">tutorial</em> article on the FFT in a professional journal that proceeded to define <em class="calibre7">convolution</em> merely by presenting something like that shown in <a href="#calibre_link-1150">Figure 5-37</a> with no further explanation!</p>
<p class="caption"><a id="calibre_link-1150"></a><strong class="calibre9">Figure 5-37</strong> One very efficient, but perplexing, way of defining convolution.</p>
<p class="image"><img src="images/001304.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Unfortunately, few beginners can gain an understanding of the convolution process from <a href="#calibre_link-1150">Figure 5-37</a> alone. Here, we avoid this dilemma by defining the process of convolution and gently proceed through a couple of simple convolution examples. We conclude this chapter with a discussion of the <a id="calibre_link-2160"></a>powerful convolution theorem and show why it’s so useful as a qualitative tool in discrete system analysis.</p>
<p class="calibre3"><a id="calibre_link-2680"></a></p>
<h4 class="calibre13">5.9.1 Discrete Convolution in the Time Domain</h4>
<p class="calibre3">Discrete convolution is a process whose input is two sequences and that provides a single output sequence. Convolution inputs can be two time-domain sequences giving a time-domain output, or two frequency-domain input sequences providing a frequency-domain result. (Although the two input sequences must both be in the same domain for the process of convolution to have any practical meaning, their sequence lengths need not be the same.) Let’s say we have two input sequences <em class="calibre7">h</em>(<em class="calibre7">k</em>) of length <em class="calibre7">P</em> and <em class="calibre7">x</em>(<em class="calibre7">k</em>) of length <em class="calibre7">Q</em> in the time domain. The output sequence <em class="calibre7">y</em>(<em class="calibre7">n</em>) of the convolution of the two inputs is defined mathematically as</p>
<p class="caption"><a id="calibre_link-1151"></a>(5-26)</p>
<p class="image"><img src="images/001407.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Let’s examine <a href="#calibre_link-1151">Eq. (5-26)</a> by way of example, using the <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">k</em>) sequences shown in <a href="#calibre_link-1152">Figure 5-38</a>. In this example, we can write the terms for each <em class="calibre7">y</em>(<em class="calibre7">n</em>) in <a href="#calibre_link-1151">Eq. (5-26)</a> as</p>
<p class="caption"><a id="calibre_link-2681"></a><a id="calibre_link-1152"></a><strong class="calibre9">Figure 5-38</strong> Convolution example input sequences: (a) first sequence <em class="calibre7">h</em>(<em class="calibre7">k</em>) of length <em class="calibre7">P</em> = 4; (b) second sequence <em class="calibre7">x</em>(<em class="calibre7">k</em>) of length <em class="calibre7">Q</em> = 3.</p>
<p class="image"><img src="images/000338.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1153"></a>(5-27)</p>
<p class="image"><img src="images/000114.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">With <em class="calibre7">P</em> = 4 and <em class="calibre7">Q</em> = 3, we need evaluate only 4 + 3 − 1 = 6 individual <em class="calibre7">y</em>(<em class="calibre7">n</em>) terms. Because <em class="calibre7">h</em>(4) and <em class="calibre7">h</em>(5) are zero, we can eliminate some of the terms in <a href="#calibre_link-1153">Eq. (5-27)</a> and evaluate the remaining <em class="calibre7">x</em>(<em class="calibre7">n</em>−<em class="calibre7">k</em>) indices, giving the following expressions for <em class="calibre7">y</em>(<em class="calibre7">n</em>) as</p>
<p class="caption"><a id="calibre_link-1154"></a>(5-28)</p>
<p class="image"><img src="images/000036.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Looking at the indices of the <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">k</em>) terms in <a href="#calibre_link-1154">Eq. (5-28)</a>, we see two very important things occurring. First, convolution is merely the summation of a series of products&mdash;so the process itself is not very complicated. Second, notice that, for a given <em class="calibre7">y</em>(<em class="calibre7">n</em>), <em class="calibre7">h</em>(<em class="calibre7">k</em>)’s index is increasing as <em class="calibre7">x</em>(<em class="calibre7">k</em>)’s index is decreasing. This fact has led many authors to introduce a new sequence <em class="calibre7">x</em>(−<em class="calibre7">k</em>) and use that new sequence to graphically illustrate the convolution process. The <em class="calibre7">x</em>(−<em class="calibre7">k</em>) <a id="calibre_link-2682"></a>sequence is simply our original <em class="calibre7">x</em>(<em class="calibre7">k</em>) reflected about the 0 index of the <em class="calibre7">k</em> axis as shown in <a href="#calibre_link-1155">Figure 5-39</a>. Defining <em class="calibre7">x</em>(−<em class="calibre7">k</em>) as such enables us to depict the products and summations of <a href="#calibre_link-1154">Eq. (5-28)</a>’s convolution as in <a href="#calibre_link-1156">Figure 5-40</a>; that is, we can now align the <em class="calibre7">x</em>(−<em class="calibre7">k</em>) samples with the samples of <em class="calibre7">h</em>(<em class="calibre7">k</em>) for a given <em class="calibre7">n</em> index to calculate <em class="calibre7">y</em>(<em class="calibre7">n</em>). As shown in <a href="#calibre_link-1156">Figure 5-40(a)</a>, the alignment of <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">n</em>−<em class="calibre7">k</em>), for <em class="calibre7">n</em> = 0, yields <em class="calibre7">y</em>(0) = 1. This is the result of the first line in <a href="#calibre_link-1154">Eq. (5-28)</a> repeated on the right side of <a href="#calibre_link-1156">Figure 5-40(a)</a>. The calculation of <em class="calibre7">y</em>(1), for <em class="calibre7">n</em> = 1, is depicted in <a href="#calibre_link-1156">Figure 5-40(b)</a>, where <em class="calibre7">x</em>(<em class="calibre7">n</em>−<em class="calibre7">k</em>) is shifted one element to the right, resulting in <em class="calibre7">y</em>(1) = 3. We continue this <em class="calibre7">x</em>(<em class="calibre7">n</em>−<em class="calibre7">k</em>) shifting and incrementing <em class="calibre7">n</em> until we arrive at the last nonzero convolution result of <em class="calibre7">y</em>(5) shown in <a href="#calibre_link-1156">Figure 5-40(f)</a>. So, performing the convolution of <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">k</em>) comprises</p>
<p class="indenthangingn1"><strong class="calibre9">1.</strong> plotting both the <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">k</em>) sequences,</p>
<p class="indenthangingn1"><strong class="calibre9">2.</strong> flipping the <em class="calibre7">x</em>(<em class="calibre7">k</em>) sequence around the <em class="calibre7">k</em> = 0 sample to obtain <em class="calibre7">x</em>(−<em class="calibre7">k</em>),</p>
<p class="indenthangingn1"><strong class="calibre9">3.</strong> summing the products of <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(0−<em class="calibre7">k</em>) for all <em class="calibre7">k</em> to yield <em class="calibre7">y</em>(0),</p>
<p class="indenthangingn1"><strong class="calibre9">4.</strong> shifting the <em class="calibre7">x</em>(−<em class="calibre7">k</em>) sequence one sample to the right,</p>
<p class="indenthangingn1"><strong class="calibre9">5.</strong> summing the products of <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(1−<em class="calibre7">k</em>) for all <em class="calibre7">k</em> to obtain <em class="calibre7">y</em>(1), and</p>
<p class="indenthangingn1"><strong class="calibre9">6.</strong> continuing to shift <em class="calibre7">x</em>(−<em class="calibre7">k</em>) and sum products until there’s no overlap of <em class="calibre7">h</em>(<em class="calibre7">k</em>) and the shifted <em class="calibre7">x</em>(<em class="calibre7">n</em>−<em class="calibre7">k</em>), in which case all further <em class="calibre7">y</em>(<em class="calibre7">n</em>) output samples are zero and we’re done.</p>
<p class="caption"><a id="calibre_link-1155"></a><strong class="calibre9">Figure 5-39</strong> Convolution example input sequence: (a) second sequence <em class="calibre7">x</em>(<em class="calibre7">k</em>) of length 3; (b) reflection of the second sequence about the <em class="calibre7">k</em> = 0 index.</p>
<p class="image"><img src="images/001184.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The full convolution of our <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">k</em>) is the <em class="calibre7">y</em>(<em class="calibre7">n</em>) sequence on the right side of <a href="#calibre_link-1156">Figure 5-40(f)</a>. We’ve scanned the <em class="calibre7">x</em>(−<em class="calibre7">k</em>) sequence across the <em class="calibre7">h</em>(<em class="calibre7">k</em>) sequence and summed the products where the sequences overlap. By the way, notice that the <em class="calibre7">y</em>(<em class="calibre7">n</em>) sequence in <a href="#calibre_link-1156">Figure 5-40(f)</a> has six elements where <em class="calibre7">h</em>(<em class="calibre7">k</em>) had a length of four and <em class="calibre7">x</em>(<em class="calibre7">k</em>) was of length three. In the general case, if <em class="calibre7">h</em>(<em class="calibre7">k</em>) is of length <em class="calibre7">P</em> and <em class="calibre7">x</em>(<em class="calibre7">k</em>) is of length <em class="calibre7">Q</em>, the length of <em class="calibre7">y</em>(<em class="calibre7">n</em>) will have a sequence length of <em class="calibre7">L</em>, where</p>
<p class="caption"><a id="calibre_link-1354"></a>(5-29)</p>
<p class="image"><img src="images/001486.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2683"></a><a id="calibre_link-1156"></a><strong class="calibre9">Figure 5-40</strong> Graphical depiction of the convolution of <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">k</em>) in <a href="#calibre_link-1152">Figure 5-38</a>.</p>
<p class="image"><img src="images/000225.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2243"></a>At this point, it’s fair for the beginner to ask, “OK, so what? What does this <em class="calibre7">strange</em> convolution process have to do with digital signal processing?” The answer to that question lies in understanding the effects of the convolution theorem.</p>
<p class="calibre3"><a id="calibre_link-1683"></a></p>
<h4 class="calibre13">5.9.2 The Convolution Theorem</h4>
<p class="calibre3">The convolution theorem is a fundamental constituent of digital signal processing. It impacts our results anytime we filter or Fourier transform discrete data. To see why this is true, let’s simplify the notation of <a href="#calibre_link-1151">Eq. (5-26)</a> and use the abbreviated form</p>
<p class="caption"><a id="calibre_link-2684"></a>(5-30)</p>
<p class="image"><img src="images/001739.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where, again, the “<sub class="calibre12">*</sub>” symbol means convolution. The convolution theorem may be stated as follows: If two time-domain sequences <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">k</em>) have DFTs of <em class="calibre7">H</em>(<em class="calibre7">m</em>) and <em class="calibre7">X</em>(<em class="calibre7">m</em>), respectively, then the DFT of <em class="calibre7">h</em>(<em class="calibre7">k</em>) <sub class="calibre12">*</sub> <em class="calibre7">x</em>(<em class="calibre7">k</em>) is the product <em class="calibre7">H</em>(<em class="calibre7">m</em>) · <em class="calibre7">X</em>(<em class="calibre7">m</em>). Likewise, the inverse DFT of <em class="calibre7">H</em>(<em class="calibre7">m</em>) · <em class="calibre7">X</em>(<em class="calibre7">m</em>) is <em class="calibre7">h</em>(<em class="calibre7">k</em>) <sub class="calibre12">*</sub> <em class="calibre7">x</em>(<em class="calibre7">k</em>). We can represent this relationship with the expression</p>
<p class="caption"><a id="calibre_link-1157"></a>(5-31)</p>
<p class="image"><img src="images/001527.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1157">Equation (5-31)</a> tells us that two sequences resulting from <em class="calibre7">h</em>(<em class="calibre7">k</em>) <sub class="calibre12">*</sub> <em class="calibre7">x</em>(<em class="calibre7">k</em>) and <em class="calibre7">H</em>(<em class="calibre7">m</em>) · <em class="calibre7">X</em>(<em class="calibre7">m</em>) are Fourier transform pairs. So, taking the DFT of <em class="calibre7">h</em>(<em class="calibre7">k</em>) <sub class="calibre12">*</sub> <em class="calibre7">x</em>(<em class="calibre7">k</em>) always gives us <em class="calibre7">H</em>(<em class="calibre7">m</em>) · <em class="calibre7">X</em>(<em class="calibre7">m</em>). Likewise, we can determine <em class="calibre7">h</em>(<em class="calibre7">k</em>) <sub class="calibre12">*</sub> <em class="calibre7">x</em>(<em class="calibre7">k</em>) by taking the inverse DFT of <em class="calibre7">H</em>(<em class="calibre7">m</em>) · <em class="calibre7">X</em>(<em class="calibre7">m</em>). The important point to learn from <a href="#calibre_link-1157">Eq. (5-31)</a> is that convolution in the time domain is equivalent to multiplication in the frequency domain. (We won’t derive the convolution theorem here because its derivation is readily available to the interested reader[<a href="#calibre_link-1158">26</a>&ndash;<a href="#calibre_link-1159">29</a>].) To help us appreciate this principle, <a href="#calibre_link-1160">Figure 5-41</a> sketches the relationship between convolution in the time domain and multiplication in the frequency domain.</p>
<p class="caption"><a id="calibre_link-1160"></a><strong class="calibre9">Figure 5-41</strong> Relationships of the convolution theorem.</p>
<p class="image"><img src="images/001068.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We can easily illustrate the convolution theorem by taking 8-point DFTs of <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">k</em>) to get <em class="calibre7">H</em>(<em class="calibre7">m</em>) and <em class="calibre7">X</em>(<em class="calibre7">m</em>), respectively, and listing these values as in <a href="#calibre_link-1161">Table 5-3</a>. (Of course, we have to pad <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">k</em>) with zeros, so they both have lengths of 8 to take 8-point DFTs.) Tabulating the inverse DFT of the product <em class="calibre7">H</em>(<em class="calibre7">m</em>) · <em class="calibre7">X</em>(<em class="calibre7">m</em>) allows us to verify <a href="#calibre_link-1157">Eq. (5-31)</a>, as listed in the last two columns of <a href="#calibre_link-1161">Table 5-3</a>, where the acronym IDFT again means inverse DFT. The values from <a href="#calibre_link-1161">Table 5-3</a> are shown in <a href="#calibre_link-1162">Figure 5-42</a>. (For simplicity, only the magnitudes of <em class="calibre7">H</em>(<em class="calibre7">m</em>), <em class="calibre7">X</em>(<em class="calibre7">m</em>), and <em class="calibre7">H</em>(<em class="calibre7">m</em>) · <em class="calibre7">X</em>(<em class="calibre7">m</em>) are shown in the figure.) We need to become comfortable with convolution in the time domain because, as we’ve learned, it’s the process used in FIR filters. As detailed in <a href="#calibre_link-609">Section 5.2</a>, we perform discrete time-domain FIR filtering by convolving an input sequence, <em class="calibre7">x</em>(<em class="calibre7">n</em>) say, <a id="calibre_link-2685"></a>with the impulse response <em class="calibre7">h</em>(<em class="calibre7">k</em>) of a filter, and for FIR filters that impulse response happens to also be the filter’s coefficients.<sup class="calibre10"><a id="calibre_link-1164"></a><a href="#calibre_link-1163">†</a></sup> The result of that convolution is a filtered time-domain sequence whose spectrum is modified (multiplied) by the filter’s frequency response <em class="calibre7">X</em>(<em class="calibre7">m</em>). <a href="#calibre_link-524">Section 13.10</a> describes a clever scheme to perform FIR filtering efficiently using the FFT algorithm to implement convolution.</p>
<p class="footnotes"><a id="calibre_link-1163"></a><sup class="calibre11"><a href="#calibre_link-1164">†</a></sup> As we’ll see in <a href="#calibre_link-289">Chapter 6</a>, the coefficients used for an infinite impulse response (IIR) filter are not equal to that filter’s impulse response.</p>
<p class="caption"><a id="calibre_link-2686"></a><a id="calibre_link-1161"></a><strong class="calibre9">Table 5-3</strong> Convolution Values of <em class="calibre7">h</em>(<em class="calibre7">k</em>) and <em class="calibre7">x</em>(<em class="calibre7">k</em>) from <a href="#calibre_link-1152">Figure 5-38</a></p>
<p class="image"><img src="images/000745.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1162"></a><strong class="calibre9">Figure 5-42</strong> Convolution relationships of <em class="calibre7">h</em>(<em class="calibre7">k</em>), <em class="calibre7">x</em>(<em class="calibre7">k</em>), <em class="calibre7">H</em>(<em class="calibre7">m</em>), and <em class="calibre7">X</em>(<em class="calibre7">m</em>) from <a href="#calibre_link-1152">Figure 5-38</a>.</p>
<p class="image"><img src="images/000123.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Because of the duality of the convolution theorem, we could have swapped the time and frequency domains in our discussion of convolution and multiplication being a Fourier transform pair. This means that, similar to <a href="#calibre_link-1157">Eq. (5-31)</a>, we can also write</p>
<p class="caption"><a id="calibre_link-1166"></a>(5-32)</p>
<p class="image"><img src="images/001621.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So the convolution theorem can be stated more generally as <em class="calibre7">Convolution in one domain is equivalent to multiplication in the other domain</em>. <a href="#calibre_link-1165">Figure 5-43</a> <a id="calibre_link-2242"></a>shows the relationship between multiplication in the time domain and convolution in the frequency domain. <a href="#calibre_link-1166">Equation (5-32)</a> is the fundamental relationship used in the process of windowing time-domain data to reduce DFT leakage, as discussed in <a href="#calibre_link-594">Section 3.9</a>.</p>
<p class="caption"><a id="calibre_link-1165"></a><strong class="calibre9">Figure 5-43</strong> Relationships of the convolution theorem related to multiplication in the time domain.</p>
<p class="image"><img src="images/000961.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2687"></a></p>
<h4 class="calibre13">5.9.3 Applying the Convolution Theorem</h4>
<p class="calibre3">The convolution theorem is useful as a qualitative tool in predicting the effects of different operations in discrete linear time-invariant systems. For example, many authors use the convolution theorem to show why periodic sampling of continuous signals results in discrete samples whose spectra are periodic in the frequency domain. Consider the real continuous time-domain waveform in <a href="#calibre_link-1167">Figure 5-44(a)</a>, with the one-sided spectrum of bandwidth <em class="calibre7">B</em>. <a id="calibre_link-2688"></a>Being a real signal, of course, its spectrum is symmetrical about 0 Hz. (In <a href="#calibre_link-1167">Figure 5-44</a>, the large right-pointing arrows represent Fourier transform operations.) Sampling this waveform is equivalent to multiplying it by a sequence of periodically spaced impulses, <a href="#calibre_link-1167">Figure 5-44(b)</a>, whose values are unity. If we say that the sampling rate is <em class="calibre7">f<sub class="calibre12">s</sub></em> samples/second, then the sample period <em class="calibre7">t<sub class="calibre12">s</sub></em> = 1/<em class="calibre7">f<sub class="calibre12">s</sub></em> seconds. The result of this multiplication is the sequence of discrete time-domain impulses shown in <a href="#calibre_link-1167">Figure 5-44(c)</a>. We can use the convolution theorem to help us predict what the frequency-domain effect is of this multiplication in the time domain. From our theorem, we now realize that the spectrum of the time-domain product must be the convolution of the original spectra. Well, we know what the spectrum of the original continuous waveform is. What about the spectrum of the time-domain impulses? It has been shown that the spectrum of periodic impulses, whose period is <em class="calibre7">t<sub class="calibre12">s</sub></em> seconds, is also periodic impulses in the frequency domain with a spacing of <em class="calibre7">f<sub class="calibre12">s</sub></em> Hz as shown in <a href="#calibre_link-1167">Figure 5-44(b)</a><a href="#calibre_link-1168">[30]</a>.</p>
<p class="caption"><a id="calibre_link-1167"></a><strong class="calibre9">Figure 5-44</strong> Using convolution to predict the spectral replication effects of periodic sampling.</p>
<p class="image"><img src="images/000012.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Now, all we have to do is convolve the two spectra. In this case, convolution is straightforward because both of the frequency-domain functions are symmetrical about the zero-Hz point, and flipping one of them about zero Hz <a id="calibre_link-2689"></a>is superfluous. So we merely slide one of the functions across the other and plot the product of the two. The convolution of the original waveform spectrum and the spectral impulses results in replications of the waveform spectrum every <em class="calibre7">f<sub class="calibre12">s</sub></em> Hz, as shown in <a href="#calibre_link-1167">Figure 5-44(c)</a>. This discussion reiterates the fact that the DFT is always periodic with a period of <em class="calibre7">f<sub class="calibre12">s</sub></em> Hz.</p>
<p class="calibre3">Here’s another example of how the convolution theorem can come in handy when we try to understand digital signal processing operations. This author once used the theorem to resolve the puzzling result, at the time, of a triangular window function having its first frequency response null at twice the frequency of the first null of a rectangular window function. The question was “If a rectangular time-domain function of width <em class="calibre7">T</em> has its first spectral null at 1/<em class="calibre7">T</em> Hz, why does a triangular time-domain function of width <em class="calibre7">T</em> have its first spectral null at 2/T Hz?” We can answer this question by considering convolution in the time domain.</p>
<p class="calibre3">Look at the two rectangular time-domain functions shown in <a href="#calibre_link-1169">Figures 5-45(a)</a> and <a href="#calibre_link-1169">5-45(b)</a>. If their widths are each <em class="calibre7">T</em> seconds, their spectra are shown to have nulls at 1/<em class="calibre7">T</em> Hz as depicted in the frequency-domain functions in <a href="#calibre_link-1169">Figures 5-45(a)</a> and <a href="#calibre_link-1169">5-45(b)</a>. We know that the frequency magnitude responses will <a id="calibre_link-2690"></a>be the absolute value of the classic sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> function.<sup class="calibre10"><a id="calibre_link-1171"></a><a href="#calibre_link-1170">†</a></sup> If we convolve those two rectangular time-domain functions of width <em class="calibre7">T</em>, we’ll get the triangular function shown in <a href="#calibre_link-1169">Figure 5-45(c)</a>. Again, in this case, flipping one rectangular function about the zero time axis is unnecessary. To convolve them, we need only scan <a id="calibre_link-2211"></a>one function across the other and determine the area of their overlap. The time shift where they overlap the most happens to be a zero time shift. Thus, our resultant convolution has a peak at a time shift of zero seconds because there’s 100 percent overlap. If we slide one of the rectangular functions in either direction, the convolution decreases linearly toward zero. When the time shift is <em class="calibre7">T</em>/2 seconds, the rectangular functions have a 50 percent overlap. The convolution is zero when the time shift is <em class="calibre7">T</em> seconds&mdash;that’s when the two rectangular functions cease to overlap.</p>
<p class="footnotes"><a id="calibre_link-1170"></a><sup class="calibre11"><a href="#calibre_link-1171">†</a></sup> The sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em> function was introduced in our discussion of window functions in <a href="#calibre_link-594">Section 3.9</a> and is covered in greater detail in <a href="#calibre_link-597">Section 3.13</a>.</p>
<p class="caption"><a id="calibre_link-1169"></a><strong class="calibre9">Figure 5-45</strong> Using convolution to show that the Fourier transform of a triangular function has its first null at twice the frequency of the Fourier transform of a rectangular function.</p>
<p class="image"><img src="images/000855.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Notice that the triangular convolution result has a width of 2<em class="calibre7">T</em>, and that’s really the key to answering our question. Because convolution in the time domain is equivalent to multiplication in the frequency domain, the Fourier transform magnitude of our 2<em class="calibre7">T</em>-width triangular function is the |sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em>| in <a href="#calibre_link-1169">Figure 5-45(a)</a> times the |sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em>| in <a href="#calibre_link-1169">Figure 5-45(b)</a>, or the (sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em>)<sup class="calibre10">2</sup> function in <a href="#calibre_link-1169">Figure 5-45(c)</a>. If a triangular function of width 2T has its first frequency-domain null at 1/<em class="calibre7">T</em> Hz, then the same function of width <em class="calibre7">T</em> must have its first frequency null at 2/<em class="calibre7">T</em> Hz as shown in <a href="#calibre_link-1169">Figure 5-45(d)</a>, and that’s what we set out to show. Comparison of <a href="#calibre_link-1169">Figures 5-45(c)</a> and <a href="#calibre_link-1169">5-45(d)</a> illustrates a fundamental Fourier transform property that compressing a function in the time domain results in an expansion of its corresponding frequency-domain representation.</p>
<p class="calibre3">We cannot overemphasize the importance of the convolution theorem as an analysis tool. As an aside, for years I thought convolution was a process developed in the second half of the twentieth century to help us analyze discrete-time signal processing systems. Later I learned that statisticians had been using convolution since the late 1800s. In statistics the probability density function (PDF) of the sum of two random variables is the convolution of their individual PDFs.</p>
<p class="calibre3"><a id="calibre_link-615"></a></p>
<h3 class="calibre6">5.10 Analyzing FIR Filters</h3>
<p class="calibre3">There are two popular ways to analyze tapped-delay line, nonrecursive FIR filters. The first way uses continuous-time Fourier algebra, and the second way uses the discrete Fourier transform. (By “analyze an FIR filter” we mean determining the FIR filter’s frequency response based on known filter coefficients.) Let’s quickly review the two FIR filter analysis methods.</p>
<p class="calibre3"><a id="calibre_link-2691"></a></p>
<h4 class="calibre13">5.10.1 Algebraic Analysis of FIR Filters</h4>
<p class="calibre3">The algebraic method used to analyze nonrecursive FIR filters uses the discrete-time Fourier transform (DTFT) equation. Linear system theory tells us that the frequency response of a linear system (our filter) is the Fourier <a id="calibre_link-2692"></a>transform of that system’s impulse response. Because a tapped-delay line FIR filter’s impulse response is equal to its coefficient values, we proceed by expressing the Fourier transform of the filter’s coefficients. In <a href="#calibre_link-598">Section 3.14</a> we learned that we can describe the continuous Fourier transform of a discrete sequence using the DTFT expressed as</p>
<p class="caption"><a id="calibre_link-1172"></a>(5-33)</p>
<p class="image"><img src="images/000644.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Modifying <a href="#calibre_link-1172">Eq. (5-33)</a>’s notation to correspond to the DTFT of an FIR filter having <em class="calibre7">N</em> coefficients (impulse response) represented by <em class="calibre7">h</em>(<em class="calibre7">k</em>), where index <em class="calibre7">k</em> = 0, 1, 2, ..., <em class="calibre7">N</em>−1, we can express the filter’s complex frequency response as</p>
<p class="caption"><a id="calibre_link-1173"></a>(5-34)</p>
<p class="image"><img src="images/000875.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><em class="calibre7">H</em>(ω) is an (<em class="calibre7">N</em>−1)th-order polynomial, and this is why, for example, a 6-tap FIR filter is often called a <em class="calibre7">5th-order FIR filter.</em> In <a href="#calibre_link-1173">Eq. (5-34)</a> the digital frequency variable ω is continuous and ranges from 0 to 2π radians/sample, corresponding to a continuous-time frequency range of 0 to <em class="calibre7">f<sub class="calibre12">s</sub></em> Hz.</p>
<p class="calibre3">Let’s see how <a href="#calibre_link-1173">Eq. (5-34)</a> is used to determine the frequency response of an FIR filter. Assume we have a 4-tap FIR filter whose coefficients are <em class="calibre7">h</em>(<em class="calibre7">k</em>) = [0.2, 0.4, 0.4, 0.2]. In this case our continuous H(ω) equation becomes</p>
<p class="caption"><a id="calibre_link-1174"></a>(5-35)</p>
<p class="image"><img src="images/000536.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We can, if we wish, write the complex 3rd-order <a href="#calibre_link-1174">Eq. (5-35)</a> in rectangular form as</p>
<p class="caption"><a id="calibre_link-1175"></a>(5-36)</p>
<p class="image"><img src="images/001395.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Evaluating <a href="#calibre_link-1174">Eq. (5-35)</a>, or <a href="#calibre_link-1175">Eq. (5-36)</a>, and plotting the magnitude of the continuous complex <em class="calibre7">H</em>(ω) function results in the curve in <a href="#calibre_link-1176">Figure 5-46(a)</a>. To compute the continuous <em class="calibre7">H</em><sub class="calibre12">ø</sub>(ω) phase function, we merely take the arctangent of the ratio of the imaginary part over the real part of <em class="calibre7">H</em>(ω), yielding the <em class="calibre7">H</em><sub class="calibre12">ø</sub>(ω) phase response in <a href="#calibre_link-1176">Figure 5-46(b)</a>.</p>
<p class="caption"><a id="calibre_link-2126"></a><a id="calibre_link-1176"></a><strong class="calibre9">Figure 5-46</strong> FIR filter frequency response: (a) magnitude; (b) phase.</p>
<p class="image"><img src="images/001711.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">In practice, evaluating <a href="#calibre_link-1173">Eq. (5-34)</a> would be performed using some sort of commercial math software, where code must be written to compute a sampled version of the continuous <em class="calibre7">H</em>(ω). Rather than writing the code to implement <a href="#calibre_link-1173">Eq. (5-34)</a>, fortunately we can conveniently compute an FIR filter’s <em class="calibre7">H</em>(ω) frequency response using software that performs the discrete Fourier transform. That’s the subject we discuss next.</p>
<p class="calibre3"><a id="calibre_link-2693"></a></p>
<h4 class="calibre13">5.10.2 DFT Analysis of FIR Filters</h4>
<p class="calibre3">The most convenient way to determine an FIR filter’s frequency response is to perform the discrete Fourier transform (DFT) of the filter’s coefficients. This analysis method is popular because the DFT is built into most commercial signal processing software packages such as MathCAD, LabView, MATLAB, etc. (In fact, in a pinch, we can even compute DFTs with Microsoft Excel.) The DFT of an FIR filter’s coefficients is computed using</p>
<p class="caption"><a id="calibre_link-1177"></a>(5-37)</p>
<p class="image"><img src="images/000941.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">which we normally implement with the high-speed fast Fourier transform (FFT) algorithm. Variables <em class="calibre7">m</em> and <em class="calibre7">n</em> both range from 0 to <em class="calibre7">N</em>-1.</p>
<p class="calibre3">Ah, but there’s trouble in paradise because <a href="#calibre_link-1177">Eq. (5-37)</a> poses a problem. If we perform a 4-point DFT of the above 4-tap FIR filter coefficients, <em class="calibre7">h</em>(<em class="calibre7">k</em>) = [0.2, 0.4, 0.4, 0.2] as shown in <a href="#calibre_link-1178">Figure 5-47(a)</a>, we obtain the |<em class="calibre7">H</em>(<em class="calibre7">m</em>)| samples in <a href="#calibre_link-1178">Figure 5-47(b)</a>. That |<em class="calibre7">H</em>(<em class="calibre7">m</em>)| sequence reveals very little about the frequency response of the 4-tap FIR filter. We need more |<em class="calibre7">H</em>(<em class="calibre7">m</em>)| frequency-domain information. That is, we need improved frequency <em class="calibre7">resolution</em>.</p>
<p class="caption"><a id="calibre_link-2694"></a><a id="calibre_link-1178"></a><strong class="calibre9">Figure 5-47</strong> Four-tap FIR filter: (a) impulse response; (b) 4-point DFT frequency magnitude response.</p>
<p class="image"><img src="images/000733.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Fortunately we can obtain a finer-granularity version of <em class="calibre7">H</em>(<em class="calibre7">m</em>) by <em class="calibre7">zero padding</em> the <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients with zero-valued samples and performing a larger-sized DFT. <a href="#calibre_link-1179">Figure 5-48(a)</a> shows the 4-tap FIR filter’s coefficients padded with 60 zero-valued samples. Performing a 64-point DFT on that padded <em class="calibre7">h</em>(<em class="calibre7">k</em>) sequence yields the higher-resolution discrete |<em class="calibre7">H</em>(<em class="calibre7">m</em>)| magnitude response sequence shown in <a href="#calibre_link-1179">Figure 5-48(b)</a>. Sequence |<em class="calibre7">H</em>(<em class="calibre7">m</em>)| is, of course, computed using</p>
<p class="caption"><a id="calibre_link-2695"></a>(5-38)</p>
<p class="image"><img src="images/001285.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1179"></a><strong class="calibre9">Figure 5-48</strong> High-resolution FIR filter frequency response: (a) zero-padded <em class="calibre7">h(k)</em>; (b) discrete magnitude response; (c) phase response.</p>
<p class="image"><img src="images/001589.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">H</em><sub class="calibre12">real</sub>(<em class="calibre7">m</em>) and <em class="calibre7">H</em><sub class="calibre12">imag</sub>(<em class="calibre7">m</em>) are the real and imaginary parts computed using <a href="#calibre_link-1177">Eq. (5-37)</a>. The circular white dots in <a href="#calibre_link-1179">Figure 5-48(b)</a> correspond to the square dots in <a href="#calibre_link-1178">Figure 5-47(b)</a>.</p>
<p class="calibre3">Remember, now, a filter’s complex <em class="calibre7">H</em>(<em class="calibre7">m</em>) frequency response sequence is</p>
<p class="caption"><a id="calibre_link-2696"></a>(5-38′)</p>
<p class="image"><img src="images/000388.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">comprising a real-valued |<em class="calibre7">H</em>(<em class="calibre7">m</em>)| magnitude response times a complex <em class="calibre7">e</em><sup class="calibre10"><em class="calibre7">jH</em><sub class="calibre15">ø</sub>(<em class="calibre7">m</em>)</sup> phase response. The real-valued phase-angle samples, shown in <a href="#calibre_link-1179">Figure 5-48(c)</a>, are computed using</p>
<p class="caption"><a id="calibre_link-2697"></a>(5-39)</p>
<p class="image"><img src="images/001479.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So, our FIR filter analysis <em class="calibre7">rule of thumb</em> is to append a sequence of zero-valued samples (whose length is, say, 10<em class="calibre7">N</em>) to an <em class="calibre7">N</em>-tap filter’s <em class="calibre7">h</em>(<em class="calibre7">k</em>) impulse response. Appending those zero-valued samples is called <em class="calibre7">zero padding</em> the <em class="calibre7">h</em>(<em class="calibre7">k</em>) sequence. Next we compute the DFT of that padded sequence. Of course the <a id="calibre_link-2238"></a>final zero-padded sequence should have a length that is an integer power of two so that we can use the FFT to compute the high-resolution <em class="calibre7">H</em>(<em class="calibre7">m</em>).</p>
<p class="calibre3">By the way, it doesn’t matter if the zero-valued samples are placed before or after the original <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients prior to performing the DFT. The computed high-resolution |<em class="calibre7">H</em>(<em class="calibre7">m</em>)| magnitude sequence will be the same in either case, and the resulting <em class="calibre7">H</em><sub class="calibre12">ø</sub>(<em class="calibre7">m</em>) phase samples in the two cases will differ only by a constant phase angle. (The DFT shifting theorem discussed in <a href="#calibre_link-113">Section 3.6</a> explains why this is true.)</p>
<p class="calibre3"><a id="calibre_link-2698"></a></p>
<h4 class="calibre13">5.10.3 FIR Filter Group Delay Revisited</h4>
<p class="calibre3">We mentioned in <a href="#calibre_link-370">Section 5.8</a> how a constant time delay, what we formally refer to as <em class="calibre7"><a href="#calibre_link-363">group delay</a></em>, through a filter was crucial in many applications. A constant group delay means a filter has a linear phase response over its passband and will induce no phase distortion in its output signals. Here we explore the concept of group delay a bit further.</p>
<p class="calibre3"><a id="calibre_link-2380"></a>The group delay, as a function of frequency, of a filter having a frequency response of <em class="calibre7">H</em>(ω) = |<em class="calibre7">H</em>(ω)|<em class="calibre7">e</em><sup class="calibre10"><em class="calibre7">jH</em><sub class="calibre15">ø</sub>(ω)</sup> is the negative of the derivative of the filter’s <em class="calibre7">H</em><sub class="calibre12">ø</sub>(ω) phase response with respect to frequency ω and is expressed as</p>
<p class="caption"><a id="calibre_link-1182"></a>(5-40)</p>
<p class="image"><img src="images/000513.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where digital frequency ω is continuous and ranges from −π to π radians/sample, corresponding to a continuous-time frequency range of −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 to <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz. Because the dimensions of <em class="calibre7">H</em><sub class="calibre12">ø</sub>(ω) are radians, and the dimensions of ω are radians/sample, the dimensions of group delay <em class="calibre7">G</em>(ω) are time measured in samples. We graphically depict the notion of the group delay, for a lowpass filter, in <a href="#calibre_link-1180">Figure 5-49</a>.</p>
<p class="caption"><a id="calibre_link-1180"></a><strong class="calibre9">Figure 5-49</strong> FIR filter group delay derived from a filter’s phase response.</p>
<p class="image"><img src="images/000616.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">For example, the complex-valued frequency response of a <em class="calibre7">K</em>-tap moving average filter is</p>
<p class="caption"><a id="calibre_link-1181"></a>(5-41)</p>
<p class="image"><img src="images/000437.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where the subscript “ma” means moving average. As such, from <a href="#calibre_link-1181">Eq. (5-41)</a> the phase response of a <em class="calibre7">K</em> = 5-tap moving average filter is</p>
<p class="caption"><a id="calibre_link-2699"></a>(5-42)</p>
<p class="image"><img src="images/000413.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Using <a href="#calibre_link-1182">Eq. (5-40)</a>, the group delay of a <em class="calibre7">K</em> = 5-tap moving average filter is</p>
<p class="caption"><a id="calibre_link-2700"></a>(5-43)</p>
<p class="image"><img src="images/001264.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2239"></a>Luckily for us, <a href="#calibre_link-1182">Eq. (5-40)</a> becomes very simple to evaluate if an <em class="calibre7">N</em>-tap FIR filter’s <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients (impulse response samples) are symmetrical. By “symmetrical” we mean <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients that abide by</p>
<p class="caption"><a id="calibre_link-1183"></a>(5-44)</p>
<p class="image"><img src="images/000303.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where 0≤<em class="calibre7">k</em>≤(<em class="calibre7">N</em>−1)/2 when <em class="calibre7">N</em> is odd, and 0≤<em class="calibre7">k</em>≤(<em class="calibre7">N</em>/2)−1 when <em class="calibre7">N</em> is even. <a href="#calibre_link-1183">Equation (5-44)</a> merely means that the first coefficient equals the last coefficient, the second coefficient equals the next to the last coefficient, and so on. All of the FIR filters we’ve discussed, so far, fall into this category.</p>
<p class="calibre3">OK, here’s the point we’re making. For symmetrical-coefficient FIR filters that comply with <a href="#calibre_link-1183">Eq. (5-44)</a>, their group delay is simple to compute. The group delay of such filters, measured in samples, is a constant equal to half the number of delay elements in the filter’s tapped-delay line structure. That is,</p>
<p class="caption"><a id="calibre_link-1185"></a>(5-45)</p>
<p class="image"><img src="images/001141.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">D</em> is the number of unit-delay elements in the filter’s delay line. Measured in seconds, a symmetrical FIR filter’s group delay is</p>
<p class="caption"><a id="calibre_link-2701"></a>(5-46)</p>
<p class="image"><img src="images/000191.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">t<sub class="calibre12">s</sub></em> is the reciprocal of the filter’s <em class="calibre7">f<sub class="calibre12">s</sub></em> input signal sample rate.</p>
<p class="calibre3">We can now make the following all-encompassing statement: The group delay of a tapped-delay line FIR digital filter, whose impulse response is symmetric, is equal to</p>
<p class="caption"><a id="calibre_link-1184"></a>(5-47)</p>
<p class="image"><img src="images/001030.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">For our purposes, we view a linear-phase FIR filter’s group delay as simply the time delay through the filter. That is, if the group delay of a filter is <em class="calibre7">G</em> samples, then the filter’s output sequence is delayed by <em class="calibre7">G</em> samples relative the filter’s input sequence.</p>
<p class="calibre3">It’s worth mentioning at this point that although we have not yet discussed such filter networks, if a tapped-delay line (FIR) network has an antisymmetrical impulse response defined by</p>
<p class="caption"><a id="calibre_link-2702"></a>(5-48)</p>
<p class="image"><img src="images/000083.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where 0≤<em class="calibre7">k</em>≤(<em class="calibre7">N</em>−1)/2 when <em class="calibre7">N</em> is odd and 0≤<em class="calibre7">k</em>≤(<em class="calibre7">N</em>/2)−1 when <em class="calibre7">N</em> is even, such a network also has a linear phase response and its group delay is also described by <a href="#calibre_link-1184">Eq. (5-47)</a>. Digital differentiators and Hilbert transformers, discussed in later chapters, fall into this category.</p>
<p class="calibre3"><a id="calibre_link-2237"></a>At this point, looking at <a href="#calibre_link-1185">Eq. (5-45)</a>, the DSP novice may wonder, “If <em class="calibre7">D</em> is an odd number, how is it possible to have a discrete signal sequence delayed by a noninteger number of samples?” The answer to this sensible question is illustrated in <a href="#calibre_link-1186">Figure 5-50</a>, where <em class="calibre7">x</em>(<em class="calibre7">n</em>) is a sinusoidal sequence applied to a symmetrical FIR filter having 6 taps (<em class="calibre7">D</em> = 5 delay elements in the tapped-delay line). There we see that the sinusoidal sequence is preserved at the filter’s <em class="calibre7">y</em>(<em class="calibre7">n</em>) output and delayed relative to input <em class="calibre7">x</em>(<em class="calibre7">n</em>) by a group delay value of exactly 5/2 samples. In the lingo of digital filters, the behavior in <a href="#calibre_link-1186">Figure 5-50</a> is called <em class="calibre7">fractional delay.</em></p>
<p class="caption"><a id="calibre_link-1186"></a><strong class="calibre9">Figure 5-50</strong> Group delay of a 6-tap (5 delay elements) FIR filter.</p>
<p class="image"><img src="images/001475.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Again, constant group delay&mdash;linear phase&mdash;is a desirable filter property because the spectral components in the filter’s output signal will suffer no phase distortion. Stated in different words: all spectral components within a linear-phase filter’s passband will be delayed by the same amount of time as they pass through the filter. If a linear-phase filter’s input is a complicated digital communications signal, rich in spectral-phase complexity representing digital data, the spectral-phase relationships and the digital data are preserved undistorted at the filter’s output. Their linear-phase property is the reason we use FIR filters!</p>
<p class="calibre3"><a id="calibre_link-2703"></a></p>
<h4 class="calibre13">5.10.4 FIR Filter Passband Gain</h4>
<p class="calibre3">One FIR filter property that is of interest is the filter’s <em class="calibre7">passband gain</em>. The standard definition of passband gain is that it is the filter’s passband magnitude <a id="calibre_link-2203"></a>response level around which the passband ripple fluctuates, as shown by the lowpass filter in <a href="#calibre_link-1187">Figure 5-51</a> where the passband gain equals unity. In practice we design filters to have very small passband ripple, so a lowpass filter’s passband gain is roughly equal to its DC gain (gain at zero Hz), which is the sum of the filter’s impulse response sequence, i.e., the sum of the FIR filter’s coefficients. (We leave the proof of this as a homework problem.) Most commercial FIR filter design software packages compute filter coefficients such that their passband gain is unity.</p>
<p class="caption"><a id="calibre_link-1187"></a><strong class="calibre9">Figure 5-51</strong> FIR filter passband gain definition.</p>
<p class="image"><img src="images/000510.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2704"></a></p>
<h4 class="calibre13">5.10.5 Estimating the Number of FIR Filter Taps</h4>
<p class="calibre3">Our final topic regarding the analysis of FIR filters is: How do we estimate the number of filter taps (coefficients), <em class="calibre7">N</em>, that can satisfy a given frequency magnitude response of an FIR filter? Several authors have proposed empirical relationships for estimating <em class="calibre7">N</em> for traditional tapped-delay line lowpass FIR filters based on the desired passband ripple, stopband attenuation, and transition region width[<a href="#calibre_link-1188">24</a>,<a href="#calibre_link-1189">31</a>&ndash;<a href="#calibre_link-1190">33</a>]. A particularly simple expression proposed by Prof. Fred Harris for <em class="calibre7">N</em>, giving results consistent with other estimates for passband ripple values near 0.1 dB, is</p>
<p class="caption"><a id="calibre_link-125"></a>(5-49)</p>
<p class="image"><img src="images/000292.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">Atten</em> is the filter’s desired stopband attenuation measured in dB, and <em class="calibre7">f</em><sub class="calibre12">pass</sub> and <em class="calibre7">f</em><sub class="calibre12">stop</sub> are frequencies normalized to the <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate in Hz as illustrated in <a href="#calibre_link-1191">Figure 5-52</a>. For example, <em class="calibre7">f</em><sub class="calibre12">pass</sub> = 0.2 means that the continuous-time frequency of <em class="calibre7">f</em><sub class="calibre12">pass</sub> is 0.2<em class="calibre7">f<sub class="calibre12">s</sub></em> Hz.</p>
<p class="caption"><a id="calibre_link-1191"></a><strong class="calibre9">Figure 5-52</strong> Example FIR filter frequency definitions.</p>
<p class="image"><img src="images/001372.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">As an example, let’s obtain a rough estimate of the number of lowpass FIR filter taps (coefficients) needed to achieve the magnitude response shown in <a href="#calibre_link-1191">Figure 5-52</a>. Assuming <em class="calibre7">f<sub class="calibre12">s</sub></em> = 1000 Hz, we want the end of a lowpass filter’s passband to be at 250 Hz, the beginning of the stopband is 350 Hz, and we <a id="calibre_link-2705"></a>need a stopband attenuation of 48 dB. Applying those values to <a href="#calibre_link-125">Eq. (5-49)</a>, we have</p>
<p class="caption"><a id="calibre_link-2706"></a>(5-50)</p>
<p class="image"><img src="images/001791.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Taking the integer closest to 21.8, i.e., 22, we then state that the lowpass filter in <a href="#calibre_link-1191">Figure 5-52</a> can be built using a 22-tap FIR filter. We’ll use <a href="#calibre_link-125">Eq. (5-49)</a> many times in later chapters of this book.</p>
<p class="calibre3"><a id="calibre_link-616"></a></p>
<h3 class="calibre6">References</h3>
<p class="chapterendnote"><a id="calibre_link-1079"></a>[1] Shynk, J. J. “Adaptive IIR Filtering,” <em class="calibre7">IEEE ASSP Magazine,</em> April 1989.</p>
<p class="chapterendnote"><a id="calibre_link-2707"></a>[2] Laundrie, A. “Adaptive Filters Enable Systems to Track Variations,” <em class="calibre7">Microwaves &amp; RF,</em> September 1989.</p>
<p class="chapterendnote"><a id="calibre_link-2708"></a>[3] Bullock, S. R. “High Frequency Adaptive Filter,” <em class="calibre7">Microwave Journal,</em> September 1990.</p>
<p class="chapterendnote"><a id="calibre_link-2709"></a>[4] Haykin, S. S. <em class="calibre7">Adaptive Filter Theory</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1986.</p>
<p class="chapterendnote"><a id="calibre_link-1080"></a>[5] Goodwin, G. C., and Sin, K. S. <em class="calibre7">Adaptive Filtering Prediction and Control</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1984.</p>
<p class="chapterendnote"><a id="calibre_link-1100"></a>[6] Gibbs, J. W. <em class="calibre7">Nature,</em> Vol. 59, 1899, p. 606.</p>
<p class="chapterendnote"><a id="calibre_link-2710"></a>[7] Stockham, T. G. “High-Speed Convolution and Correlation with Applications to Digital Filtering,” <a href="#calibre_link-187">Chapter 7</a> in <em class="calibre7">Digital Processing of Signals,</em> ed. by B. Gold et al., McGraw-Hill, New York, 1969, pp. 203&ndash;232.</p>
<p class="chapterendnote"><a id="calibre_link-1101"></a>[8] Wait, J. V. “Digital Filters,” in <em class="calibre7">Active Filters: Lumped, Distributed, Integrated, Digital, and Parametric</em>, ed. by L. P. Huelsman, McGraw-Hill, New York, 1970, pp. 200&ndash;277.</p>
<p class="chapterendnote"><a id="calibre_link-2711"></a><a id="calibre_link-1109"></a>[9] Dolph, C. L. “A Current Distribution for Broadside Arrays Which Optimizes the Relationship Between Beam Width and Side-Lobe Level,” <em class="calibre7">Proceedings of the IRE,</em> Vol. 35, June 1946.</p>
<p class="chapterendnote"><a id="calibre_link-2712"></a>[10] Barbiere, D. “A Method for Calculating the Current Distribution of Chebyshev Arrays,” <em class="calibre7">Proceedings of the IRE,</em> Vol. 40, January 1952.</p>
<p class="chapterendnote"><a id="calibre_link-1110"></a>[11] Cook, C. E., and Bernfeld, M. <em class="calibre7">Radar Signals</em>, Academic Press, New York, 1967, pp. 178&ndash;180.</p>
<p class="chapterendnote"><a id="calibre_link-1112"></a>[12] Kaiser, J. F. “Digital Filters,” in <em class="calibre7">System Analysis by Digital Computer</em>, ed. by F. F. Kuo and J. F. Kaiser, John Wiley and Sons, New York, 1966, pp. 218&ndash;277.</p>
<p class="chapterendnote"><a id="calibre_link-1113"></a>[13] Williams, C. S. <em class="calibre7">Designing Digital Filters</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1986, p. 117.</p>
<p class="chapterendnote"><a id="calibre_link-1120"></a>[14] Harris, F. J. “On the Use of Windows for Harmonic Analysis with the Discrete Fourier Transform,” <em class="calibre7">Proceedings of the IEEE,</em> Vol. 66, No. 1, January 1978.</p>
<p class="chapterendnote"><a id="calibre_link-1128"></a>[15] McClellan, J. H., Parks, T. W., and Rabiner, L. R. “A Computer Program for Designing Optimum FIR Linear Phase Digital Filters,” <em class="calibre7">IEEE Trans. on Audio and Electroacoustics</em>, Vol. AU-21, No. 6, December 1973, p. 515.</p>
<p class="chapterendnote"><a id="calibre_link-1131"></a>[16] Rabiner, L. R., and Gold, B. <em class="calibre7">Theory and Application of Digital Signal Processing</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1975, p. 136.</p>
<p class="chapterendnote"><a id="calibre_link-1134"></a>[17] Parks, T. W., and McClellan, J. H. “Chebyshev Approximation for Nonrecursive Digital Filters with Linear Phase,” <em class="calibre7">IEEE Trans. on Circuit Theory</em>, Vol. CT-19, March 1972.</p>
<p class="chapterendnote"><a id="calibre_link-2713"></a>[18] McClellan, J. H., and Parks, T. W. “A Unified Approach to the Design of Optimum FIR Linear Phase Digital Filters,” <em class="calibre7">IEEE Trans. on Circuit Theory</em>, Vol. CT-20, November 1973.</p>
<p class="chapterendnote"><a id="calibre_link-1146"></a>[19] Rabiner, L. R., McClellan, J. H., and Parks, T. W. “FIR Digital Filter Design Techniques Using Weighted Chebyshev Approximation,” <em class="calibre7">Proceedings of the IEEE</em>, Vol. 63, No. 4, April 1975.</p>
<p class="chapterendnote"><a id="calibre_link-1132"></a>[20] Oppenheim, A. V., and Schafer, R. W. <em class="calibre7">Discrete Time Signal Processing</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1989, p. 478.</p>
<p class="chapterendnote"><a id="calibre_link-1135"></a>[21] Funderburk, D. M., and Park, S. “Implementation of a C-QUAM AM-Stereo Receiver Using a General Purpose DSP Device,” <em class="calibre7">RF Design</em>, June 1993.</p>
<p class="chapterendnote"><a id="calibre_link-2714"></a>[22] Harris Semiconductor Inc. “A Digital, 16-Bit, 52 Msps Halfband Filter,” <em class="calibre7">Microwave Journal</em>, September 1993.</p>
<p class="chapterendnote"><a id="calibre_link-2715"></a>[23] Ballanger, M. G. “Computation Rate and Storage Estimation in Multirate Digital Filtering with Half-Band Filters,” <em class="calibre7">IEEE Trans. on Acoust. Speech, and Signal Proc.,</em> Vol. ASSP-25, No. 4, August 1977.</p>
<p class="chapterendnote"><a id="calibre_link-1188"></a>[24] Crochiere, R. E., and Rabiner, L. R. “Decimation and Interpolation of Digital Signals&mdash;A Tutorial Review,” <em class="calibre7">Proceedings of the IEEE,</em> Vol. 69, No. 3, March 1981, p. 318.</p>
<p class="chapterendnote"><a id="calibre_link-1136"></a>[25] Ballanger, M. G., Daguet, J. L., and Lepagnol, G. P. “Interpolation, Extrapolation, and Reduction of Computational Speed in Digital Filters,” <em class="calibre7">IEEE Trans. on Acoust. Speech, and Signal Proc.,</em> Vol. ASSP-22, No. 4, August 1974.</p>
<p class="chapterendnote"><a id="calibre_link-2716"></a><a id="calibre_link-1158"></a>[26] Oppenheim, A. V., Willsky, A. S., and Young, I. T. <em class="calibre7">Signals and Systems</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1983, p. 212.</p>
<p class="chapterendnote"><a id="calibre_link-2717"></a>[27] Stearns, S. <em class="calibre7">Digital Signal Analysis</em>, Hayden Book Co., Rochelle Park, New Jersey, 1975, p. 93.</p>
<p class="chapterendnote"><a id="calibre_link-1201"></a>[28] Oppenheim, A. V., and Schafer, R. W. <em class="calibre7">Discrete Time Signal Processing</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1989, p. 58.</p>
<p class="chapterendnote"><a id="calibre_link-1159"></a>[29] Rabiner, L. R., and Gold, B. <em class="calibre7">Theory and Application of Digital Signal Processing</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1975, p. 59.</p>
<p class="chapterendnote"><a id="calibre_link-1168"></a>[30] Oppenheim, A. V., Willsky, A. S., and Young, I. T. <em class="calibre7">Signals and Systems</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1983, p. 201.</p>
<p class="chapterendnote"><a id="calibre_link-1189"></a>[31] Rorabaugh, C. <em class="calibre7">DSP Primer</em>, McGraw-Hill, New York, 1999, pp. 278&ndash;279.</p>
<p class="chapterendnote"><a id="calibre_link-2718"></a>[32] Kaiser, J. “Nonrecursive Digital Filter Design Using Io-Sinh Window Function,” <em class="calibre7">Proc. 1974 IEEE Int. Symp. Circuits Systems</em>, April 1974, pp. 20&ndash;23.</p>
<p class="chapterendnote"><a id="calibre_link-1190"></a>[33] Harris, F. <em class="calibre7">Multirate Signal Processing for Communication Systems</em>, Prentice Hall, Upper Saddle River, New Jersey, 2004, pp. 56&ndash;57.</p>
<p class="calibre3"><a id="calibre_link-617"></a></p>
<h3 class="calibre6"><a id="calibre_link-2719" class="calibre5"></a>Chapter 5 Problems</h3>
<p class="indenthanging"><strong class="calibre9">5.1</strong> We first introduced the notion of <em class="calibre7"><a href="#calibre_link-1064">impulse response</a></em> in <a href="#calibre_link-286">Chapter 1</a>, and here in <a href="#calibre_link-79">Chapter 5</a> we discussed the importance of knowing the impulse response of FIR filter networks. With that said, if the <em class="calibre7">y</em>(<em class="calibre7">n</em>) output of a discrete system is equal to the system’s <em class="calibre7">x</em>(<em class="calibre7">n</em>) input sequence:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Draw the unit impulse response of such a system.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Draw the block diagram (structure) of that system.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> What is the frequency magnitude response of such a system? Prove your answer.</p>
<p class="indenthanging"><strong class="calibre9">5.2</strong> Consider a simple analog signal defined by <em class="calibre7">x</em>(<em class="calibre7">t</em>) = cos(2π800<em class="calibre7">t</em>) shown in <a href="#calibre_link-1192">Figure P5-2</a>. The FIR lowpass filter has a passband extending from −400 Hz to +400 Hz, a passband gain of unity, a transition region width of 20 Hz, and a stopband attenuation of 60 dB.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Draw the spectral magnitude of <em class="calibre7">x</em>(<em class="calibre7">n</em>) showing all spectral components in the range of −2<em class="calibre7">f<sub class="calibre12">s</sub></em> to +2<em class="calibre7">f<sub class="calibre12">s</sub></em>.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Draw the spectral magnitude of <em class="calibre7">y</em>(<em class="calibre7">n</em>) showing all spectral components in the range of −2<em class="calibre7">f<sub class="calibre12">s</sub></em> to +2<em class="calibre7">f<sub class="calibre12">s</sub></em>.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> What is the time-domain peak amplitude of the sinusoidal <em class="calibre7">y</em>(<em class="calibre7">n</em>) output?</p>
<p class="caption"><a id="calibre_link-1192"></a><strong class="calibre9">Figure P5-2</strong></p>
<p class="image"><img src="images/000512.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">5.3</strong> Assume we want to filter the audio signal from a digital video disc (DVD) player as shown in <a href="#calibre_link-1193">Figure P5-3</a>. The filtered audio signal drives, by way of a digital-to-analog (D/A) converter, a speaker. For the audio signal to have acceptable time synchronization with the video signal, video engineers have determined that the time delay of the filter must be no greater than 6×10<sup class="calibre10">−3</sup> seconds. If the <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate of the audio is 48 kHz, what is the maximum number of taps in the FIR filter that will satisfy the time delay restriction? (Assume a linear-phase FIR filter, and zero time delay through the D/A converter.)</p>
<p class="caption"><a id="calibre_link-2720"></a><a id="calibre_link-1193"></a><strong class="calibre9">Figure P5-3</strong></p>
<p class="image"><img src="images/001539.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">5.4</strong> There are times when we want to build a lowpass filter and a highpass filter that are <em class="calibre7">complementary</em>. By “complementary” we mean that a highpass filter’s passband covers the frequency range defined by a lowpass filter’s stopband range. This idea is illustrated in <a href="#calibre_link-1194">Figure P5-4(a)</a>. An example of such filters is an audio system, shown in <a href="#calibre_link-1194">Figure P5-4(b)</a>, where the low-frequency spectral components of an <em class="calibre7">x</em>(<em class="calibre7">n</em>) audio signal drive, by way of a digital-to-analog (D/A) converter, a low-frequency speaker (woofer). Likewise, the high-frequency spectral components of <em class="calibre7">x</em>(<em class="calibre7">n</em>) drive a high-frequency speaker (tweeter). Audio <a id="calibre_link-2721"></a>enthusiasts call <a href="#calibre_link-1194">Figure P5-4(b)</a> a “crossover” network. Assuming that the lowpass filter is implemented with a 15-tap FIR filter whose <em class="calibre7">h</em><sub class="calibre12">Low</sub>(<em class="calibre7">k</em>) coefficients are those in <a href="#calibre_link-1194">Figure P5-4(c)</a>, the complementary highpass filter will have the coefficients shown in <a href="#calibre_link-1194">Figure P5-4(d)</a>. Highpass coefficients <em class="calibre7">h</em><sub class="calibre12">High</sub>(<em class="calibre7">k</em>) are defined by</p>
<p class="image"><img src="images/000590.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1194"></a><strong class="calibre9">Figure P5-4</strong></p>
<p class="image"><img src="images/000566.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">Here is the problem: Draw a block diagram of a system that performs the process in <a href="#calibre_link-1194">P5-4(b)</a> where only the <em class="calibre7">h</em><sub class="calibre12">Low</sub>(<em class="calibre7">k</em>) lowpass FIR filter need be implemented.</p>
<p class="indenthanging"><strong class="calibre9">5.5</strong> Think about a discrete System A, shown in <a href="#calibre_link-1195">Figure P5-5</a>, that has an undesirable amplitude (gain) loss by a factor 0.5 (−6 dB), whose output requires lowpass linear-phase filtering. What can we do in the design of the lowpass FIR filter so the filter has an amplitude gain of 2 to compensate for System A’s amplitude loss?</p>
<p class="caption"><a id="calibre_link-1195"></a><strong class="calibre9">Figure P5-5</strong></p>
<p class="image"><img src="images/001427.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">5.6</strong> Let’s assume we have an <em class="calibre7">x</em>(<em class="calibre7">n</em>) time sequence, whose <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate is 20 kHz, and its |<em class="calibre7">X</em>(<em class="calibre7">f</em>)| spectral magnitude is that shown in <a href="#calibre_link-1196">Figure P5-6(a)</a>. We are required to design a linear-phase lowpass FIR filter that will attenuate the undesired high-frequency noise indicated in <a href="#calibre_link-1196">Figure P5-6(a)</a>. So we design a lowpass FIR filter whose frequency magnitude response is the |<em class="calibre7">H</em>(<em class="calibre7">f</em>)| shown in <a href="#calibre_link-1196">Figure P5-6(b)</a> and assume our filter design exercise is complete. Sometime later, unfortunately, we learn that the original <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence’s sample rate was <em class="calibre7">not</em> 20 kHz, but is in fact 40 kHz.</p>
<p class="caption"><a id="calibre_link-1196"></a><strong class="calibre9">Figure P5-6</strong></p>
<p class="image"><img src="images/000463.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">Here is the problem: What must we do to our lowpass filter’s <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients, originally designed based on a 20 kHz sample rate, so that they will still attenuate <em class="calibre7">x</em>(<em class="calibre7">n</em>)’s undesired high-frequency noise when the <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate is actually 40 kHz?</p>
<p class="indenthanging"><a id="calibre_link-2722"></a><strong class="calibre9">5.7</strong> Here is an interesting little problem. Think about applying the sinusoidal input sequence shown in <a href="#calibre_link-1197">Figure P5-7(a)</a> to an 8-point moving average FIR filter. The filter’s output sequence is that depicted in <a href="#calibre_link-1197">Figure P5-7(b)</a>.</p>
<p class="caption"><a id="calibre_link-1197"></a><strong class="calibre9">Figure P5-7</strong></p>
<p class="image"><img src="images/001318.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><a id="calibre_link-2723"></a><strong class="calibre9">(a)</strong> What characteristic of the filter’s frequency response causes the filter’s output sequence to go to all zeros as shown in <a href="#calibre_link-1197">Figure P5-7(b)</a>?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> In <a href="#calibre_link-1197">Figure P5-7(b)</a>, what do we call those initial nonzero-valued filter output samples?</p>
<p class="indenthanging"><strong class="calibre9">5.8</strong> Are abrupt (sudden) changes in the amplitude of a continuous, or discrete, signal associated with low or high frequencies?</p>
<p class="indenthanging"><strong class="calibre9">5.9</strong> Consider an FIR filter whose impulse response is shown in <a href="#calibre_link-1198">Figure P5-9(a)</a>. Given the <em class="calibre7">x</em>(<em class="calibre7">n</em>) filter input sequence shown in <a href="#calibre_link-1198">Figure P5-9(b)</a>:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the length, measured in samples, of the nonzero-valued samples of the filter’s output sequence?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What is the maximum sample value of the filter’s output sequence?</p>
<p class="caption"><a id="calibre_link-1198"></a><strong class="calibre9">Figure P5-9</strong></p>
<p class="image"><img src="images/000357.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">5.10</strong> Consider an FIR filter whose impulse response is that shown in <a href="#calibre_link-1199">Figure P5-10(a)</a>. Given the <em class="calibre7">x</em>(<em class="calibre7">n</em>) filter input sequence shown in <a href="#calibre_link-1199">Figure P5-10(b)</a>, draw the filter’s output sequence.</p>
<p class="caption"><a id="calibre_link-1199"></a><strong class="calibre9">Figure P5-10</strong></p>
<p class="image"><img src="images/001204.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><a id="calibre_link-2724"></a><strong class="calibre9">5.11</strong> Regarding the material in this chapter, it’s educational to revisit the idea of periodic sampling that was presented in <a href="#calibre_link-287">Chapter 2</a>. Think about a continuous <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal in <a href="#calibre_link-1200">Figure P5-11(a)</a> whose spectrum is depicted in <a href="#calibre_link-1200">Figure P5-11(b)</a>. Also, consider the continuous periodic infinitely narrow impulses, <em class="calibre7">s</em>(<em class="calibre7">t</em>), shown in <a href="#calibre_link-1200">Figure P5-11(c)</a>. Reference <a href="#calibre_link-1201">[28]</a> provides the algebraic acrobatics to show that the spectrum of <em class="calibre7">s</em>(<em class="calibre7">t</em>) is the continuous infinitely narrow impulses, <em class="calibre7">S</em>(<em class="calibre7">f</em>), shown in <a href="#calibre_link-1200">Figure P5-11(d)</a>. If we multiply the <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal by the <em class="calibre7">s</em>(<em class="calibre7">t</em>) impulses, we obtain the continuous <em class="calibre7">y</em>(<em class="calibre7">t</em>) = <em class="calibre7">s</em>(<em class="calibre7">t</em>)<em class="calibre7">x</em>(<em class="calibre7">t</em>) impulse signal shown by the arrows in <a href="#calibre_link-1200">Figure P5-11(e)</a>.</p>
<p class="caption"><a id="calibre_link-1200"></a><strong class="calibre9">Figure P5-11</strong></p>
<p class="image"><img src="images/000242.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">Now, if we use an analog-to-digital converter to represent those <em class="calibre7">y</em>(<em class="calibre7">t</em>) impulse values as a sequence of discrete samples, we obtain the <em class="calibre7">y</em>(<em class="calibre7">n</em>) sequence shown in <a href="#calibre_link-1200">Figure P5-11(f)</a>. Here is the problem: Briefly discuss what we learned in this <a href="#calibre_link-79">Chapter 5</a> that tells us the spectrum of the <em class="calibre7">y</em>(<em class="calibre7">n</em>) samples comprises periodic replications of the <em class="calibre7">X</em>(<em class="calibre7">f</em>) in <a href="#calibre_link-1200">Figure P5-11(b)</a>. Your brief discussion should confirm the material in <a href="#calibre_link-287">Chapter 2</a> which stated that discrete-time sequences have periodic (replicated) spectra.</p>
<p class="indenthanging"><a id="calibre_link-2725"></a><strong class="calibre9">5.12</strong> Now that we’re familiar with the powerful <em class="calibre7">convolution theorem</em>, think about the discrete system shown in <a href="#calibre_link-1202">Figure P5-12(a)</a>.</p>
<p class="caption"><a id="calibre_link-1202"></a><strong class="calibre9">Figure P5-12</strong></p>
<p class="image"><img src="images/000232.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">Given that <em class="calibre7">x</em>(<em class="calibre7">n</em>)’s spectrum is the <em class="calibre7">X</em>(<em class="calibre7">m</em>) shown in <a href="#calibre_link-1202">Figure P5-12(b)</a>:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Draw the <em class="calibre7">Y</em>(<em class="calibre7">m</em>) spectrum of sequence <em class="calibre7">y</em>(<em class="calibre7">n</em>). (We’re not worried about the vertical axis scale here, merely the frequency axis and spectral shape of <em class="calibre7">Y</em>(<em class="calibre7">m</em>).)</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Will aliasing errors occur in the <em class="calibre7">y</em>(<em class="calibre7">n</em>) = <em class="calibre7">x</em>(<em class="calibre7">n</em>)<sup class="calibre10">2</sup> output? (That is, will spectral replications in <em class="calibre7">Y</em>(<em class="calibre7">m</em>) overlap each other?)</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> What is <em class="calibre7">x</em>(<em class="calibre7">n</em>)’s maximum one-sided bandwidth that will avoid aliasing errors in <em class="calibre7">y</em>(<em class="calibre7">n</em>)? (Stated in different words, what is the maximum one-sided bandwidth of <em class="calibre7">x</em>(<em class="calibre7">n</em>) that will avoid overlapped spectral replications in <em class="calibre7">Y</em>(<em class="calibre7">m</em>)?)</p>
<p class="indenthanging"><strong class="calibre9">5.13</strong> It’s likely that you have heard of the process called <em class="calibre7">linear interpolation.</em> It’s a computationally simple (but not terribly accurate) scheme for estimating sample values of a continuous function in between some given <em class="calibre7">x</em>(<em class="calibre7">n</em>) sample values of that function. For the <em class="calibre7">x</em>(<em class="calibre7">n</em>) time samples in <a href="#calibre_link-1203">Figure P5-13(a)</a>, linear interpolation is the process of computing the intermediate <em class="calibre7">y</em>(<em class="calibre7">n</em>) samples shown as the black squares in <a href="#calibre_link-1203">Figure P5-13(b)</a>. That is, the interpolated sample <em class="calibre7">y</em>(1) is the value lying on the center of the straight line connecting <em class="calibre7">x</em>(0) and <em class="calibre7">x</em>(1), the interpolated sample <em class="calibre7">y</em>(2) is the value lying on the center of the straight line connecting <em class="calibre7">x</em>(1) and <em class="calibre7">x</em>(2), and so on. Given this process of linear interpolation:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the equation defining <em class="calibre7">y</em>(<em class="calibre7">n</em>) in terms of the <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> The implementation of linear interpolation is often called a <em class="calibre7">filter</em> because we build interpolators using tapped-delay line structures, just like standard FIR filter structures. Draw the block diagram of a linear interpolation <em class="calibre7">filter</em> that computes <em class="calibre7">y</em>(<em class="calibre7">n</em>) from the input <em class="calibre7">x</em>(<em class="calibre7">n</em>) sequence.</p>
<p class="caption"><a id="calibre_link-2726"></a><a id="calibre_link-1203"></a><strong class="calibre9">Figure P5-13</strong></p>
<p class="image"><img src="images/000138.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">5.14</strong> Consider a linear-phase lowpass FIR filter whose coefficients are</p>
<p class="center"><em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">k</em>) = [−0.8, 1.6, 25.5, 47, 25.5, 1.6, −0.8],</p>
<p class="indentpara">and whose DC gain, <em class="calibre7">H</em><sub class="calibre12">1</sub>(0), is equal to 99.6. If we change those coefficients to</p>
<p class="center"><em class="calibre7">h</em><sub class="calibre12">2</sub>(<em class="calibre7">k</em>) = [−0.8, 1.6, <em class="calibre7">Q</em>, 47, <em class="calibre7">Q</em>, 1.6, −0.8],</p>
<p class="indentpara">we obtain a new DC gain equal to 103.6. What is the value of <em class="calibre7">Q</em>?</p>
<p class="indenthanging"><strong class="calibre9">5.15</strong> <a href="#calibre_link-1204">Figure P5-15</a> shows a linear-phase 5-tap FIR filter.</p>
<p class="caption"><a id="calibre_link-1204"></a><strong class="calibre9">Figure P5-15</strong></p>
<p class="image"><img src="images/001294.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">DSP engineers always seek to reduce the number of multipliers in their systems. Redesign the filter in <a href="#calibre_link-1204">Figure P5-15</a> to a form that reduces the number of necessary multiplications per output sample. Draw the block diagram of your new design.</p>
<p class="indentpara"><strong class="calibre9">Hint:</strong> Write the difference equation for the <em class="calibre7">y</em>(<em class="calibre7">n</em>) output sequence, and recall the relationships between the filter’s coefficients.</p>
<p class="indenthanging"><a id="calibre_link-2727"></a><strong class="calibre9">5.16</strong> The two linear-phase lowpass filters in <a href="#calibre_link-1205">Figure P5-16</a> have very similar frequency responses, but those responses are not identical except at a single frequency. If we replaced Filter h<sub class="calibre12">1</sub> with Filter h<sub class="calibre12">2</sub> to reduce our filtering computational workload, determine the frequency, ω<sub class="calibre12">o</sub>, where the two <em class="calibre7">H</em><sub class="calibre12">1</sub>(ω) and <em class="calibre7">H</em><sub class="calibre12">2</sub>(ω) frequency responses are equal.</p>
<p class="indentpara"><strong class="calibre9">Hint:</strong> Begin by creating closed-form equations for <em class="calibre7">H</em><sub class="calibre12">1</sub>(ω) and <em class="calibre7">H</em><sub class="calibre12">2</sub>(ω) using the discrete-time Fourier transform (DTFT).</p>
<p class="caption"><a id="calibre_link-1205"></a><strong class="calibre9">Figure P5-16</strong></p>
<p class="image"><img src="images/000030.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">5.17</strong> The following is a useful problem regarding the 3-tap nonrecursive FIR filter shown in <a href="#calibre_link-1206">Figure P5-17(a)</a>. The problem’s solution shows us how to design computationally efficient narrowband-noise reduction filters. If |<em class="calibre7">h</em><sub class="calibre12">1</sub>| ≤ 2, the filter will have an |<em class="calibre7">H</em>(ω)| frequency magnitude response having two nulls at ±ω<sub class="calibre12">n</sub> as shown in <a href="#calibre_link-1206">Figure P5-17(b)</a>. (Here, the frequency axis value of π radians/sample corresponds to a cyclic frequency of half the sample rate, <em class="calibre7">f<sub class="calibre12">s</sub></em>/2.)</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Assume we have a low-frequency signal of interest that’s contaminated with high-level narrowband noise located at ±3.35 MHz when the sample rate is <em class="calibre7">f<sub class="calibre12">s</sub></em> = 8.25 MHz as shown in <a href="#calibre_link-1206">Figure P5-17(c)</a>. To attenuate that noise, for what value of <em class="calibre7">h</em><sub class="calibre12">1</sub> will the 3-tap FIR filter’s nulls be located at the noise center frequency of ±3.35 MHz? Show your work.</p>
<p class="indentpara1"><strong class="calibre9">Hint:</strong> Use the discrete-time Fourier transform (DTFT) of the filter’s impulse response to create a closed-form equation for the filter’s <em class="calibre7">H</em>(ω) frequency response in terms of the coefficient <em class="calibre7">h</em><sub class="calibre12">1</sub> and frequency ω. Next, obtain the expression for <em class="calibre7">h</em><sub class="calibre12">1</sub> in terms of the filter’s null frequency ω<sub class="calibre12">n</sub>.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What is the DC gain (gain at zero Hz) of our 3-tap FIR filter?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Explain why the filter has a linear, or nonlinear, phase response.</p>
<p class="caption"><a id="calibre_link-2728"></a><a id="calibre_link-1206"></a><strong class="calibre9">Figure P5-17</strong></p>
<p class="image"><img src="images/000873.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">5.18</strong> What characteristic must the coefficients of an FIR filter have to ensure that its frequency-domain phase response is a linear function of frequency (i.e., linear phase)?</p>
<p class="indenthanging"><strong class="calibre9">5.19</strong> Quickfilter Technologies Inc. produces a tapped-delay line FIR filter chip (Part #QF1D512) that has an astounding <em class="calibre7">N</em> = 512 taps. When a new filter input sample is applied to the chip, how many addition operations must this chip perform to compute a single filter output sample?</p>
<p class="indenthanging"><strong class="calibre9">5.20</strong> Intersil Corp. produces an HSP5021 <em class="calibre7">down-converter</em> integrated circuit containing a symmetrical-coefficient FIR filter having 255 taps. If the down-converter chip’s input signal sample rate is <em class="calibre7">f<sub class="calibre12">s</sub></em> = 8 MHz, what is the group delay (delay through the filter) of their 255-tap FIR filter measured in samples?</p>
<p class="indenthanging"><strong class="calibre9">5.21</strong> Assume we have digitized an analog signal at an <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate of 2×10<sup class="calibre10">6</sup> samples/second. Next we pass the samples through a 70-tap linear-phase lowpass FIR filter whose cutoff frequency (end of the passband) is 600 kHz. What would be the time delay, measured in seconds, between the lowpass filter’s input and output for a sinusoidal tone whose frequency is 200 kHz?</p>
<p class="indenthanging"><a id="calibre_link-2729"></a><strong class="calibre9">5.22</strong> Think about two linear-phase FIR filters whose frequency magnitude responses are shown in <a href="#calibre_link-1207">Figure P5-22</a>.</p>
<p class="caption"><a id="calibre_link-1207"></a><strong class="calibre9">Figure P5-22</strong></p>
<p class="image"><img src="images/001730.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Let’s assume that filter <em class="calibre7">H</em><sub class="calibre12">1</sub>(<em class="calibre7">f</em>) is a 17-tap FIR filter. What is the group delay of this linear-phase filter measured in samples?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Next, let’s assume that filter <em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">f</em>) is a 17-tap <em class="calibre7">half-band</em> FIR filter. <em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">f</em>), like all half-band FIR filters, has a gain of 0.5 at the frequency <em class="calibre7">f</em> = <em class="calibre7">f<sub class="calibre12">s</sub></em>/4. What is the group delay of this linear-phase <em class="calibre7">H</em><sub class="calibre12">2</sub>(<em class="calibre7">f</em>) filter, measured in samples?</p>
<p class="indenthanging"><strong class="calibre9">5.23</strong> Reverberation, a kind of echo, is a popular <em class="calibre7">audio effect</em> applied to guitar music. (Most commercial electric guitar amplifiers have a reverberation capability.) In the world of continuous signals reverberation is implemented with an analog delay line as shown in <a href="#calibre_link-1208">Figure P5-23(a)</a>. That analog delay line is typically a kind of <em class="calibre7">speaker</em> at one end of a coiled metal spring, and a kind of <em class="calibre7">microphone</em> at the other end of the spring. However, analog reverberation units have no convenient way to control the amount of time delay, and unfortunately their hardware is physically large.</p>
<p class="caption"><a id="calibre_link-1208"></a><strong class="calibre9">Figure P5-23</strong></p>
<p class="image"><img src="images/000753.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">Making use of digital signal processing on the other hand, the process of reverberation seems easy to implement using a delay line network like that shown in <a href="#calibre_link-1208">Figure P5-23(b)</a>. For the digital reverberation process to be usable, however, it must have a constant gain, where</p>
<p class="image"><img src="images/000572.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">over the full operating frequency range of the system. That is, we want our reverberator to have a flat frequency magnitude response. (By “Gain” we mean the steady-state gain after the delay line is filled with input samples.)</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Assume we have the <a href="#calibre_link-1208">Figure P5-23(b)</a> delay line with <em class="calibre7">N</em> = 8 delay elements. What is the <em class="calibre7">N</em> = 8 digital reverberator’s <em class="calibre7">h</em>(<em class="calibre7">n</em>) time-domain impulse response?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What is the equation for the digital reverberator’s |<em class="calibre7">H</em>(ω)| frequency magnitude response?</p>
<p class="indentpara1"><a id="calibre_link-2730"></a><strong class="calibre9">Hint:</strong> Use what you learned in <a href="#calibre_link-598">Section 3.14</a>, and don’t forget your trigonometric identities.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Draw a rough sketch of the |<em class="calibre7">H</em>(ω)| frequency magnitude response from Part (b). (This curve shows us how well simple digital delay-line reverberators work.)</p>
<p class="indenthanging"><strong class="calibre9">5.24</strong> There are digital filtering schemes that use the process conceptually shown in <a href="#calibre_link-1209">Figure P5-24(a)</a>. In that parallel-path filter the <em class="calibre7">x</em>(<em class="calibre7">n</em>) input is filtered to generate sequence <em class="calibre7">w</em>(<em class="calibre7">n</em>). The network’s <em class="calibre7">y</em>(<em class="calibre7">n</em>) output is the <em class="calibre7">x</em>(<em class="calibre7">n</em>) input sequence minus the <em class="calibre7">w</em>(<em class="calibre7">n</em>) sequence. The <em class="calibre7">w</em>(<em class="calibre7">n</em>) sequence is defined by</p>
<p class="center"><em class="calibre7">w</em>(<em class="calibre7">n</em>) = <em class="calibre7">x</em>(<em class="calibre7">n</em>) + 2<em class="calibre7">x</em>(<em class="calibre7">n</em>−2) + <em class="calibre7">x</em>(<em class="calibre7">n</em>−4).</p>
<p class="caption"><a id="calibre_link-1209"></a><strong class="calibre9">Figure P5-24</strong></p>
<p class="image"><img src="images/001611.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">The actual implementation of such a parallel-path filter is shown in <a href="#calibre_link-1209">Figure P5-24(b)</a> where the multi-element delay line in the upper path of <a href="#calibre_link-1209">Figure P5-24(b)</a> is needed for time alignment to compensate for the time delay of the bottom-path FIR filter. How many unit-delay elements must be used in the upper path in <a href="#calibre_link-1209">Figure P5-24(b)</a>?</p>
<p class="indenthanging"><a id="calibre_link-2731"></a><strong class="calibre9">5.25</strong> As we stated in <a href="#calibre_link-615">Section 5.10</a>, a lowpass FIR filter’s frequency magnitude response at zero Hz (DC) is equal to the sum of the filter’s impulse response samples (sum of the filter’s coefficients). Prove this important lowpass FIR filter property.</p>
<p class="indenthanging"><strong class="calibre9">5.26</strong> Although we didn’t state it explicitly in the text, the continuous frequency magnitude response of a symmetrical 7-tap FIR filter (for example, an FIR filter whose <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients are indexed as shown in <a href="#calibre_link-1210">Figure P5-26</a>) can be computed using</p>
<p class="image"><img src="images/001432.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1210"></a><strong class="calibre9">Figure P5-26</strong></p>
<p class="image"><img src="images/000634.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">(The normalized frequency range is −π ≤ ω ≤ π where ω is a continuous normalized angle with ω = π corresponding to a cyclic frequency of <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz.) There are two reasons we introduce the above |<em class="calibre7">H</em>(ω)| expression:</p>
<p class="indenthangingb1">• Such |<em class="calibre7">H</em>(ω)| equations can be used to compute the magnitude responses of linear-phase FIR filters, having an odd number of taps, when no FFT software routine is available.</p>
<p class="indenthangingb1">• You won’t be surprised when you see, in the literature of DSP, FIR filter frequency magnitude response equations such as the above summation of cosine functions.</p>
<p class="indentpara">Derive the general equation for the |<em class="calibre7">H</em>(ω)| for an <em class="calibre7">N</em>-tap symmetrical FIR filter’s magnitude response, when <em class="calibre7">N</em> is odd. Show your work.</p>
<p class="indentpara"><strong class="calibre9">Hint:</strong> Use what you learned in <a href="#calibre_link-598">Section 3.14</a>, and pay careful attention to the range of the <em class="calibre7">k</em> index in <a href="#calibre_link-1210">Figure P5-26</a>. Notice how <em class="calibre7">h</em>(0) is the center coefficient! Also, don’t forget our friend Leonhard Euler.</p>
<p class="indenthanging"><a id="calibre_link-2732"></a><strong class="calibre9">5.27</strong> Assume a commercial data acquisition device has the ability to implement a 191-tap digital FIR filter. What is the narrowest transition region width (<em class="calibre7">f</em><sub class="calibre12">stop</sub> − <em class="calibre7">f</em><sub class="calibre12">pass</sub>), stated in terms of <em class="calibre7">f<sub class="calibre12">s</sub></em>, we can expect to achieve for a lowpass FIR filter using this device if we desire at least 55 dB of stopband attenuation?</p>
<p class="indenthanging"><strong class="calibre9">5.28</strong> Texas Instruments Inc. produces a video processing chip (Part #TMS320DM646x) containing the FIR filter shown in <a href="#calibre_link-1211">Figure P5-28</a>. Coefficient <em class="calibre7">b</em>, defined by the user, controls the frequency magnitude response of the filter.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the time-domain difference equation for the filter?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Does the filter have a linear-phase frequency response? Justify your answer.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> What is the group delay of the filter measured in samples?</p>
<p class="caption"><a id="calibre_link-1211"></a><strong class="calibre9">Figure P5-28</strong></p>
<p class="image"><img src="images/000483.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">5.29</strong> Here is a fun problem proving that you have actually been performing convolutions since you were a child. Show how the multiplication (computing the product) of the two numbers 24 and 13 can be performed by convolving their digits.</p>
</div>


</body></html>
