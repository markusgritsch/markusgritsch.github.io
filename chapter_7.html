<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><title>Understanding Digital Signal Processing</title>
<style type="text/css">
body {
  font-family: "BookerlyLCD";
}
a {
  color: #005090;
  text-decoration: none;
}
a {font-variant-numeric: oldstyle-nums proportional-nums;}
p.caption {font-variant-numeric: oldstyle-nums proportional-nums;}
</style>
</head><body>


<div class="calibre" id="calibre_link-572">
<p class="calibre3"><a id="calibre_link-2482"></a></p>
<h2 class="calibre8"><a id="calibre_link-2483" class="calibre5"></a>Contents</h2>
<p class="toc-chapter"><strong class="calibre9"><a href="#calibre_link-632">7 SPECIALIZED DIGITAL NETWORKS AND FILTERS</a></strong></p>
<p class="toc-section"><a href="#calibre_link-193">7.1 Differentiators</a></p>
<p class="toc-section"><a href="#calibre_link-633">7.2 Integrators</a></p>
<p class="toc-section"><a href="#calibre_link-634">7.3 Matched Filters</a></p>
<p class="toc-section"><a href="#calibre_link-635">7.4 Interpolated Lowpass FIR Filters</a></p>
<p class="toc-section"><a href="#calibre_link-97">7.5 Frequency Sampling Filters: The Lost Art</a></p>
<p class="toc-section1"><a href="#calibre_link-636">References</a></p>

</div>


<div class="calibre" id="calibre_link-632">
<p class="calibre3"><a id="calibre_link-187"></a></p>
<h2 class="calibre8"><a id="calibre_link-2151" class="calibre5"></a>7 Specialized Digital Networks and Filters</h2>
<p class="image"><img src="images/001599.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We begin this chapter by presenting three useful digital networks&mdash;differentiators, integrators, and matched filters&mdash;that are common in the world of DSP. Beyond generic applications that require derivatives to be computed, differentiators are a key component of FM (frequency modulation) demodulation. A common application of integration is computing the integral of stock market prices over some period of days to determine trends in stock price data. Matched filters are used to detect the arrival of a specific discrete signal sequence, such as a radar return signal.</p>
<p class="calibre3">Later in this chapter we introduce two specialized implementations of finite impulse response (FIR) filters: interpolated lowpass FIR filters and frequency sampling filters. The common thread between these two FIR filter types is that they’re lean mean filtering machines. They wring every last drop of computational efficiency from a guaranteed-stable linear-phase filter. In many lowpass filtering applications these FIR filter types can attain greatly reduced computational workloads compared to the traditional Parks-McClellan-designed FIR filters discussed in <a href="#calibre_link-79">Chapter 5</a>.</p>
<p class="calibre3">We discuss this chapter’s specialized digital networks and FIR filters now because their behavior will be easier to understand using the <em class="calibre7">z</em>-transform concepts introduced in the last chapter.</p>
<p class="calibre3"><a id="calibre_link-193"></a></p>
<h3 class="calibre6">7.1 Differentiators</h3>
<p class="calibre3">This section focuses on simple tapped-delay line (FIR) differentiators. The idea of differentiation is well defined in the world of continuous (analog) signals, but the notion of derivatives is not strictly defined for discrete signals. However, fortunately we <em class="calibre7">can</em> approximate the calculus of a derivative <a id="calibre_link-2853"></a>operation in DSP. To briefly review the notion of differentiation, think about a continuous sinewave, whose frequency is ω radians/second, represented by</p>
<p class="caption"><a id="calibre_link-1650"></a>(7-1)</p>
<p class="image"><img src="images/000606.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The derivative of that sinewave is</p>
<p class="caption"><a id="calibre_link-2854"></a>(7-1′)</p>
<p class="image"><img src="images/000615.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So the derivative of a sinewave is a cosine wave whose amplitude is proportional to the original sinewave’s frequency. <a href="#calibre_link-1650">Equation (7-1)</a> tells us that an ideal digital differentiator’s frequency magnitude response is a straight line linearly increasing with frequency ω as shown in <a href="#calibre_link-1651">Figure 7-1(a)</a>. The differentiator’s phase is that shown in <a href="#calibre_link-1651">Figure 7-1(b)</a>, where the digital frequency ω = π radians/sample is equivalent to half the signal data sample rate in Hz (<em class="calibre7">f<sub class="calibre12">s</sub></em>/2).</p>
<p class="caption"><a id="calibre_link-1651"></a><strong class="calibre9">Figure 7-1</strong> Ideal differentiator frequency response: (a) magnitude; (b) phase in radians; (c) real part; (d) imaginary part.</p>
<p class="image"><img src="images/001396.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2048"></a>Given the magnitude and phase response of our ideal digital differentiator, we can draw the real and imaginary parts of its frequency response as shown in <a href="#calibre_link-1651">Figures 7-1(c)</a> and <a href="#calibre_link-1651">7-1(d)</a>. (The real part of the response is identically zero.) What we can say is that our ideal differentiator has the simple frequency response described, in rectangular form, by</p>
<p class="caption"><a id="calibre_link-1660"></a>(7-2)</p>
<p class="image"><img src="images/001474.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">With these thoughts in mind, let’s see how we can build a digital differentiator. We start by exploring two simple discrete-time FIR (nonrecursive) differentiators: a <em class="calibre7">first-difference</em> and a <em class="calibre7">central-difference</em> differentiator. They are computationally simple schemes for approximating the derivative of an <em class="calibre7">x</em>(<em class="calibre7">n</em>) time-domain sequence with respect to time.</p>
<p class="calibre3"><a id="calibre_link-2855"></a></p>
<h4 class="calibre13">7.1.1 Simple Differentiators</h4>
<p class="calibre3">With respect to the <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples in <a href="#calibre_link-1652">Figure 7-2(a)</a>, the <em class="calibre7">first-difference</em> differentiator is simply the process of computing the difference between successive <em class="calibre7">x</em>(<em class="calibre7">n</em>) <a id="calibre_link-2148"></a>samples. (While DSP purists prefer to use the terminology <em class="calibre7">digital differencer</em>, we’ll use the popular term <em class="calibre7">differentiator</em> for our purposes.) If we call <em class="calibre7">y</em><sub class="calibre12">Fd</sub>(<em class="calibre7">n</em>) the output of a first-difference differentiator, then <em class="calibre7">y</em><sub class="calibre12">Fd</sub>(<em class="calibre7">n</em>) is</p>
<p class="caption"><a id="calibre_link-2856"></a>(7-3)</p>
<p class="image"><img src="images/000813.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1652"></a><strong class="calibre9">Figure 7-2</strong> Simple differentiators.</p>
<p class="image"><img src="images/000436.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">For the <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples in <a href="#calibre_link-1652">Figure 7-2(b)</a>, the <em class="calibre7">central-difference</em> differentiator is the process of computing the average difference between alternate pairs of <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples. If we call <em class="calibre7">y</em><sub class="calibre12">Cd</sub>(<em class="calibre7">n</em>) the output of a central-difference differentiator, then <em class="calibre7">y</em><sub class="calibre12">Cd</sub>(<em class="calibre7">n</em>) is</p>
<p class="caption"><a id="calibre_link-2857"></a>(7-4)</p>
<p class="image"><img src="images/000840.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The two simple differentiators are implemented with tapped-delay line structures, just like our standard FIR filters in <a href="#calibre_link-79">Chapter 5</a>, as shown in <a href="#calibre_link-1652">Figure 7-2(c)</a>. (In fact, the two differentiators are merely two different forms of a comb filter, as discussed in detail in <a href="#calibre_link-1653">Section 7.5.1</a>, and this is why differentiators are often called <em class="calibre7">differentiating filters</em>.) So what’s the difference (no pun intended) between these two simple differentiators? They are different with respect to their frequency responses, which we now investigate.</p>
<p class="calibre3">The first-difference differentiator is the most fundamental notion of digital differentiation, i.e., computing the difference between successive samples of a discrete sequence. The problem with this differentiator is that many real-world signals have high-frequency spectral components consisting of noise, and the first-difference differentiator amplifies that noise. The frequency magnitude response of a first-difference differentiator is</p>
<p class="caption"><a id="calibre_link-2858"></a>(7-5)</p>
<p class="image"><img src="images/000139.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">as shown by the dashed curve in <a href="#calibre_link-1654">Figure 7-3</a>, where it has the characteristic of a highpass filter. (For comparison, we show an ideal differentiator’s straight-line |<em class="calibre7">H</em><sub class="calibre12">Ideal</sub>(ω)| = ω magnitude response in <a href="#calibre_link-1654">Figure 7-3</a>.) Looking at that dashed curve, we see how the first-difference differentiator tends to amplify high-frequency spectral components, and this may be detrimental because real-world signals often contain high-frequency noise.</p>
<p class="caption"><a id="calibre_link-1654"></a><strong class="calibre9">Figure 7-3</strong> Frequency magnitude responses of simple differentiators.</p>
<p class="image"><img src="images/001790.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The central-difference differentiator’s |<em class="calibre7">H</em><sub class="calibre12">Cd</sub>(ω)| frequency magnitude response, on the other hand, is</p>
<p class="caption"><a id="calibre_link-2859"></a>(7-6)</p>
<p class="image"><img src="images/000185.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">as shown by the dotted curve in <a href="#calibre_link-1654">Figure 7-3</a>, and this differentiator can be useful in that it tends to attenuate high-frequency (noise) spectral components. Looking at the |<em class="calibre7">H</em><sub class="calibre12">Cd</sub>(ω)| curve, we see that the price we pay for that high-frequency attenuation is a reduction in the frequency range over which the central-difference differentiator approaches an ideal differentiator’s linear <a id="calibre_link-2304"></a>|<em class="calibre7">H</em><sub class="calibre12">Ideal</sub>(ω)|. The central-difference differentiator’s linear range is from 0 to only, say, 0.2π radians/sample (0.1<em class="calibre7">f<sub class="calibre12">s</sub></em> Hz). The <em class="calibre7">useful</em> operating frequency ranges of the first-difference and central-difference differentiators are fairly narrow. This means the differentiators are only accurate when the spectral content of the input signal is low in frequency with respect to the input signal’s <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate.</p>
<p class="calibre3">Another dissimilarity between the <a href="#calibre_link-1652">Figure 7-2(c)</a> differentiators is their group delay. Because the impulse response (coefficients) of these tapped-delay line networks are antisymmetrical, both differentiators have linear phase responses, and thus both networks have a constant time delay (delay between the input and output, also called <em class="calibre7"><a href="#calibre_link-363">group delay</a></em>). Like the tapped-delay line FIR filters in <a href="#calibre_link-79">Chapter 5</a>, antisymmetrical-coefficient differentiators have a group delay (measured in samples) determined by</p>
<p class="caption"><a id="calibre_link-2860"></a>(7-7)</p>
<p class="image"><img src="images/001025.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">D</em> is the number of unit-delay elements in their tapped-delay lines. (<em class="calibre7">D</em> can also be viewed as one less than the length of the impulse response of a differentiator.) Hence the first-difference differentiator, where <em class="calibre7">D</em> = 1, has an input-to-output delay of 1/2 = 0.5 samples. The central-difference differentiator, where <em class="calibre7">D</em> = 2, has a group delay of 2/2 = 1 sample. Whether or not a differentiator’s time delay is an integer number of samples is very important in applications where multiple-signal sequences must be aligned (synchronized) in time. (An example of this integer-delay differentiation issue is the FM demodulator discussion in <a href="#calibre_link-314">Section 13.22</a>.)</p>
<p class="calibre3">DSP folk have improved, in certain respects, upon the above two computationally simple differentiators in an attempt to (1) extend the linear operating frequency range, (2) continue to attenuate high-frequency spectral <a id="calibre_link-2149"></a>components, and (3) keep the number of arithmetic computations as low as possible. It is to those specialized differentiators that we now turn our attention.</p>
<p class="calibre3"><a id="calibre_link-2861"></a></p>
<h4 class="calibre13">7.1.2 Specialized Narrowband Differentiators</h4>
<p class="calibre3">DSP pioneer Richard Hamming provided the following</p>
<p class="caption"><a id="calibre_link-1656"></a>(7-8)</p>
<p class="image"><img src="images/000077.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">as an expression to compute the coefficients of what he called “low-noise Lanczos,” differentiating filters having 2<em class="calibre7">M</em>+1 coefficients<a href="#calibre_link-1655">[1]</a>. Variable <em class="calibre7">k</em>, the integer index of those coefficients, ranges from −<em class="calibre7">M</em> to <em class="calibre7">M</em>. If we set <em class="calibre7">M</em> = 1 in <a href="#calibre_link-1656">Eq. (7-8)</a>, we obtain the coefficients of the standard central-difference differentiator in <a href="#calibre_link-1652">Figure 7-2(c)</a>. Assigning <em class="calibre7">M</em> = 2 to <a href="#calibre_link-1656">Eq. (7-8)</a> yields the coefficients</p>
<p class="caption"><a id="calibre_link-1658"></a>(7-9)</p>
<p class="image"><img src="images/000100.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">for a five-coefficient differentiator whose |<em class="calibre7">H</em><sub class="calibre12">L</sub>(ω)| magnitude response is the dotted curve in <a href="#calibre_link-1657">Figure 7-4</a>. The <em class="calibre7">h</em><sub class="calibre12">L</sub>(<em class="calibre7">k</em>) differentiator in <a href="#calibre_link-1658">Eq. (7-9)</a> is of interest because if we’re willing to multiply those coefficients by 10, we have a high-gain differentiator requiring only two multiplies per output sample. (Happily, those multiplications can be implemented with a binary arithmetic left shift, thus eliminating the multiplications altogether.) The disadvantage of this <em class="calibre7">h</em><sub class="calibre12">L</sub>(<em class="calibre7">k</em>) differentiator is that its linear operating frequency range is the smallest of any differentiator we’ve considered so far.</p>
<p class="caption"><a id="calibre_link-1657"></a><strong class="calibre9">Figure 7-4</strong> Frequency magnitude responses of Lanczos differentiators.</p>
<p class="image"><img src="images/000911.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Hamming presented two expressions for what he called “super Lanczos low-noise differentiators.” The first expression yielded the five-coefficient differentiator defined by</p>
<p class="caption"><a id="calibre_link-2862"></a>(7-10)</p>
<p class="image"><img src="images/001522.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">whose normalized |<em class="calibre7">H</em><sub class="calibre12">SL1</sub>(ω)| magnitude response is the long-dash curve in <a href="#calibre_link-1657">Figure 7-4</a>. The <em class="calibre7">h</em><sub class="calibre12">SL1</sub>(<em class="calibre7">k</em>) differentiator has a wider linear operating frequency range than the <em class="calibre7">h</em><sub class="calibre12">L</sub>(<em class="calibre7">k</em>) differentiator, but at the expense of degraded high-frequency attenuation. However, <em class="calibre7">h</em><sub class="calibre12">SL1</sub>(<em class="calibre7">k</em>) is also of interest because if we’re willing to multiply the coefficients by 6, we again have a high-gain differentiator requiring only two multiplies per output sample. (Again, those multiplications by ±8 can be implemented with binary arithmetic left shifts to eliminate the multiplication operations.)</p>
<p class="calibre3">Hamming’s second expression for a super Lanczos low-noise differentiator generated the seven-coefficient differentiator defined by</p>
<p class="caption"><a id="calibre_link-2863"></a>(7-11)</p>
<p class="image"><img src="images/000343.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2153"></a>whose normalized |<em class="calibre7">H</em><sub class="calibre12">SL2</sub>(ω)| magnitude response is the short-dash curve in <a href="#calibre_link-1657">Figure 7-4</a>. In terms of linear operating frequency range and high-frequency attenuation, the <em class="calibre7">h</em><sub class="calibre12">SL2</sub>(<em class="calibre7">k</em>) differentiator is a reasonable compromise between the <em class="calibre7">h</em><sub class="calibre12">L</sub>(<em class="calibre7">k</em>) and <em class="calibre7">h</em><sub class="calibre12">SL1</sub>(<em class="calibre7">k</em>) differentiators. Notice how the <em class="calibre7">h</em><sub class="calibre12">SL2</sub>(<em class="calibre7">k</em>) differentiator has a good high-frequency noise attenuation characteristic. Then again, in one respect, the <em class="calibre7">h</em><sub class="calibre12">SL2</sub>(<em class="calibre7">k</em>) differentiator is not all that <em class="calibre7">super</em> because it requires six multiplies per output sample. (We can do better. <a href="#calibre_link-705">Section 13.38</a> presents a very computationally efficient narrowband differentiator whose linear operating frequency range exceeds that of the <em class="calibre7">h</em><sub class="calibre12">SL1</sub>(<em class="calibre7">k</em>) differentiator.)</p>
<p class="calibre3">With the exception of the first-difference differentiator, after accounting for their constant integer group delays, all of the above differentiators achieve the ideal <em class="calibre7">H</em><sub class="calibre12">ideal</sub>(ω) phase response in <a href="#calibre_link-1651">Figure 7-1(b)</a>. In the next section we introduce high-performance wideband differentiators.</p>
<p class="calibre3"><a id="calibre_link-2864"></a></p>
<h4 class="calibre13">7.1.3 Wideband Differentiators</h4>
<p class="calibre3">Nonrecursive discrete-time differentiators having wider linear operating frequency ranges than the above simple differentiators can be built. All we must do is find the coefficients of a general <em class="calibre7">wideband</em> differentiator whose frequency magnitude response is shown in <a href="#calibre_link-1659">Figure 7-5(a)</a>, having a cutoff frequency of ω<sub class="calibre12">c</sub>.</p>
<p class="caption"><a id="calibre_link-1659"></a><strong class="calibre9">Figure 7-5</strong> Frequency response of a <em class="calibre7">general</em> wideband differentiator: (a) desired magnitude response; (b) 30 <em class="calibre7">h</em><sub class="calibre12">gen</sub>(<em class="calibre7">k</em>) coefficients; (c) actual magnitude response.</p>
<p class="image"><img src="images/001748.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We can derive an equation defining the <em class="calibre7">h</em><sub class="calibre12">gen</sub>(<em class="calibre7">k</em>) coefficients of a general wideband differentiator by defining those coefficients to be the inverse Fourier transform of our desired frequency response from <a href="#calibre_link-1660">Eq. (7-2)</a> of <em class="calibre7">H</em><sub class="calibre12">ideal</sub>(ω) = <em class="calibre7">j</em>ω for continuous ω defined over the range of −ω<sub class="calibre12">c</sub>≤ω≤ω<sub class="calibre12">c</sub>. Following this strategy, the coefficients of our general differentiator are given by</p>
<p class="caption"><a id="calibre_link-1661"></a>(7-12)</p>
<p class="image"><img src="images/001665.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2865"></a>We can perform the integration in <a href="#calibre_link-1661">Eq. (7-12)</a> using the dreaded (but useful) integration by parts method, or by searching our math reference books for a closed-form integral expression in the form of <a href="#calibre_link-1661">Eq. (7-12)</a><a href="#calibre_link-1662">[2]</a>. Being successful in this second approach, we find that the integral of (ω<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω<em class="calibre7">k</em></sup>)dω is (<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω<em class="calibre7">k</em></sup>) (<em class="calibre7">j</em>ω<em class="calibre7">k</em>−1)/(<em class="calibre7">jk</em>)<sup class="calibre10">2</sup>. Using this information, we can write</p>
<p class="caption"><a id="calibre_link-1663"></a>(7-13)</p>
<p class="image"><img src="images/001595.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where integer index <em class="calibre7">k</em> is −∞≤<em class="calibre7">k</em>≤∞, and <em class="calibre7">k</em> ≠ 0.</p>
<p class="calibre3">The real-valued <em class="calibre7">h</em><sub class="calibre12">gen</sub>(<em class="calibre7">k</em>) in <a href="#calibre_link-1663">Eq. (7-13)</a> can be used to compute the coefficients of a tapped-delay line digital differentiator. This expression, however, is based on the notion that we need an infinite number of differentiator coefficients to achieve the desired response in <a href="#calibre_link-1659">Figure 7-5(a)</a>. Because implementing <a id="calibre_link-2150"></a>an infinite-tap differentiator is not possible in our universe, <a href="#calibre_link-1659">Figure 7-5(b)</a> shows <a href="#calibre_link-1663">Eq. (7-13)</a> limited (truncated) to a manageable 30 coefficients, and <a href="#calibre_link-1659">Figure 7-5(c)</a> provides the frequency magnitude response of that 30-tap differentiator with ω<sub class="calibre12">c</sub> = 0.85π. (The ripples in that magnitude response are to be expected once we think about it. Truncation in one domain causes ripples in the other domain, right?)</p>
<p class="calibre3">As a brief aside, if we set ω<sub class="calibre12">c</sub> = π in <a href="#calibre_link-1663">Eq. (7-13)</a>, the coefficients of an <em class="calibre7">N</em>-coefficient differentiator become</p>
<p class="caption"><a id="calibre_link-1664"></a>(7-14)</p>
<p class="image"><img src="images/001548.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where −(<em class="calibre7">N</em>−1)/2≤<em class="calibre7">k</em>≤(<em class="calibre7">N</em>−1)/2, and <em class="calibre7">k</em> ≠ 0. When index <em class="calibre7">k</em> = 0, <em class="calibre7">h</em><sub class="calibre12">ω<sub class="calibre15">c</sub>=π</sub>(0) is set to zero. <a href="#calibre_link-1664">Equation (7-14)</a> is by far the most popular form given in the standard DSP textbooks for computing digital differentiator coefficients. Using <a href="#calibre_link-1664">Eq. (7-14)</a>, however, is only valid for even-order (<em class="calibre7">N</em> is odd) differentiators, and it is applicable only when the cutoff frequency is ω<sub class="calibre12">c</sub> = π (<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz).</p>
<p class="calibre3">So where do we stand regarding these wideband differentiators? We’ve obtained <a href="#calibre_link-1663">Eq. (7-13)</a> for computing the coefficients of a general wideband differentiator. Unfortunately that expression has a time-domain index (<em class="calibre7">k</em>) having negative values, which can be inconvenient to model using commercial signal processing software. We’ve discussed the widely disseminated <a href="#calibre_link-1664">Eq. (7-14)</a> and mentioned its limitations. Again, we can do better.</p>
<p class="calibre3">For a more useful form of an <em class="calibre7">h</em><sub class="calibre12">gen</sub>(<em class="calibre7">k</em>) expression for an arbitrary-length <em class="calibre7">N</em>-tap differentiator we propose the following:</p>
<p class="caption"><a id="calibre_link-1665"></a>(7-15)</p>
<p class="image"><img src="images/001031.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">M</em> = (<em class="calibre7">N</em>−1)/2, and 0≤<em class="calibre7">k</em>≤<em class="calibre7">N</em>−1. For odd <em class="calibre7">N</em> we set <em class="calibre7">h</em><sub class="calibre12">gen</sub>((<em class="calibre7">N</em>−1)/2), the center coefficient, to zero. <a href="#calibre_link-1665">Eq. (7-15)</a> looks a bit messy, but it’s quite practical because</p>
<p class="indenthangingb">• the differentiator passband width, ω<sub class="calibre12">c</sub>, is a design variable, and not fixed at ω<sub class="calibre12">c</sub> = π as in <a href="#calibre_link-1664">Eq. (7-14)</a>;</p>
<p class="indenthangingb">• the number of taps, <em class="calibre7">N</em>, can be odd or even; and</p>
<p class="indenthangingb">• the coefficient index <em class="calibre7">k</em> is never negative.</p>
<p class="calibre3">Fortunately, because of the range of index <em class="calibre7">k</em>, <a href="#calibre_link-1665">Eq. (7-15)</a> is straightforward to model using commercially available signal processing software.</p>
<p class="calibre3"><a id="calibre_link-2866"></a></p>
<h4 class="calibre13">7.1.4 Optimized Wideband Differentiators</h4>
<p class="calibre3">For completeness, we point out that the widely available Parks-McClellan algorithm can be used to design wideband digital differentiators whose performance is superior to those produced by <a href="#calibre_link-1665">Eq. (7-15)</a> when the number of taps <em class="calibre7">N</em> <a id="calibre_link-2344"></a>is greater than, say, 25. That behavior is illustrated in <a href="#calibre_link-1666">Figure 7-6</a>, where the solid curve shows the frequency magnitude response of an <em class="calibre7">N</em> = 30 Parks-McClellan-designed differentiator for ω<sub class="calibre12">c</sub> = 0.85π, and the bold dashed curve is an <em class="calibre7">N</em> = 30 differentiator designed using <a href="#calibre_link-1665">Eq. (7-15)</a>.</p>
<p class="caption"><a id="calibre_link-1666"></a><strong class="calibre9">Figure 7-6</strong> Frequency magnitude responses of 30-tap wideband differentiators.</p>
<p class="image"><img src="images/000774.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">What the DSP pioneers found, in studying the Parks-McClellan algorithm, is that it computes coefficients that provide more accurate differentiation when <em class="calibre7">N</em> is even as opposed to when <em class="calibre7">N</em> is odd. (However, we must keep in mind that the group delay through an even-tap differentiator is not an integer number of samples, and this could be troublesome in systems that require time synchronization among multiple signals.) Design curves showing the relative error for various-length even- and odd-<em class="calibre7">N</em> Parks-McClellan differentiators versus ω<sub class="calibre12">c</sub> are available[<a href="#calibre_link-1667">3</a>,<a href="#calibre_link-1668">4</a>].</p>
<p class="calibre3">Of course, windowing a wideband differentiator’s coefficients, using one of the common window sequences described in <a href="#calibre_link-134">Chapters 3</a> and <a href="#calibre_link-79">5</a>, will greatly reduce the ripples in a differentiator’s magnitude response. (Windowing in one domain reduces ripples in the other domain, right?) Improved magnitude response linearity, through time-domain windowing, comes at the expense of degrading the sharpness of the response’s transition region near ω<sub class="calibre12">c</sub>.</p>
<p class="calibre3"><a id="calibre_link-633"></a></p>
<h3 class="calibre6">7.2 Integrators</h3>
<p class="calibre3">The idea of integration is well defined in the domain of continuous (analog) signals, but not so clearly defined in the world of discrete signals. With that said, here we discuss approximating continuous integration by using digital filters that perform numerical integration of sampled signals. We’ll discuss digital integration networks whose outputs estimate the area under a continuous curve such as the <em class="calibre7">x</em>(<em class="calibre7">t</em>) function shown in <a href="#calibre_link-1669">Figure 7-7(a)</a>.</p>
<p class="caption"><a id="calibre_link-1669"></a><strong class="calibre9">Figure 7-7</strong> Integrator areas of summation.</p>
<p class="image"><img src="images/001630.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2867"></a></p>
<h4 class="calibre13"><a id="calibre_link-2346"></a>7.2.1 Rectangular Rule Integrator</h4>
<p class="calibre3">One simple way to estimate, to approximate, the area under the <em class="calibre7">x</em>(<em class="calibre7">t</em>) curve is to merely sum the <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples. Such a <em class="calibre7">rectangular rule</em> integrator computes the sum of the shaded rectangles shown in <a href="#calibre_link-1669">Figure 7-7(b)</a>. In the time domain we define the rectangular rule integrator, a running summation, as</p>
<p class="caption"><a id="calibre_link-1670"></a>(7-16)</p>
<p class="image"><img src="images/001672.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where the current sum, <em class="calibre7">y</em><sub class="calibre12">Re</sub>(<em class="calibre7">n</em>), is the previous <em class="calibre7">y</em><sub class="calibre12">Re</sub>(<em class="calibre7">n</em>−1) sum plus the current input sample <em class="calibre7">x</em>(<em class="calibre7">n</em>). When <em class="calibre7">n</em> = 2, for example, <a href="#calibre_link-1670">Eq. (7-16)</a> adds the area under the right-side shaded rectangle shown in <a href="#calibre_link-1669">Figure 7-7(b)</a> to the previous sum <em class="calibre7">y</em><sub class="calibre12">Re</sub>(1) to compute <em class="calibre7">y</em><sub class="calibre12">Re</sub>(2). The height and width of that right-side shaded rectangle are <em class="calibre7">x</em>(2) and one, respectively.</p>
<p class="calibre3"><a id="calibre_link-2347"></a>The frequency response of this rectangular rule integrator is</p>
<p class="caption"><a id="calibre_link-2868"></a>(7-16′)</p>
<p class="image"><img src="images/000158.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2869"></a></p>
<h4 class="calibre13">7.2.2 Trapezoidal Rule Integrator</h4>
<p class="calibre3">A useful area integration estimation scheme is the <em class="calibre7">trapezoidal rule</em> defined by</p>
<p class="caption"><a id="calibre_link-1671"></a>(7-17)</p>
<p class="image"><img src="images/001098.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">When <em class="calibre7">n</em> = 2, for example, <a href="#calibre_link-1671">Eq. (7-17)</a> computes the area (the average of <em class="calibre7">x</em>(2) + <em class="calibre7">x</em>(1)) under the right-side shaded trapezoid shown in <a href="#calibre_link-1669">Figure 7-7(c)</a> and adds that value to the previous <em class="calibre7">y</em><sub class="calibre12">Tr</sub>(1) to compute <em class="calibre7">y</em><sub class="calibre12">Tr</sub>(2). The frequency response of the trapezoidal rule integrator is</p>
<p class="caption"><a id="calibre_link-2870"></a>(7-17′)</p>
<p class="image"><img src="images/001745.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2871"></a></p>
<h4 class="calibre13">7.2.3 Simpson’s Rule Integrator</h4>
<p class="calibre3">A popular discrete-time integration scheme is <em class="calibre7">Simpson’s rule</em> defined by</p>
<p class="caption"><a id="calibre_link-2872"></a>(7-18)</p>
<p class="image"><img src="images/001212.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where three samples are used to compute the area under the single shaded curve in <a href="#calibre_link-1669">Figure 7-7(d)</a>. The frequency response of the Simpson’s rule integrator is</p>
<p class="caption"><a id="calibre_link-2873"></a>(7-18′)</p>
<p class="image"><img src="images/000251.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">(Simpson’s rule is named after the eighteenth-century English mathematician Thomas Simpson. Oddly enough, Simpson’s rule was actually developed by Sir Isaac Newton rather than Simpson. But don’t hold that against Simpson because the famous iterative method for finding the roots of a polynomial, called <em class="calibre7">Newton’s method</em>, was developed by Simpson!)</p>
<p class="calibre3">The above three time-domain integration approximations were developed using the principles of <em class="calibre7">polynomial curve fitting</em> where Simpson’s rule fits three signal samples to a second-order polynomial in <em class="calibre7">x</em>, the trapezoidal rule fits two samples to a first-order polynomial in <em class="calibre7">x</em>, and the rectangular rule uses a single sample in a zero-order polynomial in <em class="calibre7">x</em>.</p>
<p class="calibre3"><a id="calibre_link-2874"></a></p>
<h4 class="calibre13"><a id="calibre_link-2345"></a>7.2.4 Tick’s Rule Integrator</h4>
<p class="calibre3">For completeness, we point out an integration approximation similar to Simpson’s rule that you may encounter in the literature of DSP called <em class="calibre7">Tick’s rule</em>. It’s defined as</p>
<p class="caption"><a id="calibre_link-2875"></a>(7-19)</p>
<p class="image"><img src="images/001091.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">having a frequency response given by</p>
<p class="caption"><a id="calibre_link-2876"></a>(7-19′)</p>
<p class="image"><img src="images/000609.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The Tick’s rule integrator was designed to be especially accurate over the low-frequency range of 0≤ω≤π/2 radians/sample (zero to <em class="calibre7">f<sub class="calibre12">s</sub></em>/4 Hz) with little concern for its accuracy at higher frequencies<a href="#calibre_link-1672">[5]</a>.</p>
<p class="calibre3"><a id="calibre_link-2877"></a></p>
<h4 class="calibre13">7.2.5 Integrator Performance Comparison</h4>
<p class="calibre3">OK, so how well do the above discrete integrators perform? We can measure their performance by comparing their behavior to an ideal continuous (analog) integrator. Doing so, we first recall that the integral of the continuous function cos(ω<em class="calibre7">t</em>) is</p>
<p class="caption"><a id="calibre_link-2878"></a>(7-20)</p>
<p class="image"><img src="images/000985.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">telling us that if we apply a sinusoid to an ideal integrator, the output of the integrator will be a sinusoid, phase-shifted by −π/2 radians (−90°), whose amplitude is reduced by a factor of 1/ω. Thus the frequency magnitude response of an ideal integrator is |<em class="calibre7">H</em><sub class="calibre12">ideal</sub>| = |1/ω| as shown in <a href="#calibre_link-1673">Figure 7-8(a)</a>, and the integrator’s phase is that shown in <a href="#calibre_link-1673">Figure 7-8(b)</a>, where the digital frequency ω = π radians/sample is equivalent to half the signal data sample rate in Hz (<em class="calibre7">f<sub class="calibre12">s</sub></em>/2).</p>
<p class="caption"><a id="calibre_link-1673"></a><strong class="calibre9">Figure 7-8</strong> Ideal integrator frequency response: (a) magnitude; (b) phase in radians; (c) real part; (d) imaginary part.</p>
<p class="image"><img src="images/000655.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The frequency magnitude responses of an ideal integrator and our four digital integrators are shown in <a href="#calibre_link-1674">Figure 7-9</a> over various bandwidths in the positive-frequency range of 0≤ω≤π. For ease of comparison, the magnitude curves are all normalized so that their peak values, in the vicinity of ω = 0, are unity. (Note that the ideal integrator’s response curve in <a href="#calibre_link-1674">Figure 7-9(b)</a> is obscured by the Simpson’s rule and Tick’s rule curves.) What we see from <a href="#calibre_link-1674">Figure 7-9</a> is that the various integrators have very little difference over the ω frequency range of 0 to π/2 radians/sample (zero to <em class="calibre7">f<sub class="calibre12">s</sub></em>/4 Hz), but above that range there are meaningful differences that we’ll discuss in a moment.</p>
<p class="caption"><a id="calibre_link-1674"></a><strong class="calibre9">Figure 7-9</strong> Normalized frequency magnitude responses of four integrators.</p>
<p class="image"><img src="images/001511.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The magnitude response curves in <a href="#calibre_link-1674">Figure 7-9</a> are a bit difficult to interpret when a linear magnitude axis is used. With that thought in mind, <a href="#calibre_link-1675">Figure 7-10</a> <a id="calibre_link-2879"></a>shows the various integrators’ percent absolute errors using logarithmic axis scaling. We defined the percent absolute error as</p>
<p class="caption"><a id="calibre_link-2880"></a>(7-21)</p>
<p class="image"><img src="images/001505.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-1675"></a><strong class="calibre9">Figure 7-10</strong> Integrator absolute errors in percent.</p>
<p class="image"><img src="images/000547.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Looking at the error curves in <a href="#calibre_link-1675">Figure 7-10</a> might cause you to think, “These integrators aren’t very accurate. For example, the Simpson’s rule integrator has roughly a 7 percent error at ω = 0.5π (<em class="calibre7">f<sub class="calibre12">s</sub></em>/4 Hz).” Well, the situation is not as bad as it first appears. Looking at the ideal integrator’s response in <a href="#calibre_link-1674">Figure 7-9(a)</a>, we must realize that a 7 percent error of the small magnitude response values near ω = 0.5π is not nearly as significant as a 7 percent error for the larger magnitude response values below ω = 0.1π. So this means our <a id="calibre_link-2881"></a>simple integrators are quite accurate at low frequencies where we most need high accuracy.</p>
<p class="calibre3">What we learn from <a href="#calibre_link-1675">Figure 7-10</a> is that all of the digital integrators have good accuracy at low frequencies, with the Tick’s rule and Simpson’s rule integrators being the most accurate. (The phrase “low frequencies” means that the spectral components of the function, the signal, we are trying to integrate are low in frequency relative to the <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate.) However, if the integrators’ input signals have appreciable noise spectral components near <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz, <a id="calibre_link-2373"></a>the Tick’s rule and Simpson’s rule integrators will amplify that noise because those integrators have <em class="calibre7">z</em>-domain transfer function poles (infinite gain) at <em class="calibre7">z</em> = −1, corresponding to a cyclic frequency of <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz. In such high-frequency noise scenarios the rectangular or trapezoidal rule integrators should be used because they provide improved attenuation of spectral components in the vicinity of <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz.</p>
<p class="calibre3">The integrators that we’ve discussed are interesting because they are recursive networks and they all have linear phase. However, only the trapezoidal, Simpson’s, and Tick’s rule integrators achieve the ideal <em class="calibre7">H</em><sub class="calibre12">ideal</sub>(ω) phase response in <a href="#calibre_link-1673">Figure 7-8(b)</a>.</p>
<p class="calibre3">The above integrators all have <em class="calibre7">z</em>-domain transfer function poles at <em class="calibre7">z</em> = 1, corresponding to a cyclic frequency of zero Hz, and this has an important consequence when we implement integrators in digital hardware. Those poles force us to ensure that the numerical format of our integrator hardware can accommodate summation results when the <em class="calibre7">x</em>(<em class="calibre7">n</em>) input sequence has a nonzero average value (a constant amplitude bias). Stated in different words, the widths of our binary data registers must be large enough to guarantee that any nonzero amplitude bias on <em class="calibre7">x</em>(<em class="calibre7">n</em>) will not cause numerical overflow and corrupt the data within an integrator. <a href="#calibre_link-291">Chapter 10</a>’s discussion of cascaded integrator-comb (CIC) filters elaborates on this integrator data register width issue.</p>
<p class="calibre3"><a id="calibre_link-634"></a></p>
<h3 class="calibre6">7.3 Matched Filters</h3>
<p class="calibre3">In this section we introduce a signal processing operation known as <em class="calibre7">matched filtering</em>. A matched filter is a process that maximizes the signal-power-to-noise-power ratio (SNR) of its <em class="calibre7">y</em>(<em class="calibre7">t</em>) output when a specified <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">t</em>) signal of interest arrives at its input. Such a process is widely used in radar, sonar, oil exploration, digital communications systems, and frequency-domain processing of two-dimensional images. Those systems are designed to reliably detect (recognize) if, and at what instant in time or position in space, a well-defined <em class="calibre7">s</em>(<em class="calibre7">t</em>) signal of interest arrived at their inputs.</p>
<p class="calibre3">Matched filtering, for continuous signals, is depicted in <a href="#calibre_link-1676">Figure 7-11(a)</a>. In that figure the system’s <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">t</em>) input signal is an <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">t</em>) signal of interest, which may be a radar signal or perhaps a small portion of a digital communications signal, contaminated with an <em class="calibre7">x</em><sub class="calibre12">n</sub>(<em class="calibre7">t</em>) noise signal. The matched filter’s task is to maximize the SNR of the <em class="calibre7">y</em>(<em class="calibre7">t</em>) signal so that reliable detection of <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">t</em>) can be performed.</p>
<p class="caption"><a id="calibre_link-1676"></a><strong class="calibre9">Figure 7-11</strong> Matched filtering: (a) continuous signal implementation; (b) digital implementation with <em class="calibre7">h</em>(<em class="calibre7">k</em>) impulse response.</p>
<p class="image"><img src="images/001402.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2882"></a></p>
<h4 class="calibre13">7.3.1 Matched Filter Properties</h4>
<p class="calibre3">So the question is “What should the frequency response of the matched filter be to maximize our chances of detecting the presence of <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">t</em>) in the noisy <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">t</em>) <a id="calibre_link-2120"></a>signal?” The answer can be found in most communications textbooks<a href="#calibre_link-1677">[6]</a>, and here’s how we interpret that answer. Given the <em class="calibre7">S</em>(<em class="calibre7">f</em>) spectrum of <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">t</em>), the desire to maximize the SNR of <em class="calibre7">y</em>(<em class="calibre7">t</em>), lots of calculus, plus an application of Schwarz’s inequality, the optimum <em class="calibre7">H</em>(<em class="calibre7">f</em>) frequency response of the matched filter can be shown to be</p>
<p class="caption"><a id="calibre_link-1678"></a>(7-22)</p>
<p class="image"><img src="images/000682.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">T</em> is the time duration of the <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">t</em>) signal measured in seconds, and * signifies conjugation. <a href="#calibre_link-1678">Equation (7-22)</a> tells us that the optimum <em class="calibre7">H</em>(<em class="calibre7">f</em>) frequency response of the continuous matched filter should be the complex conjugate of the spectrum of our signal of interest multiplied by a phase shift that’s a linear function of frequency. Stated in different words, the time-domain impulse response of the optimum matched filter is the inverse Fourier transform of <em class="calibre7">S</em><sup class="calibre10">*</sup>(<em class="calibre7">f</em>) shifted in the negative-time direction by <em class="calibre7">T</em> seconds. We now provide a physical meaning of all of this as we determine how to implement a matched filter in discrete-time sampled systems.</p>
<p class="calibre3">To show how to build a digital (discrete-time) matched filter, as shown in <a href="#calibre_link-1676">Figure 7-11(b)</a>, first we need to determine the <em class="calibre7">h</em>(<em class="calibre7">k</em>) impulse response of the filter. Let’s make the following assumptions:</p>
<p class="indenthangingb">• Our discrete signal of interest is an <em class="calibre7">N</em>-sample <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>) sequence.</p>
<p class="indenthangingb">• <em class="calibre7">S</em>(<em class="calibre7">m</em>) is the <em class="calibre7">N</em>-point discrete Fourier transform (DFT) of <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>).</p>
<p class="indenthangingb">• <em class="calibre7">m</em> is the discrete frequency index 0 ≤ <em class="calibre7">m</em> ≤ <em class="calibre7">N</em>−1.</p>
<p class="indenthangingb">• The <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">n</em>) data input sample rate is <em class="calibre7">f<sub class="calibre12">s</sub></em> samples/second.</p>
<p class="calibre3"><a id="calibre_link-2374"></a>Under these assumptions we convert the continuous frequency <em class="calibre7">f</em> in <a href="#calibre_link-1678">Eq. (7-22)</a> to the DFT’s discrete frequencies of <em class="calibre7">mf<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em> to express the digital matched filter’s <em class="calibre7">H</em>(<em class="calibre7">m</em>) discrete frequency response as</p>
<p class="caption"><a id="calibre_link-1679"></a>(7-23)</p>
<p class="image"><img src="images/001321.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">T</em> is the time duration of the <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>) signal. OK, our next step is to define <em class="calibre7">T</em> such that the inverse DFT of <em class="calibre7">H</em>(<em class="calibre7">m</em>), our desired <em class="calibre7">h</em>(<em class="calibre7">k</em>), is the inverse DFT of <em class="calibre7">S</em><sup class="calibre10">*</sup>(<em class="calibre7">m</em>) shifted in the negative-time direction by an amount equal to the time duration of <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>). This sounds a bit complicated, but it’s really not so bad, as we shall see.</p>
<p class="calibre3">To determine <em class="calibre7">T</em> in <a href="#calibre_link-1679">Eq. (7-23)</a> we need to know how many sample periods (with 1/<em class="calibre7">f<sub class="calibre12">s</sub></em> being one period) comprise the time duration of an <em class="calibre7">N</em>-sample <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>) sequence. The answer is: The time duration of an <em class="calibre7">N</em>-sample discrete sequence is <em class="calibre7">N</em>−1 sample periods. (Readers should convince themselves that this is true.) So <em class="calibre7">T</em> in <a href="#calibre_link-1679">Eq. (7-23)</a> is (<em class="calibre7">N</em>−1)/<em class="calibre7">f<sub class="calibre12">s</sub></em> seconds, and we write the discrete frequency response of our discrete matched filter as</p>
<p class="caption"><a id="calibre_link-2883"></a>(7-24)</p>
<p class="image"><img src="images/000142.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Finally, our discrete matched filter’s <em class="calibre7">h</em>(<em class="calibre7">k</em>) impulse response is the <em class="calibre7">N</em>-point inverse DFT of <em class="calibre7">H</em>(<em class="calibre7">m</em>), which, from <a href="#calibre_link-295">Appendix C</a>, is merely the straight time reversal (left-to-right flip) of <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>). And there you have it&mdash;we express our optimum <em class="calibre7">h</em>(<em class="calibre7">k</em>) as</p>
<p class="caption"><a id="calibre_link-1680"></a>(7-25)</p>
<p class="image"><img src="images/000756.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">k</em> ranges from 0 to <em class="calibre7">N</em>−1. We struggled through the above process of developing <a href="#calibre_link-1680">Eq. (7-25)</a> so the reader would understand the origin of our expression for <em class="calibre7">h</em>(<em class="calibre7">k</em>).</p>
<p class="calibre3"><a id="calibre_link-2884"></a></p>
<h4 class="calibre13">7.3.2 Matched Filter Example</h4>
<p class="calibre3">As an example of matched filtering, <a href="#calibre_link-1681">Figure 7-12(a)</a> shows an <em class="calibre7">N</em> = 9 sample <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>) signal-of-interest sequence and the optimum <em class="calibre7">h</em>(<em class="calibre7">k</em>) matched filter impulse response. If the matched filter’s <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">n</em>) input contains two occurrences of <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>), as shown in <a href="#calibre_link-1681">Figure 7-12(b)</a>, the filter’s <em class="calibre7">y</em>(<em class="calibre7">n</em>) output will be the two pulses (each one symmetrical) shown in <a href="#calibre_link-1681">Figure 7-12(c)</a>. Our signal recognition process is then making sure the threshold detection process in <a href="#calibre_link-1676">Figure 7-11(a)</a> detects the high-level peaks in <em class="calibre7">y</em>(<em class="calibre7">n</em>). It’s useful to remind ourselves that the <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">n</em>) sequence enters the filter in a reversed order from that shown in <a href="#calibre_link-1681">Figure 7-12(b)</a>. That is, sample <em class="calibre7">x</em><sub class="calibre12">in</sub>(0) enters the filter first, followed by the <em class="calibre7">x</em><sub class="calibre12">in</sub>(1) sample, and so on. So the <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>) sequences within <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">n</em>), arriving at the filter’s input, are in the same left-right orientation as the filter’s <em class="calibre7">h</em>(<em class="calibre7">k</em>) impulse response.</p>
<p class="caption"><a id="calibre_link-1681"></a><strong class="calibre9">Figure 7-12</strong> Matched filtering example: (a) signal of interest <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>) and <em class="calibre7">h</em>(<em class="calibre7">k</em>); (b) filter <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">n</em>) input; (c) filter <em class="calibre7">y</em>(<em class="calibre7">n</em>) output.</p>
<p class="image"><img src="images/000444.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To show the value of matched filtering, <a href="#calibre_link-1682">Figure 7-13(a)</a> shows an <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">n</em>) input sequence, having two occurrences of the previous <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>), but this time <a id="calibre_link-2121"></a>badly contaminated with random noise. It’s very difficult to see the two <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>) sequences in <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">n</em>). In this noisy-signal case the filter’s <em class="calibre7">y</em>(<em class="calibre7">n</em>) output, shown in <a href="#calibre_link-1682">Figure 7-13(b)</a>, still distinctly exhibits the two peaks similar to the noise-free example in <a href="#calibre_link-1681">Figure 7-12(c)</a>. Actually, we should call the two peaks in <a href="#calibre_link-1681">Figure 7-12(c)</a> “correlation peaks” because our matched filter is performing a <a id="calibre_link-1959"></a>correlation between the <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">n</em>) input signal and the predefined <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>) signal of interest. The <em class="calibre7">y</em>(<em class="calibre7">n</em>) output is not the <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>) signal of interest&mdash;<em class="calibre7">y</em>(<em class="calibre7">n</em>) is a quantitative measure of the similarity between the <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">n</em>) input signal and <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>).</p>
<p class="caption"><a id="calibre_link-1682"></a><strong class="calibre9">Figure 7-13</strong> Matched filtering example: (a) filter <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">n</em>) input contaminated with noise; (b) filter <em class="calibre7">y</em>(<em class="calibre7">n</em>) output.</p>
<p class="image"><img src="images/001295.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2885"></a></p>
<h4 class="calibre13">7.3.3 Matched Filter Implementation Considerations</h4>
<p class="calibre3">There are a number of important topics to consider when implementing matched filters. They are:</p>
<p class="indenthangingb">• Matched filters are most conveniently implemented with tapped-delay line FIR filters like those we studied in <a href="#calibre_link-79">Chapter 5</a>. The <em class="calibre7">h</em>(<em class="calibre7">k</em>) sequence merely becomes the coefficients of the FIR filter. Again, our digital matched filter performs convolution of <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">n</em>) and <em class="calibre7">h</em>(<em class="calibre7">k</em>), which is equivalent to performing correlation between <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">n</em>) and <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>). In the 1980s the TRW LSI Products organization produced an integrated circuit that contained a 32-tap FIR architecture used for matched filtering. The chip was justifiably called a <em class="calibre7">digital correlator</em>.</p>
<p class="indenthangingb">• As we discussed in <a href="#calibre_link-1683">Section 5.9.2</a>, time-domain convolution can be implemented by way of frequency-domain multiplication. When the lengths of <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>) and <em class="calibre7">h</em>(<em class="calibre7">k</em>) are large (say, <em class="calibre7">N</em> &gt; 80) and forward and inverse FFTs are used, frequency-domain multiplication may be more computationally efficient than traditional time-domain convolution.</p>
<p class="indenthangingb">• The <em class="calibre7">H</em>(<em class="calibre7">m</em>) frequency response given in <a href="#calibre_link-1679">Eq. (7-23)</a> is based on two assumptions: (1) that the <em class="calibre7">x</em><sub class="calibre12">n</sub>(<em class="calibre7">n</em>) noise is truly random, having a flat-level broadband power spectrum, which means there is no correlation between one <em class="calibre7">x</em><sub class="calibre12">n</sub>(<em class="calibre7">n</em>) noise sample and any subsequent <em class="calibre7">x</em><sub class="calibre12">n</sub>(<em class="calibre7">n</em>+<em class="calibre7">k</em>) sample in <a href="#calibre_link-1676">Figure 7-11(b)</a>; and (2) the <em class="calibre7">x</em><sub class="calibre12">n</sub>(<em class="calibre7">n</em>) noise’s probability density function (PDF) is Gaussian in shape. Such noise is referred to as <em class="calibre7">additive white noise</em> (AWN). If the <em class="calibre7">x</em><sub class="calibre12">n</sub>(<em class="calibre7">n</em>) noise is not AWN, for example, when <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>) is a radio signal and <em class="calibre7">x</em><sub class="calibre12">n</sub>(<em class="calibre7">n</em>) is a high-level intentional jamming signal, or when <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>) is a single data symbol of a digital communications signal contaminated with some previous-in-time data symbol, then <a href="#calibre_link-1678">Eq. (7-22)</a> must be modified. References [<a href="#calibre_link-1684">7</a>&ndash;<a href="#calibre_link-1685">9</a>] provide additional information regarding this non-AWN scenario.</p>
<p class="indenthangingb">• Matched filtering is easy to perform. However, the detection threshold operation in <a href="#calibre_link-1676">Figure 7-11</a>, to detect the peaks in <a href="#calibre_link-1682">Figure 7-13(b)</a>, can become difficult to implement reliably depending on the nature of <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>), <em class="calibre7">x</em><sub class="calibre12">n</sub>(<em class="calibre7">n</em>), and the SNR of <em class="calibre7">x</em><sub class="calibre12">in</sub>(<em class="calibre7">n</em>). If we set the threshold too high, then we reduce our probability of detection by risking failure to detect <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>). If we set the threshold too low, then we increase our probability of false alarm by incorrectly identifying a noise spike in <em class="calibre7">y</em>(<em class="calibre7">n</em>) as an occurrence of our desired <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>). Advanced signal processing textbooks, by way of statistics and an abundance of probability theory, cover these topics. Representative descriptions of these concepts are provided in references[<a href="#calibre_link-1686">10</a>,<a href="#calibre_link-1687">11</a>].</p>
<p class="calibre3"><a id="calibre_link-635"></a></p>
<h3 class="calibre6"><a id="calibre_link-2324" class="calibre5"></a>7.4 Interpolated Lowpass FIR Filters</h3>
<p class="calibre3">In this section we cover a class of digital filters, called <em class="calibre7">interpolated FIR filters</em>, used to build narrowband lowpass FIR filters that can be more computationally efficient than the traditional Parks-McClellan-designed tapped-delay line FIR filters that we studied in <a href="#calibre_link-79">Chapter 5</a>. Interpolated FIR filters can reduce traditional narrowband lowpass FIR filter computational workloads by more than 80 percent. In their description, we’ll introduce interpolated FIR filters with a simple example, discuss how filter parameter selection is made, provide filter performance curves, and go through a simple lowpass filter design example showing their computational savings over traditional FIR filters[<a href="#calibre_link-1688">12</a>,<a href="#calibre_link-1689">13</a>].</p>
<p class="calibre3">Interpolated FIR (IFIR) filters are based upon the behavior of an <em class="calibre7">N</em>-tap nonrecursive linear-phase FIR filter when each of its unit delays is replaced with <em class="calibre7">M</em> unit delays, with the <em class="calibre7">expansion factor M</em> being an integer, as shown in <a href="#calibre_link-1690">Figure 7-14(a)</a>. If the <em class="calibre7">h</em><sub class="calibre12">p</sub>(<em class="calibre7">k</em>) impulse response of a 9-tap FIR filter is that shown in <a href="#calibre_link-1690">Figure 7-14(b)</a>, the impulse response of an <em class="calibre7">expanded</em> FIR filter, where for example <em class="calibre7">M</em> = 3, is the <em class="calibre7">h</em><sub class="calibre12">sh</sub>(<em class="calibre7">k</em>) in <a href="#calibre_link-1690">Figure 7-14(c)</a>. The <em class="calibre7">M</em> unit delays result in the <a id="calibre_link-2326"></a>zero-valued samples, the white dots, in the <em class="calibre7">h</em><sub class="calibre12">sh</sub>(<em class="calibre7">k</em>) impulse response. Our variable <em class="calibre7">k</em> is merely an integer time-domain index where 0 ≤ <em class="calibre7">k</em> ≤ <em class="calibre7">N</em>−1. To define our terminology, we’ll call the original FIR filter the <em class="calibre7">prototype</em> filter&mdash;that’s why we used the subscript “p” in <em class="calibre7">h</em><sub class="calibre12">p</sub>(<em class="calibre7">k</em>)&mdash;and we’ll call the filter with expanded delays the <em class="calibre7">shaping</em> subfilter. Soon we’ll see why this terminology is sensible.</p>
<p class="caption"><a id="calibre_link-1690"></a><strong class="calibre9">Figure 7-14</strong> Filter relationships: (a) shaping FIR filter with <em class="calibre7">M</em> unit delays between the taps; (b) impulse response of a prototype FIR filter; (c) impulse response of an expanded-delay shaping FIR filter with <em class="calibre7">M</em> = 3.</p>
<p class="image"><img src="images/001190.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We can express a prototype FIR filter’s <em class="calibre7">z</em>-domain transfer function as</p>
<p class="caption"><a id="calibre_link-1691"></a>(7-26)</p>
<p class="image"><img src="images/001389.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">N</em><sub class="calibre12">p</sub> is the length of <em class="calibre7">h</em><sub class="calibre12">p</sub>. The transfer function of a general shaping FIR filter, with <em class="calibre7">z</em> in <a href="#calibre_link-1691">Eq. (7-26)</a> replaced with <em class="calibre7">z<sup class="calibre10">M</sup></em>, is</p>
<p class="caption"><a id="calibre_link-1692"></a>(7-27)</p>
<p class="image"><img src="images/000330.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Later we’ll see why we chose to provide <a href="#calibre_link-1691">Eqs. (7-26)</a> and <a href="#calibre_link-1692">(7-27)</a>. If the number of coefficients in the prototype filter is <em class="calibre7">N</em><sub class="calibre12">p</sub>, the shaping filter has <em class="calibre7">N</em><sub class="calibre12">p</sub> nonzero coefficients and an expanded impulse response length of</p>
<p class="caption"><a id="calibre_link-1705"></a>(7-28)</p>
<p class="image"><img src="images/001658.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Later we’ll see how <em class="calibre7">N</em><sub class="calibre12">sh</sub> has an important effect on the implementation of IFIR filters.</p>
<p class="calibre3">The frequency-domain effect of those <em class="calibre7">M</em> unit delays is shown in <a href="#calibre_link-1693">Figure 7-15</a>. As we should expect, an <em class="calibre7">M</em>-fold expansion of the time-domain filter impulse response causes an <em class="calibre7">M</em>-fold compression (and repetition) of the frequency-domain |<em class="calibre7">H</em><sub class="calibre12">p</sub>(<em class="calibre7">f</em>)| magnitude response as in <a href="#calibre_link-1693">Figure 7-15(b)</a>. While <em class="calibre7">H</em><sub class="calibre12">p</sub>(<em class="calibre7">f</em>) has a single passband, <em class="calibre7">H</em><sub class="calibre12">sh</sub>(<em class="calibre7">f</em>) has <em class="calibre7">M</em> passbands. (The frequency axis of these curves is normalized to the <em class="calibre7">f<sub class="calibre12">s</sub></em> filter input signal sample rate. For example, the normalized frequency <em class="calibre7">f</em><sub class="calibre12">pass</sub> is equivalent to a frequency of <em class="calibre7">f</em><sub class="calibre12">pass</sub><em class="calibre7">f<sub class="calibre12">s</sub></em> Hz.) Those repetitive passbands in |<em class="calibre7">H</em><sub class="calibre12">sh</sub>(<em class="calibre7">f</em>)| centered about integer multiples of 1/<em class="calibre7">M</em> (<em class="calibre7">f<sub class="calibre12">s</sub></em>/<em class="calibre7">M</em> Hz) are called <em class="calibre7">images</em>, and on them we now focus our attention.</p>
<p class="caption"><a id="calibre_link-1693"></a><strong class="calibre9">Figure 7-15</strong> IFIR filter magnitude responses: (a) the prototype filter; (b) shaping subfilter; (c) image-reject subfilter; (d) final IFIR filter.</p>
<p class="image"><img src="images/001179.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we follow the shaping subfilter with a lowpass <em class="calibre7">image-reject</em> subfilter, <a href="#calibre_link-1693">Figure 7-15(c)</a>, whose task is to attenuate the image passbands, we can realize a multistage filter whose frequency response is shown in <a href="#calibre_link-1693">Figure 7-15(d)</a>. The resultant |<em class="calibre7">H</em><sub class="calibre12">ifir</sub>(<em class="calibre7">f</em>)| frequency magnitude response is, of course, the product</p>
<p class="caption"><a id="calibre_link-2886"></a>(7-29)</p>
<p class="image"><img src="images/001394.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The structure of the cascaded subfilters is the so-called IFIR filter shown in <a href="#calibre_link-1694">Figure 7-16(a)</a>, with its interpolated impulse response given in <a href="#calibre_link-1694">Figure 7-16(b)</a>.</p>
<p class="caption"><a id="calibre_link-2887"></a><a id="calibre_link-1694"></a><strong class="calibre9">Figure 7-16</strong> Lowpass interpolated FIR filter: (a) cascade structure; (b) resultant impulse response.</p>
<p class="image"><img src="images/000218.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2322"></a>If the original desired lowpass filter’s passband width is <em class="calibre7">f</em><sub class="calibre12">pass</sub>, its stopband begins at <em class="calibre7">f</em><sub class="calibre12">stop</sub>, and the transition region width is <em class="calibre7">f</em><sub class="calibre12">trans</sub> = <em class="calibre7">f</em><sub class="calibre12">stop</sub>−<em class="calibre7">f</em><sub class="calibre12">pass</sub>, then the prototype subfilter’s normalized frequency parameters are defined as</p>
<p class="caption"><a id="calibre_link-1706"></a>(7-30)</p>
<p class="image"><img src="images/000278.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2888"></a>(7-30′)</p>
<p class="image"><img src="images/001284.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2889"></a>(7-30″)</p>
<p class="image"><img src="images/001528.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The image-reject subfilter’s frequency parameters are</p>
<p class="caption"><a id="calibre_link-1707"></a>(7-31)</p>
<p class="image"><img src="images/001166.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2890"></a>(7-31′)</p>
<p class="image"><img src="images/000742.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The stopband attenuations of the prototype filter and image-reject subfilter are identical and set equal to the desired IFIR filter stopband attenuation. The word <em class="calibre7">interpolated</em> in the acronym IFIR is used because the image-reject subfilter interpolates samples in the prototype filter’s <em class="calibre7">h</em><sub class="calibre12">p</sub>(<em class="calibre7">k</em>) impulse response, making the overall IFIR filter’s impulse response equal to the <em class="calibre7">h</em><sub class="calibre12">ifir</sub>(<em class="calibre7">k</em>) sequence in <a href="#calibre_link-1695">Figure 7-34(b)</a>. Note that <em class="calibre7">h</em><sub class="calibre12">ifir</sub>(<em class="calibre7">k</em>) does not represent the coefficients used in any FIR subfilter filter. Sequence <em class="calibre7">h</em><sub class="calibre12">ifir</sub>(<em class="calibre7">k</em>) is the convolution of the shaping and image-reject subfilters’ impulse responses (coefficients). Some authors emphasize this attribute by referring to the image-reject subfilter as an <em class="calibre7">interpolator</em>. The <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate remains unchanged within an IFIR filter, so no actual signal interpolation takes place.</p>
<p class="calibre3">To give you an incentive to continue reading, the following example shows the terrific computational advantage of using IFIR filters. Consider the design of a <em class="calibre7">desired</em> linear-phase FIR filter whose normalized passband width is <em class="calibre7">f</em><sub class="calibre12">pass</sub> = 0.1, its passband ripple is 0.1 dB, the transition region width is <em class="calibre7">f</em><sub class="calibre12">trans</sub> = 0.02, and the stopband attenuation is 60 dB. (The passband ripple is a peak-peak specification measured in dB.) With an expansion factor of <em class="calibre7">M</em> = 3, the |<em class="calibre7">H</em><sub class="calibre12">p</sub>(<em class="calibre7">f</em>)| frequency magnitude response of the prototype filter is shown in <a href="#calibre_link-1696">Figure 7-17(a)</a>. The normalized frequency axis for these curves is such that a value of 0.5 on the abscissa represents the cyclic frequency <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz, half the sample rate. The frequency response of the shaping subfilter, for <em class="calibre7">M</em> = 3, is provided in <a href="#calibre_link-1696">Figure 7-17(b)</a> with an image passband centered about (1/<em class="calibre7">M</em>) Hz. The response of the image-reject subfilter is the solid curve in <a href="#calibre_link-1696">Figure 7-17(c)</a>, and the response of the overall IFIR filter is provided in <a href="#calibre_link-1696">Figure 7-17(d)</a>.</p>
<p class="caption"><a id="calibre_link-1696"></a><strong class="calibre9">Figure 7-17</strong> Example lowpass IFIR filter magnitude responses: (a) the prototype filter; (b) shaping subfilter; (c) image-reject subfilter; (d) final IFIR filter.</p>
<p class="image"><img src="images/000486.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Satisfying the original desired filter specifications in <a href="#calibre_link-1696">Figure 7-17(d)</a> would require a traditional tapped-delay FIR filter with <em class="calibre7">N</em><sub class="calibre12">tfir</sub> = 137 taps, where the “tfir” subscript means <em class="calibre7">traditional FIR</em>. In our IFIR filter, the shaping <a id="calibre_link-2325"></a>and the image-reject subfilters require <em class="calibre7">N</em><sub class="calibre12">p</sub> = 45 and <em class="calibre7">N</em><sub class="calibre12">ir</sub> = 25 taps respectively, for a total of <em class="calibre7">N</em><sub class="calibre12">ifir</sub> = 70 taps. We can define the percent reduction in computational workload (number of multiplies per filter output sample) of an IFIR filter, over a traditional tapped-delay line FIR filter, as</p>
<p class="caption"><a id="calibre_link-1702"></a>(7-32)</p>
<p class="image"><img src="images/000661.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">As such, the above example IFIR filter has achieved a multiplication computational workload reduction, over a traditional FIR filter, of</p>
<p class="caption"><a id="calibre_link-2891"></a>(7-32′)</p>
<p class="image"><img src="images/001300.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1696">Figure 7-17</a> shows how the transition region width (the shape) of |<em class="calibre7">H</em><sub class="calibre12">ifir</sub>(<em class="calibre7">f</em>)| is determined by the transition region width of |<em class="calibre7">H</em><sub class="calibre12">sh</sub>(<em class="calibre7">f</em>)|, and this justifies the decision to call <em class="calibre7">h</em><sub class="calibre12">sh</sub>(<em class="calibre7">k</em>) the <em class="calibre7">shaping</em> subfilter.</p>
<p class="calibre3"><a id="calibre_link-2892"></a></p>
<h4 class="calibre13">7.4.1 Choosing the Optimum Expansion Factor <em class="calibre7">M</em></h4>
<p class="calibre3">The expansion factor <em class="calibre7">M</em> deserves our attention because it can have a profound effect on the computational efficiency of IFIR filters. To show this, had we used <em class="calibre7">M</em> = 2 in our <a href="#calibre_link-1696">Figure 7-17</a> example, we would have realized an IFIR filter described by the <em class="calibre7">M</em> = 2 row in <a href="#calibre_link-1697">Table 7-1</a>. In that case the computation <a id="calibre_link-2204"></a>reduction over a conventional FIR filter is 43 percent. With <em class="calibre7">M</em> = 2, a reduced amount of frequency-domain compression occurred in <em class="calibre7">H</em><sub class="calibre12">sh</sub>(<em class="calibre7">f</em>), which mandated more taps in <em class="calibre7">h</em><sub class="calibre12">sh</sub>(<em class="calibre7">k</em>) than were needed in the <em class="calibre7">M</em> = 3 case.</p>
<p class="caption"><a id="calibre_link-1697"></a><strong class="calibre9">Table 7-1</strong> IFIR Filter Computation Reduction versus <em class="calibre7">M</em></p>
<p class="image"><img src="images/001485.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Now had <em class="calibre7">M</em> = 4 been used, the computation reduction, over a single traditional tapped-delay line FIR filter, would only be 8 percent as shown in <a href="#calibre_link-1697">Table 7-1</a>. This is because the <em class="calibre7">H</em><sub class="calibre12">sh</sub>(<em class="calibre7">f</em>) passband images would be so close together that a high-performance (increased number of taps) image-reject subfilter would be required. As so often happens in signal processing designs, there is a trade-off to be made. We would like to use a large value for <em class="calibre7">M</em> to compress the <em class="calibre7">H</em><sub class="calibre12">sh</sub>(<em class="calibre7">f</em>)’s transition region width as much as possible, but a large <em class="calibre7">M</em> reduces the transition region width of the image-reject subfilter, which increases the number of taps in <em class="calibre7">h</em><sub class="calibre12">ir</sub>(<em class="calibre7">k</em>) and its computational workload. In our <a href="#calibre_link-1696">Figure 7-17</a> IFIR filter example an expansion factor of <em class="calibre7">M</em> = 3 is optimum because it yields the greatest computation reduction over a traditional tapped-delay line FIR filter.</p>
<p class="calibre3">The optimum IFIR filter expansion factor was found by Mehrnia and Willson<a href="#calibre_link-1698">[14]</a> to be</p>
<p class="caption"><a id="calibre_link-1699"></a>(7-33)</p>
<p class="image"><img src="images/000120.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We’ll explore the meaning, and effects, of <a href="#calibre_link-1699">Eq. (7-33)</a> in the next few pages, but first let’s determine the percent computation reduction afforded to us by IFIR filters.</p>
<p class="calibre3"><a id="calibre_link-2893"></a></p>
<h4 class="calibre13">7.4.2 Estimating the Number of FIR Filter Taps</h4>
<p class="calibre3">To estimate the computation reduction achieved by using IFIR filters, an algorithm is needed to compute the number of taps, <em class="calibre7">N</em><sub class="calibre12">tfir</sub>, in a traditional tapped-delay line FIR filter. Several authors have proposed empirical relationships for estimating <em class="calibre7">N</em><sub class="calibre12">tfir</sub> for traditional tapped-delay line FIR filters based on passband ripple, stopband attenuation, and transition region width[<a href="#calibre_link-1700">15</a>−<a href="#calibre_link-1701">17</a>]. A particularly <a id="calibre_link-2329"></a>simple expression for <em class="calibre7">N</em><sub class="calibre12">tfir</sub>, giving results consistent with other estimates for passband ripple values near 0.1 dB, is</p>
<p class="caption"><a id="calibre_link-1482"></a>(7-34)</p>
<p class="image"><img src="images/000730.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">Atten</em> is the stopband attenuation measured in dB, and <em class="calibre7">f</em><sub class="calibre12">pass</sub> and <em class="calibre7">f</em><sub class="calibre12">stop</sub> are the normalized frequencies in <a href="#calibre_link-1693">Figure 7-15(d)</a><a href="#calibre_link-1701">[17]</a>. (Again, by “normalized” we mean that the <em class="calibre7">f</em><sub class="calibre12">pass</sub> and <em class="calibre7">f</em><sub class="calibre12">stop</sub> frequency values are normalized to the filter input sample rate, <em class="calibre7">f</em><sub class="calibre12">s</sub>, in Hz. For example, <em class="calibre7">f</em><sub class="calibre12">pass</sub> = 0.1 is equivalent to a continuous-time frequency of <em class="calibre7">f</em><sub class="calibre12">pass</sub> = 0.1<em class="calibre7">f</em><sub class="calibre12">s</sub> Hz.) Likewise, the number of taps in the prototype and image-reject subfilters can be estimated using</p>
<p class="caption"><a id="calibre_link-2894"></a>(7-34′)</p>
<p class="image"><img src="images/001063.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2895"></a>(7-34″)</p>
<p class="image"><img src="images/000188.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2896"></a></p>
<h4 class="calibre13">7.4.3 Modeling IFIR Filter Performance</h4>
<p class="calibre3">As it turns out, IFIR filter computational workload reduction depends on the expansion factor <em class="calibre7">M</em>, the passband width, and the transition region width of the desired IFIR filter. To show this, we substitute the above expressions for <em class="calibre7">N</em><sub class="calibre12">tfir</sub>, <em class="calibre7">N</em><sub class="calibre12">p</sub>, and <em class="calibre7">N</em><sub class="calibre12">ir</sub> into <a href="#calibre_link-1702">Eq. (7-32)</a> and write</p>
<p class="caption"><a id="calibre_link-1703"></a>(7-35)</p>
<p class="image"><img src="images/000810.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">f</em><sub class="calibre12">trans</sub> = <em class="calibre7">f</em><sub class="calibre12">stop</sub>−<em class="calibre7">f</em><sub class="calibre12">pass</sub>.</p>
<p class="calibre3">Having <a href="#calibre_link-1699">Eqs. (7-33)</a> and <a href="#calibre_link-1703">(7-35)</a> available to us, we can now see the performance of IFIR filters. The optimum expansion factor curves from <a href="#calibre_link-1699">Eq. (7-33)</a> are plotted, versus desired IFIR filter transition region width, for various values of passband width in <a href="#calibre_link-1704">Figure 7-18(a)</a>. When various optimum expansion factors are used in an IFIR filter design, the percent computation reduction, when an <em class="calibre7">M</em><sub class="calibre12">opt</sub> value is plugged into <a href="#calibre_link-1703">Eq. (7-35)</a>, is that shown in <a href="#calibre_link-1704">Figure 7-18(b)</a>.</p>
<p class="caption"><a id="calibre_link-1704"></a><strong class="calibre9">Figure 7-18</strong> IFIR filter performance versus desired transition region width for various passband widths: (a) optimum expansion factors; (b) percent computation reduction.</p>
<p class="image"><img src="images/000116.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So in IFIR filter design, we use our desired filter transition region width and passband width values to determine the <em class="calibre7">M</em><sub class="calibre12">opt</sub> optimum expansion factor using either <a href="#calibre_link-1699">Eq. (7-33)</a> or the curves in <a href="#calibre_link-1704">Figure 7-18(a)</a>. Given that <em class="calibre7">M</em><sub class="calibre12">opt</sub> value, we estimate our IFIR filter’s percent computation reduction from either <a href="#calibre_link-1703">Eq. (7-35)</a> or the curves in <a href="#calibre_link-1704">Figure 7-18(b)</a>. We’ll go through an IFIR filter design example shortly.</p>
<p class="calibre3"><a id="calibre_link-2897"></a></p>
<h4 class="calibre13"><a id="calibre_link-2059"></a>7.4.4 IFIR Filter Implementation Issues</h4>
<p class="calibre3">The computation reduction of IFIR filters is based on the assumption that they are implemented as two separate subfilters as in <a href="#calibre_link-1694">Figure 7-16</a>. We have resisted the temptation to combine the two subfilters into a single filter whose coefficients are the convolution of the subfilters’ impulse responses. Such a maneuver would eliminate the zero-valued coefficients of the shaping subfilter, and we’d lose all our desired computation reduction.</p>
<p class="calibre3">The curves in <a href="#calibre_link-1704">Figure 7-18(a)</a> indicate an important implementation issue when using IFIR filters. With decreasing IFIR filter passband width, larger expansion factors, <em class="calibre7">M</em>, can be used. When using programmable DSP chips, larger values of <em class="calibre7">M</em> require that a larger block of hardware <em class="calibre7">data memory</em>, in the form of a <em class="calibre7">circular buffer</em>, be allocated to hold a sufficient number of input <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples for the shaping subfilter. The size of this data memory must be equal to at least <em class="calibre7">N</em><sub class="calibre12">sh</sub> as indicated in <a href="#calibre_link-1705">Eq. (7-28)</a>. Some authors refer to this data memory allocation requirement, to accommodate all the stuffed zeros in the <em class="calibre7">h</em><sub class="calibre12">sh</sub>(<em class="calibre7">k</em>) impulse response, as a disadvantage of IFIR filters. This is a misleading viewpoint <a id="calibre_link-2270"></a>because, as it turns out, the <em class="calibre7">N</em><sub class="calibre12">sh</sub> length of <em class="calibre7">h</em><sub class="calibre12">sh</sub>(<em class="calibre7">k</em>) is only a few percent larger than the length of the impulse response of a traditional FIR filter having the same performance as an IFIR filter. So from a data storage standpoint the price we pay to use IFIR filters is a slight increase in the size of memory to accommodate <em class="calibre7">N</em><sub class="calibre12">sh</sub>, plus the data memory of size <em class="calibre7">K</em><sub class="calibre12">ir</sub> needed for the image-reject subfilter. In practice, for narrowband lowpass IFIR filters, <em class="calibre7">K</em><sub class="calibre12">ir</sub> is typically less than 10 percent of <em class="calibre7">N</em><sub class="calibre12">sh</sub>.</p>
<p class="calibre3">When implementing an IFIR filter with a programmable DSP chip, the filter’s computation reduction gain can only be realized if the chip’s architecture enables <em class="calibre7">zero-overhead looping</em> through the circular data memory using an increment equal to the expansion factor <em class="calibre7">M</em>. That looping capability ensures that only the nonzero-valued coefficients of <em class="calibre7">h</em><sub class="calibre12">sh</sub>(<em class="calibre7">k</em>) are used in the shaping subfilter computations.</p>
<p class="calibre3">In practice the shaping and image-reject subfilters should be implemented with a <em class="calibre7">folded</em> tapped-delay line FIR structure, exploiting their impulse response symmetry, to reduce the number of necessary multiplications by a factor of two. (See <a href="#calibre_link-148">Section 13.7</a>.) Using a folded structure does not alter the performance curves provided in <a href="#calibre_link-1704">Figure 7-18</a>. Regarding an IFIR filter’s implementation in fixed-point hardware, its sensitivity to coefficient quantization errors is no greater than the errors exhibited by traditional FIR filters<a href="#calibre_link-1688">[12]</a>.</p>
<p class="calibre3"><a id="calibre_link-2898"></a></p>
<h4 class="calibre13">7.4.5 IFIR Filter Design Example</h4>
<p class="calibre3">The design of practical lowpass IFIR filters is straightforward and comprises four steps:</p>
<p class="indenthangingn1"><strong class="calibre9">1.</strong> Define the desired lowpass filter performance requirements.</p>
<p class="indenthangingn1"><strong class="calibre9">2.</strong> Determine a candidate value for the expansion factor <em class="calibre7">M</em>.</p>
<p class="indenthangingn1"><strong class="calibre9">3.</strong> Design and evaluate the shaping and image-reject subfilters.</p>
<p class="indenthangingn1"><strong class="calibre9">4.</strong> Investigate IFIR performance for alternate expansion factors near the initial <em class="calibre7">M</em> value.</p>
<p class="calibre3">As a design example, refer to <a href="#calibre_link-1693">Figure 7-15(d)</a> and assume we want to build a lowpass IFIR filter with <em class="calibre7">f</em><sub class="calibre12">pass</sub> = 0.02, a peak-peak passband ripple of 0.5 dB, a transition region bandwidth of <em class="calibre7">f</em><sub class="calibre12">trans</sub> = 0.01 (thus <em class="calibre7">f</em><sub class="calibre12">stop</sub> = 0.03), and 50 dB of stopband attenuation. First, we find the <em class="calibre7">f</em><sub class="calibre12">trans</sub> = 0.01 point on the abscissa of <a href="#calibre_link-1704">Figure 7-18(a)</a> and follow it up to the point where it intersects the <em class="calibre7">f</em><sub class="calibre12">pass</sub> = 0.02 curve. This intersection indicates that we should start our design with an expansion factor of <em class="calibre7">M</em> = 7. (The same intersection point in <a href="#calibre_link-1704">Figure 7-18(b)</a> suggests that we can achieve a computational workload reduction of roughly 75 percent.)</p>
<p class="calibre3"><a id="calibre_link-2327"></a>With <em class="calibre7">M</em> = 7, and applying <a href="#calibre_link-1706">Eq. (7-30)</a>, we use our favorite traditional FIR filter design software to design a linear-phase prototype FIR filter with the following parameters:</p>
<p class="indentpara3"><em class="calibre7">f</em><sub class="calibre12">p-pass</sub> = <em class="calibre7">M</em>(0.02) = 0.14,<br class="calibre1" />passband ripple = (0.5)/2 dB = 0.25 dB,<br class="calibre1" /><em class="calibre7">f</em><sub class="calibre12">p-stop</sub> = <em class="calibre7">M</em>(0.03) = 0.21, and<br class="calibre1" />stopband attenuation = 50 dB.</p>
<p class="calibre3">(Notice how we used our cascaded filters’ passband ripple rule of thumb from <a href="#calibre_link-130">Section 6.8.1</a> to specify the prototype filter’s passband ripple to be half our final desired ripple, and we’ll do the same for the image-reject subfilter.) Such a prototype FIR filter will have <em class="calibre7">N</em><sub class="calibre12">p</sub> = 33 taps and, from <a href="#calibre_link-1705">Eq. (7-28)</a>, when expanded by <em class="calibre7">M</em> = 7 the shaping subfilter will have an impulse response length of <em class="calibre7">N</em><sub class="calibre12">sh</sub> = 225 samples.</p>
<p class="calibre3">Next, using <a href="#calibre_link-1707">Eq. (7-31)</a>, we design an image-reject subfilter having the following parameters:</p>
<p class="indentpara3"><em class="calibre7">f</em><sub class="calibre12">ir-pass</sub> = <em class="calibre7">f</em><sub class="calibre12">pass</sub> = 0.02,<br class="calibre1" />passband ripple = (0.5)/2 dB = 0.25 dB,<br class="calibre1" /><em class="calibre7">f</em><sub class="calibre12">ir-stop</sub> = 1/<em class="calibre7">M</em> −<em class="calibre7">f</em><sub class="calibre12">stop</sub> = 1/7 − 0.03 = 0.113, and<br class="calibre1" />stopband attenuation = 50 dB.</p>
<p class="calibre3">This image-reject subfilter will have <em class="calibre7">N</em><sub class="calibre12">ir</sub> = 27 taps and when cascaded with the shaping subfilter will yield an IFIR filter requiring 60 multiplications per filter output sample. The frequency response of the IFIR filter is shown in <a href="#calibre_link-1708">Figure 7-19(a)</a>, with passband response detail provided in <a href="#calibre_link-1708">Figure 7-19(b)</a>.</p>
<p class="caption"><a id="calibre_link-1708"></a><strong class="calibre9">Figure 7-19</strong> IFIR filter design example magnitude responses: (a) full response; (b) passband response detail.</p>
<p class="image"><img src="images/000955.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">A traditional FIR filter satisfying our design example specifications would require approximately <em class="calibre7">N</em><sub class="calibre12">tfir</sub> = 240 taps. Because the IFIR filter requires only 60 multiplications per output sample, using <a href="#calibre_link-1702">Eq. (7-32)</a>, we have realized a computational workload reduction of 75 percent. The final IFIR filter design step is to sit back and enjoy a job well done.</p>
<p class="calibre3"><a id="calibre_link-2323"></a>Further modeling of our design example for alternate expansion factors yields the IFIR filter performance results in <a href="#calibre_link-1709">Table 7-2</a>. There we see how the <em class="calibre7">M</em> expansion factors of 5 through 8 provide very similar computational reductions and <em class="calibre7">N</em><sub class="calibre12">sh</sub>-sized data storage requirements for the shaping subfilter.</p>
<p class="caption"><a id="calibre_link-1709"></a><strong class="calibre9">Table 7-2</strong> Design Example Computation Reduction versus <em class="calibre7">M</em></p>
<p class="image"><img src="images/000519.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">IFIR filters are suitable whenever narrowband lowpass linear-phase filtering is required, for example, the filtering prior to decimation for narrowband channel selection within wireless communications receivers, or in digital television. IFIR filters are essential components in sharp-transition wideband frequency-response masking FIR filters[<a href="#calibre_link-1710">18</a>,<a href="#calibre_link-1711">19</a>]. In addition, IFIR filters can also be employed in narrowband two-dimensional filtering applications.</p>
<p class="calibre3">Additional, and more complicated, IFIR design methods have been described in the literature. Improved computational workload reduction, on the order of 30 to 40 percent beyond that presented here, has been reported using an intricate design scheme when the <a href="#calibre_link-1694">Figure 7-16</a> image-reject subfilter is replaced with multiple stages of filtering<a href="#calibre_link-1712">[20]</a>.</p>
<p class="calibre3">If you “feel the need for speed,” there are additional ways to reduce the computational workload of IFIR filters. Those techniques are available in references <a href="#calibre_link-1713">[21]</a> and <a href="#calibre_link-1714">[22]</a>. We will revisit IFIR filters in <a href="#calibre_link-291">Chapter 10</a> to see how they are used in sample rate conversion (decimation or interpolation) applications.</p>
<p class="calibre3">To conclude our linear-phase narrowband IFIR filter material, we reiterate that they can achieve significant computational workload reduction (as large as 90 percent) relative to traditional tapped-delay line FIR filters, at the cost of less than a 10 percent increase in hardware data memory requirements. Happily, IFIR implementation is a straightforward cascade of filters designed using readily available traditional FIR filter design software.</p>
<p class="calibre3"><a id="calibre_link-97"></a></p>
<h3 class="calibre6"><a id="calibre_link-2064" class="calibre5"></a>7.5 Frequency Sampling Filters: The Lost Art</h3>
<p class="calibre3">This section describes a class of digital filters, called <em class="calibre7">frequency sampling filters</em>, used to implement linear-phase FIR filter designs. Although frequency sampling filters were developed over 35 years ago, the advent of the powerful Parks-McClellan tapped-delay line FIR filter design method has driven them to near obscurity. Thus in the 1970s frequency sampling filter implementations lost favor to the point where their coverage in today’s DSP classrooms and textbooks ranges from very brief to nonexistent. However, we’ll show how frequency sampling filters remain <em class="calibre7">more computationally efficient</em> than Parks-McClellan-designed filters for certain applications where the desired passband width is less than roughly one-fifth the sample rate. The purpose of this material is to introduce the DSP practitioner to the structure, performance, and design of frequency sampling filters, and to present a detailed comparison between a proposed high-performance frequency sampling filter implementation and its tapped-delay line FIR filter equivalent. In addition, we’ll clarify and expand the literature of frequency sampling filters concerning the practical issues of phase linearity, filter stability, gain normalization, and computational workload using design examples.</p>
<p class="calibre3">Frequency sampling filters were founded upon the fact that a traditional <em class="calibre7">N-</em>tap nonrecursive tapped-delay line (direct convolution) FIR filter as shown in <a href="#calibre_link-1715">Figure 7-20(a)</a> can be implemented as a comb filter in cascade with a bank of <em class="calibre7">N</em> complex resonators as shown in <a href="#calibre_link-1715">Figure 7-20(b)</a>. We call the filter in <a href="#calibre_link-1715">Figure 7-20(b)</a> a general <em class="calibre7">frequency sampling filter</em> (FSF), and its equivalence to the nonrecursive FIR filter has been verified[<a href="#calibre_link-1716">23</a>−<a href="#calibre_link-1717">25</a>]. While the <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients, where 0 &lt; <em class="calibre7">k</em> &lt; <em class="calibre7">N</em>−1, of <em class="calibre7">N-</em>tap nonrecursive FIR filters are typically real-valued, in general they can be complex, and that’s the initial assumption made in equating the two filters in <a href="#calibre_link-1715">Figure 7-20</a>. The <em class="calibre7">H</em>(<em class="calibre7">k</em>) gain factors, the discrete Fourier transform of the <em class="calibre7">h</em>(<em class="calibre7">k</em>) time-domain coefficients, are, in the general case, complex values represented by |<em class="calibre7">H</em>(<em class="calibre7">k</em>)|<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ϕ(<em class="calibre7">k</em>)</sup>.</p>
<p class="caption"><a id="calibre_link-1715"></a><strong class="calibre9">Figure 7-20</strong> FIR filters: (a) <em class="calibre7">N</em>-tap nonrecursive tapped-delay line; (b) equivalent <em class="calibre7">N</em>-section frequency sampling filter.</p>
<p class="image"><img src="images/000008.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The basis of FSF design is the definition of a desired FIR filter frequency response in the form of <em class="calibre7">H</em>(<em class="calibre7">k</em>) frequency-domain samples, whose magnitudes are depicted as dots in <a href="#calibre_link-1718">Figure 7-21</a>. Next, those complex <em class="calibre7">H</em>(<em class="calibre7">k</em>) sample values are used as gain factors following the resonators in the FSF structure (block diagram). If you haven’t seen it before, please don’t be intimidated by this apparently complicated FSF structure. We’ll soon understand every part of it, and how those parts work together.</p>
<p class="caption"><a id="calibre_link-1718"></a><strong class="calibre9">Figure 7-21</strong> Defining a desired filter response by frequency sampling.</p>
<p class="image"><img src="images/000846.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Later we’ll develop the math to determine the interpolated (actual) frequency magnitude response |<em class="calibre7">H</em>(<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup>)| of an FSF shown by the continuous curve in <a href="#calibre_link-1718">Figure 7-21</a>. In this figure, the frequency axis labeling convention is a normalized angle measured in π radians/sample with the depicted ω frequency range covering 0 to 2π radians/sample, corresponding to a cyclic frequency range of 0 to <em class="calibre7">f<sub class="calibre12">s</sub></em>, where <em class="calibre7">f<sub class="calibre12">s</sub></em> is the sample rate in Hz.</p>
<p class="calibre3"><a id="calibre_link-2282"></a>To avoid confusion, we remind the reader that there is a popular nonrecursive FIR filter design technique known as the <em class="calibre7">frequency sampling design method</em> described in the DSP literature. That design scheme begins (in a manner similar to an FSF design) with the definition of desired <em class="calibre7">H</em>(<em class="calibre7">k</em>) frequency response samples, then an inverse discrete Fourier transform is performed on those samples to obtain a time-domain impulse response sequence that’s <a id="calibre_link-2078"></a>used as the <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients in the nonrecursive <em class="calibre7">N-</em>tap FIR structure of <a href="#calibre_link-1715">Figure 7-20(a)</a>. In the FSF design method described here, the desired frequency-domain <em class="calibre7">H</em>(<em class="calibre7">k</em>) sample values are the coefficients used in the FSF structure of <a href="#calibre_link-1715">Figure 7-20(b)</a> which is typically called the <em class="calibre7">frequency sampling implementation</em> of an FIR filter.</p>
<p class="calibre3">Although more complicated than nonrecursive FIR filters, FSFs deserve study because in many narrowband filtering situations they can implement a linear-phase FIR filter at a reduced computational workload relative to an <em class="calibre7">N-</em>tap nonrecursive FIR filter. The computation reduction occurs because, while all of the <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients are used in the nonrecursive FIR filter implementation, most of the <em class="calibre7">H</em>(<em class="calibre7">k</em>) values will be zero-valued, corresponding to the stopband, and need not be implemented. To understand the function and benefits of FSFs, we start by considering the behavior of the comb filter and then review the performance of a single digital resonator.</p>
<p class="calibre3"><a id="calibre_link-1653"></a></p>
<h4 class="calibre13">7.5.1 Comb Filter and Complex Resonator in Cascade</h4>
<p class="calibre3">A single section of a complex FSF is a comb filter followed by a single complex digital resonator as shown in <a href="#calibre_link-1719">Figure 7-22</a>.</p>
<p class="caption"><a id="calibre_link-1719"></a><strong class="calibre9">Figure 7-22</strong> A single section of a complex FSF.</p>
<p class="image"><img src="images/001350.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The 1/<em class="calibre7">N</em> gain factor following a resonator in <a href="#calibre_link-1715">Figure 7-20(b)</a> is omitted, for simplicity, from the single-section complex FSF. (The effect of including the 1/<em class="calibre7">N</em> factor will be discussed later.) To understand the single-section FSF’s operation, we first review the characteristics of the nonrecursive comb filter whose time-domain difference equation is</p>
<p class="caption"><a id="calibre_link-2899"></a>(7-36)</p>
<p class="image"><img src="images/000304.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">with its output equal to the input sequence minus the input delayed by <em class="calibre7">N</em> samples. The comb filter’s <em class="calibre7">z-</em>domain transfer function is</p>
<p class="caption"><a id="calibre_link-257"></a>(7-37)</p>
<p class="image"><img src="images/001143.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2462"></a>The frequency response of a comb filter, derived in <a href="#calibre_link-732">Section G.1</a> of <a href="#calibre_link-297">Appendix G</a>, is</p>
<p class="caption"><a id="calibre_link-2900"></a>(7-38)</p>
<p class="image"><img src="images/000884.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">with a magnitude response of |<em class="calibre7">H</em><sub class="calibre12">comb</sub>(<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup>)| = 2|sin(ω<em class="calibre7">N</em>/2)| whose maximum value is 2. It’s meaningful to view the comb filter’s time-domain impulse response and frequency-domain magnitude response as shown in <a href="#calibre_link-1720">Figure 7-23</a> for <em class="calibre7">N</em> = 8. The magnitude response makes it clear why the term <em class="calibre7">comb</em> is used.</p>
<p class="caption"><a id="calibre_link-1720"></a><strong class="calibre9">Figure 7-23</strong> Time- and frequency-domain characteristics of an <em class="calibre7">N</em> = 8 comb filter.</p>
<p class="image"><img src="images/000726.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-257">Equation (7-37)</a> leads to a key feature of this comb filter; its transfer function has <em class="calibre7">N</em> periodically spaced zeros around the <em class="calibre7">z-</em>plane’s unit circle as shown in <a href="#calibre_link-1720">Figure 7-23(c)</a>. Each of those zeros, located at <em class="calibre7">z</em>(<em class="calibre7">k</em>) = <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">2π<em class="calibre7">k/N</em></sup>, where <em class="calibre7">k</em> = 0, 1, 2, . . ., <em class="calibre7">N</em>−1, corresponds to a magnitude null in <a href="#calibre_link-1720">Figure 7-23(b)</a>, where the normalized frequency axis is labeled from −π to +π radians/sample. Those <em class="calibre7">z</em>(<em class="calibre7">k</em>) values are the <em class="calibre7">N</em> roots of unity when we set <a href="#calibre_link-257">Eq. (7-37)</a> equal to zero, yielding <em class="calibre7">z</em>(<em class="calibre7">k</em>)<em class="calibre7"><sup class="calibre10">N</sup></em> = (<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">2π<em class="calibre7">k/N</em></sup>)<em class="calibre7"><sup class="calibre10">N</sup></em> = 1. We can combine the magnitude response (on a linear scale) and <em class="calibre7">z-</em>plane information in the three-dimensional <em class="calibre7">z-</em>plane depiction shown in <a href="#calibre_link-1721">Figure 7-24</a>, where we see the intersection of the |<em class="calibre7">H</em><sub class="calibre12">comb</sub>(<em class="calibre7">z</em>)| surface and the unit circle. Breaking the curve at the <em class="calibre7">z</em> = −1 point, and laying it flat, corresponds to the magnitude curve in <a href="#calibre_link-1720">Figure 7-23(b)</a>.</p>
<p class="caption"><a id="calibre_link-1721"></a><strong class="calibre9">Figure 7-24</strong> The <em class="calibre7">z</em>-plane frequency magnitude response of the <em class="calibre7">N</em> = 8 comb filter.</p>
<p class="image"><img src="images/001582.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To preview where we’re going, soon we’ll build an FSF by cascading the comb filter with a digital resonator having a transfer function pole lying on top of one of the comb’s <em class="calibre7">z-</em>plane zeros, resulting in a linear-phase bandpass filter. With this thought in mind, let’s characterize the digital resonator in <a href="#calibre_link-1719">Figure 7-22</a>.</p>
<p class="calibre3">The complex resonator’s time-domain difference equation is</p>
<p class="caption"><a id="calibre_link-2901"></a>(7-39)</p>
<p class="image"><img src="images/001034.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2902"></a>where the angle ω<sub class="calibre12">r</sub>, −π ≤ ω<sub class="calibre12">r</sub> ≤ π determines the resonant frequency of our resonator. We show this by considering the resonator’s <em class="calibre7">z-</em>domain transfer function</p>
<p class="caption"><a id="calibre_link-2903"></a>(7-40)</p>
<p class="image"><img src="images/000085.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">and the resonator’s complex time-domain impulse response, for ω<sub class="calibre12">r</sub> = π/4, in <a href="#calibre_link-1722">Figure 7-25</a>.</p>
<p class="caption"><a id="calibre_link-1722"></a><strong class="calibre9">Figure 7-25</strong> Single complex digital resonator impulse response with ω<sub class="calibre12">r</sub> = π/4.</p>
<p class="image"><img src="images/001499.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The ω<sub class="calibre12">r</sub> = π/4 resonator’s impulse response is a complex sinusoid, the real part (a cosine sequence) of which is plotted in <a href="#calibre_link-1723">Figure 7-26(a)</a>, and can be <a id="calibre_link-2904"></a>considered infinite in duration. (The imaginary part of the impulse response is, as we would expect, a sinewave sequence.) The frequency magnitude response is very narrow and centered at ω<sub class="calibre12">r</sub>. The resonator’s <em class="calibre7">H</em><sub class="calibre12">res</sub>(<em class="calibre7">z</em>) has a single zero at <em class="calibre7">z</em> = 0, but what concerns us most is its pole, at <em class="calibre7">z</em> = <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω<sub class="calibre15">r</sub></sup>, on the unit circle at an angle of ω<sub class="calibre12">r</sub> as shown in <a href="#calibre_link-1723">Figure 7-26(c)</a>. We can think of the resonator as an infinite impulse response (IIR) filter that’s conditionally stable because its pole is neither inside nor outside the unit circle.</p>
<p class="caption"><a id="calibre_link-1723"></a><strong class="calibre9">Figure 7-26</strong> Time- and frequency-domain characteristics of a single complex digital resonator with ω<sub class="calibre12">r</sub> = π/4.</p>
<p class="image"><img src="images/001468.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We now analyze the single-section complex FSF in <a href="#calibre_link-1719">Figure 7-22</a>. The <em class="calibre7">z-</em>domain transfer function of this FSF is the product of the individual transfer functions and <em class="calibre7">H</em>(<em class="calibre7">k</em>), or</p>
<p class="caption"><a id="calibre_link-2905"></a>(7-41)</p>
<p class="image"><img src="images/001296.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we restrict the resonator’s resonant frequency ω<sub class="calibre12">r</sub> to be 2π<em class="calibre7">k/N</em>, where <em class="calibre7">k</em> = 0, 1, 2, . . ., <em class="calibre7">N</em>−1, then the resonator’s <em class="calibre7">z</em>-domain pole will be located atop one of the comb’s zeros and we’ll have an FSF transfer function of</p>
<p class="caption"><a id="calibre_link-1725"></a>(7-42)</p>
<p class="image"><img src="images/001768.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where the “ss” subscript means a single-section complex FSF. We can understand a single-section FSF by reviewing its time- and frequency-domain behavior for <em class="calibre7">N</em> = 32, <em class="calibre7">k</em> = 2, and <em class="calibre7">H</em>(2) = 1 as shown in <a href="#calibre_link-1724">Figure 7-27</a>.</p>
<p class="caption"><a id="calibre_link-1724"></a><strong class="calibre9">Figure 7-27</strong> Time- and frequency-domain characteristics of a single-section complex FSF where <em class="calibre7">N</em> = 32, <em class="calibre7">k</em> = 2, and <em class="calibre7">H</em>(2) = 1.</p>
<p class="image"><img src="images/001562.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1724">Figure 7-27</a> is rich in information. We see that the complex FSF’s impulse response is a truncated complex sinusoid whose real part is shown in <a href="#calibre_link-1724">Figure 7-27(a)</a>. The positive impulse from the comb filter started the resonator oscillation at zero time. Then at just the right sample, <em class="calibre7">N</em> = 32 samples later, which is <em class="calibre7">k</em> = 2 cycles of the sinusoid, the negative impulse from the comb arrives at the resonator to cancel all further oscillation. The frequency magnitude response, being the Fourier transform of the truncated sinusoidal impulse response, takes the form of a sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em>-like function. In the <em class="calibre7">z</em>-plane <a id="calibre_link-1996"></a>plot of <a href="#calibre_link-1724">Figure 7-27</a>, the resonator’s pole is indeed located atop the comb filter’s <em class="calibre7">k</em> = 2 zero on the unit circle, canceling the frequency magnitude response null at 2π<em class="calibre7">k/N</em> = π/8 radians. (Let’s remind ourselves that a normalized angular frequency of 2π<em class="calibre7">k/N</em> radians/sample corresponds to a cyclic frequency of <em class="calibre7">kf<sub class="calibre12">s</sub>/N</em>, where <em class="calibre7">f<sub class="calibre12">s</sub></em> is the sample rate in Hz. Thus the filter in <a href="#calibre_link-1724">Figure 7-27</a> resonates at <em class="calibre7">f<sub class="calibre12">s</sub></em>/16 Hz.)</p>
<p class="calibre3">We can determine the FSF’s interpolated frequency response by evaluating the <em class="calibre7">H</em><sub class="calibre12">ss</sub>(<em class="calibre7">z</em>) transfer function on the unit circle. Substituting <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup> for <em class="calibre7">z</em> in <em class="calibre7">H</em><sub class="calibre12">ss</sub>(<em class="calibre7">z</em>) in <a href="#calibre_link-1725">Eq. (7-42)</a>, as detailed in <a href="#calibre_link-297">Appendix G</a>, <a href="#calibre_link-733">Section G.2</a>, we obtain an <em class="calibre7">H</em><sub class="calibre12">ss</sub>(<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup>) frequency response of</p>
<p class="caption"><a id="calibre_link-270"></a>(7-43)</p>
<p class="image"><img src="images/000394.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Evaluating |<em class="calibre7">H</em><sub class="calibre12">ss</sub>(<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup>)| over the frequency range of −π &lt; ω &lt; π yields the curve in <a href="#calibre_link-1724">Figure 7-27(b)</a>. Our single-section FSF has linear phase because the <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>π<em class="calibre7">k/N</em></sup> term in <a href="#calibre_link-270">Eq. (7-43)</a> is a fixed phase angle based on constants <em class="calibre7">N</em> and <em class="calibre7">k</em>, the angle of <em class="calibre7">H</em>(<em class="calibre7">k</em>) is fixed, and the <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>ω(<em class="calibre7">N</em>−1)/2</sup> phase term is a linear function of frequency (ω). As derived in <a href="#calibre_link-297">Appendix G</a>, <a href="#calibre_link-733">Section G.2</a>, the maximum magnitude response of a single-section complex FSF is <em class="calibre7">N</em> when |<em class="calibre7">H</em>(<em class="calibre7">k</em>)| = 1, and we illustrate this fact in <a href="#calibre_link-1726">Figure 7-28</a>.</p>
<p class="caption"><a id="calibre_link-1726"></a><strong class="calibre9">Figure 7-28</strong> The <em class="calibre7">z</em>-plane frequency magnitude response of a single-section complex FSF with <em class="calibre7">N</em> = 32 and <em class="calibre7">k</em> = 2.</p>
<p class="image"><img src="images/001366.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2906"></a></p>
<h4 class="calibre13">7.5.2 Multisection Complex FSFs</h4>
<p class="calibre3">In order to build useful FSFs we use multiple resonator sections, as indicated in <a href="#calibre_link-1715">Figure 7-20(b)</a>, to provide bandpass FIR filtering. For example, let’s build a three-section complex bandpass FSF by establishing the following parameters: <em class="calibre7">N</em> = 32, and the nonzero frequency samples are <em class="calibre7">H</em>(2), <em class="calibre7">H</em>(3), and <em class="calibre7">H</em>(4). The desired frequency magnitude response is shown in <a href="#calibre_link-1727">Figure 7-29(a)</a> with the bandpass FSF structure provided in <a href="#calibre_link-1727">Figure 7-29(b)</a>.</p>
<p class="caption"><a id="calibre_link-2907"></a><a id="calibre_link-1727"></a><strong class="calibre9">Figure 7-29</strong> Three-section <em class="calibre7">N</em> = 32 complex FSF: (a) desired frequency magnitude response; (b) implementation.</p>
<p class="image"><img src="images/000403.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-1994"></a>Exploring this scenario, recall that the <em class="calibre7">z</em>-domain transfer function of parallel filters is the sum of the individual transfer functions. So, the transfer function of an <em class="calibre7">N-</em>section complex FSF from <a href="#calibre_link-1725">Eq. (7-42)</a> is</p>
<p class="caption"><a id="calibre_link-1728"></a>(7-44)</p>
<p class="image"><img src="images/001015.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where the subscript “cplx” means a complex multisection FSF.</p>
<p class="calibre3">Let’s pause for a moment to understand <a href="#calibre_link-1728">Eq. (7-44)</a>; the first factor on the right side represents a comb filter, and the comb is in cascade (multiplication) with the sum of ratio terms. The summation of the ratios (each ratio is a resonator) means those resonators are connected in parallel. Recall from <a href="#calibre_link-130">Section 6.8.1</a> that the combined transfer function of filters connected in parallel is the sum of the individual transfer functions. It’s important to be comfortable with the form of <a href="#calibre_link-1728">Eq. (7-44)</a> because we’ll be seeing many similar expressions in the material to come.</p>
<p class="calibre3">So a comb filter is driving a bank of resonators. For an <em class="calibre7">N</em> = 32 complex FSF we could have up to 32 resonators, but in practice only a few resonators are needed for narrowband filters. In <a href="#calibre_link-1727">Figure 7-29</a>, we used only three resonators. That’s the beauty of FSFs; most of the <em class="calibre7">H</em>(<em class="calibre7">k</em>) gain values in <a href="#calibre_link-1728">Eq. (7-44)</a> are zero-valued and those resonators are not implemented, keeping the FSF computationally efficient.</p>
<p class="calibre3">Using the same steps as in <a href="#calibre_link-297">Appendix G</a>, <a href="#calibre_link-733">Section G.2</a>, we can write the frequency response of a multisection complex FSF, such as in <a href="#calibre_link-1727">Figure 7-29</a>, as</p>
<p class="caption"><a id="calibre_link-265"></a>(7-45)</p>
<p class="image"><img src="images/001649.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The designer of a multisection complex FSF can achieve any desired filter phase response by specifying the ϕ(<em class="calibre7">k</em>) phase angle value of each nonzero complex <em class="calibre7">H</em>(<em class="calibre7">k</em>) = |<em class="calibre7">H</em>(<em class="calibre7">k</em>)|<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ϕ(<em class="calibre7">k</em>)</sup> gain factor. However, to build a linear-phase complex FSF, the designer must (1) specify the ϕ(<em class="calibre7">k</em>) phase values to be a linear function of frequency, and (2) define the ϕ(<em class="calibre7">k</em>) phase sequence so its slope is −(<em class="calibre7">N</em>-1)/2. This second condition forces the FSF to have a positive time delay of (<em class="calibre7">N</em>−1)/2 samples, as would the <em class="calibre7">N-</em>tap nonrecursive FIR filter in <a href="#calibre_link-1715">Figure 7-20(a)</a>. The following expressions for ϕ(<em class="calibre7">k</em>), with <em class="calibre7">N</em> being even, satisfy those two conditions.</p>
<p class="caption"><a id="calibre_link-264"></a>(7-46)</p>
<p class="image"><img src="images/001557.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2908"></a>(7-46′)</p>
<p class="image"><img src="images/001081.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-267"></a>(7-46″)</p>
<p class="image"><img src="images/001724.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2909"></a>If <em class="calibre7">N</em> is odd, the linear-phase <em class="calibre7">H</em>(<em class="calibre7">k</em>) phase values are</p>
<p class="caption"><a id="calibre_link-2910"></a>(7-47)</p>
<p class="image"><img src="images/000478.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-2911"></a>(7-47′)</p>
<p class="image"><img src="images/001152.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Two example linear-phase ϕ(<em class="calibre7">k</em>) sequences, for <em class="calibre7">N</em> = 19 and <em class="calibre7">N</em> = 20, are shown in <a href="#calibre_link-1729">Figure 7-30</a>. The ϕ(0) = 0 values set the phase to be zero at zero Hz, and the ϕ(<em class="calibre7">N</em>/2) = 0, at the cyclic frequency of <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 in <a href="#calibre_link-1729">Figure 7-30(b)</a>, ensures a symmetrical time-domain impulse response.</p>
<p class="caption"><a id="calibre_link-1729"></a><strong class="calibre9">Figure 7-30</strong> Linear phase of <em class="calibre7">H</em>(<em class="calibre7">k</em>) for a single-section FSF: (a) <em class="calibre7">N</em> = 19; (b) <em class="calibre7">N</em> = 20.</p>
<p class="image"><img src="images/000993.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Assigning the appropriate phase for the nonzero <em class="calibre7">H</em>(<em class="calibre7">k</em>) gain factors is, however, only half the story in building a multisection FSF. There’s good news to be told. Examination of the frequency response in <a href="#calibre_link-265">Eq. (7-45)</a> shows us a simple way to achieve phase linearity in practice. Substituting |<em class="calibre7">H</em>(<em class="calibre7">k</em>)|<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ϕ(<em class="calibre7">k</em>)</sup>, with ϕ(<em class="calibre7">k</em>) defined by <a href="#calibre_link-264">Eq. (7-46)</a> above, for <em class="calibre7">H</em>(<em class="calibre7">k</em>) in <a href="#calibre_link-265">Eq. (7-45)</a> provides the expression for the frequency response of an even-<em class="calibre7">N</em> multisection linear-phase complex FSF,</p>
<p class="caption"><a id="calibre_link-263"></a>(7-48)</p>
<p class="image"><img src="images/000375.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where the “lp” subscript indicates linear phase.</p>
<p class="calibre3"><a href="#calibre_link-263">Equation (7-48)</a> is not as complicated as it looks. It merely says the total FSF frequency response is the sum of individual resonators’ sin(<em class="calibre7">x</em>)/<em class="calibre7">x</em>-like frequency responses. The first term within the brackets represents the resonator <a id="calibre_link-2912"></a>centered at <em class="calibre7">k</em> = <em class="calibre7">N</em>/2 (<em class="calibre7">f<sub class="calibre12">s</sub></em>/2). The first summation is the positive-frequency resonators and the second summation represents the negative-frequency resonators.</p>
<p class="calibre3">The (−1)<em class="calibre7"><sup class="calibre10">k</sup></em> terms in the numerators of <a href="#calibre_link-263">Eq. (7-48)</a> deserve our attention because they are an alternating sequence of plus and minus ones. Thus a single-section frequency response will be 180° out of phase relative to its neighboring section. That is, the outputs of neighboring single-section FSFs will have a fixed π-radians phase difference over the passband common to both filters as shown in <a href="#calibre_link-1730">Figure 7-31</a>. (The occurrence of the (−1)<em class="calibre7"><sup class="calibre10">k</sup></em> factors in <a href="#calibre_link-263">Eq. (7-48)</a> is established in <a href="#calibre_link-297">Appendix G</a>, <a href="#calibre_link-734">Section G.3</a>.)</p>
<p class="caption"><a id="calibre_link-1730"></a><strong class="calibre9">Figure 7-31</strong> Comparison of the magnitude and phase responses, and phase difference, between the <em class="calibre7">k</em> = 3 and the <em class="calibre7">k</em> = 4 FSFs, when <em class="calibre7">N</em> = 32.</p>
<p class="image"><img src="images/001051.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The effect of those (−1)<em class="calibre7"><sup class="calibre10">k</sup></em> factors is profound and not emphasized nearly enough in the literature of FSFs. Rather than defining each nonzero complex <em class="calibre7">H</em>(<em class="calibre7">k</em>) gain factor with its linearly increasing phase angles ϕ(<em class="calibre7">k</em>), we can build a linear-phase multisection FSF by using just the |<em class="calibre7">H</em>(<em class="calibre7">k</em>)| magnitude values and incorporating the alternating signs for those real-valued gain factors. In addition, if the nonzero |<em class="calibre7">H</em>(<em class="calibre7">k</em>)| gain factors are all equal to one, we avoid <a href="#calibre_link-1727">Figure 7-29</a>’s gain factor multiplications altogether as shown in <a href="#calibre_link-1731">Figure 7-32(a)</a>.</p>
<p class="caption"><a id="calibre_link-1731"></a><strong class="calibre9">Figure 7-32</strong> Simplified <em class="calibre7">N</em> = 32 three-section linear-phase complex bandpass FSF: (a) implementation; (b) frequency response.</p>
<p class="image"><img src="images/001134.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The unity-valued |<em class="calibre7">H</em>(<em class="calibre7">k</em>)| gain factors and the alternating-signed summation allow the complex gain multiplies in <a href="#calibre_link-1727">Figure 7-29(b)</a> to be replaced by simple adds and subtracts as in <a href="#calibre_link-1731">Figure 7-32(a)</a>. We add the even-<em class="calibre7">k</em> and subtract the odd-<em class="calibre7">k</em> resonator outputs. <a href="#calibre_link-1731">Figure 7-32(b)</a> confirms the linear phase, with phase discontinuities at the magnitude nulls, of these multisection complex FSFs. The transfer function of the simplified complex linear-phase FSF is</p>
<p class="caption"><a id="calibre_link-2291"></a><a id="calibre_link-1732"></a>(7-49)</p>
<p class="image"><img src="images/000589.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">(We didn’t use the “lp” subscript, meaning linear phase, in <a href="#calibre_link-1732">Eq. (7-49)</a> because, from here on, all our complex FSFs will be linear phase.)</p>
<p class="calibre3"><a id="calibre_link-1413"></a></p>
<h4 class="calibre13">7.5.3 Ensuring FSF Stability</h4>
<p class="calibre3">So far we’ve discussed complex FSFs with pole/zero cancellation on the unit circle. However, in practice exact cancellation requires infinite-precision arithmetic, and real-world binary word quantization errors in the FSF’s coefficients can make the filter poles lie outside the unit circle. The result would be an unstable filter, whose impulse response is no longer finite in duration, which must be avoided. (This is a beautiful example of the time-honored axiom “In theory, there’s no difference between theory and practice. In practice, sometimes the <em class="calibre7">theory</em> doesn’t work.”) Even if a pole is located only very slightly outside the unit circle, roundoff noise will grow as time increases, corrupting the output samples of the filter. We prevent this problem by moving the comb filter’s zeros and the resonators’ poles just inside the unit circle as depicted in <a href="#calibre_link-1733">Figure 7-33(a)</a>. Now the zeros and a pole are located on a circle of radius <em class="calibre7">r</em>, where the damping factor <em class="calibre7">r</em> is just slightly less than 1.</p>
<p class="caption"><a id="calibre_link-1733"></a><strong class="calibre9">Figure 7-33</strong> Ensuring FSF stability: (a) poles and zeros are inside the unit circle; (b) real part of a stable single-section FSF impulse response; (c) FSF structure.</p>
<p class="image"><img src="images/000181.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2913"></a>We call <em class="calibre7">r</em> the damping factor because a single-stage FSF impulse response becomes a damped sinusoid. For example, the real part of the impulse response of a single-stage complex FSF, where <em class="calibre7">N</em> = 32, <em class="calibre7">k</em> = 2, <em class="calibre7">H</em>(2) = 2, and <em class="calibre7">r</em> = 0.95, is shown in <a href="#calibre_link-1733">Figure 7-33(b)</a>. Compare that impulse response to <a href="#calibre_link-1724">Figure 7-27(a)</a>. The structure of a single-section FSF with zeros and a pole inside the unit circle is shown in <a href="#calibre_link-1733">Figure 7-33(c)</a>.</p>
<p class="calibre3">The comb filter’s feedforward coefficient is −<em class="calibre7">r<sup class="calibre10">N</sup></em> because the new <em class="calibre7">z</em>-domain transfer function of this comb filter is</p>
<p class="caption"><a id="calibre_link-1734"></a>(7-50)</p>
<p class="image"><img src="images/001232.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">with the <em class="calibre7">N</em> zeros for this comb being located at <em class="calibre7">z<sub class="calibre12">r</sub></em><sub class="calibre12">&lt;1</sub>(<em class="calibre7">k</em>) = <em class="calibre7">re<sup class="calibre10">j</sup></em><sup class="calibre10">2π<em class="calibre7">k/N</em></sup>, where <em class="calibre7">k</em> = 0, 1, 2, . . ., <em class="calibre7">N</em>−1.</p>
<p class="calibre3">Those <em class="calibre7">z<sub class="calibre12">r</sub></em><sub class="calibre12">&lt;1</sub>(<em class="calibre7">k</em>) values are the <em class="calibre7">N</em> roots of <em class="calibre7">r<sup class="calibre10">N</sup></em> when we set <a href="#calibre_link-1734">Eq. (7-50)</a> equal to zero, yielding <em class="calibre7">z<sub class="calibre12">r</sub></em><sub class="calibre12">&lt;1</sub>(<em class="calibre7">k</em>)<em class="calibre7"><sup class="calibre10">N</sup></em> = (<em class="calibre7">re<sup class="calibre10">j</sup></em><sup class="calibre10">2π<em class="calibre7">k</em>/<em class="calibre7">N</em></sup>)<em class="calibre7"><sup class="calibre10">N</sup></em> = <em class="calibre7">r<sup class="calibre10">N</sup></em>. The <em class="calibre7">z</em>-domain transfer function of the resonator in <a href="#calibre_link-1733">Figure 7-33(b)</a>, with its pole located at a radius of <em class="calibre7">r</em>, at an angle of 2π<em class="calibre7">k</em>/<em class="calibre7">N</em>, is</p>
<p class="caption"><a id="calibre_link-2914"></a>(7-51)</p>
<p class="image"><img src="images/001104.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">leading us to the transfer function of a guaranteed-stable single-section complex FSF of</p>
<p class="caption"><a id="calibre_link-2915"></a>(7-52)</p>
<p class="image"><img src="images/000665.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">whose implementation is shown in <a href="#calibre_link-1733">Figure 7-33(c)</a>. The subscript “gs,ss” means a guaranteed-stable single-section FSF. The <em class="calibre7">z</em>-domain transfer function of a guaranteed-stable <em class="calibre7">N-</em>section complex FSF is</p>
<p class="caption"><a id="calibre_link-271"></a>(7-53)</p>
<p class="image"><img src="images/001728.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2461"></a>where the subscript “gs,cplx” means a guaranteed-stable complex multisection FSF. The frequency response of a guaranteed-stable multisection complex FSF (derived in <a href="#calibre_link-297">Appendix G</a>, <a href="#calibre_link-735">Section G.4</a>) is</p>
<p class="caption"><a id="calibre_link-2916"></a>(7-54)</p>
<p class="image"><img src="images/001477.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If we modify the bandpass FSF structure in <a href="#calibre_link-1731">Figure 7-32(a)</a> to force the zeros and poles inside the unit circle, we have the structure shown in <a href="#calibre_link-1695">Figure 7-34(a)</a>. The frequency-domain effects of zeros and poles inside the unit circle are significant, as can be seen in <a href="#calibre_link-1695">Figure 7-34(b)</a> for the two cases where <em class="calibre7">r</em> = 0.95 and <em class="calibre7">r</em> = 0.9999.</p>
<p class="caption"><a id="calibre_link-1695"></a><strong class="calibre9">Figure 7-34</strong> Guaranteed-stable <em class="calibre7">N</em> = 32 three-section linear-phase complex bandpass FSF: (a) implementation; (b) frequency response for two values of damping factor <em class="calibre7">r</em>.</p>
<p class="image"><img src="images/001022.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a href="#calibre_link-1695">Figure 7-34(b)</a> shows how a value of <em class="calibre7">r</em> = 0.95 badly corrupts our complex bandpass FSF performance; the stopband attenuation is degraded, and significant phase nonlinearity is apparent. Damping factor <em class="calibre7">r</em> values of less than unity cause phase nonlinearity because the filter is in a <em class="calibre7">nonreciprocal zero</em> condition. Recall a key characteristic of FIR filters: To maintain linear phase, any <em class="calibre7">z</em>-plane zero located inside the unit circle at <em class="calibre7">z</em> = <em class="calibre7">z<sub class="calibre12">r</sub></em><sub class="calibre12">&lt;1</sub>(<em class="calibre7">k</em>), where <em class="calibre7">z<sub class="calibre12">r</sub></em><sub class="calibre12">&lt;1</sub>(<em class="calibre7">k</em>) is not equal to 0, must be accompanied by a zero at a reciprocal location, namely, <em class="calibre7">z</em> = 1/<em class="calibre7">z<sub class="calibre12">r</sub></em><sub class="calibre12">&lt;1</sub>(<em class="calibre7">k</em>) outside the unit circle. We do not satisfy this condition here, leading to phase nonlinearity. (The reader should have anticipated nonlinear phase due to the asymmetrical impulse response in <a href="#calibre_link-1733">Figure 7-33(b)</a>.) The closer we can place the zeros to the unit circle, the more linear the phase response. So <a id="calibre_link-2289"></a>the recommendation is to define <em class="calibre7">r</em> to be as close to unity as your binary number format allows<a href="#calibre_link-1735">[26]</a>. If integer arithmetic is used, set <em class="calibre7">r</em> = 1−1/2<em class="calibre7"><sup class="calibre10">B</sup></em>, where <em class="calibre7">B</em> is the number of bits used to represent a filter coefficient magnitude.</p>
<p class="calibre3">Another stabilization method worth considering is decrementing the largest component (either real or imaginary) of a resonator’s <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">2π<em class="calibre7">k</em>/<em class="calibre7">N</em></sup> feedback coefficient by one least significant bit. This technique can be applied selectively to problematic resonators and is effective in combating instability due to rounding errors, which results in finite-precision <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">2π<em class="calibre7">k</em>/<em class="calibre7">N</em></sup> coefficients having magnitudes greater than unity.</p>
<p class="calibre3">Thus far we’ve reviewed FSFs with complex coefficients and frequency magnitude responses not symmetrical about zero Hz. Next we explore FSFs with real-only coefficients having conjugate-symmetric frequency magnitude and phase responses.</p>
<p class="calibre3"><a id="calibre_link-2917"></a></p>
<h4 class="calibre13">7.5.4 Multisection Real-Valued FSFs</h4>
<p class="calibre3">We can obtain real-FSF structures (real-valued coefficients) by forcing our complex <em class="calibre7">N-</em>section FSF, where <em class="calibre7">N</em> is even, to have conjugate poles, by ensuring that all nonzero <em class="calibre7">H</em>(<em class="calibre7">k</em>) gain factors are accompanied by conjugate <em class="calibre7">H</em>(<em class="calibre7">N</em>−<em class="calibre7">k</em>) gain factors, so that <em class="calibre7">H</em>(<em class="calibre7">N</em>−<em class="calibre7">k</em>) = <em class="calibre7">H</em>*(<em class="calibre7">k</em>). That is, we can build real-valued FSFs if we use conjugate pole pairs located at angles of ±2π<em class="calibre7">k/N</em> radians. The transfer function of such an FSF (derived in <a href="#calibre_link-297">Appendix G</a>, <a href="#calibre_link-736">Section G.5</a>) is</p>
<p class="caption"><a id="calibre_link-1736"></a>(7-55)</p>
<p class="image"><img src="images/000735.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where the subscript “gs,real” means a guaranteed-stable real-valued multisection FSF, and ϕ<em class="calibre7"><sub class="calibre12">k</sub></em> is the desired phase angle of the <em class="calibre7">k</em>th section. <a href="#calibre_link-1736">Eq. (7-55)</a> defines the structure of a <em class="calibre7">Type-I real FSF</em> to be as shown in <a href="#calibre_link-1737">Figure 7-35(a)</a>, requiring five multiplies per resonator output sample. The implementation of a real pole-pair resonator, using real-only arithmetic, is shown in <a href="#calibre_link-1737">Figure 7-35(b)</a>.</p>
<p class="caption"><a id="calibre_link-1737"></a><strong class="calibre9">Figure 7-35</strong> Guaranteed-stable, even-<em class="calibre7">N</em>, Type-I real FSF: (a) structure; (b) using real-only resonator coefficients.</p>
<p class="image"><img src="images/000073.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Of course, for lowpass FSFs the stage associated with the <em class="calibre7">H</em>(<em class="calibre7">N</em>/2) gain factor in <a href="#calibre_link-1737">Figure 7-35</a> would not be implemented, and for bandpass FSFs neither stage associated with the <em class="calibre7">H</em>(0) and <em class="calibre7">H</em>(<em class="calibre7">N</em>/2) gain factors would be implemented. The behavior of a single-section Type-I real FSF with <em class="calibre7">N</em> = 32, <em class="calibre7">k</em> = 3, <em class="calibre7">H</em>(3) = 1, <em class="calibre7">r</em> = 0.99999, and ϕ<sub class="calibre12">3</sub> = 0 is provided in <a href="#calibre_link-1738">Figure 7-36</a>.</p>
<p class="caption"><a id="calibre_link-1738"></a><strong class="calibre9">Figure 7-36</strong> Time- and frequency-domain characteristics of a single-section Type-I FSF when <em class="calibre7">N</em> = 32, <em class="calibre7">k</em> = 3, <em class="calibre7">H</em>(3) = 1, <em class="calibre7">r</em> = 0.99999, and ϕ3 = 0.</p>
<p class="image"><img src="images/001453.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">An alternate version of the Type-I FSF, with a simplified resonator structure, can be developed by setting all ϕ<em class="calibre7"><sub class="calibre12">k</sub></em> values equal to zero and moving the gain factor of two inside the resonators. Next we incorporate the alternating <a id="calibre_link-2918"></a>signs in the final summation as shown in <a href="#calibre_link-1739">Figure 7-37</a> to achieve linear phase, just as we did to arrive at the linear-phase multisection complex FSF in <a href="#calibre_link-1731">Figure 7-32(a)</a>, by adding the even-<em class="calibre7">k</em> and subtracting the odd-<em class="calibre7">k</em> resonator outputs. The “±” symbol in <a href="#calibre_link-1739">Figure 7-37(a)</a> warns us that when <em class="calibre7">N</em> is even, <em class="calibre7">k</em> = (<em class="calibre7">N</em>/2) −1 can be odd or even.</p>
<p class="caption"><a id="calibre_link-1739"></a><strong class="calibre9">Figure 7-37</strong> Linear-phase, even-<em class="calibre7">N</em>, Type-II real FSF: (a) structure; (b) real-only resonator implementation.</p>
<p class="image"><img src="images/000489.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If the nonzero |<em class="calibre7">H</em>(<em class="calibre7">k</em>)| gain factors are unity, this Type-II real FSF requires only three multiplies per section output sample. When a resonator’s multiply by 2 can be performed by a hardware binary arithmetic left shift, <a id="calibre_link-2919"></a>only two multiplies are needed per output sample. The transfer function of this real-valued FSF is</p>
<p class="caption"><a id="calibre_link-2920"></a>(7-56)</p>
<p class="image"><img src="images/000488.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Neither the Type-I nor the Type-II FSF has exactly linear phase. While the phase nonlinearity is relatively small, their passband group delays can have a peak-to-peak fluctuation of up to two sample periods (2/<em class="calibre7">f<sub class="calibre12">s</sub></em>) when used in multisection applications. This phase nonlinearity is unavoidable because those FSFs have isolated zeros located at <em class="calibre7">z</em> = <em class="calibre7">r</em>cos(2π<em class="calibre7">k/N</em>), when ϕ<em class="calibre7"><sub class="calibre12">k</sub></em> = 0, as shown in <a href="#calibre_link-1738">Figure 7-36(c)</a>. Because the isolated zeros inside the unit circle have no accompanying reciprocal zeros located outside the unit circle at <em class="calibre7">z</em> = 1/[<em class="calibre7">r</em>cos(2π<em class="calibre7">k/N</em>)], sadly, this causes phase nonlinearity.</p>
<p class="calibre3">While the Type-I and -II FSFs are the most common types described in the literature of FSFs, their inability to yield exact linear phase has not received <a id="calibre_link-2287"></a>sufficient attention or analysis. In the next section we take steps to obtain linear phase by repositioning the isolated zero.</p>
<p class="calibre3"><a id="calibre_link-2921"></a></p>
<h4 class="calibre13">7.5.5 Linear-Phase Multisection Real-Valued FSFs</h4>
<p class="calibre3">We can achieve exact real-FSF phase linearity by modifying the Type-I real FSF resonator’s feedforward coefficients, in <a href="#calibre_link-1737">Figure 7-35(b)</a>, moving the isolated zero on top of the comb filter’s zero located at <em class="calibre7">z</em> = <em class="calibre7">r</em>. We do this by setting ϕ<em class="calibre7"><sub class="calibre12">k</sub></em> = π<em class="calibre7">k/N</em>. The numerator of the transfer function of one section of the real FSF, from <a href="#calibre_link-1736">Eq. (7-55)</a>, is</p>
<p class="center">cos(ϕ<em class="calibre7"><sub class="calibre12">k</sub></em>) −<em class="calibre7">r</em>cos(ϕ<em class="calibre7"><sub class="calibre12">k</sub></em>−2π<em class="calibre7">k/N</em>)<em class="calibre7">z</em><sup class="calibre10">−1</sup>.</p>
<p class="calibre3">If we set this expression equal to zero, and let ϕ<em class="calibre7"><sub class="calibre12">k</sub></em> = π<em class="calibre7">k/N</em>, we find that the shifted isolated zero location <em class="calibre7">z</em><sub class="calibre12">0</sub> is</p>
<p class="center">cos(ϕ<em class="calibre7"><sub class="calibre12">k</sub></em>) −<em class="calibre7">r</em>cos(ϕ<em class="calibre7"><sub class="calibre12">k</sub></em>−2π<em class="calibre7">k/N</em>)<em class="calibre7">z</em><sub class="calibre12">0</sub><sup class="calibre10">−1</sup> = cos(π<em class="calibre7">k/N</em>) −<em class="calibre7">r</em>cos(π<em class="calibre7">k/N</em>−2π<em class="calibre7">k/N</em>)<em class="calibre7">z</em><sub class="calibre12">0</sub><sup class="calibre10">−1</sup> = 0</p>
<p class="calibre3">or</p>
<p class="image"><img src="images/001066.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Substituting π<em class="calibre7">k/N</em> for ϕ<em class="calibre7"><sub class="calibre12">k</sub></em> in <a href="#calibre_link-1736">Eq. (7-55)</a> yields the transfer function of a linear-phase Type-III real FSF as</p>
<p class="caption"><a id="calibre_link-2922"></a>(7-57)</p>
<p class="image"><img src="images/001354.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The implementation of the linear-phase Type-III real FSF is shown in <a href="#calibre_link-1740">Figure 7-38</a>, requiring four multiplies per section output sample.</p>
<p class="caption"><a id="calibre_link-1740"></a><strong class="calibre9">Figure 7-38</strong> Even-<em class="calibre7">N</em>, linear-phase, Type-III real FSF: (a) structure; (b) real-only resonator implementation.</p>
<p class="image"><img src="images/001356.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2923"></a>Notice that the <em class="calibre7">H</em>(<em class="calibre7">N</em>/2), <em class="calibre7">f<sub class="calibre12">s</sub></em>/2, section is absent in <a href="#calibre_link-1740">Figure 7-38(a)</a>. We justify this as follows: The even-<em class="calibre7">N</em> Type-I, -II, and -III real-FSF sections have impulse responses comprising <em class="calibre7">N</em> nonzero samples. As such, their <em class="calibre7">k</em> = <em class="calibre7">N</em>/2 sections’ impulse responses, comprising even-length sequences of alternating plus and minus ones, are not symmetrical. This asymmetry property would corrupt the exact linear phase should a <em class="calibre7">k</em> = <em class="calibre7">N</em>/2 section be included. Consequently, as with even-length nonrecursive FIR filters, even-<em class="calibre7">N</em> Type-I, -II, and -III real FSFs cannot be used to implement linear-phase highpass filters.</p>
<p class="calibre3"><a href="#calibre_link-1741">Figure 7-39</a> shows the frequency-domain performance of an eight-section Type-III FSF, for <em class="calibre7">N</em> = 32 where the eight sections begin at DC (0 ≤ <em class="calibre7">k</em> ≤ 7). <a href="#calibre_link-1741">Figure 7-39(c)</a> provides a group delay comparison between the Type-III FSF and an equivalent eight-section Type-II FSF showing the improved Type-III phase linearity having a constant group delay of (<em class="calibre7">N</em>−1)/2 samples over the passband.</p>
<p class="caption"><a id="calibre_link-1741"></a><strong class="calibre9">Figure 7-39</strong> Interpolated frequency-domain response of a Type-III FSF having eight sections with <em class="calibre7">N</em> = 32: (a) magnitude response; (b) phase response; (c) group delay compared with an equivalent Type-II FSF.</p>
<p class="image"><img src="images/000384.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2924"></a></p>
<h4 class="calibre13"><a id="calibre_link-2925"></a>7.5.6 Where We’ve Been and Where We’re Going with FSFs</h4>
<p class="calibre3">We’ve reviewed the structure and behavior of a complex FSF whose complex resonator stages had poles residing atop the zeros of a comb filter, resulting in a recursive FIR filter. Next, to ensure filter implementation stability, we forced the pole/zero locations to be just inside the unit circle. We examined a guaranteed-stable even-<em class="calibre7">N</em> Type-I real FSF having resonators with conjugate pole pairs, resulting in an FSF with real-valued coefficients. Next, we modified the Type-I real-FSF structure, yielding the more computationally efficient but only moderately linear-phase Type-II real FSF. Finally, we modified the coefficients of the Type-I real FSF and added post-resonator gain factors, resulting in the exact linear-phase Type-III real FSF. During this development, we realized that the even-<em class="calibre7">N</em> Type-I, -II, and -III real FSFs cannot be used to implement linear-phase highpass filters.</p>
<p class="calibre3">In the remainder of this section we introduce a proposed resonator structure that provides superior filtering properties compared to the Type-I, -II, and -III resonators. Next we’ll examine the use of nonzero transition band filter sections to improve overall FSF passband ripple and stopband attenuation, followed by a discussion of several issues regarding modeling and designing FSFs. We’ll compare the performance of real FSFs to their equivalent Parks-McClellan-designed <em class="calibre7">N-</em>tap nonrecursive FIR filters. Finally, a detailed FSF design procedure is presented.</p>
<p class="calibre3"><a id="calibre_link-2926"></a></p>
<h4 class="calibre13">7.5.7 An Efficient Real-Valued FSF</h4>
<p class="calibre3">There are many real-valued resonators that can be used in FSFs, but of particular interest to us is the Type-IV resonator presented in <a href="#calibre_link-1742">Figure 7-40(a)</a>. This resonator deserves attention because it</p>
<p class="indenthangingb">• is guaranteed stable,</p>
<p class="indenthangingb">• exhibits highly linear phase,</p>
<p class="indenthangingb">• uses real-valued coefficients,</p>
<p class="indenthangingb">• is computationally efficient,</p>
<p class="indenthangingb">• can implement highpass FIR filters, and</p>
<p class="indenthangingb">• yields stopband attenuation performance superior to the Type-I, -II, and -III FSFs.</p>
<p class="caption"><a id="calibre_link-1742"></a><strong class="calibre9">Figure 7-40</strong> Type-IV resonator: (a) original structure; (b) simplified version.</p>
<p class="image"><img src="images/000141.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">From here on, the Type IV will be our FSF of choice.</p>
<p class="calibre3">Cascading Type-IV resonators with a comb filter provide a Type-IV real-only FSF with a transfer function of</p>
<p class="caption"><a id="calibre_link-276"></a>(7-58)</p>
<p class="image"><img src="images/000382.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2045"></a>where <em class="calibre7">N</em> is even. (Note: When <em class="calibre7">N</em> is odd, <em class="calibre7">k</em> = <em class="calibre7">N</em>/2 is not an integer and the |<em class="calibre7">H</em>(<em class="calibre7">N</em>/2)| term does not exist.) As derived in <a href="#calibre_link-297">Appendix G</a>, <a href="#calibre_link-737">Section G.6</a>, the Type-IV FSF frequency response is</p>
<p class="caption"><a id="calibre_link-1765"></a>(7-59)</p>
<p class="image"><img src="images/001234.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The even-<em class="calibre7">N</em> frequency and resonance magnitude responses for a single Type-IV FSF section are</p>
<p class="caption"><a id="calibre_link-2927"></a>(7-60)</p>
<p class="image"><img src="images/000271.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">and</p>
<p class="caption"><a id="calibre_link-2928"></a>(7-61)</p>
<p class="image"><img src="images/001114.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">and its resonant magnitude gains at <em class="calibre7">k</em> = 0 (DC), and <em class="calibre7">k</em> = <em class="calibre7">N</em>/2 (<em class="calibre7">f<sub class="calibre12">s</sub></em>/2), are</p>
<p class="caption"><a id="calibre_link-1745"></a>(7-62)</p>
<p class="image"><img src="images/000165.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To reduce the number of resonator multiply operations, it is tempting to combine the dual −<em class="calibre7">r</em><sup class="calibre10">2</sup> factors in <a href="#calibre_link-1742">Figure 7-40(a)</a> to simplify the Type-IV resonator as shown in <a href="#calibre_link-1742">Figure 7-40(b)</a>. However, a modification reducing both the number of multiply and addition operations in each FSF resonator is to implement the (1−<em class="calibre7">r</em><sup class="calibre10">2</sup><em class="calibre7">z</em><sup class="calibre10">−2</sup>) term in the numerator of <a href="#calibre_link-276">Eq. (7-58)</a> as a second-order comb filter as shown in <a href="#calibre_link-1743">Figure 7-41(a)</a><a href="#calibre_link-1744">[27]</a>. This transforms the Type-IV resonator to that shown in <a href="#calibre_link-1743">Figure 7-41(b)</a>. The |<em class="calibre7">H</em>(0)|/2 and |<em class="calibre7">H</em>(<em class="calibre7">N</em>/2)|/2 gain factors compensate for the gain of 2<em class="calibre7">N</em> for a Type-IV resonator in <a href="#calibre_link-1745">Eq. (7-62)</a>.</p>
<p class="caption"><a id="calibre_link-1743"></a><strong class="calibre9">Figure 7-41</strong> Type-IV, even-<em class="calibre7">N</em>, real FSF: (a) structure; (b) its modified resonator.</p>
<p class="image"><img src="images/000274.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The cascaded-comb subfilter combination has <em class="calibre7">N</em> zeros spaced around the unit circle with dual <em class="calibre7">z</em>-plane zeros at <em class="calibre7">z</em> = 1 (0 Hz) and dual zeros at <em class="calibre7">z</em> = −1 <a id="calibre_link-2288"></a>(<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz). However, the <em class="calibre7">k</em> = 0 and <em class="calibre7">k</em> = <em class="calibre7">N</em>/2 Type-IV resonators have dual poles at <em class="calibre7">z</em> = ±1, respectively, enabling the necessary pole/zero cancellation.</p>
<p class="calibre3">The “±” symbols in <a href="#calibre_link-1743">Figure 7-41(a)</a> remind us, again, that when <em class="calibre7">N</em> is even, <em class="calibre7">k</em> = <em class="calibre7">N</em>/2 could be odd or even. This FSF has the very agreeable characteristic of having an impulse response whose length is <em class="calibre7">N</em>+1 samples. Thus, unlike the Type-I, -II, and -III FSFs, an even-<em class="calibre7">N</em> Type-IV FSF’s <em class="calibre7">k</em> = <em class="calibre7">N</em>/2 section impulse response (alternating ±1s) is symmetrical, and Type-IV FSFs can be used to build linear-phase highpass filters. When <em class="calibre7">N</em> is odd, the <em class="calibre7">k</em> = <em class="calibre7">N</em>/2 section is absent in <a href="#calibre_link-1743">Figure 7-41</a>, and the odd-<em class="calibre7">N</em> Type-IV transfer function is identical to <a href="#calibre_link-276">Eq. (7-58)</a> with the summation’s upper limit being (<em class="calibre7">N</em>−1)/2 instead of <em class="calibre7">N</em>/2.</p>
<p class="calibre3">We’ve covered a lot of ground thus far, so <a href="#calibre_link-1746">Table 7-3</a> summarizes what we’ve discussed concerning real-valued FSFs. The table lists the average passband group delay measured in sample periods, the number of multiplies and additions necessary per output sample for a single FSF section, and a few remarks regarding the behavior of the various real FSFs. The section gains at their resonant frequencies, assuming the desired |<em class="calibre7">H</em>(<em class="calibre7">k</em>)| gain factors are unity, is <em class="calibre7">N</em> for all four of the real-valued FSFs.</p>
<p class="caption"><a id="calibre_link-1746"></a><strong class="calibre9">Table 7-3</strong> Summary of Even-N Real FSF Properties</p>
<p class="image"><img src="images/001379.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2929"></a></p>
<h4 class="calibre13">7.5.8 Modeling FSFs</h4>
<p class="calibre3">We derived several different <em class="calibre7">H</em>(<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup>) frequency response equations here, not so much to use them for modeling FSF performance but to examine them in order to help define the structure of our FSF block diagrams. For example, it <a id="calibre_link-2292"></a>was analyzing the properties of <em class="calibre7">H</em><sub class="calibre12">Type-IV</sub>(<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup>) that motivated the use of the 1/2 gain factors in the Type-IV FSF structure.</p>
<p class="calibre3">When modeling the FSFs, fortunately it’s not necessary to write code to calculate frequency-domain responses using the various <em class="calibre7">H</em>(<em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup>) equations provided here. All that’s necessary is code to compute the time-domain impulse response of the FSF being modeled, pad the impulse response with enough zeros so the padded sequence is 10 to 20 times the length of the original, perform a discrete Fourier transform (DFT) on the padded sequence, and plot the resulting interpolated frequency-domain magnitude and phase. Of course, forcing your padded sequence length to be an integer power of two enables the use of the efficient FFT to calculate frequency-domain responses. Alternatively, many commercial signal processing software packages have built-in functions to calculate filter frequency response curves based solely on the filter’s transfer function coefficients.</p>
<p class="calibre3"><a id="calibre_link-2930"></a></p>
<h4 class="calibre13">7.5.9 Improving Performance with Transition Band Coefficients</h4>
<p class="calibre3">We can increase FSF stopband attenuation if we carefully define |<em class="calibre7">H</em>(<em class="calibre7">k</em>)| magnitude samples in the transition region, between the passband and stopband. For example, consider a lowpass Type-IV FSF having seven sections, of unity gain, with <em class="calibre7">N</em> = 32, whose desired performance is shown in <a href="#calibre_link-1747">Figure 7-42(a)</a>, and whose interpolated (actual) frequency magnitude response is provided in <a href="#calibre_link-1747">Figure 7-42(b)</a>.</p>
<p class="caption"><a id="calibre_link-2931"></a><a id="calibre_link-1747"></a><strong class="calibre9">Figure 7-42</strong> Seven-section, <em class="calibre7">N</em> = 32, Type-IV FSF: (a) desired frequency response; (b) actual performance; (c) using one transition sample; (d) improved stopband attenuation.</p>
<p class="image"><img src="images/001117.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The assignment of a transition magnitude sample, coefficient <em class="calibre7">T</em><sub class="calibre12">1</sub> whose value is between 0 and 1 as in <a href="#calibre_link-1747">Figure 7-42(c)</a>, reduces the abruptness in the transition region between the passband and the stopband of our desired magnitude response. Setting <em class="calibre7">T</em><sub class="calibre12">1</sub> = 0.389 results in reduced passband ripple and the improved stopband sidelobe suppression shown in <a href="#calibre_link-1747">Figure 7-42(d)</a>. The price we pay for the improved performance is the computational cost of an additional FSF section and increased width of the transition region.</p>
<p class="calibre3">Assigning a coefficient value of <em class="calibre7">T</em><sub class="calibre12">1</sub> = 0.389 was not arbitrary or magic. Measuring the maximum stopband sidelobe level for various values of 0 ≤ <em class="calibre7">T</em><sub class="calibre12">1</sub> ≤ 1 reveals the existence of an optimum value for <em class="calibre7">T</em><sub class="calibre12">1</sub>. <a href="#calibre_link-1748">Figure 7-43</a> shows that the maximum stopband sidelobe level is minimized when <em class="calibre7">T</em><sub class="calibre12">1</sub> = 0.389. The minimum sidelobe level of −46 dB (when <em class="calibre7">T</em><sub class="calibre12">1</sub> = 0.389) corresponds to the height of the maximum stopband sidelobe in <a href="#calibre_link-1747">Figure 7-42(d)</a>. This venerable and well-known method of employing a transition region coefficient to <a id="calibre_link-2063"></a>reduce passband ripple and minimize stopband sidelobe levels also applies to bandpass FSF design where the transition sample is used just before and just after the filter’s passband unity-magnitude |<em class="calibre7">H</em>(<em class="calibre7">k</em>)| samples.</p>
<p class="caption"><a id="calibre_link-1748"></a><strong class="calibre9">Figure 7-43</strong> Maximum stopband sidelobe level as a function of the transition region coefficient value for a seven-section Type-IV real FSF when <em class="calibre7">N</em> = 32.</p>
<p class="image"><img src="images/000217.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Further stopband sidelobe level suppression is possible if two transition coefficients, <em class="calibre7">T</em><sub class="calibre12">1</sub> and <em class="calibre7">T</em><sub class="calibre12">2</sub>, are used such that 0 ≤ <em class="calibre7">T</em><sub class="calibre12">2</sub> ≤ <em class="calibre7">T</em><sub class="calibre12">1</sub> ≤ 1. (Note: For lowpass filters, if <em class="calibre7">T</em><sub class="calibre12">1</sub> is the |<em class="calibre7">H</em>(<em class="calibre7">k</em>)| sample, then <em class="calibre7">T</em><sub class="calibre12">2</sub> is the |<em class="calibre7">H</em>(<em class="calibre7">k</em>+1)| sample.) Each additional transition coefficient used improves the stopband attenuation by approximately 25 dB. However, finding the optimum values for the <em class="calibre7">T</em> coefficients is a daunting task. Optimum transition region coefficient values depend on the number of unity-gain FSF sections, the value of <em class="calibre7">N</em>, and the number of coefficients used; and unfortunately there’s no closed-form equation available to calculate optimum transition coefficient values. We must search for them empirically.</p>
<p class="calibre3">If one coefficient (<em class="calibre7">T</em><sub class="calibre12">1</sub>) is used, finding its optimum value can be considered a one-dimensional search. If two coefficients are used, the search becomes two-dimensional, and so on. Fortunately, descriptions of linear algebra search techniques are available[<a href="#calibre_link-1716">23</a>,<a href="#calibre_link-1749">28</a>−<a href="#calibre_link-1750">30</a>], and commercial mathematical software packages have built-in <em class="calibre7">optimization</em> functions to facilitate this computationally intensive search. For Type-I/II FSFs, tables of optimum transition region coefficients for various <em class="calibre7">N</em>, and number of FSF sections used, have been published<a href="#calibre_link-1716">[23]</a>, and a subset of those tables is provided as an appendix in a textbook<a href="#calibre_link-1751">[24]</a>. For the higher-performance Type-IV FSFs, tables of optimum coefficient values have been compiled by the author and are provided in <a href="#calibre_link-298">Appendix H</a>. With this good news in mind, shortly we’ll look at a real-world FSF design example to appreciate the benefits of FSFs.</p>
<p class="calibre3"><a id="calibre_link-2932"></a></p>
<h4 class="calibre13">7.5.10 Alternate FSF Structures</h4>
<p class="calibre3">With the primary comb filter in <a href="#calibre_link-1743">Figure 7-41</a> having a feedforward coefficient of −<em class="calibre7">r<sup class="calibre10">N</sup></em>, its even-<em class="calibre7">N</em> transfer function zeros are equally spaced around and inside <a id="calibre_link-2933"></a>the unit circle, as shown in <a href="#calibre_link-1720">Figures 7-23(c)</a> and <a href="#calibre_link-98">7-44(a)</a>, so the <em class="calibre7">k</em> = 1 zero is at an angle of 2π/<em class="calibre7">N</em> radians. In this Case I, if <em class="calibre7">N</em> is odd, the comb’s zeros are spaced as shown in <a href="#calibre_link-98">Figure 7-44(b)</a>. An alternate situation, Case II, exists when the comb filter’s feedforward coefficient is +<em class="calibre7">r<sup class="calibre10">N</sup></em>. In this mode, an even-<em class="calibre7">N</em> comb filter’s zeros are rotated counterclockwise on the unit circle by π/<em class="calibre7">N</em> radians as shown in <a href="#calibre_link-98">Figure 7-44(c)</a>, where the comb’s <em class="calibre7">k</em> = 1 zero is at an angle of 3π/<em class="calibre7">N</em> radians<a href="#calibre_link-1744">[27]</a>. The <em class="calibre7">k</em> = 0 zeros are shown as solid dots.</p>
<p class="caption"><a id="calibre_link-98"></a><strong class="calibre9">Figure 7-44</strong> Four possible orientations of comb filter zeros near the unit circle.</p>
<p class="image"><img src="images/001007.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The structure of a Case II FSF is identical to that of a Case I FSF; however, the Case II resonators’ coefficients must be altered to rotate the poles by π/<em class="calibre7">N</em> radians to ensure pole/zero cancellation. As such, the transfer function of a Case II, even-<em class="calibre7">N</em>, Type-IV FSF is</p>
<p class="caption"><a id="calibre_link-2934"></a>(7-63)</p>
<p class="image"><img src="images/001102.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Because a Case II FSF cannot have a pole or a zero at <em class="calibre7">z</em> = 1 (DC), these FSFs are unable to build lowpass filters, in which case the <em class="calibre7">z</em><sup class="calibre10">−2</sup>-delay comb filter in <a href="#calibre_link-1743">Figure 7-41(a)</a> is not implemented. <a href="#calibre_link-1752">Table 7-4</a> lists the filtering capabilities of the various Case I and Case II Type-IV FSFs.</p>
<p class="caption"><a id="calibre_link-2173"></a><a id="calibre_link-1752"></a><strong class="calibre9">Table 7-4</strong> Type-IV FSF Modes of Operation</p>
<p class="image"><img src="images/000422.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Their inability to implement lowpass filtering limits the utility of Case II FSFs, but their resonators’ shifted center frequencies do provide some additional flexibility in defining the cutoff frequencies of bandpass and highpass filters. The remainder of this material considers only the Case I Type-IV FSFs.</p>
<p class="calibre3"><a id="calibre_link-2935"></a></p>
<h4 class="calibre13">7.5.11 The Merits of FSFs</h4>
<p class="calibre3">During the formative years of FIR filter theory (early 1970s) a computer program was made available for designing nonrecursive FIR filters using the Parks-McClellan (PM) method<a href="#calibre_link-1753">[31]</a>. This filter design technique provided complete control in defining desired passband ripple, stopband attenuation, and transition region width. (FIR filters designed using the PM method are often called <em class="calibre7">optimal FIR</em>, <em class="calibre7">Remez Exchange</em>, or <em class="calibre7">equiripple</em> filters.) Many of the early descriptions of the PM design method included a graphical comparison of various lowpass FIR filter design methods similar to that redrawn in <a href="#calibre_link-1754">Figure 7-45</a>[<a href="#calibre_link-1755">29</a>,<a href="#calibre_link-1756">32</a>,<a href="#calibre_link-1757">33</a>]. In this figure, a given filter’s normalized (to impulse response length <em class="calibre7">N</em>, and the sample rate <em class="calibre7">f<sub class="calibre12">s</sub></em>) transition bandwidth is plotted as a function of its minimum stopband attenuation. (Passband peak-to-peak ripple values, measured in dB, are provided numerically within the figure.)</p>
<p class="caption"><a id="calibre_link-1754"></a><strong class="calibre9">Figure 7-45</strong> Comparison of the Kaiser window, frequency sampling, and Parks-McClellan-designed FIR filters.</p>
<p class="image"><img src="images/000055.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Because the normalized transition bandwidth measure <em class="calibre7">D</em> in <a href="#calibre_link-1754">Figure 7-45</a> is roughly independent of <em class="calibre7">N</em>, this diagram is considered to be a valid performance comparison of the three FIR filter design methods. For a given passband ripple and stopband attenuation, the PM-designed FIR filter could exhibit the narrowest transition bandwidth, thus the highest performance filter. The wide dissemination of <a href="#calibre_link-1754">Figure 7-45</a> justifiably biased filter designers toward the PM design method. (During his discussion of <a href="#calibre_link-1754">Figure 7-45</a>, one author boldly declared, “The smaller is <em class="calibre7">D</em>, the better is the filter”<a href="#calibre_link-1756">[32]</a>.) Given its flexibility, improved performance, and ease of use, the PM method quickly became the predominant FIR filter design technique. Consequently, in the 1970s FSF implementations lost favor to the point where they’re rarely mentioned in today’s DSP classrooms or textbooks.</p>
<p class="calibre3">However, from a computational workload standpoint, <a href="#calibre_link-1754">Figure 7-45</a> is like modern swimwear: what it shows is important; what it does not show is vital. That design comparison does not account for those situations where <a id="calibre_link-2269"></a>both frequency sampling and PM filters meet the filter performance requirements but the frequency sampling implementation is more computationally efficient. The following FIR filter design example illustrates this issue and shows why FSFs should be included in our bag of FIR filter design tools.</p>
<p class="calibre3"><a id="calibre_link-2936"></a></p>
<h4 class="calibre13">7.5.12 Type-IV FSF Example</h4>
<p class="calibre3">Consider the design of a linear-phase lowpass FIR filter whose cutoff frequency is 0.05 times the sample rate <em class="calibre7">f<sub class="calibre12">s</sub></em>, the stopband must begin at 0.095 times <em class="calibre7">f<sub class="calibre12">s</sub></em>, the maximum passband ripple is 0.3 dB peak to peak, and the minimum stopband attenuation must be 65 dB. If we designed a six-section Type-IV FSF with <em class="calibre7">N</em> = 62 and <em class="calibre7">r</em> = 0.99999, its frequency-domain performance satisfies our requirements and is the solid curve in <a href="#calibre_link-1758">Figure 7-46(a)</a>.</p>
<p class="caption"><a id="calibre_link-1758"></a><strong class="calibre9">Figure 7-46</strong> An <em class="calibre7">N</em> = 62, six-section Type-IV real FSF (solid) versus a 60-tap PM-designed filter (dashed): (a) frequency magnitude response; (b) passband response detail.</p>
<p class="image"><img src="images/000903.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">For this FSF, two transition region coefficients of |<em class="calibre7">H</em>(4)| = <em class="calibre7">T</em><sub class="calibre12">1</sub> = 0.589921 and |<em class="calibre7">H</em>(5)| = <em class="calibre7">T</em><sub class="calibre12">2</sub> = 0.104964 were used. Included in <a href="#calibre_link-1758">Figure 7-46(a)</a>, the dashed curve, is the magnitude response of a PM-designed 60-tap nonrecursive FIR filter. Both filters meet the performance requirements and have linear phase. The structure of the Type-IV FSF is provided in <a href="#calibre_link-1759">Figure 7-47</a>. A PM-designed filter implemented using a <em class="calibre7">folded</em> nonrecursive FIR structure (as discussed in <a href="#calibre_link-148">Section 13.7</a>), exploiting its impulse response symmetry to halve the number of multipliers, requires 30 multiplies and 59 adds per output sample. We see the computational savings of the Type-IV FSF, which requires only 17 multiplies and 19 adds per output sample. (Note: The FSF’s <em class="calibre7">H</em>(<em class="calibre7">k</em>) gain factors are all zero for 6 ≤ <em class="calibre7">k</em> ≤ 31.)</p>
<p class="caption"><a id="calibre_link-1759"></a><strong class="calibre9">Figure 7-47</strong> Structure of the <em class="calibre7">N</em> = 62, six-section, lowpass, Type-IV FSF with two transition region coefficients.</p>
<p class="image"><img src="images/001758.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2937"></a></p>
<h4 class="calibre13"><a id="calibre_link-2938"></a>7.5.13 When to Use an FSF</h4>
<p class="calibre3">In this section we answer the burning question “When is it smarter (more computationally efficient) to use a Type-IV FSF instead of a PM-designed FIR filter?” The computational workload of a PM-designed FIR filter is directly related to the length of its time-domain impulse response, which in turn is inversely proportional to the filter transition bandwidth. The narrower the transition bandwidth, the greater the nonrecursive FIR filter’s computational workload measured in arithmetic operations per output sample. On the other <a id="calibre_link-2939"></a>hand, the computational workload of an FSF is roughly proportional to its passband width. The more FSF sections needed for wider bandwidths and the more transition region coefficients used, the higher the FSF’s computational workload. So in comparing the computational workload of FSFs to PM-designed FIR filters, both transition bandwidth and passband width must be considered.</p>
<p class="calibre3"><a href="#calibre_link-1760">Figure 7-48</a> provides a computational comparison between even-<em class="calibre7">N</em> Type-IV FSFs and PM-designed nonrecursive lowpass FIR filters. The curves represent desired filter performance parameters where a Type-IV FSF and a PM-designed filter have approximately equal computational workloads per output sample. (The bandwidth values in the figure axis are normalized to the sample rate, so, for example, a frequency value of 0.1 equals <em class="calibre7">f<sub class="calibre12">s</sub></em>/10.) If the desired FIR filter transition region width and passband width combination (a point) lies beneath the curves in <a href="#calibre_link-1760">Figure 7-48</a>, then a Type-IV FSF is computationally more efficient than a PM-designed filter. <a href="#calibre_link-1760">Figure 7-48(a)</a> is a comparison accounting only for multiply operations. For filter implementations where multiplies and adds require equal processor clock cycles, <a href="#calibre_link-1760">Figure 7-48(b)</a> provides the appropriate comparison. The solitary black dot in the figure indicates the comparison curves location for the above <a href="#calibre_link-1758">Figure 7-46</a> Type-IV FSF filter example. (A Type-IV FSF design example using the curves in <a href="#calibre_link-1760">Figure 7-48</a> will be presented later.)</p>
<p class="caption"><a id="calibre_link-1760"></a><strong class="calibre9">Figure 7-48</strong> Computational workload comparison between even-<em class="calibre7">N</em> lowpass Type-IV FSFs and nonrecursive PM FIR filters: (a) only multiplications considered; (b) multiplications and additions considered. (No 1/<em class="calibre7">N</em> gain factor used.)</p>
<p class="image"><img src="images/000786.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-2472"></a>The assumptions made in creating <a href="#calibre_link-1760">Figure 7-48</a> are an even-<em class="calibre7">N</em> Type-IV FSF, damping factor <em class="calibre7">r</em> = 0.99999, and no 1/<em class="calibre7">N</em> gain scaling from <a href="#calibre_link-1715">Figure 7-20(b)</a>. The PM filter implementation used in the comparison assumes a symmetrical impulse response, an <em class="calibre7">M</em>-tap folded structure requiring <em class="calibre7">M</em>/2 multiplies, and <em class="calibre7">M</em>−1 additions. The performance criteria levied on the PM filter are typical Type-IV FSF properties (when floating-point coefficients are used) given in <a href="#calibre_link-1761">Table 7-5</a>.</p>
<p class="caption"><a id="calibre_link-1761"></a><strong class="calibre9">Table 7-5</strong> Typical Even-<em class="calibre7">N</em> Type-IV FSF Properties</p>
<p class="image"><img src="images/001270.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The Type-IV resonators have a gain of <em class="calibre7">N</em>, so the subsequent gain of the FSF in <a href="#calibre_link-1759">Figure 7-47</a> is <em class="calibre7">N</em>. For FSF implementations using floating-point numbers, this gain may not be a major design issue. In filters implemented with fixed-point numbers, the gain of <em class="calibre7">N</em> could cause overflow errors, and a gain reduction by a scaling factor of 1/<em class="calibre7">N</em> may be necessary. Occasionally, in the literature, a 1/<em class="calibre7">N</em> scaling factor is shown as a single multiply just prior to an FSF’s comb filter[<a href="#calibre_link-1751">24</a>,<a href="#calibre_link-1762">34</a>]. This scale factor implementation is likely to cause an intolerable increase in the input signal quantization noise. A more practical approach is to apply the 1/<em class="calibre7">N</em> scaling at the output of each FSF section, prior to the final summation, as indicated in <a href="#calibre_link-1715">Figure 7-20(b)</a>. Thus every FSF resonator output is multiplied by a non-unity value, increasing the computational workload of the FSF. In this situation, the computational comparison between even-<em class="calibre7">N</em> Type-IV FSFs and PM filters becomes as shown in <a href="#calibre_link-1763">Figure 7-49</a>.</p>
<p class="caption"><a id="calibre_link-1763"></a><strong class="calibre9">Figure 7-49</strong> Computational workload comparison between even-<em class="calibre7">N</em> lowpass Type-IV FSFs, with resonator output 1/<em class="calibre7">N</em> scaling included, and nonrecursive PM FIR filters: (a) only multiplications considered; (b) multiplications and additions considered.</p>
<p class="image"><img src="images/001640.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Of course, if <em class="calibre7">N</em> is an integer power of two, some hardware implementations may enable resonator output 1/<em class="calibre7">N</em> scaling with hardwired binary arithmetic right shifts to avoid explicit multiply operations. In this situation, the computational workload comparison in <a href="#calibre_link-1760">Figure 7-48</a> applies.</p>
<p class="calibre3">As of this writing, programmable DSP chips typically cannot take advantage of the folded FIR filter structure assumed in the creation of <a href="#calibre_link-1727">Figures 7-29</a> and <a href="#calibre_link-1729">7-30</a>. In this case, an <em class="calibre7">M</em>-tap direct convolution FIR filter has the disadvantage that it must perform the full <em class="calibre7">M</em> multiplies per output sample. However, DSP chips have the advantage of <em class="calibre7">zero-overhead looping</em> and single-clock-cycle <em class="calibre7">multiply and accumulate</em> (MAC) capabilities, making them more efficient for direct convolution FIR filtering than for filtering using the recursive FSF structures. Thus, a DSP chip implementation’s disadvantage of more necessary <a id="calibre_link-2285"></a>computations and its advantage of faster execution of those computations roughly cancel each other. With those thoughts in mind, we’re safe to use <a href="#calibre_link-1760">Figures 7-48</a> and <a href="#calibre_link-1763">7-49</a> as guides in deciding whether to use a Type-IV FSF or a PM-designed FIR filter in a programmable DSP chip filtering application.</p>
<p class="calibre3">Finally, we conclude, from the last two figures, that Type-IV FSFs are more computationally efficient than PM-designed FIR filters in lowpass applications where the passband is less than approximately <em class="calibre7">f<sub class="calibre12">s</sub></em>/5 and the transition bandwidth is less than roughly <em class="calibre7">f<sub class="calibre12">s</sub></em>/8.</p>
<p class="calibre3"><a id="calibre_link-2940"></a></p>
<h4 class="calibre13">7.5.14 Designing FSFs</h4>
<p class="calibre3">The design of a practical Type-IV FSF comprises three stages: (1) determine if an FSF can meet the desired filter performance requirements, (2) determine if a candidate FSF is more, or less, computationally efficient than an equivalent PM-designed filter, and (3) design the FSF and verify its performance. To aid in the first stage of the design, <a href="#calibre_link-1764">Figure 7-50</a> shows the typical minimum stopband attenuation of Type-IV FSFs, as a function of transition bandwidth, for various numbers of transition region coefficients. (Various values for <em class="calibre7">N</em>, and typical passband ripple performance, are given within <a href="#calibre_link-1764">Figure 7-50</a> as general reference parameters.)</p>
<p class="caption"><a id="calibre_link-2941"></a><a id="calibre_link-1764"></a><strong class="calibre9">Figure 7-50</strong> Typical Type-IV lowpass FSF stopband attenuation performance as a function of transition bandwidth.</p>
<p class="image"><img src="images/000670.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">In designing an FSF, we find the value <em class="calibre7">N</em> to be a function of the desired filter transition bandwidth, and the number of FSF sections required is determined by both <em class="calibre7">N</em> and the desired filter bandwidth. Specifically, given a linear-phase FIR filter’s desired passband width, passband ripple, transition bandwidth, and minimum stopband attenuation, the design of a linear-phase lowpass Type-IV FSF proceeds as follows:</p>
<p class="indenthangingn1"><strong class="calibre9">1.</strong> Using <a href="#calibre_link-1764">Figure 7-50</a>, determine which shaded performance band in the figure satisfies the desired minimum stopband attenuation. This step defines the number of transition coefficients necessary to meet stopband attenuation requirements.</p>
<p class="indenthangingn1"><strong class="calibre9">2.</strong> Ensure that your desired transition bandwidth value resides within the chosen shaded band. (If the transition bandwidth value lies to the right of a shaded band, a PM-designed filter will be more computationally efficient than a Type-IV FSF and the FSF design proceeds no further.)</p>
<p class="indenthangingn1"><strong class="calibre9">3.</strong> Determine if the typical passband ripple performance, provided in <a href="#calibre_link-1764">Figure 7-50</a>, for the candidate shaded band is acceptable. If so, a Type-IV FSF can meet the desired lowpass filter performance requirements. If not, a PM design should be investigated.</p>
<p class="indenthangingn1"><strong class="calibre9">4.</strong> Based on arithmetic implementation priorities, determine the appropriate computational workload comparison chart to be used from <a href="#calibre_link-1760">Figure 7-48</a> <a id="calibre_link-2942"></a>or <a href="#calibre_link-1763">Figure 7-49</a> in determining if an FSF is more efficient than a PM-designed nonrecursive filter.</p>
<p class="indenthangingn1"><strong class="calibre9">5.</strong> Using the desired filter’s transition bandwidth and passband width as coordinates of a point on the selected computational workload comparison chart, determine if that point lies beneath the appropriate curve. If so, an FSF can meet the filter performance requirements with fewer computations per filter output sample than a PM-designed filter. (If the transition bandwidth/passband point lies above the appropriate curve, a PM design should be investigated and the FSF design proceeds no further.)</p>
<p class="indenthangingn1"><strong class="calibre9">6.</strong> Assuming the designer has reached this step of the evaluation process, the design of a Type-IV FSF proceeds by selecting the filter order <em class="calibre7">N</em>. The value of <em class="calibre7">N</em> depends on the desired transition bandwidth and the number of transition coefficients from Step 1 and, when the transition bandwidth is normalized to <em class="calibre7">f<sub class="calibre12">s</sub></em>, can be estimated using</p>
<p class="caption"><a id="calibre_link-2943"></a>(7-64)</p>
<p class="image"><img src="images/000053.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn1"><strong class="calibre9">7.</strong> The required number of unity-gain FSF sections, integer <em class="calibre7">M</em>, is roughly proportional to the desired normalized double-sided passband width divided by the FSF’s frequency resolution (<em class="calibre7">f<sub class="calibre12">s</sub></em>/<em class="calibre7">N</em>) and is estimated using</p>
<p class="caption"><a id="calibre_link-2944"></a>(7-65)</p>
<p class="image"><img src="images/000902.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn1"><strong class="calibre9">8.</strong> Given the initial integer values for <em class="calibre7">N</em> and <em class="calibre7">M</em>, find the appropriate optimized transition coefficient gain values from the compiled tables in <a href="#calibre_link-298">Appendix H</a>. If the tables do not contain optimized coefficients for the given <em class="calibre7">N</em> and <em class="calibre7">M</em> values, the designer may calculate approximate coefficients by linear interpolation of the tabulated values. Alternatively, an optimization software program may be used to find optimized transition coefficients.</p>
<p class="indenthangingn1"><strong class="calibre9">9.</strong> Using the values for <em class="calibre7">N</em>, <em class="calibre7">M</em>, and the optimized transition coefficients, determine the interpolated (actual) frequency response of the filter as a function of those filter parameters. This frequency response can be obtained by evaluating <a href="#calibre_link-1765">Eq. (7-59)</a>. More conveniently, the frequency response can be determined with a commercial signal processing software package to perform the DFT of the FSF’s impulse response sequence, or by using the transfer function coefficients in <a href="#calibre_link-276">Eq. (7-58)</a>.</p>
<p class="indenthangingn1"><strong class="calibre9">10.</strong> Next the fun begins as the values for <em class="calibre7">N</em> and <em class="calibre7">M</em> are modified slightly, and Steps 8 and 9 are repeated, as the design process converges to a minimum value of <em class="calibre7">M</em> to minimize the computational workload, and optimized transition coefficients maximizing stopband attenuation.</p>
<p class="indenthangingn1"><a id="calibre_link-2945"></a><strong class="calibre9">11.</strong> When optimized filter parameters are obtained, they are then used in a Type-IV FSF implementation, as in <a href="#calibre_link-1759">Figure 7-47</a>.</p>
<p class="indenthangingn1"><strong class="calibre9">12.</strong> The final FSF design step is to sit back and enjoy a job well done.</p>
<p class="calibre3">The Type-IV FSF example presented in <a href="#calibre_link-1758">Figures 7-46</a> and <a href="#calibre_link-1759">7-47</a> provides an illustration of Steps 6 and 7. The initial design estimates for <em class="calibre7">N</em> and <em class="calibre7">M</em> are</p>
<p class="image"><img src="images/000119.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Repeated iterations of Steps 8 through 11 converge to the parameters of <em class="calibre7">N</em> = 62 and <em class="calibre7">M</em> = 6 that satisfy the desired filter performance specifications.</p>
<p class="calibre3"><a id="calibre_link-2946"></a></p>
<h4 class="calibre13">7.5.15 FSF Summary</h4>
<p class="calibre3">We’ve introduced the structure, performance, and design of frequency sampling FIR filters. Special emphasis was given to the practical issues of phase linearity, stability, and computational workload of these filters. In addition, we presented a detailed comparison of the high-performance Type-IV FSF and its nonrecursive FIR equivalent. Performance curves were presented to aid the designer in choosing between a Type-IV FSF and a Parks-McClellan-designed FIR filter for a given narrowband linear-phase filtering application. We found that</p>
<p class="indenthangingb">• Type-IV FSFs are more computationally efficient, for certain stopband attenuation levels, than Parks-McClellan-designed nonrecursive FIR filters in lowpass (or highpass) applications where the passband is less than <em class="calibre7">f<sub class="calibre12">s</sub></em>/5 and the transition bandwidth is less than <em class="calibre7">f<sub class="calibre12">s</sub></em>/8 (see <a href="#calibre_link-1727">Figures 7-29</a> and <a href="#calibre_link-1729">7-30</a>);</p>
<p class="indenthangingb">• FSFs are modular; their components (sections) are computationally identical and well understood;</p>
<p class="indenthangingb">• tables of optimum transition region coefficients, used to improve Type-IV FSF performance, can be generated (as was done in <a href="#calibre_link-298">Appendix H</a>); and</p>
<p class="indenthangingb">• although FSFs use recursive structures, they can be designed to be guaranteed stable and have linear phase.</p>
<p class="calibre3"><a id="calibre_link-636"></a></p>
<h3 class="calibre6">References</h3>
<p class="chapterendnote"><a id="calibre_link-1655"></a>[1] Hamming, R. <em class="calibre7">Digital Filters</em>, 3rd ed., Dover, Mineola, New York, 1998, pp. 133&ndash;137.</p>
<p class="chapterendnote"><a id="calibre_link-1662"></a>[2] Selby, S. <em class="calibre7">CRC Standard Mathematical Tables</em>, 21st ed., CRC Press, Boca Raton, Florida, 1973, p. 453.</p>
<p class="chapterendnote"><a id="calibre_link-1667"></a>[3] Proakis, J., and Manolakis, D. <em class="calibre7">Digital Signal Processing: Principles, Algorithms, and Applications</em>, 3rd ed., Prentice Hall, Upper Saddle River, New Jersey, 1996, pp. 656&ndash;657.</p>
<p class="chapterendnote"><a id="calibre_link-2947"></a><a id="calibre_link-1668"></a>[4] Rabiner, L., and Gold, B. <em class="calibre7">Theory and Application of Digital Signal Processing</em>, Prentice Hall, Upper Saddle River, New Jersey, 1975, p. 169.</p>
<p class="chapterendnote"><a id="calibre_link-1672"></a>[5] Hamming, R. <em class="calibre7">Numerical Methods for Scientists and Engineers</em>, 2nd ed., Dover, Mineola, New York, 1986, pp. 590&ndash;591.</p>
<p class="chapterendnote"><a id="calibre_link-1677"></a>[6] Sklar, B. <em class="calibre7">Digital Communications: Fundamentals and Applications</em>, 2nd ed., Prentice Hall, Englewood Cliffs, New Jersey, 1988, pp. 122&ndash;127.</p>
<p class="chapterendnote"><a id="calibre_link-1684"></a>[7] Engelberg, S. <em class="calibre7">Random Signals and Noise: A Mathematical Introduction</em>, CRC Press, Boca Raton, Florida, 2007, <a href="#calibre_link-289">Chapter 6</a>.</p>
<p class="chapterendnote"><a id="calibre_link-2948"></a>[8] Shanmugam, K. <em class="calibre7">Digital and Analog Communication Systems</em>, John Wiley and Sons, New York, 1979, <a href="#calibre_link-235">Chapter 8</a>.</p>
<p class="chapterendnote"><a id="calibre_link-1685"></a>[9] Mahafza, B. <em class="calibre7">Introduction to Radar Analysis</em>, CRC Press, Boca Raton, Florida, 1998, <a href="#calibre_link-289">Chapter 6</a>.</p>
<p class="chapterendnote"><a id="calibre_link-1686"></a>[10] Poor, H. Vincent. <em class="calibre7">An Introduction to Signal Detection and Estimation</em>, Springer Publishing, New York, 1998.</p>
<p class="chapterendnote"><a id="calibre_link-1687"></a>[11] Van Trees, H. <em class="calibre7">Detection, Estimation, and Modulation Theory, Part I</em>, Wiley-Interscience Publishing, Malden, Massachusetts, 2001.</p>
<p class="chapterendnote"><a id="calibre_link-1688"></a>[12] Mitra, S. K., et al. “Interpolated Finite Impulse Response Filters,” <em class="calibre7">IEEE Trans. Acoust. Speech, and Signal Proc.</em>, Vol. ASSP-32, June 1984, pp. 563&ndash;570.</p>
<p class="chapterendnote"><a id="calibre_link-1689"></a>[13] Vaidyanathan, P. <em class="calibre7">Multirate Systems and Filter Banks</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1993.</p>
<p class="chapterendnote"><a id="calibre_link-1698"></a>[14] Mehrnia, A., and Willson, A., Jr. “<em class="calibre7">On Optimal IFIR Filter Design,” Proc. of the 2004 International Symp. on Circuits and Systems (ISCAS)</em>, Vol. 3, May 23&ndash;26, 2004, pp. 133&ndash;136.</p>
<p class="chapterendnote"><a id="calibre_link-1700"></a>[15] Crochiere, R., and Rabiner, L. “Interpolation and Decimation of Digital Signals&mdash;A Tutorial Review,” <em class="calibre7">Proceedings of the IEEE</em>, Vol. 69, No. 3, March 1981, pp. 300&ndash;331.</p>
<p class="chapterendnote"><a id="calibre_link-2949"></a>[16] Kaiser, J. “Nonrecursive Digital Filter Design Using Io-Sinh Window Function,” <em class="calibre7">Proc. 1974 IEEE Int. Symp. Circuits Systems</em>, April 1974, pp. 20&ndash;23.</p>
<p class="chapterendnote"><a id="calibre_link-1701"></a>[17] Harris, F. “Digital Signal Processing for Digital Modems,” DSP World Spring Design Conference, Santa Clara, California, April 1999.</p>
<p class="chapterendnote"><a id="calibre_link-1710"></a>[18] Lim, Y. “Frequency-Response Masking Approach for the Synthesis of Sharp Linear Phase Digital Filters,” <em class="calibre7">IEEE Trans. Circuits Syst.</em>, Vol. 33, April 1986, pp. 357&ndash;364.</p>
<p class="chapterendnote"><a id="calibre_link-1711"></a>[19] Yang, R., et al. “A New Structure of Sharp Transition FIR Filters Using Frequency-Response Masking,” <em class="calibre7">IEEE Trans. Circuits Syst.</em>, Vol. 35, August 1988, pp. 955&ndash;966.</p>
<p class="chapterendnote"><a id="calibre_link-1712"></a>[20] Saramaki, T., et al. “Design of Computationally Efficient Interpolated FIR Filters,” <em class="calibre7">IEEE Trans. Circuits Syst</em>., Vol. 35, January 1988, pp. 70&ndash;88.</p>
<p class="chapterendnote"><a id="calibre_link-1713"></a>[21] Lyons, R. “Turbocharging Interpolated FIR Filters,” <em class="calibre7">IEEE Signal Processing Magazine,</em> “DSP Tips and Tricks” column, Vol. 24, No. 5, September 2007.</p>
<p class="chapterendnote"><a id="calibre_link-2950"></a><a id="calibre_link-1714"></a>[22] Lyons, R. <em class="calibre7">Streamlining Digital Signal Processing</em>, IEEE Press, Piscataway, New Jersey, 2007, pp. 73&ndash;84.</p>
<p class="chapterendnote"><a id="calibre_link-1716"></a>[23] Rabiner, L., et al. “An Approach to the Approximation Problem for Nonrecursive Digital Filters,” <em class="calibre7">IEEE Trans. Audio Electroacoust</em>., Vol. AU-18, June 1970, pp. 83&ndash;106.</p>
<p class="chapterendnote"><a id="calibre_link-1751"></a>[24] Proakis, J., and Manolakis, D. <em class="calibre7">Digital Signal Processing: Principles, Algorithms, and Applications</em>, 3rd ed., Prentice Hall, Upper Saddle River, New Jersey, 1996, pp. 506&ndash;507.</p>
<p class="chapterendnote"><a id="calibre_link-1717"></a>[25] Taylor, F., and Mellott, J. <em class="calibre7">Hands-on Digital Signal Processing</em>, McGraw-Hill, New York, 1998, pp. 325&ndash;331.</p>
<p class="chapterendnote"><a id="calibre_link-1735"></a>[26] Rader, C., and Gold, B. “Digital Filter Design Techniques in the Frequency Domain,” <em class="calibre7">Proceedings of the IEEE</em>, Vol. 55, February 1967, pp. 149&ndash;171.</p>
<p class="chapterendnote"><a id="calibre_link-1744"></a>[27] Rabiner, L., and Schafer, R. “Recursive and Nonrecursive Realizations of Digital Filters Designed by Frequency Sampling Techniques,” <em class="calibre7">IEEE Trans. Audio Electroacoust</em>., Vol. AU-19, September 1971, pp. 200&ndash;207.</p>
<p class="chapterendnote"><a id="calibre_link-1749"></a>[28] Gold, B., and Jordan, K. “A Direct Search Procedure for Designing Finite Duration Impulse Response Filters,” <em class="calibre7">IEEE Trans. Audio Electroacoust</em>., Vol. AU-17, March 1969, pp. 33&ndash;36.</p>
<p class="chapterendnote"><a id="calibre_link-1755"></a>[29] Rabiner, L., and Gold, B. <em class="calibre7">Theory and Application of Digital Signal Processing</em>, Prentice Hall, Upper Saddle River, New Jersey, 1975, pp. 105&ndash;112.</p>
<p class="chapterendnote"><a id="calibre_link-1750"></a>[30] Rorabaugh, C. <em class="calibre7">DSP Primer</em>, McGraw-Hill, New York, 1999, pp. 278&ndash;279.</p>
<p class="chapterendnote"><a id="calibre_link-1753"></a>[31] Parks, T., and McClellan, J. “A Program for the Design of Linear Phase Finite Impulse Response Digital Filters,” <em class="calibre7">IEEE Trans. Audio Electroacoust</em>., Vol. AU-20, August 1972, pp. 195&ndash;199.</p>
<p class="chapterendnote"><a id="calibre_link-1756"></a>[32] Herrmann, O. “Design of Nonrecursive Digital Filters with Linear Phase,” <em class="calibre7">Electron. Lett.,</em> Vol. 6, May 28, 1970, pp. 328&ndash;329.</p>
<p class="chapterendnote"><a id="calibre_link-1757"></a>[33] Rabiner, L. “Techniques for Designing Finite-Duration-Impulse-Response Digital Filters,” <em class="calibre7">IEEE Trans. on Communication Technology</em>, Vol. COM-19, April 1971, pp. 188&ndash;195.</p>
<p class="chapterendnote"><a id="calibre_link-1762"></a>[34] Ingle, V., and Proakis, J. <em class="calibre7">Digital Signal Processing Using MATLAB</em>, Brookes/Cole Publishing, Pacific Grove, California, 2000, pp. 202&ndash;208.</p>
<p class="calibre3"><a id="calibre_link-637"></a></p>
<h3 class="calibre6"><a id="calibre_link-2951" class="calibre5"></a>Chapter 7 Problems</h3>
<p class="indenthanging"><strong class="calibre9">7.1</strong> Prove that the frequency magnitude responses of the first-difference and central-difference differentiators can be represented by</p>
<p class="center">|<em class="calibre7">H</em><sub class="calibre12">Fd</sub>(ω)| = 2|sin(ω/2)|</p>
<p class="indentpara">and</p>
<p class="center">|<em class="calibre7">H</em><sub class="calibre12">Cd</sub>(ω)| = |sin(ω)|</p>
<p class="indentpara">respectively. The ω frequency-domain variable has a range of −π ≤ ω ≤ π, corresponding to a cyclic frequency range of −<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 to <em class="calibre7">f<sub class="calibre12">s</sub></em>/2, where <em class="calibre7">f<sub class="calibre12">s</sub></em> is the differentiator’s input signal sample rate in Hz.</p>
<p class="indentpara"><strong class="calibre9">Hint:</strong> Keep a list of trigonometric identities close at hand.</p>
<p class="indenthanging"><strong class="calibre9">7.2</strong> Redraw the block diagram of the central-difference differentiator, shown in <a href="#calibre_link-1766">Figure P7-2</a>, giving a new reduced-computation structure having only one multiplier.</p>
<p class="caption"><a id="calibre_link-1766"></a><strong class="calibre9">Figure P7-2</strong></p>
<p class="image"><img src="images/001067.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">7.3</strong> I once encountered an Internet web page that stated: “The central-difference differentiator is equivalent to two first-difference differentiators in series (cascaded).” Upon his reading that statement, if Rocky Balboa said, “This is very true,” would he be correct? Show how you arrived at your answer.</p>
<p class="indenthanging"><strong class="calibre9">7.4</strong> Assume you are working on a system that contains a servomotor and the motor’s angular position, <em class="calibre7">A</em><sub class="calibre12">pos</sub>(<em class="calibre7">n</em>), is measured by a shaft encoder coupled directly to the motor shaft as shown in <a href="#calibre_link-1767">Figure P7-4</a>. With the <em class="calibre7">A</em><sub class="calibre12">pos</sub>(<em class="calibre7">n</em>) discrete-signal sequence representing the motor shaft angular position, assume that the <em class="calibre7">A</em><sub class="calibre12">pos</sub>(<em class="calibre7">n</em>) sequence is contaminated with high-frequency noise and that the acceleration measurement network is restricted to performing no more than <a id="calibre_link-2952"></a>one multiplication per <em class="calibre7">A</em><sub class="calibre12">pos</sub>(<em class="calibre7">n</em>) input sample. What is the block diagram of the acceleration measurement network that will generate the <em class="calibre7">A</em><sub class="calibre12">acc</sub>(<em class="calibre7">n</em>) signal representing the acceleration of the motor shaft? Explain how you arrived at your solution.</p>
<p class="caption"><a id="calibre_link-1767"></a><strong class="calibre9">Figure P7-4</strong></p>
<p class="image"><img src="images/000759.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">7.5</strong> Here’s a differentiator design problem. Compute the coefficients of an <em class="calibre7">N</em> = 7-tap wideband differentiator whose cutoff frequency is ω<sub class="calibre12">c</sub> = π.</p>
<p class="indenthanging"><strong class="calibre9">7.6</strong> Differentiators are often used in digital receivers to perform FM (frequency modulation) demodulation. For a differentiator to be useful for FM demodulation its group delay should be an integer number of samples. One proposed differentiating filter has the following difference equation:</p>
<p class="image"><img src="images/000959.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">where <em class="calibre7">y</em><sub class="calibre12">diff</sub>(<em class="calibre7">n</em>) is the differentiator’s output. Prove that this differentiator’s group delay is an integer number of samples.</p>
<p class="indenthanging"><strong class="calibre9">7.7</strong> This author once read, on the Internet, the surprising statement that “the real part of the frequency response of the rectangular rule integrator is 0.5 for all input frequencies.” Prove the validity of that statement.</p>
<p class="indenthanging"><strong class="calibre9">7.8</strong> In the text we introduced the rectangular rule integrator whose block diagram is shown in <a href="#calibre_link-1768">Figure P7-8(a)</a>.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Assume that, at time index <em class="calibre7">n</em> = 2, we apply an <em class="calibre7">x</em>(<em class="calibre7">n</em>) cosine sequence whose frequency is half the input signal sample rate (<em class="calibre7">f</em><sub class="calibre12">s</sub>/2), shown in <a href="#calibre_link-1768">Figure P7-8(b)</a>, to a rectangular rule integrator. Given this <em class="calibre7">x</em>(<em class="calibre7">n</em>) input sequence, draw the <em class="calibre7">y</em>(<em class="calibre7">n</em>) output sequence of the integrator.</p>
<p class="indenthangingn"><a id="calibre_link-2953"></a><strong class="calibre9">(b)</strong> Based on the <em class="calibre7">y</em>(<em class="calibre7">n</em>) sequence from Part (a), by what factor does the rectangular rule integrator have an amplitude gain, or an amplitude loss, when the input is a sinusoid whose frequency is <em class="calibre7">f</em><sub class="calibre12">s</sub>/2 Hz?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Use the text’s equation for the frequency response of the integrator to verify your answer to Part (b) of this problem.</p>
<p class="caption"><a id="calibre_link-1768"></a><strong class="calibre9">Figure P7-8</strong></p>
<p class="image"><img src="images/000575.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">7.9</strong> Examine the <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples obtained from digitizing the continuous <em class="calibre7">x</em>(<em class="calibre7">t</em>) signal shown in <a href="#calibre_link-1769">Figure P7-9</a>, and assume we must estimate the shaded area, <em class="calibre7">A</em>, under the <em class="calibre7">x</em>(<em class="calibre7">t</em>) curve during the time interval of 0 to 3<em class="calibre7">t<sub class="calibre12">s</sub></em> seconds. If we use a trapezoidal rule integrator for our computations, will our estimate of the shaded area <em class="calibre7">A</em> be larger or smaller than the true area <em class="calibre7">A</em>? Justify your answer.</p>
<p class="caption"><a id="calibre_link-1769"></a><strong class="calibre9">Figure P7-9</strong></p>
<p class="image"><img src="images/000011.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">7.10</strong> In the continuous-signal domain an integrator is defined by the following Laplace-domain transfer function expression:</p>
<p class="image"><img src="images/000010.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><a id="calibre_link-2954"></a><strong class="calibre9">(a)</strong> Using the bilinear transform method (<a href="#calibre_link-289">Chapter 6</a>) for converting analog <em class="calibre7">s</em>-domain transfer functions to discrete <em class="calibre7">z</em>-domain transfer functions, what is the <em class="calibre7">H</em>(ω) frequency response expression for the bilinear transform-designed integrator corresponding to the <em class="calibre7">H</em>(<em class="calibre7">s</em>) above?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Which of the integrator types discussed in this chapter’s text (rectangular rule, trapezoidal rule, Simpson’s rule, and Tick’s rule) is most similar to the bilinear transform-designed integrator obtained in Part (a)?</p>
<p class="indenthanging"><strong class="calibre9">7.11</strong> Considering the four discrete integrators discussed in the text, rectangular rule, trapezoidal rule, Simpson’s rule, and Tick’s rule:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Which integrator type is the most computationally simple?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Which integrator has a transfer function pole (infinite gain) at <em class="calibre7">z</em> = −1? Show how you arrived at your answer.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Which integrator has a frequency magnitude response exactly equal to zero (infinite attenuation) at <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz? Show how you arrived at your answer.</p>
<p class="indenthanging"><strong class="calibre9">7.12</strong> Consider the following four-sample <em class="calibre7">s</em>(<em class="calibre7">n</em>) sequence to be a signal of interest that we want to detect using a tapped-delay line FIR matched filter:</p>
<p class="center"><em class="calibre7">s</em>(<em class="calibre7">n</em>) = [2, 4, −1, 1].</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Draw the block diagram of the FIR matched filter showing the filter coefficients.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What is the <em class="calibre7">y</em>(<em class="calibre7">n</em>) output sequence of the filter as the <em class="calibre7">s</em>(<em class="calibre7">n</em>) sequence passes completely through the delay line of the matched filter?</p>
<p class="indenthanging"><strong class="calibre9">7.13</strong> If <em class="calibre7">x</em><sub class="calibre12">s</sub>(<em class="calibre7">n</em>) is an <em class="calibre7">N</em>-sample, noise-free signal of interest we wish to detect using a tapped-delay line matched filter, what is a simple algebraic expression for the maximum filter output sample value?</p>
<p class="indenthanging"><strong class="calibre9">7.14</strong> Considering the signal-to-noise ratio (SNR) discussion at the end of the text’s matched filter material, think about a signal of interest represented by the three-sample, triangular-like <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) shown in <a href="#calibre_link-1770">Figure P7-14(a)</a>.</p>
<p class="caption"><a id="calibre_link-1770"></a><strong class="calibre9">Figure P7-14</strong></p>
<p class="image"><img src="images/000854.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara"><a id="calibre_link-2955"></a>Next, consider representing the <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) signal’s triangular envelope with five samples like the <em class="calibre7">x</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>) sequence shown in <a href="#calibre_link-1770">Figure P7-14(b)</a>. What is the improvement in a matched filter’s <em class="calibre7">y</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>) output SNR, measured in decibels (dB), by using the <em class="calibre7">x</em><sub class="calibre12">2</sub>(<em class="calibre7">n</em>) sequence as our signal of interest over the <em class="calibre7">y</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) output SNR using the <em class="calibre7">x</em><sub class="calibre12">1</sub>(<em class="calibre7">n</em>) sequence as our signal of interest? Justify your answer.</p>
<p class="indenthanging"><strong class="calibre9">7.15</strong> In designing lowpass IFIR filters we prefer to use large values for the <em class="calibre7">M</em> expansion factor because large <em class="calibre7">M</em> reduces the number of taps in the shaping subfilter. How do large values for <em class="calibre7">M</em> affect the number of taps in the associated image-reject subfilter?</p>
<p class="indenthanging"><strong class="calibre9">7.16</strong> Assume we’re designing a lowpass IFIR filter with an expansion factor of <em class="calibre7">M</em> = 5 and our desired IFIR filter has a passband from zero to 4 kHz (<em class="calibre7">f</em><sub class="calibre12">pass</sub> = 4 kHz).</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the passband width, in Hz, of the <em class="calibre7">prototype</em> FIR filter used to start our IFIR filter design effort?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> How many passband images will reside between zero and <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz in the IFIR <em class="calibre7">shaping</em> subfilter?</p>
<p class="indenthanging"><strong class="calibre9">7.17</strong> Assume we’re tasked to design a lowpass IFIR filter, operating at a sampling rate of <em class="calibre7">f<sub class="calibre12">s</sub></em> = 3 MHz, having the following properties:</p>
<p class="indenthangingb1">• Passband width of 60 kHz</p>
<p class="indenthangingb1">• Maximum passband peak-to-peak ripple of 0.2 dB</p>
<p class="indenthangingb1">• Stopband beginning at 61.2 kHz</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the value of the optimum <em class="calibre7">M</em> expansion factor for the shaping subfilter?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What is the maximum passband peak-to-peak ripple requirement, in dB, for the prototype filter?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Using the text’s <a href="#calibre_link-1704">Figure 7-18(b)</a>, what percent computational reduction should we expect from the IFIR filter relative to a Parks-McClellan-designed tapped-delay line FIR filter?</p>
<p class="indenthanging"><strong class="calibre9">7.18</strong> In studying frequency sampling filters (FSFs) we encountered networks containing complex multipliers like that shown in <a href="#calibre_link-1771">Figure P7-18</a>. Let’s now explore the details of such a multiplier.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Write the time-domain difference equation of the complex <em class="calibre7">w</em>(<em class="calibre7">n</em>) output of the complex multiplier in terms of <em class="calibre7">v</em>(<em class="calibre7">n</em>) = <em class="calibre7">v</em><sub class="calibre12">R</sub>(<em class="calibre7">n</em>) + <em class="calibre7">jv</em><sub class="calibre12">I</sub>(<em class="calibre7">n</em>) and <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup> where all the variables are in rectangular form. Variable ω is a fixed radian angle in the range −π ≤ ω ≤ π.</p>
<p class="indenthangingn"><a id="calibre_link-2956"></a><strong class="calibre9">(b)</strong> Based on the difference equation from Part (a), draw the block diagram of the complex multiplier where the complex <em class="calibre7">v</em>(<em class="calibre7">n</em>) and <em class="calibre7">w</em>(<em class="calibre7">n</em>) discrete sequences, and the constant complex <em class="calibre7">e<sup class="calibre10">j</sup></em><sup class="calibre10">ω</sup> multiplicand, are shown in rectangular (real-only variables) form.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> How many real multiplies and how many real additions are required to perform a single complex multiply?</p>
<p class="caption"><a id="calibre_link-1771"></a><strong class="calibre9">Figure P7-18</strong></p>
<p class="image"><img src="images/000459.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">7.19</strong> To exercise your frequency sampling filter (FSF) analysis skills, consider the three-stage Type-IV FSF in <a href="#calibre_link-1772">Figure P7-19</a>.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Draw the FSF’s pole and zero locations on the <em class="calibre7">z</em>-plane.</p>
<p class="indentpara1"><strong class="calibre9">Hint:</strong> From <a href="#calibre_link-1772">Figure P7-19</a>, determine the filter’s <em class="calibre7">N</em> and <em class="calibre7">r</em> parameters to find the zeros’ locations on the unit circle, and use each resonator’s <em class="calibre7">k</em> index value to find the FSF’s pole locations on the unit circle.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Is this filter a lowpass, bandpass, or highpass filter? Justify your answer.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Draw a rough sketch of the filter’s frequency magnitude response over the frequency range of −π≤ω≤π radians/sample (−<em class="calibre7">f<sub class="calibre12">s</sub></em>/2≤f≤<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz).</p>
<p class="caption"><a id="calibre_link-2957"></a><a id="calibre_link-1772"></a><strong class="calibre9">Figure P7-19</strong></p>
<p class="image"><img src="images/000732.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">7.20</strong> Concerning cascaded subfilters used in frequency sampling filters (FSFs):</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What is the impulse response of the “two cascaded comb filters” combination in a Type-IV FSF? (See the text’s <a href="#calibre_link-1743">Figure 7-41</a>.) Assume <em class="calibre7">N</em> = 8, and the damping factor <em class="calibre7">r</em> = 1.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Will this cascaded combination of comb filters have linear phase? Explain how you arrived at your answer.</p>
<p class="indentpara1"><strong class="calibre9">Hint:</strong> Recall what is an important characteristic of the impulse response of a linear-phase digital filter.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> If we set <em class="calibre7">r</em> = 0.9, will the combination of comb filters have linear phase? Explain how you arrived at your answer.</p>
<p class="indenthanging"><strong class="calibre9">7.21</strong> What is the range, roughly, of stopband attenuation that can be achieved with a Type-IV frequency sampling filter (FSF) having a single non-unity transition band coefficient?</p>
<p class="indenthanging"><a id="calibre_link-2958"></a><strong class="calibre9">7.22</strong> If a linear-phase lowpass filter needs to be designed to have a minimum of 85 dB of stopband attenuation, is it possible to design a Type-IV frequency sampling filter (FSF) that satisfies this attenuation requirement?</p>
<p class="indenthanging"><strong class="calibre9">7.23</strong> Assume you’ve designed a six-section, <em class="calibre7">N</em> = 23, lowpass, Type-IV frequency sampling filter (FSF) (such as that in <a href="#calibre_link-1743">Figure 7-41</a>) having three low-frequency passband sections, and the remaining three sections will use <em class="calibre7"><a href="#calibre_link-1773">transition</a></em> coefficients to achieve your desired stopband attenuation.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> What are the optimum values for those three coefficients? Show how you arrived at your solution.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Approximately what level of stopband attenuation (in dB) should we expect from our six-section, <em class="calibre7">N</em> = 23 FSF? Show how you arrived at your solution.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Draw the block diagram (the <em class="calibre7"><a href="#calibre_link-1053">structure</a></em>) of your FSF. No resonator details need be drawn. Just show a resonator as a block labeled with its appropriate <em class="calibre7">k</em> value.</p>
<p class="indenthanging"><strong class="calibre9">7.24</strong> Here is a frequency sampling filter (FSF) problem whose solution is a network useful for computing a single-bin discrete Fourier transform (DFT) output magnitude sample in a way that avoids having to perform an entire DFT. Such a network can be used for sinusoidal tone detection.</p>
<p class="indentpara">Think about building a tapped-delay line FIR filter, with the complex coefficients shown in <a href="#calibre_link-1774">Figure P7-24-I(a)</a>. After the arrival of the <em class="calibre7">x</em>(<em class="calibre7">N</em>−1) input sample the system’s output is equal to the <em class="calibre7">m</em>th DFT bin’s power sample of an <em class="calibre7">N</em>-point DFT of the most recent <em class="calibre7">N</em> input samples. What we’re saying is that we can build a real-time spectral power measurement system for computing successive single-bin DFT power values (the <em class="calibre7">m</em>th DFT bin power samples over time). The tapped-delay line filter’s <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients are</p>
<p class="center"><em class="calibre7">h</em>(<em class="calibre7">k</em>) = <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>2π<em class="calibre7">m</em>(<em class="calibre7">N</em>−1−<em class="calibre7">k</em>)/<em class="calibre7">N</em></sup></p>
<p class="caption"><a id="calibre_link-1774"></a><strong class="calibre9">Figure P7-24-I</strong></p>
<p class="image"><img src="images/001587.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">where filter coefficient index <em class="calibre7">k</em> is 0 ≤ <em class="calibre7">k</em> ≤ <em class="calibre7">N</em>−1. The output term |<em class="calibre7">X<sub class="calibre12">m</sub></em>(<em class="calibre7">n</em>)|<sup class="calibre10">2</sup> in <a href="#calibre_link-1774">Figure P7-24-I(a)</a> represents the value of the DFT’s <em class="calibre7">m</em>th bin power at time instant <em class="calibre7">n</em>. (Power samples are computed by multiplying <em class="calibre7">X<sub class="calibre12">m</sub></em>(<em class="calibre7">n</em>) samples by their conjugates <em class="calibre7">X<sub class="calibre12">m</sub></em>(<em class="calibre7">n</em>)*.)</p>
<p class="indentpara"><a id="calibre_link-2959"></a>As an example, if we needed to detect the power of the <em class="calibre7">m</em> = 2 bin of an <em class="calibre7">N</em> = 16-point DFT, the complex <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients of the tapped-delay line filter would be <em class="calibre7">h</em>(<em class="calibre7">k</em>) = <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>2π2(15−<em class="calibre7">k</em>)/16</sup> as shown in <a href="#calibre_link-1774">Figure P7-24-I(b)</a>. In this case our real-time spectral power detector would be the filter shown in <a href="#calibre_link-1775">Figure P7-24-II(a)</a>. (Notice how those coefficients are a flipped-in-time version of an <em class="calibre7">e</em><sup class="calibre10">−<em class="calibre7">j</em>2π2<em class="calibre7">k</em>/16</sup> <a id="calibre_link-2960"></a>sequence. That’s necessary because the earlier-in-time <em class="calibre7">x</em>(<em class="calibre7">n</em>) samples are toward the right in the tapped-delay line filter.)</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Reviewing the equivalency of a tapped-delay line FIR filter and a complex FSF in the text’s <a href="#calibre_link-1715">Figure 7-20</a>, draw the FSF block diagram that enables the real-time computation of the single <em class="calibre7">m</em> = 2 bin power for an <em class="calibre7">N</em> = 16-point DFT function performed in <a href="#calibre_link-1775">Figure P7-24-II(a)</a>. That is, show what would be the network inside the FSF block in <a href="#calibre_link-1775">Figure P7-24-II(b)</a>, including the numerical values for the <em class="calibre7">H</em>(<em class="calibre7">k</em>)/<em class="calibre7">N</em> gain factors following the FSF resonators.</p>
<p class="indentpara1"><strong class="calibre9">Hint:</strong> There are two ways to solve this problem. You could (1) perform a customary DFT analysis on the tapped-delay line filter’s <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients to obtain the FSF’s <em class="calibre7">H</em>(<em class="calibre7">k</em>)/<em class="calibre7">N</em> gain factors, or (2) you could determine the <em class="calibre7">H</em>(<em class="calibre7">z</em>) <em class="calibre7">z</em>-domain transfer function of the FSF to determine its block diagram. (Pick your poison.)</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> If the <em class="calibre7">f<sub class="calibre12">s</sub></em> sample rate of the <em class="calibre7">x</em>(<em class="calibre7">n)</em> inputs in <a href="#calibre_link-1775">Figure P7-24-II</a> is 200 kHz, what is the center frequency of the <em class="calibre7">m</em> = 2 DFT bin of our real-time single-bin 16-point DFT power measurement system?</p>
<p class="caption"><a id="calibre_link-1775"></a><strong class="calibre9">Figure P7-24-II</strong></p>
<p class="image"><img src="images/001529.jpg" alt="image" class="calibre2" /></p>
</div>


</body></html>
