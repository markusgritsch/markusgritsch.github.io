<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link href="style.css" rel="stylesheet" type="text/css" /><title>Understanding Digital Signal Processing</title>
<style type="text/css">
body {
  -webkit-text-size-adjust: 260%; /* text */
  zoom: 1.8; /* graphics */
  font-family: "BookerlyLCD";
}
a {
  color: #005090;
  text-decoration: none;
}
a {font-variant-numeric: oldstyle-nums proportional-nums;}
p.caption {font-variant-numeric: oldstyle-nums proportional-nums;}
</style>
</head><body>


<div class="calibre" id="calibre_link-572">
<p class="calibre3"><a id="calibre_link-2482"></a></p>
<h2 class="calibre8"><a id="calibre_link-2483" class="calibre5"></a>Contents</h2>
<p class="toc-chapter"><strong class="calibre9"><a href="#calibre_link-300">9 THE DISCRETE HILBERT TRANSFORM</a></strong></p>
<p class="toc-section"><a href="#calibre_link-647">9.1 Hilbert Transform Definition</a></p>
<p class="toc-section"><a href="#calibre_link-648">9.2 Why Care about the Hilbert Transform?</a></p>
<p class="toc-section"><a href="#calibre_link-649">9.3 Impulse Response of a Hilbert Transformer</a></p>
<p class="toc-section"><a href="#calibre_link-346">9.4 Designing a Discrete Hilbert Transformer</a></p>
<p class="toc-section"><a href="#calibre_link-650">9.5 Time-Domain Analytic Signal Generation</a></p>
<p class="toc-section"><a href="#calibre_link-651">9.6 Comparing Analytical Signal Generation Methods</a></p>
<p class="toc-section1"><a href="#calibre_link-652">References</a></p>

</div>


<div class="calibre" id="calibre_link-300">
<p class="calibre3"><a id="calibre_link-290"></a></p>
<h2 class="calibre8"><a id="calibre_link-2315" class="calibre5"></a>9 The Discrete Hilbert Transform</h2>
<p class="image"><img src="images/000837.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The discrete Hilbert transform is a process used to generate complex-valued signals from real-valued signals. Using complex signals in lieu of the real signals simplifies and improves the performance of many signal processing operations. If you’ve read about the discrete Hilbert transform in the DSP literature, you’ve probably plowed through the mathematical descriptions of analytic functions, with the constraints on their <em class="calibre7">z</em>-transforms in their regions of convergence, and perhaps you’ve encountered the Cauchy integral theorem used in the definition of the Hilbert transform.<sup class="calibre10"><a id="calibre_link-302"></a><a href="#calibre_link-301">†</a></sup> Well, the discrete Hilbert transform is not as complicated as it first appears; this chapter attempts to support that claim.</p>
<p class="footnotes"><a id="calibre_link-301"></a><sup class="calibre11"><a href="#calibre_link-302">†</a></sup> The Hilbert transform is named in honor of the great German mathematician David Hilbert (1862&ndash;1943). On his tomb in Göttingen, Germany, is inscribed, “Wir müssen wissen, wir werden wissen.” (We need to know, we shall know.)</p>
<p class="calibre3">Here we gently introduce the Hilbert transform from a practical standpoint, explain the mathematics behind its description, and show how it’s used in DSP systems. In addition to providing some of the algebraic steps missing from some textbooks, we’ll illustrate the time- and frequency-domain characteristics of the transform, with an emphasis on the physical meaning of the quadrature (complex) signals associated with Hilbert transform applications. Finally, nonrecursive Hilbert transformer design examples and techniques for generating complex, so-called analytic signals are presented. (If you’re not well versed in the notation and behavior of complex signals at this point, a review of <a href="#calibre_link-235">Chapter 8</a> would be useful.)</p>
<p class="calibre3"><a id="calibre_link-647"></a></p>
<h3 class="calibre6"><a id="calibre_link-2318" class="calibre5"></a>9.1 Hilbert Transform Definition</h3>
<p class="calibre3">The Hilbert transform (HT) is a mathematical process performed on a real signal <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>), yielding a new real signal <em class="calibre7">x</em><sub class="calibre12">ht</sub>(<em class="calibre7">t</em>), as shown in <a href="#calibre_link-303">Figure 9-1</a>.</p>
<p class="caption"><a id="calibre_link-303"></a><strong class="calibre9">Figure 9-1</strong> The notation used to define the continuous Hilbert transform.</p>
<p class="image"><img src="images/001699.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Our goal here is to ensure that <em class="calibre7">x</em><sub class="calibre12">ht</sub>(<em class="calibre7">t</em>) is a 90-degree phase-shifted version of <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>). So, before we carry on, let’s make sure we understand the notation used in <a href="#calibre_link-303">Figure 9-1</a>. The variables are defined as follows:</p>
<p class="image"><img src="images/001038.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We’ll clarify that <em class="calibre7">x</em><sub class="calibre12">ht</sub>(<em class="calibre7">t</em>) = <em class="calibre7">h</em>(<em class="calibre7">t</em>)<sub class="calibre12">*</sub><em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>), where the <sub class="calibre12">*</sub> symbol means convolution. In addition, we can define the spectrum of <em class="calibre7">x</em><sub class="calibre12">ht</sub>(<em class="calibre7">t</em>) as <em class="calibre7">X</em><sub class="calibre12">ht</sub>(ω) = <em class="calibre7">H</em>(ω)·<em class="calibre7">X</em><sub class="calibre12">r</sub>(ω). (These relationships sure make the HT look like a filter, don’t they? We’ll cogitate on this notion again later in this chapter.)</p>
<p class="calibre3">Describing how the new <em class="calibre7">x</em><sub class="calibre12">ht</sub>(<em class="calibre7">t</em>) signal, the HT of <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>), differs from the original <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) is most succinctly done by relating their Fourier transforms, <em class="calibre7">X</em><sub class="calibre12">r</sub>(ω) and <em class="calibre7">X</em><sub class="calibre12">ht</sub>(ω). In words, we can say that all of <em class="calibre7">x</em><sub class="calibre12">ht</sub>(<em class="calibre7">t</em>)’s positive-frequency components are equal to <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>)’s positive-frequency components shifted in phase by &ndash;90 degrees. Also, all of <em class="calibre7">x</em><sub class="calibre12">ht</sub>(<em class="calibre7">t</em>)’s negative-frequency components are equal to <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>)’s negative-frequency components shifted in phase by +90 degrees. Mathematically, we recall</p>
<p class="caption"><a id="calibre_link-321"></a>(9-1)</p>
<p class="image"><img src="images/000257.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">H</em>(ω) = &ndash;<em class="calibre7">j</em> over the positive-frequency range, and <em class="calibre7">H</em>(ω) = +<em class="calibre7">j</em> over the negative-frequency range. We show the nonzero imaginary part of <em class="calibre7">H</em>(ω) in <a href="#calibre_link-304">Figure 9-2(a)</a>.</p>
<p class="caption"><a id="calibre_link-304"></a><strong class="calibre9">Figure 9-2</strong> The complex frequency response of <em class="calibre7">H</em>(ω).</p>
<p class="image"><img src="images/000258.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To fully depict the complex <em class="calibre7">H</em>(ω), we show it as floating in a three-dimensional space in <a href="#calibre_link-304">Figure 9-2(b)</a>. The bold curve is our complex <em class="calibre7">H</em>(ω). On the right side is an upright plane on which we can project the imaginary part <a id="calibre_link-2319"></a>of <em class="calibre7">H</em>(ω). At the bottom of <a href="#calibre_link-304">Figure 9-2(b)</a> is a flat plane on which we can project the real part of <em class="calibre7">H</em>(ω). In rectangular notation, we say that <em class="calibre7">H</em>(ω) = 0 +<em class="calibre7">j</em>1 for negative frequencies and <em class="calibre7">H</em>(ω) = 0 −<em class="calibre7">j</em>1 for positive frequencies. (We introduce the three-dimensional axes of <a href="#calibre_link-304">Figure 9-2(b)</a> now because we’ll be using them to look at other complex frequency-domain functions later in this discussion.)</p>
<p class="calibre3">To show a simple example of an HT, and to reinforce our graphical viewpoint, <a href="#calibre_link-305">Figure 9-3(a)</a> shows the three-dimensional time and frequency representations of a real cosine wave cos(ω<em class="calibre7">t</em>). <a href="#calibre_link-305">Figure 9-3(b)</a> shows the HT of cos(ω<em class="calibre7">t</em>) to be the sinewave sin(ω<em class="calibre7">t</em>).</p>
<p class="caption"><a id="calibre_link-305"></a><strong class="calibre9">Figure 9-3</strong> The Hilbert transform: (a) cos(ω<em class="calibre7">t</em>); (b) its transform is sin(ω<em class="calibre7">t</em>).</p>
<p class="image"><img src="images/001574.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The complex spectrum on the right side of <a href="#calibre_link-305">Figure 9-3(b)</a> shows how the HT rotates the cosine wave’s positive-frequency spectral component by &ndash;<em class="calibre7">j</em>, and the cosine wave’s negative-frequency spectral component by +<em class="calibre7">j</em>. You can <a id="calibre_link-2990"></a>see on the right side of <a href="#calibre_link-305">Figure 9-3</a> that our definition of the +<em class="calibre7">j</em> multiplication operation is a +90-degree rotation of a spectral component counterclockwise about the frequency axis. (The length of those spectral components is half the peak amplitude of the original cosine wave.) We’re assuming those sinusoids on the left in <a href="#calibre_link-305">Figure 9-3</a> exist for all time, and this allows us to show their spectra as infinitely narrow impulses in the frequency domain.</p>
<p class="calibre3">Now that we have this frequency response of the HT defined, it’s reasonable for the beginner to ask: “Why would anyone want a process whose frequency-domain response is that weird <em class="calibre7">H</em>(ω) in <a href="#calibre_link-304">Figure 9-2(b)</a>?”</p>
<p class="calibre3"><a id="calibre_link-648"></a></p>
<h3 class="calibre6">9.2 Why Care about the Hilbert Transform?</h3>
<p class="calibre3">The answer is: We need to understand the HT because it’s useful in so many complex-signal (quadrature) processing applications. A brief search on the Internet reveals HT-related signal processing techniques being used in the following applications:</p>
<p class="indenthangingb">• Quadrature modulation and demodulation (communications)</p>
<p class="indenthangingb">• Automatic gain control (AGC)</p>
<p class="indenthangingb">• Analysis of two- and three-dimensional complex signals</p>
<p class="indenthangingb">• Medical imaging, seismic data and ocean wave analysis</p>
<p class="indenthangingb">• Instantaneous frequency estimation</p>
<p class="indenthangingb">• Radar/sonar signal processing, and time-domain signal analysis using wavelets</p>
<p class="indenthangingb">• Time difference of arrival (TDOA) measurements</p>
<p class="indenthangingb">• High-definition television (HDTV) receivers</p>
<p class="indenthangingb">• Loudspeaker, room acoustics, and mechanical vibration analysis</p>
<p class="indenthangingb">• Audio and color image compression</p>
<p class="indenthangingb">• Nonlinear and nonstationary system analysis</p>
<p class="calibre3">All of these applications employ the HT either to generate or to measure complex time-domain signals, and that’s where the HT’s power lies. The HT delivers to us, literally, another dimension of signal processing capabilities as we move from two-dimensional real signals to three-dimensional complex signals. Here’s how.</p>
<p class="calibre3">Let’s consider a few mathematical definitions. If we start with a real time-domain signal <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>), we can associate with it a complex signal <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>), defined as</p>
<p class="caption"><a id="calibre_link-2991"></a>(9-2)</p>
<p class="image"><img src="images/000770.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3"><a id="calibre_link-1978"></a>The complex <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) signal is known as an <em class="calibre7">analytic signal</em> (because it has no negative-frequency spectral components), and its real part is equal to the original real input signal <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>). The key here is that <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>)’s imaginary part, <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">t</em>), is the HT of the original <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) as shown in <a href="#calibre_link-306">Figure 9-4</a>.</p>
<p class="caption"><a id="calibre_link-306"></a><strong class="calibre9">Figure 9-4</strong> Functional relationship between the <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) and <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) signals.</p>
<p class="image"><img src="images/000600.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">As we’ll see shortly, in many real-world signal processing situations <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) is easier, or more meaningful, to work with than the original <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>). Before we see why that is true, we’ll explore <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) further to attempt to give it some physical meaning. Consider a real <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) = cos(ω<sub class="calibre12">o</sub><em class="calibre7">t</em>) signal that’s simply four cycles of a cosine wave and its HT <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">t</em>) sinewave as shown in <a href="#calibre_link-307">Figure 9-5</a>. The <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) analytic signal is the bold <em class="calibre7">corkscrew</em> function.</p>
<p class="caption"><a id="calibre_link-307"></a><strong class="calibre9">Figure 9-5</strong> The Hilbert transform and the analytic signal of cos(ω<sub class="calibre12">o</sub><em class="calibre7">t</em>).</p>
<p class="image"><img src="images/001461.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">We can describe <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) as a complex exponential using one of Euler’s equations. That is:</p>
<p class="caption"><a id="calibre_link-308"></a>(9-3)</p>
<p class="image"><img src="images/001626.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The spectra of those signals in <a href="#calibre_link-308">Eq. (9-3)</a> are shown in <a href="#calibre_link-309">Figure 9-6</a>. Notice three things in <a href="#calibre_link-309">Figure 9-6</a>. First, following the relationships in <a href="#calibre_link-308">Eq. (9-3)</a>, if we rotate <em class="calibre7">X</em><sub class="calibre12">i</sub>(ω) by +90 degrees counterclockwise (+<em class="calibre7">j</em>) and add it to <em class="calibre7">X</em><sub class="calibre12">r</sub>(ω), we get <em class="calibre7">X</em><sub class="calibre12">c</sub>(ω) = <em class="calibre7">X</em><sub class="calibre12">r</sub>(ω)+<em class="calibre7">jX</em><sub class="calibre12">i</sub>(ω). Second, note how the magnitude of the component in <em class="calibre7">X</em><sub class="calibre12">c</sub>(ω) is double the magnitudes in <em class="calibre7">X</em><sub class="calibre12">r</sub>(ω). Third, notice how <em class="calibre7">X</em><sub class="calibre12">c</sub>(ω) is zero over the negative-frequency range. This property of zero spectral content for negative frequencies is why <em class="calibre7">X</em><sub class="calibre12">c</sub>(ω) is called an <em class="calibre7">analytic signal</em>. Some people call <em class="calibre7">X</em><sub class="calibre12">c</sub>(ω) a <em class="calibre7">one-sided spectrum</em>.</p>
<p class="caption"><a id="calibre_link-309"></a><strong class="calibre9">Figure 9-6</strong> HT spectra: (a) spectrum of cos(ω<sub class="calibre12">o</sub><em class="calibre7">t</em>); (b) spectrum of the Hilbert transform of cos(ω<sub class="calibre12">o</sub><em class="calibre7">t</em>), sin(ω<sub class="calibre12">o</sub><em class="calibre7">t</em>); (c) spectrum of the analytic signal of cos(ω<sub class="calibre12">o</sub><em class="calibre7">t</em>), <em class="calibre7">e</em><sup class="calibre10"><em class="calibre7">j</em>ω<sub class="calibre15">o</sub>t</sup>.</p>
<p class="image"><img src="images/000500.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">To appreciate the physical meaning of our discussion here, let’s remember that the <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) signal is not just a mathematical abstraction. We can generate <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) in our laboratory and route it via cables to the laboratory down the hall. (This idea is described in <a href="#calibre_link-310">Section 8.3</a>.)</p>
<p class="calibre3">To illustrate the utility of this analytic signal <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) notion, let’s see how analytic signals are very useful in measuring instantaneous characteristics of a time-domain signal: measuring the magnitude, phase, or frequency of a signal at some given instant in time. This idea of instantaneous measurements doesn’t seem so profound when we think of characterizing, say, a pure sinewave. But if we think of a more complicated signal, like a modulated sinewave, instantaneous measurements can be very meaningful. If a real sinewave <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) is amplitude modulated so its <em class="calibre7">envelope</em> contains information, from an analytic version of the signal we can measure the instantaneous envelope <em class="calibre7">E</em>(<em class="calibre7">t</em>) value using</p>
<p class="caption"><a id="calibre_link-1968"></a><a id="calibre_link-312"></a>(9-4)</p>
<p class="image"><img src="images/000649.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">That is, the envelope of the signal is equal to the magnitude of <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>). We show a simple example of this AM demodulation idea in <a href="#calibre_link-311">Figure 9-7(a)</a>, where a sinusoidal signal is amplitude modulated by a low-frequency sinusoid (dashed curve). To recover the modulating waveform, traditional AM demodulation <a id="calibre_link-2992"></a>would rectify the amplitude-modulated sinewave, <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>), and pass the result through a lowpass filter. The filter’s output is represented by the solid curve in <a href="#calibre_link-311">Figure 9-7(b)</a> representing the modulating waveform. Instead, we can compute the HT of <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>), yielding <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">t</em>), and use <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">t</em>) to generate the <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) = <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) + <em class="calibre7">jx</em><sub class="calibre12">i</sub>(<em class="calibre7">t</em>) analytic version of <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>). Finally, we compute the magnitude of <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) using <a href="#calibre_link-312">Eq. (9-4)</a> to extract the modulating waveform shown as the bold solid curve in <a href="#calibre_link-311">Figure 9-7(c)</a>. The |<em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>)| function is a <em class="calibre7">much</em> more accurate representation of the modulating waveform than the solid curve in <a href="#calibre_link-311">Figure 9-7(b)</a>.</p>
<p class="caption"><a id="calibre_link-311"></a><strong class="calibre9">Figure 9-7</strong> Envelope detection: (a) input <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) signal; (b) traditional lowpass filtering of |<em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>)|; (c) complex envelope detection result |<em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>)|.</p>
<p class="image"><img src="images/001362.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Suppose, on the other hand, some real <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) sinewave is phase modulated. We can estimate <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>)’s instantaneous phase ø(<em class="calibre7">t</em>), using</p>
<p class="caption"><a id="calibre_link-2993"></a>(9-5)</p>
<p class="image"><img src="images/001506.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Computing ø(<em class="calibre7">t</em>) is equivalent to phase demodulation of <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>). Likewise (and more often implemented), should a real sinewave carrier be frequency modulated, we can measure its instantaneous frequency <em class="calibre7">F</em>(<em class="calibre7">t</em>) by calculating the instantaneous time rate of change of <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>)’s instantaneous phase using</p>
<p class="caption"><a id="calibre_link-2117"></a><a id="calibre_link-313"></a>(9-6)</p>
<p class="image"><img src="images/001001.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">The process in <a href="#calibre_link-313">Eq. (9-6)</a> is a form of digital differentiation, a topic we discuss in some detail in <a href="#calibre_link-187">Chapter 7</a>.</p>
<p class="calibre3">Calculating <em class="calibre7">F</em>(<em class="calibre7">t</em>) is equivalent to frequency demodulation of <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>). By the way, if ø(<em class="calibre7">t</em>) is measured in radians, then <em class="calibre7">F</em>(<em class="calibre7">t</em>) in <a href="#calibre_link-313">Eq. (9-6)</a> is measured in radians/second. Dividing <em class="calibre7">F</em>(<em class="calibre7">t</em>) by 2π will give it dimensions of Hz. (Another frequency demodulation method is discussed in <a href="#calibre_link-314">Section 13.22</a>.)</p>
<p class="calibre3">For another HT application, consider a real <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) signal whose |<em class="calibre7">X</em><sub class="calibre12">r</sub>(ω)| spectral magnitude is centered at 25 kHz as shown in <a href="#calibre_link-315">Figure 9-8(a)</a>. Suppose we wanted to translate that spectrum to be centered at 20 kHz. We could multiply <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) by the real sinusoid cos(2π5000<em class="calibre7">t</em>) to obtain a real signal whose spectrum is shown in <a href="#calibre_link-315">Figure 9-8(b)</a>. The problem with this approach is we’d need an impractically high-performance filter (the dashed curve) to eliminate those unwanted high-frequency spectral images.</p>
<p class="caption"><a id="calibre_link-315"></a><strong class="calibre9">Figure 9-8</strong> Spectra associated with frequency translation of a real signal <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>).</p>
<p class="image"><img src="images/000395.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">On the other hand, if we compute the HT of <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) to obtain <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">t</em>), and combine the two signals to form the analytic signal <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) = <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>)+<em class="calibre7">jx</em><sub class="calibre12">i</sub>(<em class="calibre7">t</em>), we’ll have the complex <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) whose one-sided spectrum is given in <a href="#calibre_link-315">Figure 9-8(c)</a>. Next we multiply the complex <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">t</em>) by the complex <em class="calibre7">e</em><sup class="calibre10">&ndash;<em class="calibre7">j</em>2π5000<em class="calibre7">t</em></sup>, yielding a frequency-translated <em class="calibre7">x</em><sub class="calibre12">out</sub>(<em class="calibre7">t</em>) complex signal whose spectrum is shown in <a href="#calibre_link-315">Figure 9-8(d)</a>. Our final step is to take the real part of <em class="calibre7">x</em><sub class="calibre12">out</sub>(<em class="calibre7">t</em>) to obtain a real signal with the desired spectrum centered about 20 kHz, as shown in <a href="#calibre_link-315">Figure 9-8(e)</a>.</p>
<p class="calibre3"><a id="calibre_link-2320"></a>Now that we’re convinced of the utility of the HT, let’s determine the HT’s time-domain impulse response and use it to build Hilbert transformers.</p>
<p class="calibre3"><a id="calibre_link-649"></a></p>
<h3 class="calibre6">9.3 Impulse Response of a Hilbert Transformer</h3>
<p class="calibre3">Instead of following tradition and just writing down the impulse response equation for a device that performs the HT, we’ll show how to arrive at that expression. To determine the HT’s impulse response expression, we take the inverse Fourier transform of the HT’s frequency response <em class="calibre7">H</em>(ω). The garden-variety continuous inverse Fourier transform of an arbitrary frequency function <em class="calibre7">X</em>(<em class="calibre7">f</em>) is defined as</p>
<p class="caption"><a id="calibre_link-316"></a>(9-7)</p>
<p class="image"><img src="images/000046.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">where <em class="calibre7">f</em> is frequency measured in cycles/second (hertz). We’ll make three changes to <a href="#calibre_link-316">Eq. (9-7)</a>. First, in terms of our original frequency variable ω = 2π<em class="calibre7">f</em> radians/second, and because d<em class="calibre7">f</em> = dω/2π, we substitute dω/2π for the d<em class="calibre7">f</em> term. Second, because we know our discrete frequency response will be periodic with a repetition interval of the sampling frequency ω<em class="calibre7"><sub class="calibre12">s</sub></em>, we’ll evaluate <a href="#calibre_link-316">Eq. (9-7)</a> over the frequency limits of &ndash;ω<em class="calibre7"><sub class="calibre12">s</sub></em>/2 to +ω<em class="calibre7"><sub class="calibre12">s</sub></em>/2. Third, we partition the original integral into two separate integrals. This algebraic massaging gives us the following:</p>
<p class="caption"><a id="calibre_link-317"></a>(9-8)</p>
<p class="image"><img src="images/000896.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Whew! OK, we’re going to plot this impulse response shortly, but first we have one hurdle to overcome. Heartache occurs when we plug <em class="calibre7">t</em> = 0 into <a href="#calibre_link-317">Eq. (9-8)</a> because we end up with the indeterminate ratio 0/0. Hardcore mathematics to the rescue here. We merely pull out the Marquis de L’Hopital’s Rule, take the time derivatives of the numerator and denominator in <a href="#calibre_link-317">Eq. (9-8)</a>, and then set <em class="calibre7">t</em> = 0 to determine <em class="calibre7">h</em>(0). Following through on this:</p>
<p class="caption"><a id="calibre_link-2994"></a><a id="calibre_link-2995"></a>(9-9)</p>
<p class="image"><img src="images/001751.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So now we know that <em class="calibre7">h</em>(0) = 0. Let’s find the discrete version of <a href="#calibre_link-317">Eq. (9-8)</a> because that’s the form we can model in software and actually use in our DSP work. We can <em class="calibre7">go digital</em> by substituting the discrete-time variable <em class="calibre7">nt<sub class="calibre12">s</sub></em> for the continuous-time variable <em class="calibre7">t</em> in <a href="#calibre_link-317">Eq. (9-8)</a>. Using the following definitions</p>
<p class="indentpara3"><em class="calibre7">n</em> = discrete time-domain integer index (...,&ndash;3,&ndash;2,&ndash;1,0,1,2,3,...)</p>
<p class="indentpara3"><em class="calibre7">f<sub class="calibre12">s</sub></em> = sample rate measured in samples/second</p>
<p class="indentpara3"><em class="calibre7">t<sub class="calibre12">s</sub></em> = time between samples, measured in seconds (<em class="calibre7">t<sub class="calibre12">s</sub></em> = 1/<em class="calibre7">f<sub class="calibre12">s</sub></em>)</p>
<p class="indentpara3"><em class="calibre7">ω<sub class="calibre12">s</sub></em> = 2π<em class="calibre7">f<sub class="calibre12">s</sub></em></p>
<p class="calibre3">we can rewrite <a href="#calibre_link-317">Eq. (9-8)</a> in discrete form as</p>
<p class="caption"><a id="calibre_link-2996"></a>(9-10)</p>
<p class="image"><img src="images/001096.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Substituting 2π<em class="calibre7">f<sub class="calibre12">s</sub></em> for ω<em class="calibre7"><sub class="calibre12">s</sub></em>, and 1/<em class="calibre7">f<sub class="calibre12">s</sub></em> for <em class="calibre7">t<sub class="calibre12">s</sub></em>, we have</p>
<p class="caption"><a id="calibre_link-319"></a>(9-11)</p>
<p class="image"><img src="images/000297.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Finally, we plot HT’s <em class="calibre7">h</em>(<em class="calibre7">n</em>) impulse response in <a href="#calibre_link-318">Figure 9-9</a>. The <em class="calibre7">f<sub class="calibre12">s</sub></em> term in <a href="#calibre_link-319">Eq. (9-11)</a> is simply a scale factor; its value does not affect the shape of <em class="calibre7">h</em>(<em class="calibre7">n</em>). An informed reader might, at this time, say, “Wait a minute. <a href="#calibre_link-319">Equation (9-11)</a> doesn‘t look at all like the equation for the HT’s impulse response that’s in my other DSP textbook. What gives?” The reader would be correct because one popular expression in the literature for <em class="calibre7">h</em>(<em class="calibre7">n</em>) is</p>
<p class="caption"><a id="calibre_link-320"></a>(9-12)</p>
<p class="image"><img src="images/000992.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-318"></a><strong class="calibre9">Figure 9-9</strong> The Hilbert transform’s discrete impulse response when <em class="calibre7">f<sub class="calibre12">s</sub></em> = 1.</p>
<p class="image"><img src="images/001244.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Here’s the answer: The derivation of <a href="#calibre_link-320">Eq. (9-12)</a> is based on the assumption that the <em class="calibre7">f<sub class="calibre12">s</sub></em> sampling rate is normalized to unity. If we set <em class="calibre7">f<sub class="calibre12">s</sub></em> = 1 in <a href="#calibre_link-319">Eq. (9-11)</a>, then that new expression will be equal to <a href="#calibre_link-320">Eq. (9-12)</a>. We leave the proof of that equality as a homework problem.</p>
<p class="calibre3"><a id="calibre_link-2220"></a>Looking again at <a href="#calibre_link-318">Figure 9-9</a>, we can reinforce the validity of our <em class="calibre7">h</em>(<em class="calibre7">n</em>) derivation. Notice that for <em class="calibre7">n</em> &gt; 0 the values of <em class="calibre7">h</em>(<em class="calibre7">n</em>) are nonzero only when <em class="calibre7">n</em> is odd. In addition, the amplitudes of those nonzero values decrease by factors of 1/1, 1/3, 1/5, 1/7, etc. Of what does that remind you? That’s right, the Fourier series of a periodic squarewave! This makes sense because our <em class="calibre7">h</em>(<em class="calibre7">n</em>) is the inverse Fourier transform of the squarewave-like <em class="calibre7">H</em>(ω) in <a href="#calibre_link-304">Figure 9-2</a>. Furthermore, our <em class="calibre7">h</em>(<em class="calibre7">n</em>) is antisymmetric, and this is consistent with a purely imaginary <em class="calibre7">H</em>(ω). (If we were to make <em class="calibre7">h</em>(<em class="calibre7">n</em>) symmetrical by inverting its values for all <em class="calibre7">n</em> &lt; 0, the new sequence would be proportional to the Fourier series of a periodic real squarewave.)</p>
<p class="calibre3">Now that we have the expression for the HT’s impulse response <em class="calibre7">h</em>(<em class="calibre7">n</em>), let’s use it to build a discrete Hilbert transformer.</p>
<p class="calibre3"><a id="calibre_link-346"></a></p>
<h3 class="calibre6">9.4 Designing a Discrete Hilbert Transformer</h3>
<p class="calibre3">Discrete Hilbert transformations can be implemented in either the time or frequency domains. Let’s look at time-domain Hilbert transformers first.</p>
<p class="calibre3"><a id="calibre_link-2997"></a></p>
<h4 class="calibre13">9.4.1 Time-Domain Hilbert Transformation: FIR Filter Implementation</h4>
<p class="calibre3">Looking back at <a href="#calibre_link-306">Figure 9-4</a>, and having <em class="calibre7">h</em>(<em class="calibre7">n</em>) available, we want to know how to generate the discrete <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>). Recalling the frequency-domain product in <a href="#calibre_link-321">Eq. (9-1)</a>, we can say <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>) is the convolution of <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) and <em class="calibre7">h</em>(<em class="calibre7">k</em>). Mathematically, this is</p>
<p class="caption"><a id="calibre_link-2998"></a><a id="calibre_link-2999"></a>(9-13)</p>
<p class="image"><img src="images/000039.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">So this means we can implement a Hilbert transformer as a discrete nonrecursive finite impulse response (FIR) filter structure as shown in <a href="#calibre_link-322">Figure 9-10</a>.</p>
<p class="caption"><a id="calibre_link-322"></a><strong class="calibre9">Figure 9-10</strong> FIR implementation of a <em class="calibre7">K</em>-tap Hilbert transformer.</p>
<p class="image"><img src="images/000284.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Designing a traditional time-domain FIR Hilbert transformer amounts to determining those <em class="calibre7">h</em>(<em class="calibre7">k</em>) values so the functional block diagram in <a href="#calibre_link-306">Figure 9-4</a> can be implemented. Our first thought is merely to take the <em class="calibre7">h</em>(<em class="calibre7">n</em>) coefficient values from <a href="#calibre_link-319">Eq. (9-11)</a>, or <a href="#calibre_link-318">Figure 9-9</a>, and use them for the <em class="calibre7">h</em>(<em class="calibre7">k</em>)s in <a href="#calibre_link-322">Figure 9-10</a>. That’s almost the right answer. Unfortunately, the <a href="#calibre_link-318">Figure 9-9</a> <em class="calibre7">h</em>(<em class="calibre7">n</em>) sequence is infinite in length, so we have to truncate the sequence. Figuring out what the truncated <em class="calibre7">h</em>(<em class="calibre7">n</em>) should be is where the true design activity takes place.</p>
<p class="calibre3">To start with, we have to decide if our truncated <em class="calibre7">h</em>(<em class="calibre7">n</em>) sequence will have an odd or even length. We make this decision by recalling that FIR implementations having antisymmetric coefficients and an odd, or even, number of taps are called a Type-III, or a Type-IV, system respectively[<a href="#calibre_link-323">1</a>&ndash;<a href="#calibre_link-324">3</a>]. These two antisymmetric filter types have the following unavoidable restrictions with respect to their frequency magnitude responses |<em class="calibre7">H</em>(ω)|:</p>
<p class="image"><img src="images/000091.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">What this little table tells us is odd-tap Hilbert transformers always have a zero magnitude response at both zero Hz and at half the sample rate. Even-tap Hilbert transformers always have a zero magnitude response at zero Hz. Let’s look at some examples.</p>
<p class="calibre3"><a href="#calibre_link-325">Figure 9-11</a> shows the frequency response of a 15-tap (Type-III, odd-tap) FIR Hilbert transformer whose coefficients are designated as <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">k</em>). These plots have much to teach us.</p>
<p class="caption"><a id="calibre_link-3000"></a><a id="calibre_link-325"></a><strong class="calibre9">Figure 9-11</strong> <em class="calibre7">H</em><sub class="calibre12">1</sub>(ω) frequency response of <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">k</em>), a 15-tap Hilbert transformer.</p>
<p class="image"><img src="images/001126.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn1"><strong class="calibre9">1.</strong> For example, an odd-tap FIR implementation does indeed have a zero magnitude response at 0 Hz and ±<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz. This means odd-tap (Type-III) FIR implementations turn out to be bandpass in performance.</p>
<p class="indenthangingn1"><strong class="calibre9">2.</strong> There’s ripple in the <em class="calibre7">H</em><sub class="calibre12">1</sub>(ω) passband. We should have expected this because we were unable to use an infinite number of <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">k</em>) coefficients. Here, just as it does when we’re designing standard lowpass FIR filters, truncating the length of the time-domain coefficients causes ripples in the frequency domain. (When we abruptly truncate a function in one domain, Mother Nature pays us back by invoking the Gibbs phenomenon, resulting in ripples in the other domain.) You guessed it. We can reduce the ripple in |<em class="calibre7">H</em><sub class="calibre12">1</sub>(ω)| by windowing the truncated <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">k</em>) sequence. However, windowing the coefficients will narrow the bandwidth of <em class="calibre7">H</em><sub class="calibre12">1</sub>(ω) somewhat, so using more coefficients may be necessary after windowing is applied. You’ll find windowing the truncated <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">k</em>) sequence to be to your advantage.</p>
<p class="indenthangingn1"><strong class="calibre9">3.</strong> It’s exceedingly difficult to compute the HT of low-frequency signals. We can widen the passband and reduce the transition region width of <em class="calibre7">H</em><sub class="calibre12">1</sub>(ω)’s magnitude response, but that requires many filter taps.</p>
<p class="indenthangingn1"><strong class="calibre9">4.</strong> The phase response of <em class="calibre7">H</em><sub class="calibre12">1</sub>(ω) is linear, as it should be when the coefficients’ absolute values are symmetrical. The slope of the phase curve <a id="calibre_link-3001"></a>(that is constant in our case) is proportional to the time delay a signal sequence experiences traversing the FIR filter. More on this in a moment. That discontinuity in the phase response at 0 Hz corresponds to π radians, as <a href="#calibre_link-304">Figure 9-2</a> tells us it should. Whew, good thing. That’s what we were after in the first place!</p>
<p class="calibre3">In our relentless pursuit of correct results, we’re forced to compensate for the linear phase shift of <em class="calibre7">H</em><sub class="calibre12">1</sub>(ω)&mdash;that constant time value equal to the group delay of the filter&mdash;when we generate our analytic <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>). We do this by delaying, in time, the original <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) by an amount equal to the group delay of the <em class="calibre7">h</em><sub class="calibre12">1</sub>(<em class="calibre7">k</em>) FIR Hilbert transformer. Recall that the group delay, <em class="calibre7">G</em>, of a tapped-delay line FIR filter, having antisymmetrical coefficients, is <em class="calibre7">G</em> = <em class="calibre7">D</em>/2 samples where <em class="calibre7">D</em> is the number of unit-delay elements in the delay line. So our block diagram for generating a complex <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>) signal, using an FIR structure, is given in <a href="#calibre_link-326">Figure 9-12(a)</a>. In this example, the 7-tap Hilbert filter has <em class="calibre7">D</em> = 6 delay elements as shown in <a href="#calibre_link-326">Figure 9-12(b)</a>. There we delay <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) by <em class="calibre7">G</em> = 6/2 = 3 samples, generating the delayed sequence <em class="calibre7">x</em>’<sub class="calibre12">r</sub>(<em class="calibre7">n</em>). This delayed sequence now aligns properly in time with <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>).</p>
<p class="caption"><a id="calibre_link-326"></a><strong class="calibre9">Figure 9-12</strong> Generating an <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>) sequence when <em class="calibre7">h</em>(<em class="calibre7">k</em>) is a 7-tap FIR Hilbert filter: (a) processing steps; (b) filter structure.</p>
<p class="image"><img src="images/000173.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">If you’re building your odd-tap FIR Hilbert transform in hardware, an easy way to obtain <em class="calibre7">x</em>’<sub class="calibre12">r</sub>(<em class="calibre7">n</em>) is to <em class="calibre7">tap off</em> the original <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) sequence at the center tap of the FIR Hilbert transformer structure as in <a href="#calibre_link-326">Figure 9-12(b)</a>. If you’re modeling <a href="#calibre_link-326">Figure 9-12(a)</a> in software, the <em class="calibre7">x</em>’<sub class="calibre12">r</sub>(<em class="calibre7">n</em>) sequence can be had by inserting <em class="calibre7">G</em> = 3 zeros at the beginning of the original <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) sequence.</p>
<p class="calibre3"><a id="calibre_link-2201"></a>We can, for example, implement an FIR Hilbert transformer using a Type-IV FIR structure, with its even number of taps. <a href="#calibre_link-327">Figure 9-13</a> shows this notion where the coefficients are, say, <em class="calibre7">h</em><sub class="calibre12">2</sub>(<em class="calibre7">k</em>). See how the frequency magnitude response is nonzero at ±<em class="calibre7">f<sub class="calibre12">s</sub></em>/2 Hz. Thus this even-tap filter approximates an ideal Hilbert transformer somewhat better than an odd-tap implementation.</p>
<p class="caption"><a id="calibre_link-327"></a><strong class="calibre9">Figure 9-13</strong> <em class="calibre7">H</em><sub class="calibre12">2</sub>(ω) frequency response of <em class="calibre7">h</em><sub class="calibre12">2</sub>(<em class="calibre7">k</em>), a 14-tap Hilbert transformer.</p>
<p class="image"><img src="images/001016.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">One of the problems with this traditional Hilbert transformer is that the passband gain in |<em class="calibre7">H</em><sub class="calibre12">2</sub>(ω)| is not unity for all frequencies, as is the <em class="calibre7">x</em>’<sub class="calibre12">r</sub>(<em class="calibre7">n</em>) path in <a href="#calibre_link-326">Figure 9-12</a>. So to minimize errors, we must use many <em class="calibre7">h</em><sub class="calibre12">2</sub>(<em class="calibre7">k</em>) coefficients (or window the coefficients) to make |<em class="calibre7">H</em><sub class="calibre12">2</sub>(ω)|’s passband as flat as possible.</p>
<p class="calibre3">Although not shown here, the negative slope of the phase response of <em class="calibre7">H</em><sub class="calibre12">2</sub>(ω) corresponds to a filter group delay of <em class="calibre7">G</em> = (14&ndash;1)/2 = 6.5 samples. This requires us to delay the original <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) sequence by a noninteger (fractional) number of samples in order to achieve time alignment with <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>). Fractional time-delay filters are beyond the scope of this material, but reference <a href="#calibre_link-328">[4]</a> is a source of further information on the topic.</p>
<p class="calibre3">Let’s recall that alternate coefficients of a Type-III (odd-tap) FIR are zeros. Thus the odd-tap Hilbert transformer is more attractive than an even-tap version from a computational workload standpoint. Almost half of the multiplications in <a href="#calibre_link-322">Figure 9-10</a> can be eliminated for a Type-III FIR Hilbert transformer. Designers might even be able to further reduce the number of multiplications by a factor of two by using the <em class="calibre7">folded</em> FIR structure (discussed in <a href="#calibre_link-148">Section 13.7</a>) that’s possible with symmetric coefficients (keeping in mind that half the coefficients are negative).</p>
<p class="calibre3">A brief warning: Here’s a mistake sometimes even the <em class="calibre7">professionals</em> make. When we design standard linear-phase FIR filters, we calculate the coefficients and then use them in our hardware or software designs. Sometimes we forget to <em class="calibre7">flip</em> the coefficients before we use them in an FIR filter. This forgetfulness usually doesn’t hurt us because typical FIR coefficients are symmetrical. <a id="calibre_link-2316"></a>Not so with FIR Hilbert filters, so please don’t forget to reverse the order of your coefficients before you use them for convolutional filtering. Failing to flip the coefficients will distort the desired HT phase response.</p>
<p class="calibre3">As an aside, Hilbert transformers can be built with IIR filter structures, and in some cases they’re more computationally efficient than FIR Hilbert transformers at the expense of a slight degradation in the 90-degree phase difference between <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) and <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>)[<a href="#calibre_link-329">5</a>,<a href="#calibre_link-330">6</a>].</p>
<p class="calibre3"><a id="calibre_link-3002"></a></p>
<h4 class="calibre13">9.4.2 Frequency-Domain Hilbert Transformation</h4>
<p class="calibre3">Here’s a frequency-domain Hilbert processing scheme deserving mention because the HT of <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) and the analytic <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>) sequence can be generated simultaneously. We merely take an <em class="calibre7">N</em>-point DFT of a real even-length-<em class="calibre7">N x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) signal sequence, obtaining the discrete <em class="calibre7">X</em><sub class="calibre12">r</sub>(<em class="calibre7">m</em>) spectrum given in <a href="#calibre_link-331">Figure 9-14(a)</a>. Next, create a new spectrum <em class="calibre7">X</em><sub class="calibre12">c</sub>(<em class="calibre7">m</em>) = 2<em class="calibre7">X</em><sub class="calibre12">r</sub>(<em class="calibre7">m</em>). Set the negative-frequency <em class="calibre7">X</em><sub class="calibre12">c</sub>(<em class="calibre7">m</em>) samples, that’s (<em class="calibre7">N</em>/2)+1 ≤ <em class="calibre7">m</em> ≤ <em class="calibre7">N</em>&ndash;1, to zero, leaving us with a new one-sided <em class="calibre7">X</em><sub class="calibre12">c</sub>(<em class="calibre7">m</em>) spectrum as in <a href="#calibre_link-331">Figure 9-14(b)</a>. Next, divide the <em class="calibre7">X</em><sub class="calibre12">c</sub>(0) (the DC term) and the <em class="calibre7">X</em><sub class="calibre12">c</sub>(<em class="calibre7">N</em>/2) spectral samples by 2. Finally, we perform an <em class="calibre7">N</em>-point inverse DFT of the new <em class="calibre7">X</em><sub class="calibre12">c</sub>(<em class="calibre7">m</em>), the result being the desired analytic <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>) time-domain sequence. The real part of <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>) is the original <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>), and the imaginary part of <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>) is the HT of <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>). Done!</p>
<p class="caption"><a id="calibre_link-331"></a><strong class="calibre9">Figure 9-14</strong> Spectrum of the original <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) sequence, and the one-sided spectrum of the analytic <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>) sequence.</p>
<p class="image"><img src="images/000064.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">There are several issues to keep in mind concerning this straightforward frequency-domain analytic signal generation scheme:</p>
<p class="indenthangingn1"><strong class="calibre9">1.</strong> If possible, restrict the <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) input sequence length to an integer power of two so the radix-2 FFT algorithm can be used to efficiently compute the DFT.</p>
<p class="indenthangingn1"><strong class="calibre9">2.</strong> Make sure the <em class="calibre7">X</em><sub class="calibre12">c</sub>(<em class="calibre7">m</em>) sequence has the same length as the original <em class="calibre7">X</em><sub class="calibre12">r</sub>(<em class="calibre7">m</em>) sequence. Remember, you zero out the negative-frequency <em class="calibre7">X</em><sub class="calibre12">c</sub>(<em class="calibre7">m</em>) samples; you don’t discard them.</p>
<p class="indenthangingn1"><strong class="calibre9">3.</strong> The factor of two in the above <em class="calibre7">X</em><sub class="calibre12">c</sub>(<em class="calibre7">m</em>) = 2<em class="calibre7">X</em><sub class="calibre12">r</sub>(<em class="calibre7">m</em>) assignment compensates for the amplitude loss by a factor of two in losing the negative-frequency spectral energy.</p>
<p class="indenthangingn1"><a id="calibre_link-1980"></a><strong class="calibre9">4.</strong> If your HT application is block-oriented in the sense that you only have to generate the analytic sequence from a fixed-length real-time sequence, this technique is sure worth thinking about because there’s no time delay heartache associated with time-domain FIR implementations to worry about. With the advent of fast hardware DSP chips and pipelined FFT techniques, the above analytic signal generation scheme may be viable for a number of applications. One scenario to consider is using the efficient 2<em class="calibre7">N</em>-Point Real FFT technique, described in <a href="#calibre_link-332">Section 13.5.2</a>, to compute the forward DFT of the real-valued <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>). Of course, the thoughtful engineer would conduct a literature search to see what algorithms are available for efficiently performing inverse FFTs when many of the frequency-domain samples are zeros.</p>
<p class="calibre3">Should you desire a decimated-by-two analytic <em class="calibre7">x</em>’<sub class="calibre12">c</sub>(<em class="calibre7">n</em>) sequence based on <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>), it’s easy to do, thanks to reference <a href="#calibre_link-333">[7]</a>. First, compute the <em class="calibre7">N</em>-point <em class="calibre7">X</em><sub class="calibre12">r</sub>(<em class="calibre7">m</em>). Next, create a new spectral sequence <em class="calibre7">X</em>’<sub class="calibre12">c</sub>(<em class="calibre7">k</em>) = 2<em class="calibre7">X</em><sub class="calibre12">r</sub>(<em class="calibre7">k</em>) for 1 ≤ <em class="calibre7">k</em> ≤ (<em class="calibre7">N/</em>2)-1. Set <em class="calibre7">X</em>’<sub class="calibre12">c</sub>(0) equal to <em class="calibre7">X</em><sub class="calibre12">r</sub>(0) + <em class="calibre7">X</em><sub class="calibre12">r</sub>(<em class="calibre7">N</em>/2). Finally, compute the (<em class="calibre7">N</em>/2)-point inverse DFT of <em class="calibre7">X</em>’<sub class="calibre12">c</sub>(<em class="calibre7">m</em>), yielding the decimated-by-two analytic <em class="calibre7">x</em>’<sub class="calibre12">c</sub>(<em class="calibre7">n</em>). The <em class="calibre7">x</em>’<sub class="calibre12">c</sub>(<em class="calibre7">n</em>) sequence has a sample rate of <em class="calibre7">f</em>’<em class="calibre7"><sub class="calibre12">s</sub></em> = <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 and the spectrum shown in <a href="#calibre_link-331">Figure 9-14(c)</a>.</p>
<p class="calibre3">In <a href="#calibre_link-334">Section 13.28.2</a> we discuss a scheme to generate interpolated analytic signals from <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>).</p>
<p class="calibre3"><a id="calibre_link-650"></a></p>
<h3 class="calibre6">9.5 Time-Domain Analytic Signal Generation</h3>
<p class="calibre3">In digital communications applications, the FIR implementation of the HT (such as that in <a href="#calibre_link-326">Figure 9-12(b)</a>) is used to generate a complex analytic signal <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>). Some practitioners now use a time-domain complex filtering technique to achieve analytic signal generation when dealing with real bandpass signals<a href="#calibre_link-335">[8]</a>. This scheme, which does not specifically perform the HT of an input sequence <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>), uses a complex filter implemented with two real FIR filters with essentially equal magnitude responses, but whose phase responses differ by exactly 90 degrees, as shown in <a href="#calibre_link-336">Figure 9-15</a>.</p>
<p class="caption"><a id="calibre_link-336"></a><strong class="calibre9">Figure 9-15</strong> Generating an <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>) sequence with a complex filter (two real FIR filters).</p>
<p class="image"><img src="images/000908.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">Here’s how it’s done. A standard <em class="calibre7">K</em>-tap FIR lowpass filter is designed, using your favorite FIR design software, to have a two-sided bandwidth slightly wider than the original real bandpass signal of interest. The real coefficients of the lowpass filter, <em class="calibre7">h</em><sub class="calibre12">LP</sub>(<em class="calibre7">k</em>), are then multiplied by the complex exponential <em class="calibre7">m</em><sub class="calibre12">ix</sub>(<em class="calibre7">k</em>) sequence specified by</p>
<p class="caption"><a id="calibre_link-337"></a>(9-14)</p>
<p class="image"><img src="images/000888.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">using the following definitions:</p>
<p class="indentpara3"><em class="calibre7">k</em> = time index term of the exponential mixing sequence (<em class="calibre7">k</em> = 0, 1, 2, ..., <em class="calibre7">K</em>&ndash;1)</p>
<p class="indentpara3"><em class="calibre7">D</em> = time delay of the <em class="calibre7">K</em>-tap lowpass filter, <em class="calibre7">D</em> = (<em class="calibre7">K</em>&ndash;1)/2</p>
<p class="indentpara3"><a id="calibre_link-2219"></a><em class="calibre7">f</em><sub class="calibre12">c</sub> = bandpass signal’s center frequency, in Hz</p>
<p class="indentpara3"><em class="calibre7">f<sub class="calibre12">s</sub></em> = sample rate of the original <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) bandpass signal sequence in Hz</p>
<p class="calibre3">The results of the <em class="calibre7">h</em><sub class="calibre12">LP</sub>(<em class="calibre7">k</em>) times <em class="calibre7">m</em><sub class="calibre12">ix</sub>(<em class="calibre7">k</em>) multiplication are complex coefficients whose rectangular-form representation is</p>
<p class="caption"><a id="calibre_link-3003"></a>(9-14′)</p>
<p class="image"><img src="images/001742.jpg" alt="image" class="calibre2" /></p>
<p class="calibre3">creating a complex bandpass filter centered at <em class="calibre7">f</em><sub class="calibre12">c</sub> Hz. The delay value <em class="calibre7">D</em> in <a href="#calibre_link-337">Eq. (9-14)</a> ensures that the <em class="calibre7">h</em><sub class="calibre12">cos</sub>(<em class="calibre7">k</em>) and <em class="calibre7">h</em><sub class="calibre12">sin</sub>(<em class="calibre7">k</em>) coefficients are symmetrical (or antisymmetrical) to obtain a linear-phase complex filter<a href="#calibre_link-338">[9]</a>.</p>
<p class="calibre3">Next we use the real and imaginary parts of the filter’s <em class="calibre7">h</em><sub class="calibre12">BP</sub>(<em class="calibre7">k</em>) coefficients in two separate real-valued-coefficient FIR filters as shown in <a href="#calibre_link-336">Figure 9-15</a>. In DSP parlance, the filter producing the <em class="calibre7">x</em><sub class="calibre12">I</sub>(<em class="calibre7">n</em>) sequence is called the I-channel for <em class="calibre7">in-phase</em>, and the filter generating <em class="calibre7">x</em><sub class="calibre12">Q</sub>(<em class="calibre7">n</em>) is called the Q-channel for <em class="calibre7">quadrature phase</em>. There are several interesting aspects of this mixing analytic signal generation scheme in <a href="#calibre_link-336">Figure 9-15</a>:</p>
<p class="indenthangingn1"><strong class="calibre9">1.</strong> The mixing of the <em class="calibre7">h</em><sub class="calibre12">LP</sub>(<em class="calibre7">k</em>) coefficients by <em class="calibre7">m</em><sub class="calibre12">ix</sub>(<em class="calibre7">k</em>) induces a loss, by a factor of two, in the frequency magnitude responses of the two real FIR filters. Doubling the <em class="calibre7">h</em><sub class="calibre12">LP</sub>(<em class="calibre7">k</em>) values before mixing will eliminate the loss.</p>
<p class="indenthangingn1"><strong class="calibre9">2.</strong> We can window the <em class="calibre7">h</em><sub class="calibre12">LP</sub>(<em class="calibre7">k</em>) coefficients before mixing to reduce the passband ripple in, and to minimize differences between, the magnitude responses of the two real filters. (We’d like to keep the passband gains as similar as possible.) Of course, windowing will degrade the lowpass filter’s roll-off somewhat, so using more coefficients may be necessary before windowing is applied.</p>
<p class="indenthangingn1"><a id="calibre_link-1979"></a><strong class="calibre9">3.</strong> Odd- or even-tap lowpass filters can be used, with equal ease, in this technique.</p>
<p class="indenthangingn1"><strong class="calibre9">4.</strong> Because the <em class="calibre7">h</em><sub class="calibre12">cos</sub>(<em class="calibre7">k</em>) or <em class="calibre7">h</em><sub class="calibre12">sin</sub>(<em class="calibre7">k</em>) coefficients are exactly symmetrical, or exactly antisymmetrical, the <em class="calibre7">folded</em> FIR structure (see <a href="#calibre_link-148">Section 13.7</a>) can be used to reduce the number of multiplies per filter output sample by roughly a factor of two.</p>
<p class="indenthangingn1"><strong class="calibre9">5.</strong> If the original bandpass signal and the complex filter are centered at one-fourth the sample rate (<em class="calibre7">f</em><sub class="calibre12">o</sub> = <em class="calibre7">f<sub class="calibre12">s</sub></em>/4), count your blessings. In this case we set <em class="calibre7">D</em> = 0 in <a href="#calibre_link-337">Eq. (9-14)</a>, making nearly half the coefficients of each real filter zero-valued, maintaining linear phase, and reduce our FIR computational workload further by a factor of two.</p>
<p class="indenthangingn1"><strong class="calibre9">6.</strong> A particularly efficient complex bandpass filter is a lowpass half-band FIR filter whose center frequency has been translated to <em class="calibre7">f</em><sub class="calibre12">c</sub> = <em class="calibre7">f<sub class="calibre12">s</sub></em>/4. The result is that half the <em class="calibre7">h</em><sub class="calibre12">sin</sub>(<em class="calibre7">k</em>) coefficients are zeros, and all but one of the <em class="calibre7">h</em><sub class="calibre12">cos</sub>(<em class="calibre7">k</em>) coefficients are zeros! (Two specialized analytic signal generation schemes using half-band filters are described in <a href="#calibre_link-339">Sections 13.1</a> and <a href="#calibre_link-340">13.37</a>.)</p>
<p class="indenthangingn1"><strong class="calibre9">7.</strong> For hardware applications, both of the two real FIR filters in <a href="#calibre_link-336">Figure 9-15</a> must be implemented. If your analytic signal generation is strictly a high-level software language exercise, such as using MATLAB, the language being used may allow <em class="calibre7">h</em><sub class="calibre12">BP</sub>(<em class="calibre7">k</em>) to be implemented as a single complex filter.</p>
<p class="calibre3">Keep in mind, now, that the <em class="calibre7">x</em><sub class="calibre12">Q</sub>(<em class="calibre7">n</em>) sequence in <a href="#calibre_link-336">Figure 9-15</a> is not the Hilbert transform of the <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) input. That wasn’t our goal here. Our intent was to generate an analytic <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>) sequence whose <em class="calibre7">x</em><sub class="calibre12">Q</sub>(<em class="calibre7">n</em>) quadrature component is the Hilbert transform of the <em class="calibre7">x</em><sub class="calibre12">I</sub>(<em class="calibre7">n</em>) in-phase sequence.</p>
<p class="calibre3"><a id="calibre_link-651"></a></p>
<h3 class="calibre6">9.6 Comparing Analytic Signal Generation Methods</h3>
<p class="calibre3">Time-domain FIR Hilbert transformer design is essentially an exercise in lowpass filter design. As such, an ideal discrete FIR Hilbert transformer, like an ideal lowpass FIR filter, cannot be achieved in practice. Fortunately, we can usually ensure that the bandpass of our <a href="#calibre_link-326">Figure 9-12</a> Hilbert transformer covers the bandwidth of the <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) input signal. The <a href="#calibre_link-326">Figure 9-12</a> Hilbert transformer has magnitude roll-off in the <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>) channel but not in the <em class="calibre7">x</em>’<sub class="calibre12">r</sub>(<em class="calibre7">n</em>) channel. Using more filter taps improves the transformer’s performance by</p>
<p class="indenthangingb">• minimizing passband ripple in the <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>) channel,</p>
<p class="indenthangingb">• minimizing passband gain differences between the two channels, and</p>
<p class="indenthangingb">• broadening the transformer’s passband width.</p>
<p class="calibre3"><a id="calibre_link-3004"></a>The choice of an odd or even number of taps depends on whether the gain at <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 should be zero or not, and whether an integer-sample delay is needed.</p>
<p class="calibre3">For roughly the same passband ripple performance, the complex filter in <a href="#calibre_link-336">Figure 9-15</a> requires a longer impulse response (more filter taps) than the <a href="#calibre_link-326">Figure 9-12</a> Hilbert transformer. However, the complex filter has the nice feature that it actually implements bandpass filtering where the <a href="#calibre_link-326">Figure 9-12</a> Hilbert transformer performs no filtering. A possible drawback of the complex filter method is that the real part of the generated complex signal is not equal to the original real input signal. (That is, <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>) does not equal <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>).)</p>
<p class="calibre3">For very high-performance analytic signal generation (where the equivalent Hilbert transformer bandwidth must be very close to the full <em class="calibre7">f<sub class="calibre12">s</sub></em>/2 bandwidth, and passband ripple must be very small), the DFT method should be considered. With the DFT method the real part of <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>) is equal to the real input <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>). Choosing which of the above analytic signal generation methods to use (or perhaps a complex down-conversion scheme from <a href="#calibre_link-235">Chapter 8</a>) in any given application requires modeling with your target computing hardware, using your expected number format (fixed point versus floating point), against the typical input signals you intend to process.</p>
<p class="calibre3"><a id="calibre_link-652"></a></p>
<h3 class="calibre6">References</h3>
<p class="chapterendnote"><a id="calibre_link-323"></a>[1] Proakis, J., and Manolakis, D. <em class="calibre7">Digital Signal Processing: Principles, Algorithms and Applications</em>, Prentice Hall, Upper Saddle River, New Jersey, 1996, pp. 618, 657.</p>
<p class="chapterendnote"><a id="calibre_link-3005"></a>[2] Rabiner, L., and Gold, B. <em class="calibre7">The Theory and Application of Digital Signal Processing</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1975, pp. 67, 168.</p>
<p class="chapterendnote"><a id="calibre_link-324"></a>[3] Oppenheim, A., and Schafer, R. <em class="calibre7">Discrete</em>-<em class="calibre7">Time Signal Processing</em>, Prentice Hall, Englewood Cliffs, New Jersey, 1st ed. 1989, 2nd ed. 1999.</p>
<p class="chapterendnote"><a id="calibre_link-328"></a>[4] Laasko, T., et al. “Splitting the Unit Delay,” <em class="calibre7">IEEE Signal Processing Magazine,</em> January 1996.</p>
<p class="chapterendnote"><a id="calibre_link-329"></a>[5] Gomes, J., and Petraglia, A. “An Analog Sampled-Data DSB to SSB Converter Using Recursive Hilbert Transformer for Accurate I and Q Channel Matching,” <em class="calibre7">IEEE Trans. on Circuits and Sys.-II, Analog and Digital Signal Processing</em>, Vol. 39. No. 3, March 2002, pp. 177&ndash;187.</p>
<p class="chapterendnote"><a id="calibre_link-330"></a>[6] Ansari, R. “IIR Hilbert Transformers,” <em class="calibre7">IEEE Trans. Acoust., Speech Signal Processing</em>, Vol. 35, August 1987, pp. 1116&ndash;1119.</p>
<p class="chapterendnote"><a id="calibre_link-333"></a>[7] Marple, S., Jr. “Computing the Discrete-Time ‘Analytic’ Signal via FFT,” <em class="calibre7">IEEE Trans. on Signal Proc.</em>, Vol. 47, No. 9, September 1999, pp. 2600&ndash;2603.</p>
<p class="chapterendnote"><a id="calibre_link-335"></a>[8] Reilly, A., et al. “Analytic Signal Generation&mdash;Tips and Traps,” <em class="calibre7">IEEE Trans. on Signal Proc.</em>, Vol. 42, No. 11, November 1994.</p>
<p class="chapterendnote"><a id="calibre_link-338"></a>[9] Bell, D. Subject: “Hilbert Transform Using FFT Approach,” Internet Newsgroup: <em class="calibre7">comp.dsp,</em> September 28, 2005.</p>
<p class="calibre3"><a id="calibre_link-653"></a></p>
<h3 class="calibre6"><a id="calibre_link-3006" class="calibre5"></a>Chapter 9 Problems</h3>
<p class="indenthanging"><strong class="calibre9">9.1</strong> Consider the real-valued continuous <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) = cos(ω<em class="calibre7">t</em>) sinusoidal signal applied to the network in <a href="#calibre_link-341">Figure P9-1</a>. The “HT” notation means Hilbert transform. Write the algebraic expressions for the signals <em class="calibre7">x</em><sub class="calibre12">a</sub>(<em class="calibre7">t</em>) and <em class="calibre7">x</em><sub class="calibre12">b</sub>(<em class="calibre7">t</em>). Justify your solutions.</p>
<p class="caption"><a id="calibre_link-341"></a><strong class="calibre9">Figure P9-1</strong></p>
<p class="image"><img src="images/000517.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">9.2</strong> Consider the real-valued continuous <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) sinusoidal signal defined by</p>
<p class="center"><em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) = <em class="calibre7">A</em>sin(2π<em class="calibre7">f</em><sub class="calibre12">o</sub><em class="calibre7">t</em>)</p>
<p class="indentpara">where <em class="calibre7">A</em> is a scalar constant, and <em class="calibre7">f</em><sub class="calibre12">o</sub> is a fixed frequency measured in Hz.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Draw the three-dimensional spectrum of the Hilbert transform of <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>).</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> What is the equation for the analytic signal whose real part is <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>), in terms of sin() and cos() functions?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> What is the equation for the analytic signal whose real part is <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>), in complex exponential notation? Show your work.</p>
<p class="indenthangingn"><strong class="calibre9">(d)</strong> Is the analytic signal whose real part is <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) a positive- or negative-frequency complex exponential? Justify your answer.</p>
<p class="indenthangingn"><strong class="calibre9">(e)</strong> On a complex plane, draw the location of the analytic signal whose real part is <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>), at time <em class="calibre7">t</em> = 0.</p>
<p class="indenthanging"><strong class="calibre9">9.3</strong> Consider the effect of repeated Hilbert transformations of a real-valued continuous <em class="calibre7">x</em>(<em class="calibre7">t</em>) = cos(ω<sub class="calibre12">o</sub><em class="calibre7">t</em>) sinusoidal signal, expressed as</p>
<p class="center"><em class="calibre7">u</em>(<em class="calibre7">t</em>) = HT[<em class="calibre7">x</em>(<em class="calibre7">t</em>)]</p>
<p class="center"><em class="calibre7">v</em>(<em class="calibre7">t</em>) = HT[<em class="calibre7">u</em>(<em class="calibre7">t</em>)]</p>
<p class="center"><em class="calibre7">w</em>(<em class="calibre7">t</em>) = HT[<em class="calibre7">v</em>(<em class="calibre7">t</em>)]</p>
<p class="center"><em class="calibre7">y</em>(<em class="calibre7">t</em>) = HT[<em class="calibre7">w</em>(<em class="calibre7">t</em>)]</p>
<p class="indentpara">where “HT[<em class="calibre7">x</em>(<em class="calibre7">t</em>)]” means the Hilbert transform of <em class="calibre7">x</em>(<em class="calibre7">t</em>).</p>
<p class="indenthangingn"><a id="calibre_link-3007"></a><strong class="calibre9">(a)</strong> Which of <em class="calibre7">u</em>(<em class="calibre7">t</em>), <em class="calibre7">v</em>(<em class="calibre7">t</em>), <em class="calibre7">w</em>(<em class="calibre7">t</em>), or <em class="calibre7">y</em>(<em class="calibre7">t</em>) equals <em class="calibre7">x</em>(<em class="calibre7">t</em>)? Justify your answer.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Which of <em class="calibre7">u</em>(<em class="calibre7">t</em>), <em class="calibre7">v</em>(<em class="calibre7">t</em>), <em class="calibre7">w</em>(<em class="calibre7">t</em>), or <em class="calibre7">y</em>(<em class="calibre7">t</em>) equals &ndash;<em class="calibre7">x</em>(<em class="calibre7">t</em>)? Justify your answer.</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> Which of <em class="calibre7">u</em>(<em class="calibre7">t</em>), <em class="calibre7">v</em>(<em class="calibre7">t</em>), <em class="calibre7">w</em>(<em class="calibre7">t</em>), or <em class="calibre7">y</em>(<em class="calibre7">t</em>) equals the inverse Hilbert transform of <em class="calibre7">x</em>(<em class="calibre7">t</em>)?</p>
<p class="indenthangingn"><strong class="calibre9">(d)</strong> Draw a block diagram of the system that implements the inverse Hilbert transform using just one forward Hilbert transform operation. Use a simple block, as shown in <a href="#calibre_link-342">Figure P9-3</a>, to represent a forward Hilbert transform.</p>
<p class="caption"><a id="calibre_link-342"></a><strong class="calibre9">Figure P9-3</strong></p>
<p class="image"><img src="images/001377.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">9.4</strong> Looking at the odd- and even-length Hilbert transformers’ time-domain impulse responses in the text’s <a href="#calibre_link-325">Figures 9-11</a> and <a href="#calibre_link-327">9-13</a>:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Why should we expect that their frequency magnitude responses are zero (a magnitude null) at zero Hz?</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Write the <em class="calibre7">z</em>-domain transfer function for a 6-tap tapped-delay line Hilbert transform filter having coefficients <em class="calibre7">h</em>(0), <em class="calibre7">h</em>(1), <em class="calibre7">h</em>(2), ..., <em class="calibre7">h</em>(5). Evaluate that function to determine the filter’s frequency response at zero Hz.</p>
<p class="indenthanging"><strong class="calibre9">9.5</strong> Draw the block diagram (the structure) of a real-coefficient 11-tap FIR Hilbert transformer that will compute an <em class="calibre7">x</em><sub class="calibre12">a</sub>(<em class="calibre7">n</em>) = <em class="calibre7">x</em>’<sub class="calibre12">r</sub>(<em class="calibre7">n</em>) + <em class="calibre7">jx</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>) analytic signal associated with a real <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) input signal.</p>
<p class="indenthanging"><strong class="calibre9">9.6</strong> Think about the tapped-delay line FIR Hilbert transformer whose coefficients are shown in <a href="#calibre_link-343">Figure P9-6</a>. The coefficients are <em class="calibre7">h</em>(0), <em class="calibre7">h</em>(1), <em class="calibre7">h</em>(2), ..., <em class="calibre7">h</em>(10).</p>
<p class="caption"><a id="calibre_link-343"></a><strong class="calibre9">Figure P9-6</strong></p>
<p class="image"><img src="images/000420.jpg" alt="image" class="calibre2" /></p>
<p class="indenthangingn"><a id="calibre_link-3008"></a><strong class="calibre9">(a)</strong> Write the <em class="calibre7">z</em>-domain transfer function polynomial, <em class="calibre7">H</em>(<em class="calibre7">z</em>), for this 11-coefficient Hilbert transformer in terms of the <em class="calibre7">h</em>(<em class="calibre7">k</em>) coefficients and <em class="calibre7">z</em>.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> We often describe a Hilbert transformer by the <em class="calibre7"><a href="#calibre_link-344">order</a></em> of the transformer’s <em class="calibre7">z</em>-domain transfer function polynomial. What is the order of the transformer whose coefficients are shown in <a href="#calibre_link-343">Figure P9-6</a>?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> How many unit-delay elements are needed in the tapped-delay line to implement the Hilbert transformer whose coefficients are shown in <a href="#calibre_link-343">Figure P9-6</a>?</p>
<p class="indenthangingn"><strong class="calibre9">(d)</strong> How many multipliers are needed in the standard tapped-delay line implementation of this Hilbert transformer?</p>
<p class="indenthanging"><strong class="calibre9">9.7</strong> The text’s <a href="#calibre_link-319">Eq. (9-11)</a> provided the expression for the impulse response of a discrete Hilbert transformer. That expression is repeated here as</p>
<p class="image"><img src="images/000174.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">The text also presented an alternate expression for the impulse response of a discrete Hilbert transformer, <a href="#calibre_link-320">Eq. (9-12)</a>, under the assumption that <em class="calibre7">f<sub class="calibre12">s</sub></em> is normalized to unity. That alternate expression is repeated here as</p>
<p class="image"><img src="images/001017.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">Show that the expressions for <em class="calibre7">h</em>(<em class="calibre7">n</em>) and <em class="calibre7">h</em>’(<em class="calibre7">n</em>) are equal.</p>
<p class="indenthanging"><strong class="calibre9">9.8</strong> Assume that we’ve performed the discrete Fourier transform (DFT) of an <em class="calibre7">N</em>-sample <em class="calibre7">x</em>(<em class="calibre7">n</em>) time-domain sequence to obtain a frequency-domain <em class="calibre7">X</em>(<em class="calibre7">m</em>) sequence. <em class="calibre7">X</em>(<em class="calibre7">m</em>)’s integer frequency index is 0 ≤ <em class="calibre7">m</em> ≤ <em class="calibre7">N</em>&ndash;1. If <em class="calibre7">N</em> is even and <em class="calibre7">X</em>(0) = <em class="calibre7">X</em>(<em class="calibre7">N</em>/2) = 0, describe what operations must be performed on <em class="calibre7">X</em>(<em class="calibre7">m</em>) to create a new frequency-domain <em class="calibre7">X</em><sub class="calibre12">new</sub>(<em class="calibre7">m</em>) sequence whose inverse DFT is the Hilbert transform of <em class="calibre7">x</em>(<em class="calibre7">n</em>). (Stated in different words: How do we perform the Hilbert transform in the frequency domain?)</p>
<p class="indenthanging"><strong class="calibre9">9.9</strong> In the literature of DSP you may learn that we can design an <em class="calibre7">N</em>-tap Hilbert transformer by first designing an <em class="calibre7">N</em>-tap half-band nonrecursive FIR filter (where <em class="calibre7">N</em>+1 is an integer multiple of four), yielding coefficients <em class="calibre7">h</em>(<em class="calibre7">n</em>). Next, we multiply the half-band filter’s <em class="calibre7">h</em>(<em class="calibre7">n</em>) coefficients by 2sin(π<em class="calibre7">n</em>/2) to obtain the desired <em class="calibre7">h</em><sub class="calibre12">hilb</sub>(<em class="calibre7">n</em>) Hilbert transformer coefficients. That is,</p>
<p class="center"><em class="calibre7">h</em><sub class="calibre12">hilb</sub>(<em class="calibre7">n</em>) = 2sin(π<em class="calibre7">n</em>/2)<em class="calibre7">h</em>(<em class="calibre7">n</em>).</p>
<p class="indentpara">Not emphasized in the literature, however, is the fact that the above <em class="calibre7">h</em><sub class="calibre12">hilb</sub>(<em class="calibre7">n</em>) expression is only valid when the <em class="calibre7">h</em>(<em class="calibre7">n</em>) coefficients’ <em class="calibre7">n</em> index is in the range</p>
<p class="image"><a id="calibre_link-3009"></a><img src="images/000065.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">where <em class="calibre7">h</em>(0) is the middle coefficient of <em class="calibre7">h</em>(<em class="calibre7">n</em>) as shown for an 11-tap half-band FIR filter in <a href="#calibre_link-345">Figure P9-9(a)</a>. In this textbook we typically use the more traditional FIR filter coefficient indexing notation of <em class="calibre7">k</em> = 0, 1, 2, ..., <em class="calibre7">N</em>&ndash;1 as shown in <a href="#calibre_link-345">Figure P9-9(b)</a>. What is the correct equation for the <em class="calibre7">h</em><sub class="calibre12">hilb</sub>(<em class="calibre7">k</em>) coefficients when the half-band filter’s coefficients are <em class="calibre7">h</em>(<em class="calibre7">k</em>) with index <em class="calibre7">k</em> defined using our standard notation of <em class="calibre7">k</em> = 0, 1, 2, ..., <em class="calibre7">N</em>&ndash;1 as shown in <a href="#calibre_link-345">Figure P9-9(b)</a>?</p>
<p class="caption"><a id="calibre_link-345"></a><strong class="calibre9">Figure P9-9</strong></p>
<p class="image"><img src="images/001158.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">9.10</strong> In <a href="#calibre_link-346">Section 9.4</a> we presented a 7-tap (6th-order) FIR Hilbert transformer filter, used to compute the complex sequence <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>) = <em class="calibre7">x</em>’<sub class="calibre12">r</sub>(<em class="calibre7">n</em>) + <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>) based on the real input sequence <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>), as shown in <a href="#calibre_link-347">Figure P9-10</a>.</p>
<p class="caption"><a id="calibre_link-347"></a><strong class="calibre9">Figure P9-10</strong></p>
<p class="image"><img src="images/000306.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara"><a id="calibre_link-3010"></a>Clever DSP engineers always seek to reduce the number of multipliers in their systems. Redesign the Hilbert transformer in <a href="#calibre_link-347">Figure P9-10</a> to a form that reduces the number of necessary multiplications per output sample. Draw the block diagram of your new design.</p>
<p class="indentpara"><strong class="calibre9">Hint:</strong> Write the difference equation for the <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>) output sequence, and recall the symmetry relationships between the Hilbert transformer filter’s coefficients.</p>
<p class="indenthanging"><strong class="calibre9">9.11</strong> Similar to the structure in the text’s <a href="#calibre_link-326">Figure 9-12</a>:</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Draw the block diagram of a tapped-delay line FIR Hilbert transformer filter, having 6 taps, that will generate both <em class="calibre7">x</em>’<sub class="calibre12">r</sub>(<em class="calibre7">n</em>) and <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>).</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> Comment on the practicality of this even-tap implementation relative to building a Hilbert transformer having an odd number of taps. (That is, is an even-tap or an odd-tap Hilbert transformer easier to implement?) Someday, if you’re designing a Hilbert transformer for a real-world project, the answer to this question may be <em class="calibre7">very</em> important!</p>
<p class="indenthanging"><strong class="calibre9">9.12</strong> In this chapter we discussed the notion of building a tapped-delay line FIR filter whose coefficients are complex-valued. Explain why, or why not, such a filter’s frequency magnitude response is periodic.</p>
<p class="indenthanging"><strong class="calibre9">9.13</strong> Because an FIR Hilbert transformer is a linear time-invariant (LTI) system, there are two ways to determine its frequency response. The first way is to derive an equation for the transformer’s frequency response as a function of a continuous frequency variable, just as we did for IIR filters in <a href="#calibre_link-348">Section 6.4</a>. Given that, we could plot that equation’s magnitude and phase, using software, on our computer screen. The second method to determine a Hilbert transformer’s frequency response is to perform the discrete Fourier transform (DFT) of the Hilbert transformer’s unit impulse response, and plot the magnitude and phase of the DFT results.</p>
<p class="indenthangingn"><strong class="calibre9">(a)</strong> Derive the expression for the frequency response of a (<em class="calibre7">K</em>&ndash;1)th-order (<em class="calibre7">K</em> taps) Hilbert transformer as a function of a continuous frequency variable ω in the range of &ndash;π to +π radians/sample.</p>
<p class="indenthangingn"><strong class="calibre9">(b)</strong> If you were to model your equation from Part (a) using software, over what range would you define your continuous frequency variable?</p>
<p class="indenthangingn"><strong class="calibre9">(c)</strong> The above Parts (a) and (b) were related to the algebraic method for finding a Hilbert transformer’s frequency response in the form of an equation that is a function of a continuous frequency variable. We can also use the discrete Fourier transform (DFT) to estimate a Hilbert transformer’s frequency response. Provide the equation for the <em class="calibre7">K</em>-point DFT of a (<em class="calibre7">K</em>&ndash;1)th-order Hilbert transformer’s unit impulse response.</p>
<p class="indenthangingn"><a id="calibre_link-3011"></a><strong class="calibre9">(d)</strong> For a 43rd-order Hilbert transformer, how many frequency-domain samples would result from your Part (c) DFT equation? How can you increase the number of DFT frequency-domain samples to see finer detail (improved granularity) of the Hilbert transformer’s frequency response?</p>
<p class="indenthanging"><strong class="calibre9">9.14</strong> Determine the closed-form equation, as a function of the number of coefficients <em class="calibre7">K</em>, of the number of multipliers needed by a tapped-delay line FIR Hilbert transformer when <em class="calibre7">K</em> is an odd number. That is, write the expression for <em class="calibre7">N</em><sub class="calibre12">mults</sub> = <em class="calibre7">some function of K</em>. Do not consider the case of a <em class="calibre7">folded</em> delay line structure alluded to in the text.</p>
<p class="indentpara"><strong class="calibre9">Hint</strong>: Due to the unusual situation when <em class="calibre7">K</em> − 1 is an integer multiple of four, you’ll have to use the mathematical notation of <img src="images/000851.jpg" alt="image" class="calibre2" /> which means the “integer part of number <em class="calibre7">X</em>.”</p>
<p class="indenthanging"><strong class="calibre9">9.15</strong> Suppose we wish to implement the quadrature processing system in <a href="#calibre_link-349">Figure P9-15</a> where <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) is a real-valued sequence whose discrete-time Fourier transform is <em class="calibre7">X</em><sub class="calibre12">r</sub>(ω), and ω is our digital frequency ranging from &ndash;π to π radians/sample. The sequences <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) and <em class="calibre7">x</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>) are interpreted as the real and imaginary parts of a complex sequence <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>) = <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">n</em>) + <em class="calibre7">jx</em><sub class="calibre12">i</sub>(<em class="calibre7">n</em>). Under the restriction that we want the discrete-time Fourier transform of <em class="calibre7">x</em><sub class="calibre12">c</sub>(<em class="calibre7">n</em>) to be defined by</p>
<p class="image"><img src="images/000909.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-349"></a><strong class="calibre9">Figure P9-15</strong></p>
<p class="image"><img src="images/001146.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">fill in the following blank lines defining the <em class="calibre7">H</em>(ω) network’s frequency response:</p>
<p class="image"><img src="images/001771.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">That is, what is <em class="calibre7">H</em>(ω) so that <em class="calibre7">X</em><sub class="calibre12">c</sub>(ω) is equal to <em class="calibre7">X</em><sub class="calibre12">r</sub>(ω) for negative frequencies, and equal to zero for positive frequencies. Show your work.</p>
<p class="indentpara"><strong class="calibre9">Hint:</strong> Begin by writing an expression for <em class="calibre7">X</em><sub class="calibre12">c</sub>(ω) in terms of <em class="calibre7">X</em><sub class="calibre12">r</sub>(ω) and <em class="calibre7">H</em>(ω).</p>
<p class="indenthanging"><strong class="calibre9">9.16</strong> Consider the network given in <a href="#calibre_link-350">Figure P9-16(a)</a> whose input is the complex <em class="calibre7">x</em>(<em class="calibre7">t</em>) = <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) + <em class="calibre7">jx</em><sub class="calibre12">i</sub>(<em class="calibre7">t</em>) signal, and whose output is the complex <em class="calibre7">y</em>(<em class="calibre7">t</em>) = <em class="calibre7">y</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) + <em class="calibre7">jy</em><sub class="calibre12">i</sub>(<em class="calibre7">t</em>) signal. <a id="calibre_link-3012"></a>The block labeled “H” represents a Hilbert transform. The <em class="calibre7">x</em>(<em class="calibre7">t</em>) input has the spectrum shown by the bold arrows in <a href="#calibre_link-350">Figure P9-16(b)</a>. Using a format similar to <a href="#calibre_link-350">Figure P9-16(b)</a>, draw the three-dimensional spectrum of the <em class="calibre7">y</em>(<em class="calibre7">t</em>) output.</p>
<p class="caption"><a id="calibre_link-350"></a><strong class="calibre9">Figure P9-16</strong></p>
<p class="image"><img src="images/000193.jpg" alt="image" class="calibre2" /></p>
<p class="indenthanging"><strong class="calibre9">9.17</strong> Consider the real-valued continuous <em class="calibre7">x</em><sub class="calibre12">r</sub>(<em class="calibre7">t</em>) cosine signal shown in <a href="#calibre_link-351">Figure P9-17(a)</a>. That cosine wave’s peak amplitude fluctuates as follows:</p>
<p class="image"><img src="images/000933.jpg" alt="image" class="calibre2" /></p>
<p class="caption"><a id="calibre_link-351"></a><strong class="calibre9">Figure P9-17</strong></p>
<p class="image"><img src="images/001036.jpg" alt="image" class="calibre2" /></p>
<p class="indentpara">If we generate the analytic <em class="calibre7">x</em><sub class="calibre12">a</sub>(<em class="calibre7">t</em>) signal, using a Hilbert transformer as shown in <a href="#calibre_link-351">Figure P9-17(b)</a>, draw the time-domain magnitude of <em class="calibre7">x</em><sub class="calibre12">a</sub>(<em class="calibre7">t</em>).</p>
</div>


</body></html>
